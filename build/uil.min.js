!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports):"function"==typeof define&&define.amd?define(["exports"],i):i((t="undefined"!=typeof globalThis?globalThis:t||self).UIL={})}(this,(function(t){"use strict";var i=function(t){var i,s=Object.prototype,e=s.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},n=o.iterator||"@@iterator",h=o.asyncIterator||"@@asyncIterator",r=o.toStringTag||"@@toStringTag";function a(t,i,s){return Object.defineProperty(t,i,{value:s,enumerable:!0,configurable:!0,writable:!0}),t[i]}try{a({},"")}catch(t){a=function(t,i,s){return t[i]=s}}function l(t,i,s,e){var o=i&&i.prototype instanceof m?i:m,n=Object.create(o.prototype),h=new z(e||[]);return n._invoke=function(t,i,s){var e=u;return function(o,n){if(e===p)throw new Error("Generator is already running");if(e===f){if("throw"===o)throw n;return H()}for(s.method=o,s.arg=n;;){var h=s.delegate;if(h){var r=I(h,s);if(r){if(r===v)continue;return r}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(e===u)throw e=f,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);e=p;var a=c(t,i,s);if("normal"===a.type){if(e=s.done?f:d,a.arg===v)continue;return{value:a.arg,done:s.done}}"throw"===a.type&&(e=f,s.method="throw",s.arg=a.arg)}}}(t,s,h),n}function c(t,i,s){try{return{type:"normal",arg:t.call(i,s)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var u="suspendedStart",d="suspendedYield",p="executing",f="completed",v={};function m(){}function g(){}function x(){}var b={};b[n]=function(){return this};var w=Object.getPrototypeOf,y=w&&w(w(D([])));y&&y!==s&&e.call(y,n)&&(b=y);var k=x.prototype=m.prototype=Object.create(b);function C(t){["next","throw","return"].forEach((function(i){a(t,i,(function(t){return this._invoke(i,t)}))}))}function S(t,i){function s(o,n,h,r){var a=c(t[o],t,n);if("throw"!==a.type){var l=a.arg,u=l.value;return u&&"object"==typeof u&&e.call(u,"__await")?i.resolve(u.__await).then((function(t){s("next",t,h,r)}),(function(t){s("throw",t,h,r)})):i.resolve(u).then((function(t){l.value=t,h(l)}),(function(t){return s("throw",t,h,r)}))}r(a.arg)}var o;this._invoke=function(t,e){function n(){return new i((function(i,o){s(t,e,i,o)}))}return o=o?o.then(n,n):n()}}function I(t,s){var e=t.iterator[s.method];if(e===i){if(s.delegate=null,"throw"===s.method){if(t.iterator.return&&(s.method="return",s.arg=i,I(t,s),"throw"===s.method))return v;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var o=c(e,t.iterator,s.arg);if("throw"===o.type)return s.method="throw",s.arg=o.arg,s.delegate=null,v;var n=o.arg;return n?n.done?(s[t.resultName]=n.value,s.next=t.nextLoc,"return"!==s.method&&(s.method="next",s.arg=i),s.delegate=null,v):n:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,v)}function M(t){var i={tryLoc:t[0]};1 in t&&(i.catchLoc=t[1]),2 in t&&(i.finallyLoc=t[2],i.afterLoc=t[3]),this.tryEntries.push(i)}function L(t){var i=t.completion||{};i.type="normal",delete i.arg,t.completion=i}function z(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(M,this),this.reset(!0)}function D(t){if(t){var s=t[n];if(s)return s.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,h=function s(){for(;++o<t.length;)if(e.call(t,o))return s.value=t[o],s.done=!1,s;return s.value=i,s.done=!0,s};return h.next=h}}return{next:H}}function H(){return{value:i,done:!0}}return g.prototype=k.constructor=x,x.constructor=g,g.displayName=a(x,r,"GeneratorFunction"),t.isGeneratorFunction=function(t){var i="function"==typeof t&&t.constructor;return!!i&&(i===g||"GeneratorFunction"===(i.displayName||i.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,a(t,r,"GeneratorFunction")),t.prototype=Object.create(k),t},t.awrap=function(t){return{__await:t}},C(S.prototype),S.prototype[h]=function(){return this},t.AsyncIterator=S,t.async=function(i,s,e,o,n){void 0===n&&(n=Promise);var h=new S(l(i,s,e,o),n);return t.isGeneratorFunction(s)?h:h.next().then((function(t){return t.done?t.value:h.next()}))},C(k),a(k,r,"Generator"),k[n]=function(){return this},k.toString=function(){return"[object Generator]"},t.keys=function(t){var i=[];for(var s in t)i.push(s);return i.reverse(),function s(){for(;i.length;){var e=i.pop();if(e in t)return s.value=e,s.done=!1,s}return s.done=!0,s}},t.values=D,z.prototype={constructor:z,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=i,this.done=!1,this.delegate=null,this.method="next",this.arg=i,this.tryEntries.forEach(L),!t)for(var s in this)"t"===s.charAt(0)&&e.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=i)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var s=this;function o(e,o){return r.type="throw",r.arg=t,s.next=e,o&&(s.method="next",s.arg=i),!!o}for(var n=this.tryEntries.length-1;n>=0;--n){var h=this.tryEntries[n],r=h.completion;if("root"===h.tryLoc)return o("end");if(h.tryLoc<=this.prev){var a=e.call(h,"catchLoc"),l=e.call(h,"finallyLoc");if(a&&l){if(this.prev<h.catchLoc)return o(h.catchLoc,!0);if(this.prev<h.finallyLoc)return o(h.finallyLoc)}else if(a){if(this.prev<h.catchLoc)return o(h.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<h.finallyLoc)return o(h.finallyLoc)}}}},abrupt:function(t,i){for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s];if(o.tryLoc<=this.prev&&e.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var n=o;break}}n&&("break"===t||"continue"===t)&&n.tryLoc<=i&&i<=n.finallyLoc&&(n=null);var h=n?n.completion:{};return h.type=t,h.arg=i,n?(this.method="next",this.next=n.finallyLoc,v):this.complete(h)},complete:function(t,i){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&i&&(this.next=i),v},finish:function(t){for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i];if(s.finallyLoc===t)return this.complete(s.completion,s.afterLoc),L(s),v}},catch:function(t){for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i];if(s.tryLoc===t){var e=s.completion;if("throw"===e.type){var o=e.arg;L(s)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,s,e){return this.delegate={iterator:D(t),resultName:s,nextLoc:e},"next"===this.method&&(this.arg=i),v}},t}("object"==typeof module?module.exports:{});try{regeneratorRuntime=i}catch(t){Function("r","regeneratorRuntime = r")(i)}var s={frag:document.createDocumentFragment(),colorRing:null,joystick_0:null,joystick_1:null,circular:null,knob:null,svgns:"http://www.w3.org/2000/svg",links:"http://www.w3.org/1999/xlink",htmls:"http://www.w3.org/1999/xhtml",DOM_SIZE:["height","width","top","left","bottom","right","margin-left","margin-right","margin-top","margin-bottom"],SVG_TYPE_D:["pattern","defs","transform","stop","animate","radialGradient","linearGradient","animateMotion","use","filter","feColorMatrix"],SVG_TYPE_G:["svg","rect","circle","path","polygon","text","g","line","foreignObject"],PI:Math.PI,TwoPI:2*Math.PI,pi90:.5*Math.PI,pi60:Math.PI/3,torad:Math.PI/180,todeg:180/Math.PI,clamp:function(t,i,s){return t=(t=t<i?i:t)>s?s:t},size:{w:240,h:20,p:30,s:8},colors:{text:"#dcdcdc",textOver:"#FFFFFF",txtselectbg:"none",background:"rgba(50,50,50,0.5)",backgroundOver:"rgba(50,50,50,0.5)",inputBorder:"#454545",inputHolder:"#808080",inputBorderSelect:"#005AAA",inputBg:"rgba(0,0,0,0.1)",inputOver:"rgba(0,0,0,0.2)",border:"#454545",borderOver:"#5050AA",borderSelect:"#308AFF",button:"#3c3c3c",boolbg:"#181818",boolon:"#C0C0C0",select:"#308AFF",moving:"#03afff",down:"#024699",over:"#024699",action:"#FF3300",stroke:"rgba(11,11,11,0.5)",scroll:"#333333",scrollback:"rgba(44,44,44,0.2)",scrollbackover:"rgba(44,44,44,0.2)",hide:"rgba(0,0,0,0)",groupBorder:"#3e3e3e",buttonBorder:"#4a4a4a",fontFamily:"Tahoma",fontShadow:"none",fontSize:11,radius:4},css:{basic:"position:absolute; pointer-events:none; box-sizing:border-box; margin:0; padding:0; overflow:hidden; -o-user-select:none; -ms-user-select:none; -khtml-user-select:none; -webkit-user-select:none; -moz-user-select:none;",button:"display:flex; justify-content:center; align-items:center; text-align:center;"},svgs:{group:"M 7 7 L 7 8 8 8 8 7 7 7 M 5 7 L 5 8 6 8 6 7 5 7 M 3 7 L 3 8 4 8 4 7 3 7 M 7 5 L 7 6 8 6 8 5 7 5 M 6 6 L 6 5 5 5 5 6 6 6 M 7 3 L 7 4 8 4 8 3 7 3 M 6 4 L 6 3 5 3 5 4 6 4 M 3 5 L 3 6 4 6 4 5 3 5 M 3 3 L 3 4 4 4 4 3 3 3 Z",arrow:"M 3 8 L 8 5 3 2 3 8 Z",arrowDown:"M 5 8 L 8 3 2 3 5 8 Z",arrowUp:"M 5 2 L 2 7 8 7 5 2 Z",solid:"M 13 10 L 13 1 4 1 1 4 1 13 10 13 13 10 M 11 3 L 11 9 9 11 3 11 3 5 5 3 11 3 Z",body:"M 13 10 L 13 1 4 1 1 4 1 13 10 13 13 10 M 11 3 L 11 9 9 11 3 11 3 5 5 3 11 3 M 5 4 L 4 5 4 10 9 10 10 9 10 4 5 4 Z",vehicle:"M 13 6 L 11 1 3 1 1 6 1 13 3 13 3 11 11 11 11 13 13 13 13 6 M 2.4 6 L 4 2 10 2 11.6 6 2.4 6 M 12 8 L 12 10 10 10 10 8 12 8 M 4 8 L 4 10 2 10 2 8 4 8 Z",articulation:"M 13 9 L 12 9 9 2 9 1 5 1 5 2 2 9 1 9 1 13 5 13 5 9 4 9 6 5 8 5 10 9 9 9 9 13 13 13 13 9 Z",character:"M 13 4 L 12 3 9 4 5 4 2 3 1 4 5 6 5 8 4 13 6 13 7 9 8 13 10 13 9 8 9 6 13 4 M 6 1 L 6 3 8 3 8 1 6 1 Z",terrain:"M 13 8 L 12 7 Q 9.06 -3.67 5.95 4.85 4.04 3.27 2 7 L 1 8 7 13 13 8 M 3 8 Q 3.78 5.420 5.4 6.6 5.20 7.25 5 8 L 7 8 Q 8.39 -0.16 11 8 L 7 11 3 8 Z",joint:"M 7.7 7.7 Q 8 7.45 8 7 8 6.6 7.7 6.3 7.45 6 7 6 6.6 6 6.3 6.3 6 6.6 6 7 6 7.45 6.3 7.7 6.6 8 7 8 7.45 8 7.7 7.7 M 3.35 8.65 L 1 11 3 13 5.35 10.65 Q 6.1 11 7 11 8.28 11 9.25 10.25 L 7.8 8.8 Q 7.45 9 7 9 6.15 9 5.55 8.4 5 7.85 5 7 5 6.54 5.15 6.15 L 3.7 4.7 Q 3 5.712 3 7 3 7.9 3.35 8.65 M 10.25 9.25 Q 11 8.28 11 7 11 6.1 10.65 5.35 L 13 3 11 1 8.65 3.35 Q 7.9 3 7 3 5.7 3 4.7 3.7 L 6.15 5.15 Q 6.54 5 7 5 7.85 5 8.4 5.55 9 6.15 9 7 9 7.45 8.8 7.8 L 10.25 9.25 Z",ray:"M 9 11 L 5 11 5 12 9 12 9 11 M 12 5 L 11 5 11 9 12 9 12 5 M 11.5 10 Q 10.9 10 10.45 10.45 10 10.9 10 11.5 10 12.2 10.45 12.55 10.9 13 11.5 13 12.2 13 12.55 12.55 13 12.2 13 11.5 13 10.9 12.55 10.45 12.2 10 11.5 10 M 9 10 L 10 9 2 1 1 2 9 10 Z",collision:"M 11 12 L 13 10 10 7 13 4 11 2 7.5 5.5 9 7 7.5 8.5 11 12 M 3 2 L 1 4 4 7 1 10 3 12 8 7 3 2 Z",map:"M 13 1 L 1 1 1 13 13 13 13 1 M 12 2 L 12 7 7 7 7 12 2 12 2 7 7 7 7 2 12 2 Z",material:"M 13 1 L 1 1 1 13 13 13 13 1 M 12 2 L 12 7 7 7 7 12 2 12 2 7 7 7 7 2 12 2 Z",texture:"M 13 4 L 13 1 1 1 1 4 5 4 5 13 9 13 9 4 13 4 Z",object:"M 10 1 L 7 4 4 1 1 1 1 13 4 13 4 5 7 8 10 5 10 13 13 13 13 1 10 1 Z",none:"M 9 5 L 5 5 5 9 9 9 9 5 Z",cursor:"M 4 7 L 1 10 1 12 2 13 4 13 7 10 9 14 14 0 0 5 4 7 Z"},setStyle:function(t){for(var i in t)s.colors[i]&&(s.colors[i]=t[i]);s.setText()},setText:function(t,i,e,o){var n=s.colors;void 0!==e&&(n.fontFamily=e),void 0!==i&&(n.text=i),void 0!==t&&(n.fontSize=t),s.css.txt=s.css.basic+"font-family:"+n.fontFamily+"; font-size:"+n.fontSize+"px; color:"+n.text+"; padding:2px 10px; left:0; top:2px; height:16px; width:100px; overflow:hidden; white-space: nowrap;",void 0!==o&&(s.css.txt+=" text-shadow:"+o+"; "),"none"!==n.fontShadow&&(s.css.txt+=" text-shadow: 1px 1px 1px "+n.fontShadow+";"),s.css.txtselect=s.css.txt+"display:flex; justify-content:left; align-items:center; text-align:left;padding:2px 5px; border:1px dashed "+n.border+"; background:"+n.txtselectbg+";",s.css.item=s.css.txt+"position:relative; background:rgba(0,0,0,0.2); margin-bottom:1px;"},cloneColor:function(){return Object.assign({},s.colors)},cloneCss:function(){return Object.assign({},s.css)},clone:function(t){return t.cloneNode(!0)},setSvg:function(t,i,s,e,o){-1===e?t.setAttributeNS(null,i,s):void 0!==o?t.childNodes[e||0].childNodes[o||0].setAttributeNS(null,i,s):t.childNodes[e||0].setAttributeNS(null,i,s)},setCss:function(t,i){for(var e in i)-1!==s.DOM_SIZE.indexOf(e)?t.style[e]=i[e]+"px":t.style[e]=i[e]},set:function(t,i){for(var e in i)"txt"===e&&(t.textContent=i[e]),"link"===e?t.setAttributeNS(s.links,"xlink:href",i[e]):t.setAttributeNS(null,e,i[e])},get:function(t,i){if(void 0===i)return t;if(!isNaN(i))return t.childNodes[i];if(i instanceof Array){if(2===i.length)return t.childNodes[i[0]].childNodes[i[1]];if(3===i.length)return t.childNodes[i[0]].childNodes[i[1]].childNodes[i[2]]}},dom:function(t,i,e,o,n){return t=t||"div",-1!==s.SVG_TYPE_D.indexOf(t)||-1!==s.SVG_TYPE_G.indexOf(t)?"svg"===t?(o=document.createElementNS(s.svgns,"svg"),s.set(o,e)):(void 0===o&&(o=document.createElementNS(s.svgns,"svg")),s.addAttributes(o,t,e,n)):o=void 0===o?document.createElementNS(s.htmls,t):o.appendChild(document.createElementNS(s.htmls,t)),i&&(o.style.cssText=i),void 0===n?o:o.childNodes[n||0]},addAttributes:function(t,i,e,o){var n=document.createElementNS(s.svgns,i);return s.set(n,e),s.get(t,o).appendChild(n),-1!==s.SVG_TYPE_G.indexOf(i)&&(n.style.pointerEvents="none"),n},clear:function(t){for(s.purge(t);t.firstChild;)t.firstChild.firstChild&&s.clear(t.firstChild),t.removeChild(t.firstChild)},purge:function(t){var i,e,o=t.attributes;if(o)for(i=o.length;i--;)"function"==typeof t[e=o[i].name]&&(t[e]=null);if(o=t.childNodes)for(i=o.length;i--;)s.purge(t.childNodes[i])},ColorLuma:function(t,i){"n"===t&&(t="#000"),(t=String(t).replace(/[^0-9a-f]/gi,"")).length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),i=i||0;var s,e,o="#";for(e=0;e<3;e++)s=parseInt(t.substr(2*e,2),16),o+=("00"+(s=Math.round(Math.min(Math.max(0,s+s*i),255)).toString(16))).substr(s.length);return o},findDeepInver:function(t){return.3*t[0]+.59*t[1]+.11*t[2]<=.6},hexToHtml:function(t){return"#"+("000000"+(t=void 0===t?0:t).toString(16)).substr(-6)},htmlToHex:function(t){return t.toUpperCase().replace("#","0x")},u255:function(t,i){return parseInt(t.substring(i,i+2),16)/255},u16:function(t,i){return parseInt(t.substring(i,i+1),16)/15},unpack:function(t){return 7==t.length?[s.u255(t,1),s.u255(t,3),s.u255(t,5)]:4==t.length?[s.u16(t,1),s.u16(t,2),s.u16(t,3)]:void 0},htmlRgb:function(t){return"rgb("+Math.round(255*t[0])+","+Math.round(255*t[1])+","+Math.round(255*t[2])+")"},pad:function(t){return 1==t.length&&(t="0"+t),t},rgbToHex:function(t){var i=Math.round(255*t[0]).toString(16),e=Math.round(255*t[1]).toString(16),o=Math.round(255*t[2]).toString(16);return"#"+s.pad(i)+s.pad(e)+s.pad(o)},hueToRgb:function(t,i,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?t+6*(i-t)*s:s<.5?i:s<2/3?t+6*(i-t)*(2/3-s):t},rgbToHsl:function(t){var i=t[0],s=t[1],e=t[2],o=Math.min(i,s,e),n=Math.max(i,s,e),h=n-o,r=0,a=0,l=(o+n)/2;return l>0&&l<1&&(a=h/(l<.5?2*l:2-2*l)),h>0&&(n==i&&n!=s&&(r+=(s-e)/h),n==s&&n!=e&&(r+=2+(e-i)/h),n==e&&n!=i&&(r+=4+(i-s)/h),r/=6),[r,a,l]},hslToRgb:function(t){var i,e,o=t[0],n=t[1],h=t[2];return 0===n?[h,h,h]:(i=2*h-(e=h<=.5?h*(n+1):h+n-h*n),[s.hueToRgb(i,e,o+.33333),s.hueToRgb(i,e,o),s.hueToRgb(i,e,o-.33333)])},makeGradiant:function(t,i,e,o){s.dom(t,null,i,e,0);for(var n,h=e.childNodes[0].childNodes.length-1,r=0;r<o.length;r++)n=o[r],s.dom("stop",null,{offset:n[0]+"%","stop-color":n[1],"stop-opacity":n[2]},e,[0,h])},makeKnob:function(t){var i=128,e=s.dom("svg",s.css.basic,{viewBox:"0 0 128 "+i,width:i,height:i,preserveAspectRatio:"none"});s.dom("circle","",{cx:64,cy:64,r:34,fill:s.colors.button,stroke:"rgba(0,0,0,0.3)","stroke-width":8},e),s.dom("path","",{d:"",stroke:s.colors.text,"stroke-width":4,fill:"none","stroke-linecap":"round"},e),s.dom("circle","",{cx:64,cy:64,r:41,stroke:"rgba(0,0,0,0.1)","stroke-width":7,fill:"none"},e),s.dom("path","",{d:"",stroke:"rgba(255,255,255,0.3)","stroke-width":2,fill:"none","stroke-linecap":"round","stroke-opacity":.5},e),s.knob=e},makeCircular:function(t){var i=128,e=s.dom("svg",s.css.basic,{viewBox:"0 0 128 "+i,width:i,height:i,preserveAspectRatio:"none"});s.dom("circle","",{cx:64,cy:64,r:40,stroke:"rgba(0,0,0,0.1)","stroke-width":10,fill:"none"},e),s.dom("path","",{d:"",stroke:s.colors.text,"stroke-width":7,fill:"none","stroke-linecap":"butt"},e),s.circular=e},makeJoystick:function(t){var i,e=128,o=Math.floor(49),n=Math.floor(.6*o),h=s.dom("svg",s.css.basic,{viewBox:"0 0 128 "+e,width:e,height:e,preserveAspectRatio:"none"});if(s.dom("defs",null,{},h),s.dom("g",null,{},h),0===t){i=[[40,"rgb(0,0,0)",.3],[80,"rgb(0,0,0)",0],[90,"rgb(50,50,50)",.4],[100,"rgb(50,50,50)",0]],s.makeGradiant("radialGradient",{id:"grad",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"},h,i),i=[[60,"rgb(0,0,0)",.5],[100,"rgb(0,0,0)",0]],s.makeGradiant("radialGradient",{id:"gradS",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"},h,i);var r=["rgb(40,40,40)","rgb(48,48,48)","rgb(30,30,30)"],a=["rgb(1,90,197)","rgb(3,95,207)","rgb(0,65,167)"];i=[[30,r[0],1],[60,r[1],1],[80,r[1],1],[100,r[2],1]],s.makeGradiant("radialGradient",{id:"gradIn",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"},h,i),i=[[30,a[0],1],[60,a[1],1],[80,a[1],1],[100,a[2],1]],s.makeGradiant("radialGradient",{id:"gradIn2",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"},h,i),s.dom("circle","",{cx:64,cy:64,r:o,fill:"url(#grad)"},h),s.dom("circle","",{cx:69,cy:74,r:n+10,fill:"url(#gradS)"},h),s.dom("circle","",{cx:64,cy:64,r:n,fill:"url(#gradIn)"},h),s.joystick_0=h}else i=[[69,"rgb(0,0,0)",0],[70,"rgb(0,0,0)",.3],[100,"rgb(0,0,0)",0]],s.makeGradiant("radialGradient",{id:"gradX",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"},h,i),s.dom("circle","",{cx:64,cy:64,r:o,fill:"none",stroke:"rgba(100,100,100,0.25)","stroke-width":"4"},h),s.dom("circle","",{cx:64,cy:64,r:n+14,fill:"url(#gradX)"},h),s.dom("circle","",{cx:64,cy:64,r:n,fill:"none",stroke:"rgb(100,100,100)","stroke-width":"4"},h),s.joystick_1=h},makeColorRing:function(){var t=256,i=s.dom("svg",s.css.basic,{viewBox:"0 0 256 "+t,width:t,height:t,preserveAspectRatio:"none"});s.dom("defs",null,{},i),s.dom("g",null,{},i);var e,o,n,h,r,a,l,c,u,d=128,p=8/113/24*Math.PI,f=0,v=[];for(a=0;a<=24;++a){if(e=.5*(f+(h=(n=a/24)*s.TwoPI)),o=1/Math.cos(.5*(h-f)),r=[Math.sin(f),-Math.cos(f),Math.sin(e)*o,-Math.cos(e)*o,Math.sin(h),-Math.cos(h)],v[1]=s.rgbToHex(s.hslToRgb([n,1,.5])),a>0){for(l=6;l--;)r[l]=(113*r[l]+d).toFixed(2);c=" M"+r[0]+" "+r[1]+" Q"+r[2]+" "+r[3]+" "+r[4]+" "+r[5],u=[[0,v[0],1],[100,v[1],1]],s.makeGradiant("linearGradient",{id:"G"+a,x1:r[0],y1:r[1],x2:r[4],y2:r[5],gradientUnits:"userSpaceOnUse"},i,u),s.dom("path","",{d:c,"stroke-width":30,stroke:"url(#G"+a+")","stroke-linecap":"butt"},i,1)}f=h-p,v[0]=v[1]}u=[[0,"#FFFFFF",1],[50,"#FFFFFF",0],[50,"#000000",0],[100,"#000000",1]],s.makeGradiant("linearGradient",{id:"GL0",x1:0,y1:d-84.9,x2:0,y2:212.9,gradientUnits:"userSpaceOnUse"},i,u),u=[[0,"#7f7f7f",1],[50,"#7f7f7f",.5],[100,"#7f7f7f",0]],s.makeGradiant("linearGradient",{id:"GL1",x1:78.95,y1:0,x2:226,y2:0,gradientUnits:"userSpaceOnUse"},i,u),s.dom("g",null,{"transform-origin":"128px 128px",transform:"rotate(0)"},i),s.dom("polygon","",{points:"78.95 43.1 78.95 212.85 226 128",fill:"red"},i,2),s.dom("polygon","",{points:"78.95 43.1 78.95 212.85 226 128",fill:"url(#GL1)","stroke-width":1,stroke:"url(#GL1)"},i,2),s.dom("polygon","",{points:"78.95 43.1 78.95 212.85 226 128",fill:"url(#GL0)","stroke-width":1,stroke:"url(#GL0)"},i,2),s.dom("path","",{d:"M 255.75 136.5 Q 256 132.3 256 128 256 123.7 255.75 119.5 L 241 128 255.75 136.5 Z",fill:"none","stroke-width":2,stroke:"#000"},i,2),s.dom("circle","",{cx:128,cy:128,r:6,"stroke-width":2,stroke:"#000",fill:"none"},i),s.colorRing=i},icon:function(t,i,e){e=e||40,i=i||"#DEDEDE";var o=["<svg xmlns='"+s.svgns+"' version='1.1' xmlns:xlink='"+s.htmls+"' style='pointer-events:none;' preserveAspectRatio='xMinYMax meet' x='0px' y='0px' width='"+e+"px' height='"+e+"px' viewBox='0 0 256 256'><g>"];switch(t){case"logo":o[1]="<path id='logoin' fill='"+i+"' stroke='none' d='"+s.logoFill_d+"'/>";break;case"save":o[1]="<path stroke='"+i+"' stroke-width='4' stroke-linejoin='round' stroke-linecap='round' fill='none' d='M 26.125 17 L 20 22.95 14.05 17 M 20 9.95 L 20 22.95'/><path stroke='"+i,o[1]+="' stroke-width='2.5' stroke-linejoin='round' stroke-linecap='round' fill='none' d='M 32.6 23 L 32.6 25.5 Q 32.6 28.5 29.6 28.5 L 10.6 28.5 Q 7.6 28.5 7.6 25.5 L 7.6 23'/>"}return o[2]="</g></svg>",o.join("\n")},logoFill_d:["M 171 150.75 L 171 33.25 155.5 33.25 155.5 150.75 Q 155.5 162.2 147.45 170.2 139.45 178.25 128 178.25 116.6 178.25 108.55 170.2 100.5 162.2 100.5 150.75 ","L 100.5 33.25 85 33.25 85 150.75 Q 85 168.65 97.55 181.15 110.15 193.75 128 193.75 145.9 193.75 158.4 181.15 171 168.65 171 150.75 ","M 200 33.25 L 184 33.25 184 150.8 Q 184 174.1 167.6 190.4 151.3 206.8 128 206.8 104.75 206.8 88.3 190.4 72 174.1 72 150.8 L 72 33.25 56 33.25 56 150.75 ","Q 56 180.55 77.05 201.6 98.2 222.75 128 222.75 157.8 222.75 178.9 201.6 200 180.55 200 150.75 L 200 33.25 Z"].join("\n")};s.setText();var e=s,o={ui:[],ID:null,lock:!1,wlock:!1,current:-1,needReZone:!0,isEventsInit:!1,prevDefault:["contextmenu","mousedown","mousemove","mouseup"],pointerEvent:["pointerdown","pointermove","pointerup"],xmlserializer:new XMLSerializer,tmpTime:null,tmpImage:null,oldCursor:"auto",input:null,parent:null,firstImput:!0,hiddenImput:null,hiddenSizer:null,hasFocus:!1,startInput:!1,inputRange:[0,0],cursorId:0,str:"",pos:0,startX:-1,moveX:-1,debugInput:!1,isLoop:!1,listens:[],e:{type:null,clientX:0,clientY:0,keyCode:NaN,key:null,delta:0},isMobile:!1,add:function(t){o.ui.push(t),o.getZone(t),o.isEventsInit||o.initEvents()},testMobile:function(){var t=navigator.userAgent;return!!(t.match(/Android/i)||t.match(/webOS/i)||t.match(/iPhone/i)||t.match(/iPad/i)||t.match(/iPod/i)||t.match(/BlackBerry/i)||t.match(/Windows Phone/i))},remove:function(t){var i=o.ui.indexOf(t);-1!==i&&(o.removeListen(t),o.ui.splice(i,1)),0===o.ui.length&&o.removeEvents()},initEvents:function(){if(!o.isEventsInit){var t=document.body;o.isMobile=o.testMobile(),o.isMobile?(t.addEventListener("touchstart",o,!1),t.addEventListener("touchend",o,!1),t.addEventListener("touchmove",o,!1)):(t.addEventListener("contextmenu",o,!1),t.addEventListener("wheel",o,!1),document.addEventListener("click",o,!1),t.addEventListener("pointerdown",o,!1),document.addEventListener("pointermove",o,!1),document.addEventListener("pointerup",o,!1)),window.addEventListener("keydown",o,!1),window.addEventListener("keyup",o,!1),window.addEventListener("resize",o.resize,!1),o.isEventsInit=!0}},removeEvents:function(){if(o.isEventsInit){var t=document.body;o.isMobile?(t.removeEventListener("touchstart",o,!1),t.removeEventListener("touchend",o,!1),t.removeEventListener("touchmove",o,!1)):(t.removeEventListener("contextmenu",o,!1),t.removeEventListener("wheel",o,!1),document.removeEventListener("click",o,!1),t.removeEventListener("pointerdown",o,!1),document.removeEventListener("pointermove",o,!1),document.removeEventListener("pointerup",o,!1)),window.removeEventListener("keydown",o),window.removeEventListener("keyup",o),window.removeEventListener("resize",o.resize),o.isEventsInit=!1}},resize:function(){o.needReZone=!0;for(var t,i=o.ui.length;i--;)(t=o.ui[i]).isGui&&!t.isCanvasOnly&&t.autoResize&&t.setHeight()},out:function(){console.log("im am out"),o.clearOldID()},in:function(){console.log("im am in")},handleEvent:function(t){if(-1!==t.type.indexOf(o.prevDefault)&&t.preventDefault(),(-1===t.type.indexOf(o.pointerEvent)||"mouse"===t.pointerType&&"pen"===t.pointerType)&&"contextmenu"!==t.type){o.findZone();var i=o.e;"keydown"===t.type&&o.keydown(t),"keyup"===t.type&&o.keyup(t),"wheel"===t.type?i.delta=t.deltaY>0?1:-1:i.delta=0,i.clientX=t.clientX||0,i.clientY=t.clientY||0,i.type=t.type,o.isMobile&&(t.touches&&t.touches.length>0&&(i.clientX=t.touches[0].clientX||0,i.clientY=t.touches[0].clientY||0),"touchstart"===t.type&&(i.type="mousedown"),"touchend"===t.type&&(i.type="mouseup"),"touchmove"===t.type&&(i.type="mousemove")),"pointerdown"===t.type&&(i.type="mousedown"),"pointerup"===t.type&&(i.type="mouseup"),"pointermove"===t.type&&(i.type="mousemove"),"mousedown"===i.type&&(o.lock=!0),"mouseup"===i.type&&(o.lock=!1),o.isMobile&&"mousedown"===i.type&&o.findID(i),"mousemove"!==i.type||o.lock||o.findID(i),null!==o.ID&&(o.ID.isCanvasOnly&&(i.clientX=o.ID.mouse.x,i.clientY=o.ID.mouse.y),o.ID.handleEvent(i)),o.isMobile&&"mouseup"===i.type&&o.clearOldID()}},findID:function(t){for(var i,s,e,n=o.ui.length,h=-1;n--;)if((i=o.ui[n]).isCanvasOnly?(s=i.mouse.x,e=i.mouse.y):(s=t.clientX,e=t.clientY),o.onZone(i,s,e)){(h=n)!==o.current&&(o.clearOldID(),o.current=h,o.ID=i);break}-1===h&&o.clearOldID()},clearOldID:function(){o.ID&&(o.current=-1,o.ID.reset(),o.ID=null,o.cursor())},calcUis:function(t,i,s){var e,o,n=t.length,h=0,r=0;for(o=0;o<n;o++)(e=t[o]).zone.w=e.w,e.zone.h=e.h,e.autoWidth?(e.zone.x=i.x,e.zone.y=s,s+=e.h+1):(0===h&&(s+=e.h+1),e.zone.x=i.x+h,e.zone.y=0===h?s-e.h:r,r=e.zone.y,(h+=e.w)+e.w>i.w&&(h=0)),e.isGroup&&e.calcUis()},findTarget:function(t,i){for(var s=t.length;s--;)if(o.onZone(t[s],i.clientX,i.clientY))return s;return-1},findZone:function(t){if(o.needReZone||t){for(var i,s=o.ui.length;s--;)i=o.ui[s],o.getZone(i),i.isGui&&i.calcUis();o.needReZone=!1}},onZone:function(t,i,s){if(void 0===i||void 0===s)return!1;var e=t.zone,o=i-e.x,n=s-e.y,h=o>=0&&n>=0&&o<=e.w&&n<=e.h;return h?t.local.set(o,n):t.local.neg(),h},getZone:function(t){if(!t.isCanvasOnly){var i=t.getDom().getBoundingClientRect();t.zone={x:i.left,y:i.top,w:i.width,h:i.height}}},cursor:function(t){(t=t||"auto")!==o.oldCursor&&(document.body.style.cursor=t,o.oldCursor=t)},toCanvas:function(t,i,s,e){if(e&&null!==o.tmpTime&&(clearTimeout(o.tmpTime),o.tmpTime=null),null===o.tmpTime){o.lock&&(o.tmpTime=setTimeout((function(){o.tmpTime=null}),10));var n=!1;i===t.canvas.width&&s===t.canvas.height||(n=!0),null===o.tmpImage&&(o.tmpImage=new Image);var h=o.tmpImage,r=o.xmlserializer.serializeToString(t.content),a='<svg xmlns="http://www.w3.org/2000/svg" width="'+i+'" height="'+s+'"><foreignObject style="pointer-events: none; left:0;" width="100%" height="100%">'+r+"</foreignObject></svg>";h.onload=function(){var e=t.canvas.getContext("2d");n?(t.canvas.width=i,t.canvas.height=s):e.clearRect(0,0,i,s),e.drawImage(this,0,0),t.onDraw()},h.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(a),h.crossOrigin=""}},setHidden:function(){if(null===o.hiddenImput){var t=o.debugInput?"":"opacity:0; zIndex:0;",i=o.parent.css.txt+"padding:0; width:auto; height:auto; text-shadow:none;";i+="left:10px; top:auto; border:none; color:#FFF; background:#000;"+t,o.hiddenImput=document.createElement("input"),o.hiddenImput.type="text",o.hiddenImput.style.cssText=i+"bottom:30px;"+(o.debugInput?"":"transform:scale(0);"),o.hiddenSizer=document.createElement("div"),o.hiddenSizer.style.cssText=i+"bottom:60px;",document.body.appendChild(o.hiddenImput),document.body.appendChild(o.hiddenSizer)}o.hiddenImput.style.width=o.input.clientWidth+"px",o.hiddenImput.value=o.str,o.hiddenSizer.innerHTML=o.str,o.hasFocus=!0},clearHidden:function(t){null!==o.hiddenImput&&(o.hasFocus=!1)},clickPos:function(t){for(var i=o.str.length,s=0,e=0;i--&&!((s+=o.textWidth(o.str[e]))>=t);)e++;return e},upInput:function(t,i){if(null===o.parent)return!1;var s=!1;if(i){var e=o.clickPos(t);if(o.moveX=e,-1===o.startX)o.startX=e,o.cursorId=e,o.inputRange=[o.startX,o.startX];else o.moveX!==o.startX&&(o.startX>o.moveX?o.inputRange=[o.moveX,o.startX]:o.inputRange=[o.startX,o.moveX]);s=!0}else-1!==o.startX&&(o.hasFocus=!0,o.hiddenImput.focus(),o.hiddenImput.selectionStart=o.inputRange[0],o.hiddenImput.selectionEnd=o.inputRange[1],o.startX=-1,s=!0);return s&&o.selectParent(),s},selectParent:function(){var t=o.textWidth(o.str.substring(0,o.cursorId)),i=o.textWidth(o.str.substring(0,o.inputRange[0])),s=o.textWidth(o.str.substring(o.inputRange[0],o.inputRange[1]));o.parent.select(t,i,s)},textWidth:function(t){return null===o.hiddenSizer?0:(t=t.replace(/ /g,"&nbsp;"),o.hiddenSizer.innerHTML=t,o.hiddenSizer.clientWidth)},clearInput:function(){null!==o.parent&&(o.firstImput||o.parent.validate(!0),o.clearHidden(),o.parent.unselect(),o.input.style.background=o.parent.colors.inputBg,o.input.style.borderColor=o.parent.colors.inputBorder,o.parent.isEdit=!1,o.input=null,o.parent=null,o.str="",o.firstImput=!0)},setInput:function(t,i){o.clearInput(),o.input=t,o.parent=i,o.input.style.background=o.parent.colors.inputOver,o.input.style.borderColor=o.parent.colors.inputBorderSelect,o.str=o.input.textContent,o.setHidden()},keydown:function(t){if(null!==o.parent){var i=t.which;t.shiftKey,o.firstImput=!1,o.hasFocus&&(window.focus(),o.hiddenImput.focus()),o.parent.isEdit=!0,13===i?o.clearInput():o.input.isNum?t.keyCode>47&&t.keyCode<58||t.keyCode>95&&t.keyCode<106||190===t.keyCode||110===t.keyCode||8===t.keyCode||109===t.keyCode?o.hiddenImput.readOnly=!1:o.hiddenImput.readOnly=!0:o.hiddenImput.readOnly=!1}},keyup:function(t){null!==o.parent&&(o.str=o.hiddenImput.value,o.parent.allEqual?o.parent.sameStr(o.str):o.input.textContent=o.str,o.cursorId=o.hiddenImput.selectionStart,o.inputRange=[o.hiddenImput.selectionStart,o.hiddenImput.selectionEnd],o.selectParent(),o.parent.validate())},loop:function(){o.isLoop&&requestAnimationFrame(o.loop),o.update()},update:function(){for(var t=o.listens.length;t--;)o.listens[t].listening()},removeListen:function(t){var i=o.listens.indexOf(t);-1!==i&&o.listens.splice(i,1),0===o.listens.length&&(o.isLoop=!1)},addListen:function(t){return-1===o.listens.indexOf(t)&&(o.listens.push(t),o.isLoop||(o.isLoop=!0,o.loop()),!0)}},n=o;function h(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,r(t,i)}function r(t,i){return(r=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}var a=function(){function t(t,i){void 0===t&&(t=0),void 0===i&&(i=0),this.x=t,this.y=i}var i=t.prototype;return i.set=function(t,i){return this.x=t,this.y=i,this},i.divide=function(t){return this.x/=t.x,this.y/=t.y,this},i.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},i.multiplyScalar=function(t){return this.x*=t,this.y*=t,this},i.divideScalar=function(t){return this.multiplyScalar(1/t)},i.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},i.angle=function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},i.addScalar=function(t){return this.x+=t,this.y+=t,this},i.negate=function(){return this.x*=-1,this.y*=-1,this},i.neg=function(){return this.x=-1,this.y=-1,this},i.isZero=function(){return 0===this.x&&0===this.y},i.copy=function(t){return this.x=t.x,this.y=t.y,this},i.equals=function(t){return t.x===this.x&&t.y===this.y},i.nearEquals=function(t,i){return t.x.toFixed(i)===this.x.toFixed(i)&&t.y.toFixed(i)===this.y.toFixed(i)},i.lerp=function(t,i){return null===t?(this.x-=this.x*i,this.y-=this.y*i):(this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i),this},t}(),l=function(){function t(t){if(void 0===t&&(t={}),this.main=t.main||null,this.isUI=t.isUI||!1,this.group=null,this.isListen=!1,this.ontop=!!t.ontop&&t.ontop,this.css=this.main?this.main.css:e.css,this.colors=this.main?this.main.colors:e.colors,this.defaultBorderColor=this.colors.border,this.svgs=e.svgs,this.isSpace=t.isSpace||!1,this.zone={x:0,y:0,w:0,h:0},this.local=(new a).neg(),this.isCanvasOnly=!1,this.isSelect=!1,this.p=void 0!==t.p?t.p:e.size.p,this.w=this.isUI?this.main.size.w:e.size.w,void 0!==t.w&&(this.w=t.w),this.h=this.isUI?this.main.size.h:e.size.h,void 0!==t.h&&(this.h=t.h),this.isSpace||(this.h=this.h<11?11:this.h),this.autoWidth=t.auto||!0,this.isOpen=!1,this.radius=t.radius||this.colors.radius,this.isNumber=!1,this.noNeg=t.noNeg||!1,this.allEqual=t.allEqual||!1,this.mono=!1,this.isEdit=!1,this.simple=t.simple||!1,this.simple&&(this.sa=0),this.setSize(this.w),void 0!==t.sa&&(this.sa=t.sa),void 0!==t.sb&&(this.sb=t.sb),this.simple&&(this.sb=this.w-this.sa),this.sc=void 0===t.sc?47:t.sc,this.objectLink=null,this.isSend=!1,this.val=null,this.bg=this.colors.background,this.bgOver=this.colors.backgroundOver,void 0!==t.bg&&(this.bg=t.bg,this.bgOver=t.bg),void 0!==t.bgOver&&(this.bgOver=t.bgOver),this.titleColor=t.titleColor||this.colors.text,this.fontColor=t.fontColor||this.colors.text,this.fontSelect=t.fontSelect||this.colors.textOver,void 0!==t.color&&(this.fontColor=t.color),this.colorPlus=e.ColorLuma(this.fontColor,.3),this.txt=t.name||"",this.rename=t.rename||"",this.target=t.target||null,this.callback=void 0===t.callback?null:t.callback,this.endCallback=null,null===this.callback&&this.isUI&&null!==this.main.callback&&(this.callback=this.main.callback),this.c=[],this.s=[],this.c[0]=e.dom("div",this.css.basic+"position:relative; height:20px; float:left; overflow:hidden;"),this.s[0]=this.c[0].style,this.isUI&&(this.s[0].marginBottom="1px"),this.simple||(this.c[1]=e.dom("div",this.css.txt),this.s[1]=this.c[1].style,this.c[1].textContent=""===this.rename?this.txt:this.rename,this.s[1].color=this.titleColor),t.pos){for(var i in this.s[0].position="absolute",t.pos)this.s[0][i]=t.pos[i];this.mono=!0}t.css&&(this.s[0].cssText=t.css)}var i=t.prototype;return i.init=function(){this.zone.h=this.h;var t=this.s,i=this.c;t[0].height=this.h+"px",this.isUI&&(t[0].background=this.bg),void 0!==i[1]&&this.autoWidth&&(t[1]=i[1].style,t[1].height=this.h-4+"px",t[1].lineHeight=this.h-8+"px");for(var s=e.frag,o=1,h=i.length;o!==h;o++)void 0!==i[o]&&(s.appendChild(i[o]),t[o]=i[o].style);var r=null!==this.target?this.target:this.isUI?this.main.inner:document.body;this.ontop?r.insertAdjacentElement("afterbegin",i[0]):r.appendChild(i[0]),i[0].appendChild(s),this.rSize(),this.isUI||(this.c[0].style.pointerEvents="auto",n.add(this))},i.dom=function(t,i,s,o,n){return e.dom(t,i,s,o,n)},i.setSvg=function(t,i,s,o,n){e.setSvg(t,i,s,o,n)},i.setCss=function(t,i){e.setCss(t,i)},i.clamp=function(t,i,s){return e.clamp(t,i,s)},i.getColorRing=function(){return e.colorRing||e.makeColorRing(),e.clone(e.colorRing)},i.getJoystick=function(t){return e["joystick_"+t]||e.makeJoystick(t),e.clone(e["joystick_"+t])},i.getCircular=function(t){return e.circular||e.makeCircular(t),e.clone(e.circular)},i.getKnob=function(t){return e.knob||e.makeKnob(t),e.clone(e.knob)},i.cursor=function(t){n.cursor(t)},i.update=function(){},i.reset=function(){},i.getDom=function(){return this.c[0]},i.uiout=function(){this.isSpace||this.s&&(this.s[0].background=this.bg)},i.uiover=function(){this.isSpace||this.s&&(this.s[0].background=this.bgOver)},i.rename=function(t){void 0!==this.c[1]&&(this.c[1].textContent=t)},i.listen=function(){return this.isListen=n.addListen(this),this},i.listening=function(){null!==this.objectLink&&(this.isSend||this.isEdit||this.setValue(this.objectLink[this.val]))},i.setValue=function(t){this.isNumber?this.value=this.numValue(t):this.value=t,this.update()},i.onChange=function(t){if(!this.isSpace)return this.callback=t||null,this},i.onFinishChange=function(t){if(!this.isSpace)return this.callback=null,this.endCallback=t,this},i.send=function(t){(t=t||this.value)instanceof Array&&1===t.length&&(t=t[0]),this.isSend=!0,null!==this.objectLink&&(this.objectLink[this.val]=t),this.callback&&this.callback(t,this.val),this.isSend=!1},i.sendEnd=function(t){(t=t||this.value)instanceof Array&&1===t.length&&(t=t[0]),this.endCallback&&this.endCallback(t),null!==this.objectLink&&(this.objectLink[this.val]=t)},i.clear=function(t){this.isListen&&n.removeListen(this),e.clear(this.c[0]),t||(null!==this.target?null!==this.group?this.group.clearOne(this):this.target.removeChild(this.c[0]):this.isUI?this.main.clearOne(this):document.body.removeChild(this.c[0]),this.isUI||n.remove(this)),this.c=null,this.s=null,this.callback=null,this.target=null,this.isListen=!1},i.setSize=function(t){if(this.autoWidth)if(this.w=t,this.simple)this.sb=this.w-this.sa;else{var i=this.w*(this.p/100);this.sa=Math.floor(i+10),this.sb=Math.floor(this.w-i-20)}},i.rSize=function(){this.autoWidth&&(this.s[0].width=this.w+"px",this.simple||(this.s[1].width=this.sa+"px"))},i.setTypeNumber=function(t){var i;switch(this.isNumber=!0,this.value=0,void 0!==t.value&&("string"==typeof t.value?this.value=1*t.value:this.value=t.value),this.min=void 0===t.min?-1/0:t.min,this.max=void 0===t.max?1/0:t.max,this.precision=void 0===t.precision?2:t.precision,this.precision){case 0:i=1;break;case 1:i=.1;break;case 2:i=.01;break;case 3:i=.001;break;case 4:i=1e-4;break;case 5:i=1e-5}this.step=void 0===t.step?i:t.step,this.range=this.max-this.min,this.value=this.numValue(this.value)},i.numValue=function(t){return this.noNeg&&(t=Math.abs(t)),1*Math.min(this.max,Math.max(this.min,t)).toFixed(this.precision)},i.handleEvent=function(t){if(!this.isSpace)return this[t.type](t)},i.wheel=function(t){return!1},i.mousedown=function(t){return!1},i.mousemove=function(t){return!1},i.mouseup=function(t){return!1},i.keydown=function(t){return!1},i.click=function(t){return!1},i.keyup=function(t){return!1},i.setReferency=function(t,i){this.objectLink=t,this.val=i},i.display=function(t){t=t||!1,this.s[0].display=t?"block":"none"},i.open=function(){this.isOpen||(this.isOpen=!0)},i.close=function(){this.isOpen&&(this.isOpen=!1)},i.needZone=function(){n.needReZone=!0},i.rezone=function(){n.needReZone=!0},i.select=function(){},i.unselect=function(){},i.setInput=function(t){n.setInput(t,this)},i.upInput=function(t,i){return n.upInput(t,i)},i.selected=function(t){this.isSelect=t||!1},t}(),c=function(t){function i(i){var s;void 0===i&&(i={}),(s=t.call(this,i)||this).value=i.value||!1,s.buttonColor=i.bColor||s.colors.button,s.inh=i.inh||Math.floor(.8*s.h),s.inw=i.inw||36;var e=Math.floor(.5*s.h)-.5*(s.inh-2);return s.c[2]=s.dom("div",s.css.basic+"background:"+s.colors.boolbg+"; height:"+(s.inh-2)+"px; width:"+s.inw+"px; top:"+e+"px; border-radius:10px; border:2px solid "+s.boolbg),s.c[3]=s.dom("div",s.css.basic+"height:"+(s.inh-6)+"px; width:16px; top:"+(e+2)+"px; border-radius:10px; background:"+s.buttonColor+";"),s.init(),s.update(),s}h(i,t);var s=i.prototype;return s.mousemove=function(t){this.cursor("pointer")},s.mousedown=function(t){return this.value=!this.value,this.update(),this.send(),!0},s.update=function(){var t=this.s;this.value?(t[2].background=this.colors.boolon,t[2].borderColor=this.colors.boolon,t[3].marginLeft="17px"):(t[2].background=this.colors.boolbg,t[2].borderColor=this.colors.boolbg,t[3].marginLeft="2px")},s.rSize=function(){t.prototype.rSize.call(this);var i=this.s,s=this.w-10-this.inw;i[2].left=s+"px",i[3].left=s+"px"},i}(l),u=function(t){function i(i){var s;void 0===i&&(i={}),(s=t.call(this,i)||this).value=!1,s.values=i.value||s.txt,s.onName=i.onName||"",s.on=!1,"string"==typeof s.values&&(s.values=[s.values]),s.isDown=!1,s.isLink=i.link||!1,s.cc=[s.colors.button,s.colors.select,s.colors.down],void 0!==i.cBg&&(s.cc[0]=i.cBg),void 0!==i.bColor&&(s.cc[0]=i.bColor),void 0!==i.cSelect&&(s.cc[1]=i.cSelect),void 0!==i.cDown&&(s.cc[2]=i.cDown),s.isLoadButton=i.loader||!1,s.isDragButton=i.drag||!1,s.isDragButton&&(s.isLoadButton=!0),s.lng=s.values.length,s.tmp=[],s.stat=[];for(var e=0;e<s.lng;e++)s.c[e+2]=s.dom("div",s.css.txt+s.css.button+"top:1px; background:"+s.cc[0]+"; height:"+(s.h-2)+"px; border:"+s.colors.buttonBorder+"; border-radius:"+s.radius+"px;"),s.c[e+2].style.color=s.fontColor,s.c[e+2].innerHTML=s.values[e],s.stat[e]=1;return void 0!==s.c[1]&&(s.c[1].textContent=""),s.isLoadButton&&s.initLoader(),s.isDragButton&&(s.lng++,s.initDrager()),s.init(),s}h(i,t);var s=i.prototype;return s.onOff=function(){this.on=!this.on,this.c[2].innerHTML=this.on?this.onName:this.values[0]},s.testZone=function(t){var i=this.local;if(-1===i.x&&-1===i.y)return"";for(var s=this.lng,e=this.tmp;s--;)if(i.x>e[s][0]&&i.x<e[s][2])return s+2;return""},s.click=function(t){if(""!==this.onName&&this.onOff(),this.isLink){var i=this.testZone(t);return!!i&&(this.value=this.values[i-2],this.send(),this.reset())}},s.mouseup=function(t){return!!this.isDown&&(this.value=!1,this.isDown=!1,this.mousemove(t))},s.mousedown=function(t){if(this.isLink)return!1;var i=this.testZone(t);return!!i&&(this.isDown=!0,this.value=this.values[i-2],this.isLoadButton||this.send(),this.mousemove(t))},s.mousemove=function(t){var i=!1,s=this.testZone(t);return""!==s?(this.cursor("pointer"),i=this.modes(this.isDown?3:2,s)):i=this.reset(),i},s.modes=function(t,i){for(var s=!1,e=0;e<this.lng;e++)(e===i-2?this.mode(t,e+2):this.mode(1,e+2))&&(s=!0);return s},s.mode=function(t,i){var s=!1,e=i-2;if(this.stat[e]!==t){switch(t){case 1:this.stat[e]=1,this.s[e+2].color=this.fontColor,this.s[e+2].background=this.cc[0];break;case 2:this.stat[e]=2,this.s[e+2].color=this.fontSelect,this.s[e+2].background=this.cc[1];break;case 3:this.stat[e]=3,this.s[e+2].color=this.fontSelect,this.s[e+2].background=this.cc[2]}s=!0}return s},s.reset=function(){return this.cursor(),this.modes(1,2)},s.dragover=function(t){t.preventDefault(),this.s[4].borderColor=this.colors.select,this.s[4].color=this.colors.select},s.dragend=function(t){t.preventDefault(),this.s[4].borderColor=this.fontColor,this.s[4].color=this.fontColor},s.drop=function(t){t.preventDefault(),this.dragend(t),this.fileSelect(t.dataTransfer.files[0])},s.initDrager=function(){this.c[4]=this.dom("div",this.css.txt+" text-align:center; line-height:"+(this.h-8)+"px; border:1px dashed "+this.fontColor+"; top:2px;\theight:"+(this.h-4)+"px; border-radius:"+this.radius+"px; pointer-events:auto;"),this.c[4].textContent="DRAG",this.c[4].addEventListener("dragover",function(t){this.dragover(t)}.bind(this),!1),this.c[4].addEventListener("dragend",function(t){this.dragend(t)}.bind(this),!1),this.c[4].addEventListener("dragleave",function(t){this.dragend(t)}.bind(this),!1),this.c[4].addEventListener("drop",function(t){this.drop(t)}.bind(this),!1)},s.initLoader=function(){this.c[3]=this.dom("input",this.css.basic+"top:0px; opacity:0; height:"+this.h+"px; pointer-events:auto; cursor:pointer;"),this.c[3].name="loader",this.c[3].type="file",this.c[3].addEventListener("change",function(t){this.fileSelect(t.target.files[0])}.bind(this),!1)},s.fileSelect=function(t){if(void 0!==t){var i=new FileReader,s=t.name,e=s.substring(s.lastIndexOf(".")+1,s.length);-1!==["png","jpg","mp4","webm","ogg"].indexOf(e)?i.readAsDataURL(t):-1!==["sea","z","hex","bvh","BVH","glb"].indexOf(e)?i.readAsArrayBuffer(t):i.readAsText(t),i.onload=function(t){this.callback&&this.callback(t.target.result,s,e)}.bind(this)}},s.label=function(t,i){i=i||2,this.c[i].textContent=t},s.icon=function(t,i,s){s=s||2,this.s[s].padding=(i||0)+"px 0px",this.c[s].innerHTML=t},s.rSize=function(){t.prototype.rSize.call(this);for(var i=this.s,s=this.sb,e=this.sa,o=this.lng,n=Math.floor((s-3*(o-1))/o);o--;)this.tmp[o]=[Math.floor(e+n*o+3*o),n],this.tmp[o][2]=this.tmp[o][0]+this.tmp[o][1],i[o+2].left=this.tmp[o][0]+"px",i[o+2].width=this.tmp[o][1]+"px";this.isDragButton&&(i[4].left=e+n+3+"px",i[4].width=n+"px"),this.isLoadButton&&(i[3].left=e+"px",i[3].width=n+"px")},i}(l),d=function(t){function i(i){var s;return void 0===i&&(i={}),(s=t.call(this,i)||this).autoWidth=!1,s.buttonColor=s.colors.button,s.setTypeNumber(i),s.radius=.5*s.w,s.twoPi=2*Math.PI,s.pi90=.5*Math.PI,s.offset=new a,s.h=i.h||s.w+10,s.top=0,s.c[0].style.width=s.w+"px",void 0!==s.c[1]&&(s.c[1].style.width=s.w+"px",s.c[1].style.textAlign="center",s.top=10,s.h+=10),s.percent=0,s.cmode=0,s.c[2]=s.dom("div",s.css.txt+"text-align:center; top:"+(s.h-20)+"px; width:"+s.w+"px; color:"+s.fontColor),s.c[3]=s.getCircular(),s.setSvg(s.c[3],"d",s.makePath(),1),s.setSvg(s.c[3],"stroke",s.fontColor,1),s.setSvg(s.c[3],"viewBox","0 0 "+s.w+" "+s.w),s.setCss(s.c[3],{width:s.w,height:s.w,left:0,top:s.top}),s.init(),s.update(),s}h(i,t);var s=i.prototype;return s.mode=function(t){if(this.cmode===t)return!1;switch(t){case 0:this.s[2].color=this.fontColor,this.setSvg(this.c[3],"stroke","rgba(0,0,0,0.1)",0),this.setSvg(this.c[3],"stroke",this.fontColor,1);break;case 1:this.s[2].color=this.colorPlus,this.setSvg(this.c[3],"stroke","rgba(0,0,0,0.3)",0),this.setSvg(this.c[3],"stroke",this.colorPlus,1)}return this.cmode=t,!0},s.reset=function(){this.isDown=!1},s.mouseup=function(t){return this.isDown=!1,this.sendEnd(),this.mode(0)},s.mousedown=function(t){return this.isDown=!0,this.old=this.value,this.oldr=null,this.mousemove(t),this.mode(1)},s.mousemove=function(t){if(this.isDown){var i=this.offset;if(i.x=this.radius-(t.clientX-this.zone.x),i.y=this.radius-(t.clientY-this.zone.y-this.top),this.r=i.angle()-this.pi90,this.r=(this.r%this.twoPi+this.twoPi)%this.twoPi,null!==this.oldr){var s=this.r-this.oldr;this.r=Math.abs(s)>Math.PI?this.oldr:this.r,s>6&&(this.r=0),s<-6&&(this.r=this.twoPi)}var e=1/this.twoPi,o=this.r*e,n=this.range*o+this.min-this.old;(n>=this.step||n<=this.step)&&(n=~~(n/this.step),this.value=this.numValue(this.old+n*this.step),this.update(!0),this.old=this.value,this.oldr=this.r)}},s.makePath=function(){var t=40,i=this.percent*this.twoPi-.001,s=t+t*Math.sin(i)+24,e=t-t*Math.cos(i)+24;return"M 64,24 A 40,40 0 "+(i>Math.PI?1:0)+" 1 "+s+","+e},s.update=function(t){this.c[2].textContent=this.value,this.percent=(this.value-this.min)/this.range,this.setSvg(this.c[3],"d",this.makePath(),1),t&&this.send()},i}(l),p=function(t){function i(i){var s;return void 0===i&&(i={}),(s=t.call(this,i)||this).ctype=i.ctype||"hex",s.wfixe=256,s.cw=s.sb>256?256:s.sb,null!=i.cw&&(s.cw=i.cw),s.side=i.side||"down",s.up="down"===s.side?0:1,s.baseH=s.h,s.offset=new a,s.decal=new a,s.pp=new a,s.c[2]=s.dom("div",s.css.txt+"height:"+(s.h-4)+"px;border-radius:"+s.radius+"px; line-height:"+(s.h-8)+"px;"),s.s[2]=s.c[2].style,s.up&&(s.s[2].top="auto",s.s[2].bottom="2px"),s.c[3]=s.getColorRing(),s.c[3].style.visibility="hidden",s.hsl=null,s.value="#ffffff",void 0!==i.value&&(i.value instanceof Array?s.value=e.rgbToHex(i.value):isNaN(i.value)?s.value=i.value:s.value=e.hexToHtml(i.value)),s.bcolor=null,s.isDown=!1,s.fistDown=!1,s.tr=98,s.tsl=Math.sqrt(3)*s.tr,s.hue=0,s.d=256,s.setColor(s.value),s.init(),void 0!==i.open&&s.open(),s}h(i,t);var s=i.prototype;return s.testZone=function(t,i){var s=this.local;return-1===s.x&&-1===s.y?"":this.up&&this.isOpen?s.y>this.wfixe?"title":"color":s.y<this.baseH+2?"title":this.isOpen?"color":void 0},s.mouseup=function(t){this.isDown=!1,this.d=256},s.mousedown=function(t){var i=this.testZone(t.clientX,t.clientY);if("title"===i)return this.isOpen?this.close():this.open(),!0;"color"===i&&(this.isDown=!0,this.fistDown=!0,this.mousemove(t))},s.mousemove=function(t){var i,s,o,n,h,r,a,l,c,u=this.testZone(t.clientX,t.clientY),d=e;if("title"===u&&this.cursor("pointer"),"color"===u&&((i=this.offset).x=t.clientX-(this.zone.x+this.decal.x+this.mid),i.y=t.clientY-(this.zone.y+this.decal.y+this.mid),s=i.length()*this.ratio,(c=i.angle())<0&&(c+=2*d.PI),s<128?this.cursor("crosshair"):this.isDown||this.cursor(),this.isDown&&(this.fistDown&&(this.d=s,this.fistDown=!1),this.d<128)))if(this.d>this.tr)o=(c+d.pi90)/d.TwoPI,this.hue=(o+1)%1,this.setHSL([(o+1)%1,this.hsl[1],this.hsl[2]]);else{a=i.x*this.ratio,l=i.y*this.ratio;var p=this.hue*d.TwoPI+d.PI;p<0&&(p+=2*d.PI),(r=Math.atan2(-l,a))<0&&(r+=2*d.PI);var f=(r+d.pi90+d.TwoPI+p)%d.TwoPI,v=f%(2/3*d.PI)-d.pi60,m=.5*this.tr,g=Math.tan(v)*m,x=Math.sqrt(a*a+l*l),b=Math.sqrt(m*m+g*g);if(x>b){var w=Math.tan(v)*x,y=Math.atan(w/b);y>d.pi60?y=d.pi60:y<-d.pi60&&(y=-d.pi60),v=(f=((r+=y-v)+d.pi90+d.TwoPI+p)%d.TwoPI)%(2/3*d.PI)-d.pi60,g=Math.tan(v)*m,x=b=Math.sqrt(m*m+g*g)}h=Math.sin(f)*x/this.tsl+.5;var k=1-2*Math.abs(h-.5);n=(Math.cos(f)*x+this.tr/2)/(1.5*this.tr)/k,n=d.clamp(n,0,1),this.setHSL([this.hsl[0],n,h])}},s.setHeight=function(){this.h=this.isOpen?this.wfixe+this.baseH+5:this.baseH,this.s[0].height=this.h+"px",this.zone.h=this.h},s.parentHeight=function(t){null!==this.group?this.group.calc(t):this.isUI&&this.main.calc(t)},s.open=function(){t.prototype.open.call(this),this.setHeight(),this.up&&(this.zone.y-=this.wfixe+5);var i=this.h-this.baseH;this.s[3].visibility="visible",this.parentHeight(i)},s.close=function(){t.prototype.close.call(this),this.up&&(this.zone.y+=this.wfixe+5);var i=this.h-this.baseH;this.setHeight(),this.s[3].visibility="hidden",this.parentHeight(-i)},s.update=function(t){var i=e.rgbToHex(e.hslToRgb([this.hsl[0],1,.5]));this.moveMarkers(),this.value=this.bcolor,this.setSvg(this.c[3],"fill",i,2,0),this.s[2].background=this.bcolor,this.c[2].textContent=e.htmlToHex(this.bcolor),this.invert=e.findDeepInver(this.rgb),this.s[2].color=this.invert?"#fff":"#000",t&&("array"===this.ctype&&this.send(this.rgb),"rgb"===this.ctype&&this.send(e.htmlRgb(this.rgb)),"hex"===this.ctype&&this.send(e.htmlToHex(this.value)),"html"===this.ctype&&this.send())},s.setColor=function(t){var i=e.unpack(t);return this.bcolor!=t&&i&&(this.bcolor=t,this.rgb=i,this.hsl=e.rgbToHsl(this.rgb),this.hue=this.hsl[0],this.update()),this},s.setHSL=function(t){return this.hsl=t,this.rgb=e.hslToRgb(t),this.bcolor=e.rgbToHex(this.rgb),this.update(!0),this},s.moveMarkers=function(){var t=this.pp,i=e;this.invert;var s=this.hsl[0]*i.TwoPI,o=2/3*i.PI,n=this.tr,h=this.hsl[0],r=this.hsl[1],a=this.hsl[2],l=(s-i.pi90)*i.todeg;h=-s+i.pi90;var c=Math.cos(h)*n,u=-Math.sin(h)*n,d=Math.cos(h-o)*n,p=-Math.sin(h-o)*n,f=Math.cos(h+o)*n,v=-Math.sin(h+o)*n,m=(p+v)/2,g=d+(f-d)*a+(c-(d+f)/2)*(s=(1-2*Math.abs(a-.5))*r),x=p+(v-p)*a+(u-m)*s;t.set(g,x).addScalar(128),this.setSvg(this.c[3],"transform","rotate("+l+" )",2),this.setSvg(this.c[3],"cx",t.x,3),this.setSvg(this.c[3],"cy",t.y,3),this.setSvg(this.c[3],"stroke",this.invert?"#fff":"#000",2,3),this.setSvg(this.c[3],"stroke",this.invert?"#fff":"#000",3),this.setSvg(this.c[3],"fill",this.bcolor,3)},s.rSize=function(){t.prototype.rSize.call(this);var i=this.s;i[2].width=this.sb+"px",i[2].left=this.sa+"px",this.rSizeColor(this.cw),this.decal.x=Math.floor(.5*(this.w-this.wfixe)),i[3].left=this.decal.x+"px"},s.rSizeColor=function(t){if(t!==this.wfixe){this.wfixe=t;var i=this.s;this.decal.y="up"===this.side?2:this.baseH+2,this.mid=Math.floor(.5*this.wfixe),this.setSvg(this.c[3],"viewBox","0 0 "+this.wfixe+" "+this.wfixe),i[3].width=this.wfixe+"px",i[3].height=this.wfixe+"px",i[3].top=this.decal.y+"px",this.ratio=256/this.wfixe,this.square=1/(this.wfixe/256*60),this.setHeight()}},i}(l),f=function(t){function i(i){var s;void 0===i&&(i={}),(s=t.call(this,i)||this).round=Math.round,s.baseH=s.h,s.hplus=i.hplus||50,s.res=i.res||40,s.l=1,s.precision=i.precision||0,s.custom=i.custom||!1,s.names=i.names||["FPS","MS"];var e=i.cc||["220,220,220","255,255,0"];s.adding=i.adding||!1,s.range=i.range||[165,100,100],s.alpha=i.alpha||.25,s.values=[],s.points=[],s.textDisplay=[],s.custom||(s.now=self.performance&&self.performance.now?self.performance.now.bind(performance):Date.now,s.startTime=0,s.prevTime=0,s.frames=0,s.ms=0,s.fps=0,s.mem=0,s.mm=0,s.isMem=!(!self.performance||!self.performance.memory),s.isMem&&(s.names.push("MEM"),e.push("0,255,255")),s.txt=i.name||"Fps");var o=Math.floor(.5*s.h)-6;s.c[1].textContent=s.txt,s.c[0].style.cursor="pointer",s.c[0].style.pointerEvents="auto";var n="display:none; left:10px; top:"+s.h+"px; height:"+(s.hplus-8)+"px; box-sizing:border-box; background: rgba(0, 0, 0, 0.2); border:"+("none"!==s.colors.groupBorder?s.colors.groupBorder+";":"1px solid rgba(255, 255, 255, 0.2);");0!==s.radius&&(n+="border-radius:"+s.radius+"px;"),s.c[2]=s.dom("path",s.css.basic+n,{}),s.c[2].setAttribute("viewBox","0 0 "+s.res+" 50"),s.c[2].setAttribute("height","100%"),s.c[2].setAttribute("width","100%"),s.c[2].setAttribute("preserveAspectRatio","none"),s.c[3]=s.dom("path",s.css.basic+"position:absolute; width:10px; height:10px; left:4px; top:"+o+"px;",{d:s.svgs.arrow,fill:s.fontColor,stroke:"none"}),s.c[4]=s.dom("div",s.css.txt+"position:absolute; left:10px; top:"+(s.h+2)+"px; display:none; width:100%; text-align:center;"),i.bottomLine&&(s.c[4]=s.dom("div",s.css.basic+"width:100%; bottom:0px; height:1px; background: rgba(255, 255, 255, 0.2);")),s.isShow=!1;var h=s.s;h[1].marginLeft="10px",h[1].lineHeight=s.h-4,h[1].color=s.fontColor,h[1].fontWeight="bold",0!==s.radius&&(h[0].borderRadius=s.radius+"px"),h[0].border=s.colors.groupBorder;var r=0;for(r=0;r<s.names.length;r++){for(var a=[],l=s.res+1;l--;)a.push(50);s.range[r]=1/s.range[r]*49,s.points.push(a),s.values.push(0),s.textDisplay.push("<span style='color:rgb("+e[r]+")'> "+s.names[r]+" ")}for(r=s.names.length;r--;)s.dom("path",null,{fill:"rgba("+e[r]+","+s.alpha+")","stroke-width":1,stroke:"rgba("+e[r]+",1)","vector-effect":"non-scaling-stroke"},s.c[2]);return s.init(),s}h(i,t);var s=i.prototype;return s.mousedown=function(t){this.isShow?this.close():this.open()},s.tick=function(t){this.values=t,this.isShow&&(this.drawGraph(),this.upText())},s.makePath=function(t){var i="";i+="M -1 50";for(var s=0;s<this.res+1;s++)i+=" L "+s+" "+t[s];return i+=" L "+(this.res+1)+" 50"},s.upText=function(t){for(var i=t||this.values,s="",e=0,o=this.names.length;e<o;e++)s+=this.textDisplay[e]+i[e].toFixed(this.precision)+"</span>";this.c[4].innerHTML=s},s.drawGraph=function(){for(var t,i=this.c[2],s=this.names.length,e=0,o=0;s--;)t=this.adding?(this.values[o]+e)*this.range[o]:this.values[o]*this.range[o],this.points[o].shift(),this.points[o].push(50-t),this.setSvg(i,"d",this.makePath(this.points[o]),s+1),e+=this.values[o],o++},s.open=function(){t.prototype.open.call(this),this.h=this.hplus+this.baseH,this.setSvg(this.c[3],"d",this.svgs.arrowDown),null!==this.group?this.group.calc(this.hplus):this.isUI&&this.main.calc(this.hplus),this.s[0].height=this.h+"px",this.s[2].display="block",this.s[4].display="block",this.isShow=!0,this.custom||n.addListen(this)},s.close=function(){t.prototype.close.call(this),this.h=this.baseH,this.setSvg(this.c[3],"d",this.svgs.arrow),null!==this.group?this.group.calc(-this.hplus):this.isUI&&this.main.calc(-this.hplus),this.s[0].height=this.h+"px",this.s[2].display="none",this.s[4].display="none",this.isShow=!1,this.custom||n.removeListen(this),this.c[4].innerHTML=""},s.begin=function(){this.startTime=this.now()},s.end=function(){var t=this.now();if(this.ms=t-this.startTime,this.frames++,t>this.prevTime+1e3&&(this.fps=this.round(1e3*this.frames/(t-this.prevTime)),this.prevTime=t,this.frames=0,this.isMem)){var i=performance.memory.usedJSHeapSize,s=performance.memory.jsHeapSizeLimit;this.mem=this.round(954e-9*i),this.mm=i/s}return this.values=[this.fps,this.ms,this.mm],this.drawGraph(),this.upText([this.fps,this.ms,this.mem]),t},s.listening=function(){this.custom||(this.startTime=this.end())},s.rSize=function(){var t=this.s,i=this.w;t[0].width=i+"px",t[1].width=i+"px",t[2].left="10px",t[2].width=i-20+"px",t[4].width=i-20+"px"},i}(l),v=function(t){function i(i){var s;void 0===i&&(i={}),(s=t.call(this,i)||this).value=void 0!==i.value?i.value:[0,0,0],s.lng=s.value.length,s.precision=void 0!==i.precision?i.precision:2,s.multiplicator=i.multiplicator||1,s.neg=i.neg||!1,s.line=void 0===i.line||i.line,s.autoWidth=void 0===i.autoWidth||i.autoWidth,s.isNumber=!1,s.isDown=!1,s.h=i.h||138,s.rh=s.h-10,s.top=0,s.c[0].style.width=s.w+"px",void 0!==s.c[1]&&(s.c[1].style.width=s.w+"px",s.top=10,s.h+=10),s.gh=s.rh-28,s.gw=s.w-28,s.c[2]=s.dom("div",s.css.txt+"text-align:center; top:"+(s.h-20)+"px; width:"+s.w+"px; color:"+s.fontColor),s.c[2].textContent=s.value;var e=s.dom("svg",s.css.basic,{viewBox:"0 0 "+s.w+" "+s.rh,width:s.w,height:s.rh,preserveAspectRatio:"none"});s.setCss(e,{width:s.w,height:s.rh,left:0,top:s.top}),s.dom("path","",{d:"",stroke:s.colors.text,"stroke-width":2,fill:"none","stroke-linecap":"butt"},e),s.dom("rect","",{x:10,y:10,width:s.gw+8,height:s.gh+8,stroke:"rgba(0,0,0,0.3)","stroke-width":1,fill:"none"},e),s.iw=(s.gw-4*(s.lng-1))/s.lng;var o=[];s.cMode=[],s.v=[];for(var n=0;n<s.lng;n++)o[n]=[14+n*s.iw+4*n,s.iw],o[n][2]=o[n][0]+o[n][1],s.cMode[n]=0,s.neg?s.v[n]=.5*(1+s.value[n]/s.multiplicator):s.v[n]=s.value[n]/s.multiplicator,s.dom("rect","",{x:o[n][0],y:14,width:o[n][1],height:1,fill:s.fontColor,"fill-opacity":.3},e);return s.tmp=o,s.c[3]=e,s.init(),void 0!==s.c[1]&&(s.c[1].style.top="0px",s.c[1].style.height="20px",s.s[1].lineHeight="15px"),s.update(!1),s}h(i,t);var s=i.prototype;return s.updateSVG=function(){this.line&&this.setSvg(this.c[3],"d",this.makePath(),0);for(var t=0;t<this.lng;t++)this.setSvg(this.c[3],"height",this.v[t]*this.gh,t+2),this.setSvg(this.c[3],"y",this.gh-this.v[t]*this.gh+14,t+2),this.neg?this.value[t]=1*((2*this.v[t]-1)*this.multiplicator).toFixed(this.precision):this.value[t]=1*(this.v[t]*this.multiplicator).toFixed(this.precision);this.c[2].textContent=this.value},s.testZone=function(t){var i=this.local;if(-1===i.x&&-1===i.y)return"";var s=this.lng,e=this.tmp;if(i.y>this.top&&i.y<this.h-20)for(;s--;)if(i.x>e[s][0]&&i.x<e[s][2])return s;return""},s.mode=function(t,i){if(t===this.cMode[i])return!1;var s;switch(t){case 0:s=.3;break;case 1:s=.6;break;case 2:s=1}return this.reset(),this.setSvg(this.c[3],"fill-opacity",s,i+2),this.cMode[i]=t,!0},s.reset=function(){for(var t=!1,i=this.lng;i--;)0!==this.cMode[i]&&(this.cMode[i]=0,this.setSvg(this.c[3],"fill-opacity",.3,i+2),t=!0);return t},s.mouseup=function(t){if(this.isDown=!1,-1!==this.current)return this.reset()},s.mousedown=function(t){return this.isDown=!0,this.mousemove(t)},s.mousemove=function(t){var i=!1,s=this.testZone(t);return""===s?i=this.reset():(i=this.mode(this.isDown?2:1,s),this.isDown&&(this.v[s]=this.clamp(1-(t.clientY-this.zone.y-this.top-10)/this.gh,0,1),this.update(!0))),i},s.update=function(t){this.updateSVG(),t&&this.send()},s.makePath=function(){for(var t,i,s,e,o,n,h="",r=0;r<this.lng;r++)t=this.gh-this.v[r]*this.gh+14,e=(i=14+r*this.iw+4*r)+.5*this.iw,s=i+this.iw,h+=0===r?"M "+i+" "+t+" T "+e+" "+t:" C "+o+" "+n+","+i+" "+t+","+e+" "+t,r===this.lng-1&&(h+=" T "+s+" "+t),o=s,n=t;return h},s.rSize=function(){t.prototype.rSize.call(this);var i=this.s;void 0!==this.c[1]&&(i[1].width=this.w+"px"),i[2].width=this.w+"px",i[3].width=this.w+"px";for(var s=(this.w-28-4*(this.lng-1))/this.lng,e=[],o=0;o<this.lng;o++)e[o]=[14+o*s+4*o,s],e[o][2]=e[o][0]+e[o][1];this.tmp=e},i}(l),m=function(t){function i(i){var s;void 0===i&&(i={}),(s=t.call(this,i)||this).ADD=i.add,s.uis=[],s.isEmpty=!0,s.autoHeight=!0,s.current=-1,s.target=null,s.decal=0,s.baseH=s.h;var e=Math.floor(.5*s.h)-6;s.isLine=void 0!==i.line&&i.line,s.c[2]=s.dom("div",s.css.basic+"width:100%; left:0; height:auto; overflow:hidden; top:"+s.h+"px"),s.c[3]=s.dom("path",s.css.basic+"position:absolute; width:10px; height:10px; left:0; top:"+e+"px;",{d:s.svgs.group,fill:s.fontColor,stroke:"none"}),s.c[4]=s.dom("path",s.css.basic+"position:absolute; width:10px; height:10px; left:4px; top:"+e+"px;",{d:s.svgs.arrow,fill:s.fontColor,stroke:"none"}),s.isLine&&(s.c[5]=s.dom("div",s.css.basic+"background:rgba(255, 255, 255, 0.2); width:100%; left:0; height:1px; bottom:0px"));var o=s.s;return o[0].height=s.h+"px",o[1].height=s.h+"px",s.c[1].name="group",o[1].marginLeft="10px",o[1].lineHeight=s.h-4,o[1].color=s.fontColor,o[1].fontWeight="bold",0!==s.radius&&(o[0].borderRadius=s.radius+"px"),o[0].border=s.colors.groupBorder,s.init(),s.setBG(s.bg),void 0!==i.open&&s.open(),s}h(i,t);var s=i.prototype;return s.testZone=function(t){var i=this.local;if(-1===i.x&&-1===i.y)return"";var s="";return i.y<this.baseH?s="title":this.isOpen&&(s="content"),s},s.clearTarget=function(){return-1!==this.current&&(this.target.uiout(),this.target.reset(),this.current=-1,this.target=null,this.cursor(),!0)},s.reset=function(){this.clearTarget()},s.handleEvent=function(t){var i=t.type,s=!1,e=!1,o=this.testZone(t);if(o){switch(o){case"content":this.cursor(),n.isMobile&&"mousedown"===i&&this.getNext(t,s),this.target&&(e=this.target.handleEvent(t)),n.lock||this.getNext(t,s);break;case"title":this.cursor("pointer"),"mousedown"===i&&(this.isOpen?this.close():this.open())}return this.isDown&&(s=!0),e&&(s=!0),s}},s.getNext=function(t,i){var s=n.findTarget(this.uis,t);s!==this.current&&(this.clearTarget(),this.current=s),-1!==s&&(this.target=this.uis[this.current],this.target.uiover())},s.calcH=function(){var t,i,s=this.uis.length,e=0,o=0,n=0;for(t=0;t<s;t++)(i=this.uis[t]).autoWidth?e+=i.h+1:(0===o?e+=i.h+1:n<i.h&&(e+=i.h-n),n=i.h,(o+=i.w)+i.w>this.w&&(o=0));return e},s.calcUis=function(){this.isOpen&&n.calcUis(this.uis,this.zone,this.zone.y+this.baseH)},s.setBG=function(t){this.s[0].background=t;for(var i=this.uis.length;i--;)this.uis[i].setBG(t)},s.add=function(){var t=arguments;"object"==typeof t[1]?(t[1].isUI=this.isUI,t[1].target=this.c[2],t[1].main=this.main):"string"==typeof arguments[1]&&(void 0===t[2]?[].push.call(t,{isUI:!0,target:this.c[2],main:this.main}):(t[2].isUI=!0,t[2].target=this.c[2],t[2].main=this.main));var i=this.ADD.apply(this,t);return this.uis.push(i),i.group=this,this.isEmpty=!1,i},s.remove=function(t){t.clear&&t.clear()},s.empty=function(){this.close();for(var t,i=this.uis.length;i--;)t=this.uis.pop(),this.c[2].removeChild(t.c[0]),t.clear(!0);this.isEmpty=!0,this.h=this.baseH},s.clearOne=function(t){var i=this.uis.indexOf(t);-1!==i&&(this.calc(-(this.uis[i].h+1)),this.c[2].removeChild(this.uis[i].c[0]),this.uis.splice(i,1),0===this.uis.length&&(this.isEmpty=!0,this.close()))},s.parentHeight=function(t){null!==this.group?this.group.calc(t):this.isUI&&this.main.calc(t)},s.open=function(){t.prototype.open.call(this),this.setSvg(this.c[4],"d",this.svgs.arrowDown),this.rSizeContent();var i=this.h-this.baseH;this.parentHeight(i)},s.close=function(){t.prototype.close.call(this);var i=this.h-this.baseH;this.setSvg(this.c[4],"d",this.svgs.arrow),this.h=this.baseH,this.s[0].height=this.h+"px",this.parentHeight(-i)},s.clear=function(){this.empty(),this.isUI&&this.main.calc(-(this.h+1)),l.prototype.clear.call(this)},s.clearGroup=function(){this.empty()},s.calc=function(t){this.isOpen&&(void 0!==t?(this.h+=t,this.isUI&&this.main.calc(t)):this.h=this.calcH()+this.baseH,this.s[0].height=this.h+"px")},s.rSizeContent=function(){for(var t=this.uis.length;t--;)this.uis[t].setSize(this.w),this.uis[t].rSize();this.calc()},s.rSize=function(){t.prototype.rSize.call(this);var i=this.s;i[3].left=this.sa+this.sb-17+"px",i[1].width=this.w+"px",i[2].width=this.w+"px",this.isOpen&&this.rSizeContent()},i}(l);m.prototype.isGroup=!0;var g=function(t){function i(i){var s;return void 0===i&&(i={}),(s=t.call(this,i)||this).autoWidth=!1,s.value=[0,0],s.joyType="analogique",s.model=void 0!==i.mode?i.mode:0,s.precision=i.precision||2,s.multiplicator=i.multiplicator||1,s.pos=new a,s.tmp=new a,s.interval=null,s.radius=.5*s.w,s.distance=.25*s.radius,s.h=i.h||s.w+10,s.top=0,s.c[0].style.width=s.w+"px",void 0!==s.c[1]&&(s.c[1].style.width=s.w+"px",s.c[1].style.textAlign="center",s.top=10,s.h+=10),s.c[2]=s.dom("div",s.css.txt+"text-align:center; top:"+(s.h-20)+"px; width:"+s.w+"px; color:"+s.fontColor),s.c[2].textContent=s.value,s.c[3]=s.getJoystick(s.model),s.setSvg(s.c[3],"viewBox","0 0 "+s.w+" "+s.w),s.setCss(s.c[3],{width:s.w,height:s.w,left:0,top:s.top}),s.ratio=128/s.w,s.init(),s.update(!1),s}h(i,t);var s=i.prototype;return s.mode=function(t){switch(t){case 0:0===this.model?(this.setSvg(this.c[3],"fill","url(#gradIn)",4),this.setSvg(this.c[3],"stroke","#000",4)):(this.setSvg(this.c[3],"stroke","rgba(100,100,100,0.25)",2),this.setSvg(this.c[3],"stroke","#666",4),this.setSvg(this.c[3],"fill","none",4));break;case 1:0===this.model?(this.setSvg(this.c[3],"fill","url(#gradIn2)",4),this.setSvg(this.c[3],"stroke","rgba(0,0,0,0)",4)):(this.setSvg(this.c[3],"stroke","rgba(48,138,255,0.25)",2),this.setSvg(this.c[3],"stroke",this.colors.select,4),this.setSvg(this.c[3],"fill","rgba(48,138,255,0.25)",4))}},s.addInterval=function(){null!==this.interval&&this.stopInterval(),this.pos.isZero()||(this.interval=setInterval(function(){this.update()}.bind(this),10))},s.stopInterval=function(){null!==this.interval&&(clearInterval(this.interval),this.interval=null)},s.reset=function(){this.addInterval(),this.mode(0)},s.mouseup=function(t){this.addInterval(),this.isDown=!1},s.mousedown=function(t){this.isDown=!0,this.mousemove(t),this.mode(2)},s.mousemove=function(t){if(this.mode(1),this.isDown){if(this.tmp.x=this.radius-(t.clientX-this.zone.x),this.tmp.y=this.radius-(t.clientY-this.zone.y-this.top),this.tmp.length()>this.distance){var i=Math.atan2(this.tmp.x,this.tmp.y);this.tmp.x=Math.sin(i)*this.distance,this.tmp.y=Math.cos(i)*this.distance}this.pos.copy(this.tmp).divideScalar(this.distance).negate(),this.update()}},s.setValue=function(t){void 0===t&&(t=[0,0]),this.pos.set(t[0]||0,t[1]||0),this.updateSVG()},s.update=function(t){void 0===t&&(t=!0),null!==this.interval&&(this.isDown||(this.pos.lerp(null,.3),this.pos.x=Math.abs(this.pos.x)<.01?0:this.pos.x,this.pos.y=Math.abs(this.pos.y)<.01?0:this.pos.y,this.isUI&&this.main.isCanvas&&this.main.draw())),this.updateSVG(),t&&this.send(),this.pos.isZero()&&this.stopInterval()},s.updateSVG=function(){var t=this.radius- -this.pos.x*this.distance,i=this.radius- -this.pos.y*this.distance;if(0===this.model){var s=t+5*this.pos.x+5,e=i+5*this.pos.y+10;this.setSvg(this.c[3],"cx",s*this.ratio,3),this.setSvg(this.c[3],"cy",e*this.ratio,3)}else this.setSvg(this.c[3],"cx",t*this.ratio,3),this.setSvg(this.c[3],"cy",i*this.ratio,3);this.setSvg(this.c[3],"cx",t*this.ratio,4),this.setSvg(this.c[3],"cy",i*this.ratio,4),this.value[0]=1*(this.pos.x*this.multiplicator).toFixed(this.precision),this.value[1]=1*(this.pos.y*this.multiplicator).toFixed(this.precision),this.c[2].textContent=this.value},s.clear=function(){this.stopInterval(),t.prototype.clear.call(this)},i}(l),x=function(t){function i(i){var s;return void 0===i&&(i={}),(s=t.call(this,i)||this).autoWidth=!1,s.buttonColor=s.colors.button,s.setTypeNumber(i),s.mPI=.8*Math.PI,s.toDeg=180/Math.PI,s.cirRange=2*s.mPI,s.offset=new a,s.radius=.5*s.w,s.h=i.h||s.w+10,s.top=0,s.c[0].style.width=s.w+"px",void 0!==s.c[1]&&(s.c[1].style.width=s.w+"px",s.c[1].style.textAlign="center",s.top=10,s.h+=10),s.percent=0,s.cmode=0,s.c[2]=s.dom("div",s.css.txt+"text-align:center; top:"+(s.h-20)+"px; width:"+s.w+"px; color:"+s.fontColor),s.c[3]=s.getKnob(),s.setSvg(s.c[3],"stroke",s.fontColor,1),s.setSvg(s.c[3],"stroke",s.fontColor,3),s.setSvg(s.c[3],"d",s.makeGrad(),3),s.setSvg(s.c[3],"viewBox","0 0 "+s.ww+" "+s.ww),s.setCss(s.c[3],{width:s.w,height:s.w,left:0,top:s.top}),s.r=0,s.init(),s.update(),s}h(i,t);var s=i.prototype;return s.mode=function(t){if(this.cmode===t)return!1;switch(t){case 0:this.s[2].color=this.fontColor,this.setSvg(this.c[3],"fill",this.colors.button,0),this.setSvg(this.c[3],"stroke",this.fontColor,1);break;case 1:this.s[2].color=this.colorPlus,this.setSvg(this.c[3],"fill",this.colors.select,0),this.setSvg(this.c[3],"stroke",this.colorPlus,1)}return this.cmode=t,!0},s.mouseup=function(t){return this.isDown=!1,this.sendEnd(),this.mode(0)},s.mousedown=function(t){return this.isDown=!0,this.old=this.value,this.oldr=null,this.mousemove(t),this.mode(1)},s.mousemove=function(t){if(this.isDown){var i=this.offset;i.x=this.radius-(t.clientX-this.zone.x),i.y=this.radius-(t.clientY-this.zone.y-this.top),this.r=-Math.atan2(i.x,i.y),null!==this.oldr&&(this.r=Math.abs(this.r-this.oldr)>Math.PI?this.oldr:this.r),this.r=this.r>this.mPI?this.mPI:this.r,this.r=this.r<-this.mPI?-this.mPI:this.r;var s=1/this.cirRange,e=(this.r+this.mPI)*s,o=this.range*e+this.min-this.old;(o>=this.step||o<=this.step)&&(o=Math.floor(o/this.step),this.value=this.numValue(this.old+o*this.step),this.update(!0),this.old=this.value,this.oldr=this.r)}},s.makeGrad=function(){var t,i,s,e="",o=64,n=Math.PI+this.mPI,h=Math.PI-this.mPI;this.step>5?t=(n-h)/(i=this.range/this.step):(t=(n-h)/o*2,i=32);for(var r=0;r<=i;++r)s=n-t*r,e+="M"+(o+44*Math.sin(s))+" "+(o+44*Math.cos(s))+" L"+(o+40*Math.sin(s))+" "+(o+40*Math.cos(s))+" ";return e},s.update=function(t){this.c[2].textContent=this.value,this.percent=(this.value-this.min)/this.range;var i=this.percent*this.cirRange-this.mPI,s=Math.sin(i),e=Math.cos(i),o=25*s+64,n=-25*e+64,h=20*s+64,r=-20*e+64;this.setSvg(this.c[3],"d","M "+o+" "+n+" L "+h+" "+r,1),t&&this.send()},i}(l),b=function(t){function i(i){var s;void 0===i&&(i={}),(s=t.call(this,i)||this).path=i.path||"",s.format=i.format||"",s.imageSize=i.imageSize||[20,20],s.isWithImage=""!==s.path,s.preLoadComplete=!1,s.tmpImage={},s.tmpUrl=[];var e=i.align||"center";s.sMode=0,s.tMode=0,s.listOnly=i.listOnly||!1,""===s.txt&&(s.p=0),s.buttonColor=i.bColor||s.colors.button;var o=Math.floor(.5*s.h)-5;return s.c[2]=s.dom("div",s.css.basic+"top:0; display:none;"),s.c[3]=s.dom("div",s.css.txt+"text-align:"+e+"; line-height:"+(s.h-4)+"px; top:1px; background:"+s.buttonColor+"; height:"+(s.h-2)+"px; border-radius:"+s.radius+"px;"),s.c[4]=s.dom("path",s.css.basic+"position:absolute; width:10px; height:10px; top:"+o+"px;",{d:s.svgs.arrow,fill:s.fontColor,stroke:"none"}),s.scroller=s.dom("div",s.css.basic+"right:5px;\twidth:10px; background:#666; display:none;"),s.c[3].style.color=s.fontColor,s.list=i.list||[],s.items=[],s.prevName="",s.baseH=s.h,s.itemHeight=i.itemHeight||s.h-3,s.full=i.full||!1,s.py=0,s.ww=s.sb,s.scroll=!1,s.isDown=!1,s.current=null,s.side=i.side||"down",s.up="down"===s.side?0:1,s.up?(s.c[2].style.top="auto",s.c[3].style.top="auto",s.c[4].style.top="auto",s.c[2].style.bottom=s.h-2+"px",s.c[3].style.bottom="1px",s.c[4].style.bottom=o+"px"):s.c[2].style.top=s.baseH+"px",s.listIn=s.dom("div",s.css.basic+"left:0; top:0; width:100%; background:rgba(0,0,0,0.2);"),s.listIn.name="list",s.topList=0,s.c[2].appendChild(s.listIn),s.c[2].appendChild(s.scroller),void 0!==i.value?isNaN(i.value)?s.value=i.value:s.value=s.list[i.value]:s.value=s.list[0],s.isOpenOnStart=i.open||!1,s.listOnly&&(s.baseH=5,s.c[3].style.display="none",s.c[4].style.display="none",s.c[2].style.top=s.baseH+"px",s.isOpenOnStart=!0),s.isWithImage&&s.preloadImage(),s.setList(s.list),s.init(),s.isOpenOnStart&&s.open(!0),s}h(i,t);var s=i.prototype;return s.preloadImage=function(){this.preLoadComplete=!1,this.tmpImage={};for(var t=0;t<this.list.length;t++)this.tmpUrl.push(this.list[t]);this.loadOne()},s.nextImg=function(){this.tmpUrl.shift(),0===this.tmpUrl.length?(this.preLoadComplete=!0,this.addImages()):this.loadOne()},s.loadOne=function(){var t=this,i=this.tmpUrl[0],s=document.createElement("img");s.style.cssText="position:absolute; width:"+t.imageSize[0]+"px; height:"+t.imageSize[1]+"px",s.setAttribute("src",this.path+i+this.format),s.addEventListener("load",(function(){t.imageSize[2]=s.width,t.imageSize[3]=s.height,t.tmpImage[i]=s,t.nextImg()}))},s.testZone=function(t){var i=this.local;if(-1===i.x&&-1===i.y)return"";if(this.up&&this.isOpen){if(i.y>this.h-this.baseH)return"title";if(this.scroll&&i.x>this.sa+this.sb-20)return"scroll";if(i.x>this.sa)return this.testItems(i.y-this.baseH)}else{if(i.y<this.baseH+2)return"title";if(this.isOpen){if(this.scroll&&i.x>this.sa+this.sb-20)return"scroll";if(i.x>this.sa)return this.testItems(i.y-this.baseH)}}return""},s.testItems=function(t){for(var i,s,e,o="",n=this.items.length;n--;)if(s=(i=this.items[n]).posy+this.topList,e=i.posy+this.itemHeight+1+this.topList,t>=s&&t<=e)return o="item"+n,this.unSelected(),this.current=i,this.selected(),o;return o},s.unSelected=function(){this.current&&(this.current.style.background="rgba(0,0,0,0.2)",this.current.style.color=this.fontColor,this.current=null)},s.selected=function(){this.current.style.background=this.colors.select,this.current.style.color="#FFF"},s.mouseup=function(t){this.isDown=!1},s.mousedown=function(t){var i=this.testZone(t);return!!i&&("scroll"===i?(this.isDown=!0,this.mousemove(t)):"title"===i?(this.modeTitle(2),this.listOnly||(this.isOpen?this.close():this.open())):this.current&&(this.value=this.list[this.current.id],this.send(),this.listOnly||(this.close(),this.setTopItem())),!0)},s.mousemove=function(t){var i=!1,s=this.testZone(t);if(!s)return i;if("title"===s)this.unSelected(),this.modeTitle(1),this.cursor("pointer");else if("scroll"===s){if(this.cursor("s-resize"),this.modeScroll(1),this.isDown){this.modeScroll(2);var e=this.zone.y+this.baseH-2;this.update(t.clientY-e-.5*this.sh)}}else this.modeTitle(0),this.modeScroll(0),this.cursor("pointer");return s!==this.prevName&&(i=!0),this.prevName=s,i},s.wheel=function(t){return"title"!==this.testZone(t)&&(this.py+=10*t.delta,this.update(this.py),!0)},s.reset=function(){this.prevName="",this.unSelected(),this.modeTitle(0),this.modeScroll(0)},s.modeScroll=function(t){if(t!==this.sMode){switch(t){case 0:this.scroller.style.background=this.buttonColor;break;case 1:this.scroller.style.background=this.colors.select;break;case 2:this.scroller.style.background=this.colors.down}this.sMode=t}},s.modeTitle=function(t){if(t!==this.tMode){var i=this.s;switch(t){case 0:i[3].color=this.fontColor,i[3].background=this.buttonColor;break;case 1:i[3].color="#FFF",i[3].background=this.colors.select;break;case 2:i[3].color=this.fontColor,i[3].background=this.colors.down}this.tMode=t}},s.clearList=function(){for(;this.listIn.children.length;)this.listIn.removeChild(this.listIn.lastChild);this.items=[]},s.setList=function(t){var i,s;this.clearList(),this.list=t,this.length=this.list.length,this.maxItem=this.full?this.length:5,this.maxItem=this.length<this.maxItem?this.length:this.maxItem,this.maxHeight=this.maxItem*(this.itemHeight+1)+2,this.max=this.length*(this.itemHeight+1)+2,this.ratio=this.maxHeight/this.max,this.sh=this.maxHeight*this.ratio,this.range=this.maxHeight-this.sh,this.c[2].style.height=this.maxHeight+"px",this.scroller.style.height=this.sh+"px",this.max>this.maxHeight&&(this.ww=this.sb-20,this.scroll=!0);for(var e=0;e<this.length;e++)s=this.list[e],(i=this.dom("div",this.css.item+"width:"+this.ww+"px; height:"+this.itemHeight+"px; line-height:"+(this.itemHeight-5)+"px; color:"+this.fontColor+";")).name="item"+e,i.id=e,i.posy=(this.itemHeight+1)*e,this.listIn.appendChild(i),this.items.push(i),this.isWithImage||(i.textContent=s);this.setTopItem()},s.addImages=function(){for(var t=this.list.length,i=0;i<t;i++)this.items[i].appendChild(this.tmpImage[this.list[i]]);this.setTopItem()},s.setTopItem=function(){if(this.isWithImage){if(!this.preLoadComplete)return;this.c[3].children.length||(this.canvas=document.createElement("canvas"),this.canvas.width=this.imageSize[0],this.canvas.height=this.imageSize[1],this.canvas.style.cssText="position:absolute; top:0px; left:0px;",this.ctx=this.canvas.getContext("2d"),this.c[3].appendChild(this.canvas)),this.tmpImage[this.value],this.ctx.drawImage(this.tmpImage[this.value],0,0,this.imageSize[2],this.imageSize[3],0,0,this.imageSize[0],this.imageSize[1])}else this.c[3].textContent=this.value},s.update=function(t){this.scroll&&(t=(t=t<0?0:t)>this.range?this.range:t,this.topList=-Math.floor(t/this.ratio),this.listIn.style.top=this.topList+"px",this.scroller.style.top=Math.floor(t)+"px",this.py=t)},s.parentHeight=function(t){null!==this.group?this.group.calc(t):this.isUI&&this.main.calc(t)},s.open=function(i){t.prototype.open.call(this),this.update(0),this.h=this.maxHeight+this.baseH+5,this.scroll?this.scroller.style.display="block":(this.topList=0,this.h=this.baseH+5+this.max,this.scroller.style.display="none"),this.s[0].height=this.h+"px",this.s[2].display="block",this.up?(this.zone.y-=this.h-(this.baseH-10),this.setSvg(this.c[4],"d",this.svgs.arrowUp)):this.setSvg(this.c[4],"d",this.svgs.arrowDown),this.rSizeContent();var s=this.h-this.baseH;this.zone.h=this.h,i||this.parentHeight(s)},s.close=function(){t.prototype.close.call(this),this.up&&(this.zone.y+=this.h-(this.baseH-10));var i=this.h-this.baseH;this.h=this.baseH,this.s[0].height=this.h+"px",this.s[2].display="none",this.setSvg(this.c[4],"d",this.svgs.arrow),this.zone.h=this.h,this.parentHeight(-i)},s.text=function(t){this.c[3].textContent=t},s.rSizeContent=function(){for(var t=this.length;t--;)this.listIn.children[t].style.width=this.ww+"px"},s.rSize=function(){l.prototype.rSize.call(this);var t=this.s,i=this.sb,s=this.sa;void 0!==t[2]&&(t[2].width=i+"px",t[2].left=s+"px",t[3].width=i+"px",t[3].left=s+"px",t[4].left=s+i-17+"px",this.ww=i,this.max>this.maxHeight&&(this.ww=i-20),this.isOpen&&this.rSizeContent())},i}(l),w=function(t){function i(i){var s;void 0===i&&(i={}),(s=t.call(this,i)||this).setTypeNumber(i),s.allway=i.allway||!1,s.isDown=!1,s.value=[0],s.multy=1,s.invmulty=1,s.isSingle=!0,s.isAngle=!1,s.isVector=!1,i.isAngle&&(s.isAngle=!0,s.multy=e.torad,s.invmulty=e.todeg),s.isDrag=i.drag||!1,void 0!==i.value&&(isNaN(i.value)?i.value instanceof Array?(s.value=i.value,s.isSingle=!1):i.value instanceof Object&&(s.value=[],void 0!==i.value.x&&(s.value[0]=i.value.x),void 0!==i.value.y&&(s.value[1]=i.value.y),void 0!==i.value.z&&(s.value[2]=i.value.z),void 0!==i.value.w&&(s.value[3]=i.value.w),s.isVector=!0,s.isSingle=!1):s.value=[i.value]),s.lng=s.value.length,s.tmp=[],s.current=-1,s.prev={x:0,y:0,d:0,v:0},s.c[2]=s.dom("div",s.css.basic+" background:"+s.colors.select+"; top:4px; width:0px; height:"+(s.h-8)+"px;"),s.cMode=[];for(var o=s.lng;o--;)s.isAngle&&(s.value[o]=(180*s.value[o]/Math.PI).toFixed(s.precision)),s.c[3+o]=s.dom("div",s.css.txtselect+" height:"+(s.h-4)+"px; background:"+s.colors.inputBg+"; borderColor:"+s.colors.inputBorder+"; border-radius:"+s.radius+"px;"),i.center&&(s.c[2+o].style.textAlign="center"),s.c[3+o].textContent=s.value[o],s.c[3+o].style.color=s.fontColor,s.c[3+o].isNum=!0,s.cMode[o]=0;return s.cursorId=3+s.lng,s.c[s.cursorId]=s.dom("div",s.css.basic+"top:4px; height:"+(s.h-8)+"px; width:0px; background:"+s.fontColor+";"),s.init(),s}h(i,t);var s=i.prototype;return s.testZone=function(t){var i=this.local;if(-1===i.x&&-1===i.y)return"";for(var s=this.lng,e=this.tmp;s--;)if(i.x>e[s][0]&&i.x<e[s][2])return s;return""},s.mousedown=function(t){var i=this.testZone(t);return!this.isDown&&(this.isDown=!0,""!==i&&(this.current=i,this.prev={x:t.clientX,y:t.clientY,d:0,v:this.isSingle?parseFloat(this.value):parseFloat(this.value[this.current])},this.setInput(this.c[3+this.current])),this.mousemove(t))},s.mouseup=function(t){return!!this.isDown&&(this.isDown=!1,this.prev={x:0,y:0,d:0,v:0},this.mousemove(t))},s.mousemove=function(t){var i=!1,s=0;if(""===this.testZone(t)?this.cursor():this.isDrag?this.cursor(-1!==this.current?"move":"pointer"):this.cursor("text"),!this.isDrag)return this.isDown&&(s=t.clientX-this.zone.x-3),-1!==this.current&&(s-=this.tmp[this.current][0]),this.upInput(s,this.isDown);if(-1!==this.current){this.prev.d+=t.clientX-this.prev.x-(t.clientY-this.prev.y);var e=this.prev.v+this.prev.d*this.step;this.value[this.current]=this.numValue(e),this.c[3+this.current].textContent=this.value[this.current],this.validate(),this.prev.x=t.clientX,this.prev.y=t.clientY,i=!0}return i},s.reset=function(){return!1},s.setValue=function(t){this.isVector?(void 0!==t.x&&(this.value[0]=t.x),void 0!==t.y&&(this.value[1]=t.y),void 0!==t.z&&(this.value[2]=t.z),void 0!==t.w&&(this.value[3]=t.w)):this.value=t,this.update()},s.sameStr=function(t){for(var i=this.value.length;i--;)this.c[3+i].textContent=t},s.update=function(t){for(var i=this.value.length;i--;)this.value[i]=this.numValue(this.value[i]*this.invmulty),this.c[3+i].textContent=this.value[i];t&&this.send()},s.send=function(t){t=t||this.value,this.isSend=!0,null!==this.objectLink&&(this.isVector?this.objectLink[this.val].fromArray(t):this.objectLink[this.val]=t),this.callback&&this.callback(t,this.val),this.isSend=!1},s.select=function(t,i,s){var e=this.s,o=-1!==this.current?this.tmp[this.current][0]+5:0;e[this.cursorId].width="1px",e[this.cursorId].left=o+t+"px",e[2].left=o+i+"px",e[2].width=s+"px"},s.unselect=function(){var t=this.s;t&&(t[2].width="0px",t[this.cursorId].width="0px")},s.validate=function(t){var i=[],s=this.lng;for(this.allway&&(t=!0);s--;){if(isNaN(this.c[3+s].textContent))this.c[3+s].textContent=this.value[s];else{var e=this.numValue(this.c[3+s].textContent);this.c[3+s].textContent=e,this.value[s]=e}i[s]=this.value[s]*this.multy}t&&(this.isSingle?this.send(i[0]):this.send(i))},s.rSize=function(){t.prototype.rSize.call(this);for(var i=Math.floor((this.sb+5)/this.lng)-5,s=this.s,e=this.lng;e--;)this.tmp[e]=[Math.floor(this.sa+i*e+5*e),i],this.tmp[e][2]=this.tmp[e][0]+this.tmp[e][1],s[3+e].left=this.tmp[e][0]+"px",s[3+e].width=this.tmp[e][1]+"px"},i}(l),y=function(t){function i(i){var s;if(void 0===i&&(i={}),(s=t.call(this,i)||this).setTypeNumber(i),s.model=i.stype||0,void 0!==i.mode&&(s.model=i.mode),s.buttonColor=i.bColor||s.colors.button,s.defaultBorderColor=s.colors.hide,s.isDown=!1,s.isOver=!1,s.allway=i.allway||!1,s.isDeg=i.isDeg||!1,s.firstImput=!1,s.c[2]=s.dom("div",s.css.txtselect+"border:none; width:47px; color:"+s.fontColor),s.c[3]=s.dom("div",s.css.basic+" top:0; height:"+s.h+"px;"),s.c[4]=s.dom("div",s.css.basic+"background:"+s.colors.scrollback+"; top:2px; height:"+(s.h-4)+"px;"),s.c[5]=s.dom("div",s.css.basic+"left:4px; top:5px; height:"+(s.h-10)+"px; background:"+s.fontColor+";"),s.c[2].isNum=!0,s.c[2].style.height=s.h-2+"px",s.c[2].style.lineHeight=s.h-10+"px",0!==s.model){var e=4,o=8,n=s.h-4,h=20;2===s.model&&(e=4,o=8,h=2,n=.5*(s.h-4)),3===s.model&&(s.c[5].style.visible="none"),s.c[4].style.borderRadius=e+"px",s.c[4].style.height=o+"px",s.c[4].style.top=.5*s.h-e+"px",s.c[5].style.borderRadius=.5*e+"px",s.c[5].style.height=e+"px",s.c[5].style.top=.5*s.h-.5*e+"px",s.c[6]=s.dom("div",s.css.basic+"border-radius:"+h+"px; margin-left:"+.5*-n+"px; border:1px solid "+s.colors.border+"; background:"+s.buttonColor+"; left:4px; top:2px; height:"+(s.h-4)+"px; width:"+n+"px;")}return s.init(),s}h(i,t);var s=i.prototype;return s.testZone=function(t){var i=this.local;return-1===i.x&&-1===i.y?"":i.x>=this.txl?"text":i.x>=this.sa?"scroll":""},s.mouseup=function(t){this.isDown&&(this.isDown=!1)},s.mousedown=function(t){var i=this.testZone(t);return!!i&&("scroll"===i&&(this.isDown=!0,this.old=this.value,this.mousemove(t)),!0)},s.mousemove=function(t){var i=!1;if("scroll"===this.testZone(t)?(this.mode(1),this.cursor("w-resize")):this.cursor(),this.isDown){var s=(t.clientX-(this.zone.x+this.sa)-3)/this.ww*this.range+this.min-this.old;(s>=this.step||s<=this.step)&&(s=Math.floor(s/this.step),this.value=this.numValue(this.old+s*this.step),this.update(!0),this.old=this.value),i=!0}return i},s.validate=function(){var t=this.c[2].textContent;isNaN(t)?this.c[2].textContent=this.value+(this.isDeg?"°":""):(this.value=this.numValue(t),this.update(!0))},s.reset=function(){this.isDown=!1,this.mode(0)},s.mode=function(t){var i=this.s;switch(t){case 0:i[2].color=this.fontColor,i[4].background=this.colors.scrollback,i[5].background=this.fontColor;break;case 1:i[2].color=this.colorPlus,i[4].background=this.colors.scrollbackover,i[5].background=this.colorPlus}},s.update=function(t){var i=Math.floor(this.ww*((this.value-this.min)/this.range));3!==this.model&&(this.s[5].width=i+"px"),this.s[6]&&(this.s[6].left=this.sa+i+3+"px"),this.c[2].textContent=this.value+(this.isDeg?"°":""),t&&this.send()},s.rSize=function(){t.prototype.rSize.call(this);var i=this.sb-this.sc;this.ww=i-6;var s=this.sc;!this.isUI&&this.simple||(s=this.sc+10),this.txl=this.w-s+2;var e=this.s;e[2].width=this.sc-6+"px",e[2].left=this.txl+4+"px",e[3].left=this.sa+"px",e[3].width=i+"px",e[4].left=this.sa+"px",e[4].width=i+"px",e[5].left=this.sa+3+"px",this.update()},i}(l),k=function(t){function i(i){var s;return void 0===i&&(i={}),(s=t.call(this,i)||this).cmode=0,s.value=i.value||"",s.placeHolder=i.placeHolder||"",s.allway=i.allway||!1,s.editable=void 0===i.edit||i.edit,s.isDown=!1,s.c[2]=s.dom("div",s.css.basic+" background:"+s.colors.select+"; top:4px; width:0px; height:"+(s.h-8)+"px;"),s.c[3]=s.dom("div",s.css.txtselect+"height:"+(s.h-4)+"px; background:"+s.colors.inputBg+"; borderColor:"+s.colors.inputBorder+"; border-radius:"+s.radius+"px;"),s.c[3].textContent=s.value,s.c[4]=s.dom("div",s.css.basic+"top:4px; height:"+(s.h-8)+"px; width:0px; background:"+s.fontColor+";"),s.c[5]=s.dom("div",s.css.txtselect+"height:"+(s.h-4)+"px; justify-content: center; font-style: italic; color:"+s.colors.inputHolder+";"),""===s.value&&(s.c[5].textContent=s.placeHolder),s.init(),s}h(i,t);var s=i.prototype;return s.testZone=function(t){var i=this.local;return-1===i.x&&-1===i.y?"":i.x>=this.sa?"text":""},s.mouseup=function(t){if(this.editable)return!!this.isDown&&(this.isDown=!1,this.mousemove(t))},s.mousedown=function(t){if(this.editable){var i=this.testZone(t);return!this.isDown&&(this.isDown=!0,"text"===i&&this.setInput(this.c[3]),this.mousemove(t))}},s.mousemove=function(t){if(this.editable){var i=0;return"text"===this.testZone(t)?this.cursor("text"):this.cursor(),this.isDown&&(i=t.clientX-this.zone.x),this.upInput(i-this.sa-3,this.isDown)}},s.update=function(){this.c[3].textContent=this.value},s.render=function(t,i,s){this.s[4].width="1px",this.s[4].left=this.sa+t+5+"px",this.s[2].left=this.sa+i+5+"px",this.s[2].width=s+"px"},s.reset=function(){this.cursor()},s.select=function(t,i,s){var e=this.s,o=this.sa+5;e[4].width="1px",e[4].left=o+t+"px",e[2].left=o+i+"px",e[2].width=s+"px"},s.unselect=function(){var t=this.s;t&&(t[2].width="0px",t[4].width="0px")},s.validate=function(t){this.allway&&(t=!0),this.value=this.c[3].textContent,""!==this.value?this.c[5].textContent="":this.c[5].textContent=this.placeHolder,t&&this.send()},s.rSize=function(){t.prototype.rSize.call(this);var i=this.s;i[3].left=this.sa+"px",i[3].width=this.sb+"px",i[5].left=this.sa+"px",i[5].width=this.sb+"px"},i}(l),C=function(t){function i(i){var s;void 0===i&&(i={}),s=t.call(this,i)||this;var e=i.prefix||"";s.c[2]=s.dom("div",s.css.txt+"text-align:right; width:60px; line-height:"+(s.h-8)+"px; color:"+s.fontColor),31===s.h&&(s.s[0].height=s.h+"px",s.s[1].top="8px",s.c[2].style.top="8px");var o=s.s;return o[1].textAlign=i.align||"left",o[1].fontWeight=i.fontWeight||"bold",s.c[1].textContent=s.txt.substring(0,1).toUpperCase()+s.txt.substring(1).replace("-"," "),s.c[2].textContent=e,s.init(),s}h(i,t);var s=i.prototype;return s.text=function(t){this.c[1].textContent=t},s.text2=function(t){this.c[2].textContent=t},s.rSize=function(){t.prototype.rSize.call(this),this.s[1].width=this.w+"px",this.s[2].left=this.w+"px"},i}(l),S=function(t){function i(i){var s;void 0===i&&(i={}),(s=t.call(this,i)||this).value=i.value||"",s.isDown=!1,s.onActif=i.onActif||function(){},s.buttonColor=i.bColor||s.colors.button,s.buttonOver=i.bOver||s.colors.over,s.buttonDown=i.bDown||s.colors.select,s.buttonAction=i.bAction||s.colors.action,i.prefix,s.c[2]=s.dom("div",s.css.txt+s.css.button+" top:1px; background:"+s.buttonColor+"; height:"+(s.h-2)+"px; border:"+s.colors.buttonBorder+"; border-radius:15px; width:30px; left:10px;"),s.c[2].style.color=s.fontColor,s.c[3]=s.dom("div",s.css.txtselect+"height:"+(s.h-4)+"px; background:"+s.colors.inputBg+"; borderColor:"+s.colors.inputBorder+"; border-radius:"+s.radius+"px;"),s.c[3].textContent=s.value;var e=Math.floor(.5*s.h)-7;return s.c[4]=s.dom("path",s.css.basic+"position:absolute; width:14px; height:14px; left:5px; top:"+e+"px;",{d:s.svgs.cursor,fill:s.fontColor,stroke:"none"}),s.stat=1,s.isActif=!1,s.init(),s}h(i,t);var s=i.prototype;return s.testZone=function(t){var i=this.local;return-1===i.x&&-1===i.y?"":i.x>this.sa&&i.x<this.sa+30?"over":"0"},s.mouseup=function(t){return!!this.isDown&&(this.isDown=!1,this.mousemove(t))},s.mousedown=function(t){return!!this.testZone(t)&&(this.isDown=!0,this.mousemove(t))},s.mousemove=function(t){var i=!1;return"over"===this.testZone(t)?(this.cursor("pointer"),i=this.mode(this.isDown?3:2)):i=this.reset(),i},s.apply=function(t){(t=t||"")!==this.value&&(this.value=t,this.c[3].textContent=this.value,this.send()),this.mode(1)},s.update=function(){this.mode(3)},s.mode=function(t){var i=!1;if(this.stat!==t){switch(1===t&&(this.isActif=!1),3===t&&(this.isActif?this.isActif=!1:(this.isActif=!0,t=4,this.onActif(this))),2===t&&this.isActif&&(t=4),t){case 1:this.stat=1,this.s[2].color=this.fontColor,this.s[2].background=this.buttonColor;break;case 2:this.stat=2,this.s[2].color=this.fontSelect,this.s[2].background=this.buttonOver;break;case 3:this.stat=3,this.s[2].color=this.fontSelect,this.s[2].background=this.buttonDown;break;case 4:this.stat=4,this.s[2].color=this.fontSelect,this.s[2].background=this.buttonAction}i=!0}return i},s.reset=function(){return this.cursor(),this.mode(this.isActif?4:1)},s.text=function(t){this.c[3].textContent=t},s.rSize=function(){t.prototype.rSize.call(this);var i=this.s;i[2].left=this.sa+"px",i[3].left=this.sa+40+"px",i[3].width=this.sb-40+"px",i[4].left=this.sa+8+"px"},i}(l),I=function(t){function i(i){var s,e;void 0===i&&(i={}),(s=t.call(this,i)||this).values=i.values,"string"==typeof s.values&&(s.values=[s.values]),s.value=i.value||s.values[0],s.isDown=!1,s.buttonColor=i.bColor||s.colors.button,s.buttonOver=i.bOver||s.colors.over,s.buttonDown=i.bDown||s.colors.select,s.lng=s.values.length,s.tmp=[],s.stat=[];for(var o=0;o<s.lng;o++)e=!1,s.values[o]===s.value&&(e=!0),s.c[o+2]=s.dom("div",s.css.txt+s.css.button+" top:1px; background:"+(e?s.buttonDown:s.buttonColor)+"; height:"+(s.h-2)+"px; border:"+s.colors.buttonBorder+"; border-radius:"+s.radius+"px;"),s.c[o+2].style.color=e?s.fontSelect:s.fontColor,s.c[o+2].innerHTML=s.values[o],s.stat[o]=e?3:1;return s.init(),s}h(i,t);var s=i.prototype;return s.testZone=function(t){var i=this.local;if(-1===i.x&&-1===i.y)return"";for(var s=this.lng,e=this.tmp;s--;)if(i.x>e[s][0]&&i.x<e[s][2])return s+2;return""},s.mouseup=function(t){return!!this.isDown&&(this.isDown=!1,this.mousemove(t))},s.mousedown=function(t){var i=this.testZone(t);return!!i&&(this.isDown=!0,this.value=this.values[i-2],this.send(),this.mousemove(t))},s.mousemove=function(t){var i=!1,s=this.testZone(t);return""!==s?(this.cursor("pointer"),i=this.modes(this.isDown?3:2,s)):i=this.reset(),i},s.modes=function(t,i){for(var s=!1,e=0;e<this.lng;e++)(e===i-2&&this.values[e]!==this.value?this.mode(t,e+2):this.values[e]===this.value?this.mode(3,e+2):this.mode(1,e+2))&&(s=!0);return s},s.mode=function(t,i){var s=!1,e=i-2;if(this.stat[e]!==t){switch(t){case 1:this.stat[e]=1,this.s[e+2].color=this.fontColor,this.s[e+2].background=this.buttonColor;break;case 2:this.stat[e]=2,this.s[e+2].color=this.fontSelect,this.s[e+2].background=this.buttonOver;break;case 3:this.stat[e]=3,this.s[e+2].color=this.fontSelect,this.s[e+2].background=this.buttonDown}s=!0}return s},s.reset=function(){this.cursor();for(var t=!1,i=0;i<this.lng;i++)(this.values[i]===this.value?this.mode(3,i+2):this.mode(1,i+2))&&(t=!0);return t},s.label=function(t,i){i=i||2,this.c[i].textContent=t},s.icon=function(t,i,s){s=s||2,this.s[s].padding=(i||0)+"px 0px",this.c[s].innerHTML=t},s.rSize=function(){t.prototype.rSize.call(this);for(var i=this.s,s=this.sb,e=this.sa,o=this.lng,n=Math.floor((s-3*(o-1))/o);o--;)this.tmp[o]=[Math.floor(e+n*o+3*o),n],this.tmp[o][2]=this.tmp[o][0]+this.tmp[o][1],i[o+2].left=this.tmp[o][0]+"px",i[o+2].width=this.tmp[o][1]+"px"},i}(l),M=function(t){function i(i){var s;return void 0===i&&(i={}),i.simple=!0,i.isSpace=!0,(s=t.call(this,i)||this).init(),s}return h(i,t),i}(l),L=function(t){function i(i){var s;void 0===i&&(i={}),(s=t.call(this,i)||this).p=100,s.value=s.txt,s.status=1,s.itype=i.itype||"none",s.val=s.itype,s.graph=s.svgs[s.itype];var e=Math.floor(.5*s.h)-7;return s.c[2]=s.dom("path",s.css.basic+"position:absolute; width:14px; height:14px; left:5px; top:"+e+"px;",{d:s.graph,fill:s.fontColor,stroke:"none"}),s.s[1].marginLeft="20px",s.init(),s}h(i,t);var s=i.prototype;return s.mousemove=function(t){this.cursor("pointer")},s.mousedown=function(t){return this.isUI&&this.main.resetItem(),this.selected(!0),this.send(),!0},s.uiout=function(){this.isSelect?this.mode(3):this.mode(1)},s.uiover=function(){this.isSelect?this.mode(4):this.mode(2)},s.update=function(){},s.mode=function(t){var i=!1;if(this.status!==t){switch(this.status=t,t){case 1:this.status=1,this.s[1].color=this.fontColor,this.s[0].background="none";break;case 2:this.status=2,this.s[1].color=this.fontColor,this.s[0].background=this.bgOver;break;case 3:this.status=3,this.s[1].color="#FFF",this.s[0].background=this.colors.select;break;case 4:this.status=4,this.s[1].color="#FFF",this.s[0].background=this.colors.down}i=!0}return i},s.reset=function(){this.cursor()},s.selected=function(t){this.isSelect&&this.mode(1),this.isSelect=t||!1,this.isSelect&&this.mode(3)},i}(l),z=function(t){function i(i){var s;void 0===i&&(i={}),(s=t.call(this,i)||this).value=!1,s.values=i.values||[],"string"==typeof s.values&&(s.values=[s.values]),s.isDown=!1,s.buttonColor=i.bColor||s.colors.button,s.buttonOver=i.bOver||s.colors.over,s.buttonDown=i.bDown||s.colors.select,s.spaces=i.spaces||[10,3],s.bsize=i.bsize||[100,20],s.bsizeMax=s.bsize[0],s.lng=s.values.length,s.tmp=[],s.stat=[],s.grid=[2,Math.round(.5*s.lng)],s.h=s.grid[1]*(s.bsize[1]+s.spaces[1])+s.spaces[1],s.c[1].textContent="",s.c[2]=s.dom("table",s.css.basic+"width:100%; top:"+(s.spaces[1]-2)+"px; height:auto; border-collapse:separate; border:none; border-spacing: "+(s.spaces[0]-2)+"px "+(s.spaces[1]-2)+"px;");var e,o,n,h=0;s.buttons=[],s.stat=[],s.tmpX=[],s.tmpY=[];for(var r=0;r<s.grid[1];r++){(n=s.c[2].insertRow()).style.cssText="pointer-events:none;";for(var a=0;a<s.grid[0];a++)(o=n.insertCell()).style.cssText="pointer-events:none;",s.values[h]?((e=document.createElement("div")).style.cssText=s.css.txt+s.css.button+"position:static; width:"+s.bsize[0]+"px; height:"+s.bsize[1]+"px; border:"+s.colors.buttonBorder+"; left:auto; right:auto; background:"+s.buttonColor+";\tborder-radius:"+s.radius+"px;",e.innerHTML=s.values[h],o.appendChild(e),s.buttons.push(e),s.stat.push(1)):((e=document.createElement("div")).style.cssText=s.css.txt+"position:static; width:"+s.bsize[0]+"px; height:"+s.bsize[1]+"px; text-align:center;\tleft:auto; right:auto; background:none;",o.appendChild(e)),e.style.cssText+=0===a?"float:right;":"float:left;",h++}return s.init(),s}h(i,t);var s=i.prototype;return s.testZone=function(t){var i=this.local;if(-1===i.x&&-1===i.y)return-1;for(var s=this.tmpX,e=this.tmpY,o=-1,n=-1,h=-1,r=this.grid[0];r--;)i.x>s[r][0]&&i.x<s[r][1]&&(n=r);for(r=this.grid[1];r--;)i.y>e[r][0]&&i.y<e[r][1]&&(h=r);return-1!==n&&-1!==h&&(o=n+2*h)>this.lng-1&&(o=-1),o},s.mouseup=function(t){return!!this.isDown&&(this.value=!1,this.isDown=!1,this.mousemove(t))},s.mousedown=function(t){var i=this.testZone(t);return!(i<0)&&(this.isDown=!0,this.value=this.values[i],this.send(),this.mousemove(t))},s.mousemove=function(t){var i=!1,s=this.testZone(t);return-1!==s?(this.cursor("pointer"),i=this.modes(this.isDown?3:2,s)):i=this.reset(),i},s.modes=function(t,i){for(var s=!1,e=0;e<this.lng;e++)(e===i?this.mode(t,e):this.mode(1,e))&&(s=!0);return s},s.mode=function(t,i){var s=!1,e=i;if(this.stat[e]!==t){switch(t){case 1:this.stat[e]=1,this.buttons[e].style.color=this.fontColor,this.buttons[e].style.background=this.buttonColor;break;case 2:this.stat[e]=2,this.buttons[e].style.color=this.fontSelect,this.buttons[e].style.background=this.buttonOver;break;case 3:this.stat[e]=3,this.buttons[e].style.color=this.fontSelect,this.buttons[e].style.background=this.buttonDown}s=!0}return s},s.reset=function(){return this.cursor(),this.modes(1,0)},s.label=function(t,i){this.buttons[i].textContent=t},s.icon=function(t,i,s){this.buttons[s].style.padding=(i||0)+"px 0px",this.buttons[s].innerHTML=t},s.testW=function(){var t=!1;if(3*this.spaces[0]+2*this.bsizeMax>this.w?(this.bsize[0]=.5*(this.w-3*this.spaces[0]),t=!0):this.bsize[0]!==this.bsizeMax&&(this.bsize[0]=this.bsizeMax,t=!0),t)for(var i=this.buttons.length;i--;)this.buttons[i].style.width=this.bsize[0]+"px"},s.rSize=function(){var i;t.prototype.rSize.call(this),this.testW(),this.tmpX=[],this.tmpY=[];for(var s=0;s<this.grid[0];s++)0===s?(i=.5*this.w-.5*this.spaces[0],this.tmpX.push([i-this.bsize[0],i])):(i=.5*this.w+.5*this.spaces[0],this.tmpX.push([i,i+this.bsize[0]]));i=this.spaces[1];for(var e=0;e<this.grid[1];e++)this.tmpY.push([i,i+this.bsize[1]]),i+=this.bsize[1]+this.spaces[1]},i}(l),D=function t(){var i,s,e=arguments,o=!1,n=null;"string"==typeof e[0]?(i=e[0],s=e[1]||{}):"object"==typeof e[0]&&(o=!0,void 0===e[2]&&[].push.call(e,{}),i=e[2].type?e[2].type:"slide",(s=e[2]).name=e[1],s.value=e[0][e[1]]);var h=i.toLowerCase();switch("group"===h&&(s.add=t),h){case"bool":n=new c(s);break;case"button":n=new u(s);break;case"circular":n=new d(s);break;case"color":n=new p(s);break;case"fps":n=new f(s);break;case"graph":n=new v(s);break;case"group":n=new m(s);break;case"joystick":n=new g(s);break;case"knob":n=new x(s);break;case"list":n=new b(s);break;case"numeric":case"number":n=new w(s);break;case"slide":n=new y(s);break;case"textInput":case"string":n=new k(s);break;case"title":n=new C(s);break;case"select":n=new S(s);break;case"selector":n=new I(s);break;case"empty":case"space":n=new M(s);break;case"item":n=new L(s);break;case"grid":n=new z(s)}if(null!==n)return o&&n.setReferency(e[0],e[1]),n},H=function(){function t(t){void 0===t&&(t={}),this.canvas=null,this.isEmpty=!0,this.colors=e.cloneColor(),this.css=e.cloneCss(),t.config&&this.setConfig(t.config),this.bg=t.bg||this.colors.background,void 0!==t.transparent&&(this.colors.background="none",this.colors.backgroundOver="none"),this.isReset=!0,this.tmpAdd=null,this.tmpH=0,this.isCanvas=t.isCanvas||!1,this.isCanvasOnly=!1,this.cssGui=void 0!==t.css?t.css:"",this.callback=void 0===t.callback?null:t.callback,this.forceHeight=t.maxHeight||0,this.lockHeight=t.lockHeight||!1,this.isItemMode=void 0!==t.itemMode&&t.itemMode,this.cn="",this.size=e.size,void 0!==t.p&&(this.size.p=t.p),void 0!==t.w&&(this.size.w=t.w),void 0!==t.h&&(this.size.h=t.h),void 0!==t.s&&(this.size.s=t.s),this.size.h=this.size.h<11?11:this.size.h,this.local=(new a).neg(),this.zone={x:0,y:0,w:this.size.w,h:0},this.mouse=(new a).neg(),this.h=0,this.prevY=-1,this.sw=0,this.isWithClose=void 0===t.close||t.close,this.bh=this.isWithClose?this.size.h:0,this.autoResize=void 0===t.autoResize||t.autoResize,this.isCenter=t.center||!1,this.isOpen=!0,this.isDown=!1,this.isScroll=!1,this.uis=[],this.current=-1,this.target=null,this.decal=0,this.ratio=1,this.oy=0,this.isNewTarget=!1,this.content=e.dom("div",this.css.basic+" width:0px; height:auto; top:0px; "+this.cssGui),this.innerContent=e.dom("div",this.css.basic+"width:100%; top:0; left:0; height:auto; overflow:hidden;"),this.content.appendChild(this.innerContent),this.inner=e.dom("div",this.css.basic+"width:100%; left:0; "),this.innerContent.appendChild(this.inner),this.scrollBG=e.dom("div",this.css.basic+"right:0; top:0; width:"+(this.size.s-1)+"px; height:10px; display:none; background:"+this.bg+";"),this.content.appendChild(this.scrollBG),this.scroll=e.dom("div",this.css.basic+"background:"+this.colors.scroll+"; right:2px; top:0; width:"+(this.size.s-4)+"px; height:10px;"),this.scrollBG.appendChild(this.scroll);var i=t.radius||this.colors.radius;this.bottom=e.dom("div",this.css.txt+"width:100%; top:auto; bottom:0; left:0; border-bottom-right-radius:"+i+"px;\tborder-bottom-left-radius:"+i+"px; text-align:center; height:"+this.bh+"px; line-height:"+(this.bh-5)+"px;"),this.content.appendChild(this.bottom),this.bottom.textContent="Close",this.bottom.style.background=this.bg,this.parent=void 0!==t.parent?t.parent:null,this.parent=void 0!==t.target?t.target:this.parent,null!==this.parent||this.isCanvas||(this.parent=document.body,this.isCenter||(this.content.style.right="10px")),null!==this.parent&&this.parent.appendChild(this.content),this.isCanvas&&null===this.parent&&(this.isCanvasOnly=!0),this.isCanvasOnly||(this.content.style.pointerEvents="auto"),this.setWidth(),this.isCanvas&&this.makeCanvas(),n.add(this)}var i=t.prototype;return i.setTop=function(t,i){this.content.style.top=t+"px",void 0!==i&&(this.forceHeight=i),this.setHeight(),n.needReZone=!0},i.dispose=function(){this.clear(),null!==this.parent&&this.parent.removeChild(this.content),n.remove(this)},i.onDraw=function(){},i.makeCanvas=function(){this.canvas=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.canvas.width=this.zone.w,this.canvas.height=this.forceHeight?this.forceHeight:this.zone.h},i.draw=function(t){if(null!==this.canvas){var i=this.zone.w,s=this.forceHeight?this.forceHeight:this.zone.h;n.toCanvas(this,i,s,t)}},i.getDom=function(){return this.content},i.setMouse=function(t){this.mouse.set(t.x,t.y)},i.setConfig=function(t){this.setColors(t),this.setText(t.fontSize,t.text,t.font,t.shadow)},i.setColors=function(t){for(var i in t)this.colors[i]&&(this.colors[i]=t[i])},i.setText=function(t,i,s,o){e.setText(t,i,s,o,this.colors,this.css)},i.hide=function(t){this.content.style.display=t?"none":"block"},i.onChange=function(t){return this.callback=t||null,this},i.mode=function(t){var i=!1;if(t!==this.cn){switch(this.cn=t,t){case"def":this.scroll.style.background=this.colors.scroll,this.bottom.style.background=this.colors.background,this.bottom.style.color=this.colors.text;break;case"scrollOver":this.scroll.style.background=this.colors.select;break;case"scrollDown":this.scroll.style.background=this.colors.down;break;case"bottomOver":this.bottom.style.background=this.colors.backgroundOver,this.bottom.style.color="#FFF"}i=!0}return i},i.clearTarget=function(){return-1!==this.current&&(this.target.uiout(),this.target.reset(),this.target=null,this.current=-1,n.cursor(),!0)},i.testZone=function(t){var i=this.local;if(-1===i.x&&-1===i.y)return"";this.isReset=!1;var s=this.isScroll?this.zone.w-this.size.s:this.zone.w;return i.y>this.zone.h-this.bh&&i.y<this.zone.h?"bottom":i.x>s?"scroll":"content"},i.handleEvent=function(t){var i=t.type,s=!1,e=!1,o=this.testZone(t);if("mouseup"===i&&this.isDown&&(this.isDown=!1),"mousedown"!==i||this.isDown||(this.isDown=!0),this.isDown&&this.isNewTarget&&(n.clearInput(),this.isNewTarget=!1),o){switch(o){case"content":t.clientY=this.isScroll?t.clientY+this.decal:t.clientY,n.isMobile&&"mousedown"===i&&this.getNext(t,s),this.target&&(e=this.target.handleEvent(t)),"mousemove"===i&&(s=this.mode("def")),"wheel"===i&&!e&&this.isScroll&&(s=this.onWheel(t)),n.lock||this.getNext(t,s);break;case"bottom":this.clearTarget(),"mousemove"===i&&(s=this.mode("bottomOver")),"mousedown"===i&&(this.isOpen=!this.isOpen,this.bottom.textContent=this.isOpen?"Close":"Open",this.setHeight(),this.mode("def"),s=!0);break;case"scroll":this.clearTarget(),"mousemove"===i&&(s=this.mode("scrollOver")),"mousedown"===i&&(s=this.mode("scrollDown")),"wheel"===i&&(s=this.onWheel(t)),this.isDown&&this.update(t.clientY-this.zone.y-.5*this.sh)}this.isDown&&(s=!0),e&&(s=!0),"keyup"===i&&(s=!0),"keydown"===i&&(s=!0),s&&this.draw()}},i.getNext=function(t,i){var s=n.findTarget(this.uis,t);s!==this.current&&(this.clearTarget(),this.current=s,this.isNewTarget=!0),-1!==s&&(this.target=this.uis[this.current],this.target.uiover())},i.onWheel=function(t){return this.oy+=20*t.delta,this.update(this.oy),!0},i.reset=function(t){if(!this.isReset){this.mouse.neg(),this.isDown=!1;var i=this.mode("def"),s=this.clearTarget();(i||s)&&this.draw(!0),this.isReset=!0}},i.add=function(){var t=arguments,i=!1;"object"==typeof t[1]?(t[1].isUI=!0,t[1].main=this,i=!!t[1].ontop&&t[1].ontop):"string"==typeof t[1]&&(void 0===t[2]?[].push.call(t,{isUI:!0,main:this}):(t[2].isUI=!0,t[2].main=this,i=!!t[1].ontop&&t[1].ontop));var s=D.apply(this,t);if(null!==s){if(i?this.uis.unshift(s):this.uis.push(s),s.autoWidth)this.prevY=0,this.calc(s.h+1);else{var e=s.c[0].getBoundingClientRect().top;this.prevY!==e&&(this.calc(s.h+1),this.prevY=e)}return this.isEmpty=!1,s}},i.applyCalc=function(){this.calc(this.tmpH),this.tmpAdd=null},i.calcUis=function(){n.calcUis(this.uis,this.zone,this.zone.y)},i.remove=function(t){t.clear&&t.clear()},i.clearOne=function(t){var i=this.uis.indexOf(t);-1!==i&&(this.calc(-(this.uis[i].h+1)),this.inner.removeChild(this.uis[i].c[0]),this.uis.splice(i,1))},i.empty=function(){for(var t,i=this.uis.length;i--;)t=this.uis.pop(),this.inner.removeChild(t.c[0]),t.clear(!0);this.isEmpty=!0,this.calc(-this.h)},i.clear=function(){this.empty()},i.resetItem=function(){if(this.isItemMode)for(var t=this.uis.length;t--;)this.uis[t].selected()},i.setItem=function(t){if(this.isItemMode)if(t=t||"",this.resetItem(),t)for(var i=this.uis.length;i--;)this.uis[i].value===t&&(this.uis[i].selected(!0),this.isScroll&&this.update(i*(this.uis[i].h+1)*this.ratio));else this.update(0)},i.upScroll=function(t){this.sw=t?this.size.s:0,this.oy=t?this.oy:0,this.scrollBG.style.display=t?"block":"none",t&&(this.total=this.h,this.maxView=this.maxHeight,this.ratio=this.maxView/this.total,this.sh=this.maxView*this.ratio,this.range=this.maxView-this.sh,this.oy=e.clamp(this.oy,0,this.range),this.scrollBG.style.height=this.maxView+"px",this.scroll.style.height=this.sh+"px"),this.setItemWidth(this.zone.w-this.sw),this.update(this.oy)},i.update=function(t){t=e.clamp(t,0,this.range),this.decal=Math.floor(t/this.ratio),this.inner.style.top=-this.decal+"px",this.scroll.style.top=Math.floor(t)+"px",this.oy=t},i.calc=function(t){this.h+=t,clearTimeout(this.tmp),this.tmp=setTimeout(this.setHeight.bind(this),10)},i.setHeight=function(){if(this.tmp&&clearTimeout(this.tmp),this.zone.h=this.bh,this.isScroll=!1,this.isOpen){var t=this.forceHeight?this.forceHeight+this.zone.y:window.innerHeight;this.maxHeight=t-this.zone.y-this.bh,this.h-this.maxHeight>1?(this.isScroll=!0,this.zone.h=this.maxHeight+this.bh):this.zone.h=this.h+this.bh}this.upScroll(this.isScroll),this.innerContent.style.height=this.zone.h-this.bh+"px",this.content.style.height=this.zone.h+"px",this.bottom.style.top=this.zone.h-this.bh+"px",this.forceHeight&&this.lockHeight&&(this.content.style.height=this.forceHeight+"px"),this.isOpen&&this.calcUis(),this.isCanvas&&this.draw(!0)},i.rezone=function(){n.needReZone=!0},i.setWidth=function(t){t&&(this.zone.w=t),this.content.style.width=this.zone.w+"px",this.isCenter&&(this.content.style.marginLeft=-Math.floor(.5*this.zone.w)+"px"),this.setItemWidth(this.zone.w-this.sw),this.setHeight(),this.isCanvasOnly||(n.needReZone=!0)},i.setItemWidth=function(t){for(var i=this.uis.length;i--;)this.uis[i].setSize(t),this.uis[i].rSize()},t}();H.prototype.isGui=!0;t.Bool=c,t.Button=u,t.Circular=d,t.Color=p,t.Fps=f,t.Group=m,t.Gui=H,t.Joystick=g,t.Knob=x,t.List=b,t.Numeric=w,t.Proto=l,t.REVISION="3.0",t.Slide=y,t.TextInput=k,t.Title=C,t.Tools=e,t.add=D,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidWlsLm1pbi5qcyIsInNvdXJjZXMiOlsiLi4vbm9kZV9tb2R1bGVzL3JlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyIsIi4uL3NyYy9jb3JlL1Rvb2xzLmpzIiwiLi4vc3JjL2NvcmUvUm9vdHMuanMiLCIuLi9zcmMvY29yZS9WMi5qcyIsIi4uL3NyYy9jb3JlL1Byb3RvLmpzIiwiLi4vc3JjL3Byb3RvL0Jvb2wuanMiLCIuLi9zcmMvcHJvdG8vQnV0dG9uLmpzIiwiLi4vc3JjL3Byb3RvL0NpcmN1bGFyLmpzIiwiLi4vc3JjL3Byb3RvL0NvbG9yLmpzIiwiLi4vc3JjL3Byb3RvL0Zwcy5qcyIsIi4uL3NyYy9wcm90by9HcmFwaC5qcyIsIi4uL3NyYy9wcm90by9Hcm91cC5qcyIsIi4uL3NyYy9wcm90by9Kb3lzdGljay5qcyIsIi4uL3NyYy9wcm90by9Lbm9iLmpzIiwiLi4vc3JjL3Byb3RvL0xpc3QuanMiLCIuLi9zcmMvcHJvdG8vTnVtZXJpYy5qcyIsIi4uL3NyYy9wcm90by9TbGlkZS5qcyIsIi4uL3NyYy9wcm90by9UZXh0SW5wdXQuanMiLCIuLi9zcmMvcHJvdG8vVGl0bGUuanMiLCIuLi9zcmMvcHJvdG8vU2VsZWN0LmpzIiwiLi4vc3JjL3Byb3RvL1NlbGVjdG9yLmpzIiwiLi4vc3JjL3Byb3RvL0VtcHR5LmpzIiwiLi4vc3JjL3Byb3RvL0l0ZW0uanMiLCIuLi9zcmMvcHJvdG8vR3JpZC5qcyIsIi4uL3NyYy9jb3JlL2FkZC5qcyIsIi4uL3NyYy9jb3JlL0d1aS5qcyIsIi4uL3NyYy9VaWwuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQtcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqL1xuXG52YXIgcnVudGltZSA9IChmdW5jdGlvbiAoZXhwb3J0cykge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgT3AgPSBPYmplY3QucHJvdG90eXBlO1xuICB2YXIgaGFzT3duID0gT3AuaGFzT3duUHJvcGVydHk7XG4gIHZhciB1bmRlZmluZWQ7IC8vIE1vcmUgY29tcHJlc3NpYmxlIHRoYW4gdm9pZCAwLlxuICB2YXIgJFN5bWJvbCA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiA/IFN5bWJvbCA6IHt9O1xuICB2YXIgaXRlcmF0b3JTeW1ib2wgPSAkU3ltYm9sLml0ZXJhdG9yIHx8IFwiQEBpdGVyYXRvclwiO1xuICB2YXIgYXN5bmNJdGVyYXRvclN5bWJvbCA9ICRTeW1ib2wuYXN5bmNJdGVyYXRvciB8fCBcIkBAYXN5bmNJdGVyYXRvclwiO1xuICB2YXIgdG9TdHJpbmdUYWdTeW1ib2wgPSAkU3ltYm9sLnRvU3RyaW5nVGFnIHx8IFwiQEB0b1N0cmluZ1RhZ1wiO1xuXG4gIGZ1bmN0aW9uIGRlZmluZShvYmosIGtleSwgdmFsdWUpIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHtcbiAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICB3cml0YWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiBvYmpba2V5XTtcbiAgfVxuICB0cnkge1xuICAgIC8vIElFIDggaGFzIGEgYnJva2VuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSB0aGF0IG9ubHkgd29ya3Mgb24gRE9NIG9iamVjdHMuXG4gICAgZGVmaW5lKHt9LCBcIlwiKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgZGVmaW5lID0gZnVuY3Rpb24ob2JqLCBrZXksIHZhbHVlKSB7XG4gICAgICByZXR1cm4gb2JqW2tleV0gPSB2YWx1ZTtcbiAgICB9O1xuICB9XG5cbiAgZnVuY3Rpb24gd3JhcChpbm5lckZuLCBvdXRlckZuLCBzZWxmLCB0cnlMb2NzTGlzdCkge1xuICAgIC8vIElmIG91dGVyRm4gcHJvdmlkZWQgYW5kIG91dGVyRm4ucHJvdG90eXBlIGlzIGEgR2VuZXJhdG9yLCB0aGVuIG91dGVyRm4ucHJvdG90eXBlIGluc3RhbmNlb2YgR2VuZXJhdG9yLlxuICAgIHZhciBwcm90b0dlbmVyYXRvciA9IG91dGVyRm4gJiYgb3V0ZXJGbi5wcm90b3R5cGUgaW5zdGFuY2VvZiBHZW5lcmF0b3IgPyBvdXRlckZuIDogR2VuZXJhdG9yO1xuICAgIHZhciBnZW5lcmF0b3IgPSBPYmplY3QuY3JlYXRlKHByb3RvR2VuZXJhdG9yLnByb3RvdHlwZSk7XG4gICAgdmFyIGNvbnRleHQgPSBuZXcgQ29udGV4dCh0cnlMb2NzTGlzdCB8fCBbXSk7XG5cbiAgICAvLyBUaGUgLl9pbnZva2UgbWV0aG9kIHVuaWZpZXMgdGhlIGltcGxlbWVudGF0aW9ucyBvZiB0aGUgLm5leHQsXG4gICAgLy8gLnRocm93LCBhbmQgLnJldHVybiBtZXRob2RzLlxuICAgIGdlbmVyYXRvci5faW52b2tlID0gbWFrZUludm9rZU1ldGhvZChpbm5lckZuLCBzZWxmLCBjb250ZXh0KTtcblxuICAgIHJldHVybiBnZW5lcmF0b3I7XG4gIH1cbiAgZXhwb3J0cy53cmFwID0gd3JhcDtcblxuICAvLyBUcnkvY2F0Y2ggaGVscGVyIHRvIG1pbmltaXplIGRlb3B0aW1pemF0aW9ucy4gUmV0dXJucyBhIGNvbXBsZXRpb25cbiAgLy8gcmVjb3JkIGxpa2UgY29udGV4dC50cnlFbnRyaWVzW2ldLmNvbXBsZXRpb24uIFRoaXMgaW50ZXJmYWNlIGNvdWxkXG4gIC8vIGhhdmUgYmVlbiAoYW5kIHdhcyBwcmV2aW91c2x5KSBkZXNpZ25lZCB0byB0YWtlIGEgY2xvc3VyZSB0byBiZVxuICAvLyBpbnZva2VkIHdpdGhvdXQgYXJndW1lbnRzLCBidXQgaW4gYWxsIHRoZSBjYXNlcyB3ZSBjYXJlIGFib3V0IHdlXG4gIC8vIGFscmVhZHkgaGF2ZSBhbiBleGlzdGluZyBtZXRob2Qgd2Ugd2FudCB0byBjYWxsLCBzbyB0aGVyZSdzIG5vIG5lZWRcbiAgLy8gdG8gY3JlYXRlIGEgbmV3IGZ1bmN0aW9uIG9iamVjdC4gV2UgY2FuIGV2ZW4gZ2V0IGF3YXkgd2l0aCBhc3N1bWluZ1xuICAvLyB0aGUgbWV0aG9kIHRha2VzIGV4YWN0bHkgb25lIGFyZ3VtZW50LCBzaW5jZSB0aGF0IGhhcHBlbnMgdG8gYmUgdHJ1ZVxuICAvLyBpbiBldmVyeSBjYXNlLCBzbyB3ZSBkb24ndCBoYXZlIHRvIHRvdWNoIHRoZSBhcmd1bWVudHMgb2JqZWN0LiBUaGVcbiAgLy8gb25seSBhZGRpdGlvbmFsIGFsbG9jYXRpb24gcmVxdWlyZWQgaXMgdGhlIGNvbXBsZXRpb24gcmVjb3JkLCB3aGljaFxuICAvLyBoYXMgYSBzdGFibGUgc2hhcGUgYW5kIHNvIGhvcGVmdWxseSBzaG91bGQgYmUgY2hlYXAgdG8gYWxsb2NhdGUuXG4gIGZ1bmN0aW9uIHRyeUNhdGNoKGZuLCBvYmosIGFyZykge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4geyB0eXBlOiBcIm5vcm1hbFwiLCBhcmc6IGZuLmNhbGwob2JqLCBhcmcpIH07XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICByZXR1cm4geyB0eXBlOiBcInRocm93XCIsIGFyZzogZXJyIH07XG4gICAgfVxuICB9XG5cbiAgdmFyIEdlblN0YXRlU3VzcGVuZGVkU3RhcnQgPSBcInN1c3BlbmRlZFN0YXJ0XCI7XG4gIHZhciBHZW5TdGF0ZVN1c3BlbmRlZFlpZWxkID0gXCJzdXNwZW5kZWRZaWVsZFwiO1xuICB2YXIgR2VuU3RhdGVFeGVjdXRpbmcgPSBcImV4ZWN1dGluZ1wiO1xuICB2YXIgR2VuU3RhdGVDb21wbGV0ZWQgPSBcImNvbXBsZXRlZFwiO1xuXG4gIC8vIFJldHVybmluZyB0aGlzIG9iamVjdCBmcm9tIHRoZSBpbm5lckZuIGhhcyB0aGUgc2FtZSBlZmZlY3QgYXNcbiAgLy8gYnJlYWtpbmcgb3V0IG9mIHRoZSBkaXNwYXRjaCBzd2l0Y2ggc3RhdGVtZW50LlxuICB2YXIgQ29udGludWVTZW50aW5lbCA9IHt9O1xuXG4gIC8vIER1bW15IGNvbnN0cnVjdG9yIGZ1bmN0aW9ucyB0aGF0IHdlIHVzZSBhcyB0aGUgLmNvbnN0cnVjdG9yIGFuZFxuICAvLyAuY29uc3RydWN0b3IucHJvdG90eXBlIHByb3BlcnRpZXMgZm9yIGZ1bmN0aW9ucyB0aGF0IHJldHVybiBHZW5lcmF0b3JcbiAgLy8gb2JqZWN0cy4gRm9yIGZ1bGwgc3BlYyBjb21wbGlhbmNlLCB5b3UgbWF5IHdpc2ggdG8gY29uZmlndXJlIHlvdXJcbiAgLy8gbWluaWZpZXIgbm90IHRvIG1hbmdsZSB0aGUgbmFtZXMgb2YgdGhlc2UgdHdvIGZ1bmN0aW9ucy5cbiAgZnVuY3Rpb24gR2VuZXJhdG9yKCkge31cbiAgZnVuY3Rpb24gR2VuZXJhdG9yRnVuY3Rpb24oKSB7fVxuICBmdW5jdGlvbiBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSgpIHt9XG5cbiAgLy8gVGhpcyBpcyBhIHBvbHlmaWxsIGZvciAlSXRlcmF0b3JQcm90b3R5cGUlIGZvciBlbnZpcm9ubWVudHMgdGhhdFxuICAvLyBkb24ndCBuYXRpdmVseSBzdXBwb3J0IGl0LlxuICB2YXIgSXRlcmF0b3JQcm90b3R5cGUgPSB7fTtcbiAgSXRlcmF0b3JQcm90b3R5cGVbaXRlcmF0b3JTeW1ib2xdID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIHZhciBnZXRQcm90byA9IE9iamVjdC5nZXRQcm90b3R5cGVPZjtcbiAgdmFyIE5hdGl2ZUl0ZXJhdG9yUHJvdG90eXBlID0gZ2V0UHJvdG8gJiYgZ2V0UHJvdG8oZ2V0UHJvdG8odmFsdWVzKFtdKSkpO1xuICBpZiAoTmF0aXZlSXRlcmF0b3JQcm90b3R5cGUgJiZcbiAgICAgIE5hdGl2ZUl0ZXJhdG9yUHJvdG90eXBlICE9PSBPcCAmJlxuICAgICAgaGFzT3duLmNhbGwoTmF0aXZlSXRlcmF0b3JQcm90b3R5cGUsIGl0ZXJhdG9yU3ltYm9sKSkge1xuICAgIC8vIFRoaXMgZW52aXJvbm1lbnQgaGFzIGEgbmF0aXZlICVJdGVyYXRvclByb3RvdHlwZSU7IHVzZSBpdCBpbnN0ZWFkXG4gICAgLy8gb2YgdGhlIHBvbHlmaWxsLlxuICAgIEl0ZXJhdG9yUHJvdG90eXBlID0gTmF0aXZlSXRlcmF0b3JQcm90b3R5cGU7XG4gIH1cblxuICB2YXIgR3AgPSBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZS5wcm90b3R5cGUgPVxuICAgIEdlbmVyYXRvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEl0ZXJhdG9yUHJvdG90eXBlKTtcbiAgR2VuZXJhdG9yRnVuY3Rpb24ucHJvdG90eXBlID0gR3AuY29uc3RydWN0b3IgPSBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZTtcbiAgR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUuY29uc3RydWN0b3IgPSBHZW5lcmF0b3JGdW5jdGlvbjtcbiAgR2VuZXJhdG9yRnVuY3Rpb24uZGlzcGxheU5hbWUgPSBkZWZpbmUoXG4gICAgR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUsXG4gICAgdG9TdHJpbmdUYWdTeW1ib2wsXG4gICAgXCJHZW5lcmF0b3JGdW5jdGlvblwiXG4gICk7XG5cbiAgLy8gSGVscGVyIGZvciBkZWZpbmluZyB0aGUgLm5leHQsIC50aHJvdywgYW5kIC5yZXR1cm4gbWV0aG9kcyBvZiB0aGVcbiAgLy8gSXRlcmF0b3IgaW50ZXJmYWNlIGluIHRlcm1zIG9mIGEgc2luZ2xlIC5faW52b2tlIG1ldGhvZC5cbiAgZnVuY3Rpb24gZGVmaW5lSXRlcmF0b3JNZXRob2RzKHByb3RvdHlwZSkge1xuICAgIFtcIm5leHRcIiwgXCJ0aHJvd1wiLCBcInJldHVyblwiXS5mb3JFYWNoKGZ1bmN0aW9uKG1ldGhvZCkge1xuICAgICAgZGVmaW5lKHByb3RvdHlwZSwgbWV0aG9kLCBmdW5jdGlvbihhcmcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ludm9rZShtZXRob2QsIGFyZyk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGV4cG9ydHMuaXNHZW5lcmF0b3JGdW5jdGlvbiA9IGZ1bmN0aW9uKGdlbkZ1bikge1xuICAgIHZhciBjdG9yID0gdHlwZW9mIGdlbkZ1biA9PT0gXCJmdW5jdGlvblwiICYmIGdlbkZ1bi5jb25zdHJ1Y3RvcjtcbiAgICByZXR1cm4gY3RvclxuICAgICAgPyBjdG9yID09PSBHZW5lcmF0b3JGdW5jdGlvbiB8fFxuICAgICAgICAvLyBGb3IgdGhlIG5hdGl2ZSBHZW5lcmF0b3JGdW5jdGlvbiBjb25zdHJ1Y3RvciwgdGhlIGJlc3Qgd2UgY2FuXG4gICAgICAgIC8vIGRvIGlzIHRvIGNoZWNrIGl0cyAubmFtZSBwcm9wZXJ0eS5cbiAgICAgICAgKGN0b3IuZGlzcGxheU5hbWUgfHwgY3Rvci5uYW1lKSA9PT0gXCJHZW5lcmF0b3JGdW5jdGlvblwiXG4gICAgICA6IGZhbHNlO1xuICB9O1xuXG4gIGV4cG9ydHMubWFyayA9IGZ1bmN0aW9uKGdlbkZ1bikge1xuICAgIGlmIChPYmplY3Quc2V0UHJvdG90eXBlT2YpIHtcbiAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihnZW5GdW4sIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZ2VuRnVuLl9fcHJvdG9fXyA9IEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlO1xuICAgICAgZGVmaW5lKGdlbkZ1biwgdG9TdHJpbmdUYWdTeW1ib2wsIFwiR2VuZXJhdG9yRnVuY3Rpb25cIik7XG4gICAgfVxuICAgIGdlbkZ1bi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEdwKTtcbiAgICByZXR1cm4gZ2VuRnVuO1xuICB9O1xuXG4gIC8vIFdpdGhpbiB0aGUgYm9keSBvZiBhbnkgYXN5bmMgZnVuY3Rpb24sIGBhd2FpdCB4YCBpcyB0cmFuc2Zvcm1lZCB0b1xuICAvLyBgeWllbGQgcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKHgpYCwgc28gdGhhdCB0aGUgcnVudGltZSBjYW4gdGVzdFxuICAvLyBgaGFzT3duLmNhbGwodmFsdWUsIFwiX19hd2FpdFwiKWAgdG8gZGV0ZXJtaW5lIGlmIHRoZSB5aWVsZGVkIHZhbHVlIGlzXG4gIC8vIG1lYW50IHRvIGJlIGF3YWl0ZWQuXG4gIGV4cG9ydHMuYXdyYXAgPSBmdW5jdGlvbihhcmcpIHtcbiAgICByZXR1cm4geyBfX2F3YWl0OiBhcmcgfTtcbiAgfTtcblxuICBmdW5jdGlvbiBBc3luY0l0ZXJhdG9yKGdlbmVyYXRvciwgUHJvbWlzZUltcGwpIHtcbiAgICBmdW5jdGlvbiBpbnZva2UobWV0aG9kLCBhcmcsIHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgdmFyIHJlY29yZCA9IHRyeUNhdGNoKGdlbmVyYXRvclttZXRob2RdLCBnZW5lcmF0b3IsIGFyZyk7XG4gICAgICBpZiAocmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgICByZWplY3QocmVjb3JkLmFyZyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgcmVzdWx0ID0gcmVjb3JkLmFyZztcbiAgICAgICAgdmFyIHZhbHVlID0gcmVzdWx0LnZhbHVlO1xuICAgICAgICBpZiAodmFsdWUgJiZcbiAgICAgICAgICAgIHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIiAmJlxuICAgICAgICAgICAgaGFzT3duLmNhbGwodmFsdWUsIFwiX19hd2FpdFwiKSkge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlSW1wbC5yZXNvbHZlKHZhbHVlLl9fYXdhaXQpLnRoZW4oZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgIGludm9rZShcIm5leHRcIiwgdmFsdWUsIHJlc29sdmUsIHJlamVjdCk7XG4gICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICBpbnZva2UoXCJ0aHJvd1wiLCBlcnIsIHJlc29sdmUsIHJlamVjdCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gUHJvbWlzZUltcGwucmVzb2x2ZSh2YWx1ZSkudGhlbihmdW5jdGlvbih1bndyYXBwZWQpIHtcbiAgICAgICAgICAvLyBXaGVuIGEgeWllbGRlZCBQcm9taXNlIGlzIHJlc29sdmVkLCBpdHMgZmluYWwgdmFsdWUgYmVjb21lc1xuICAgICAgICAgIC8vIHRoZSAudmFsdWUgb2YgdGhlIFByb21pc2U8e3ZhbHVlLGRvbmV9PiByZXN1bHQgZm9yIHRoZVxuICAgICAgICAgIC8vIGN1cnJlbnQgaXRlcmF0aW9uLlxuICAgICAgICAgIHJlc3VsdC52YWx1ZSA9IHVud3JhcHBlZDtcbiAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgIH0sIGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgICAgLy8gSWYgYSByZWplY3RlZCBQcm9taXNlIHdhcyB5aWVsZGVkLCB0aHJvdyB0aGUgcmVqZWN0aW9uIGJhY2tcbiAgICAgICAgICAvLyBpbnRvIHRoZSBhc3luYyBnZW5lcmF0b3IgZnVuY3Rpb24gc28gaXQgY2FuIGJlIGhhbmRsZWQgdGhlcmUuXG4gICAgICAgICAgcmV0dXJuIGludm9rZShcInRocm93XCIsIGVycm9yLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgcHJldmlvdXNQcm9taXNlO1xuXG4gICAgZnVuY3Rpb24gZW5xdWV1ZShtZXRob2QsIGFyZykge1xuICAgICAgZnVuY3Rpb24gY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmcoKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZUltcGwoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgaW52b2tlKG1ldGhvZCwgYXJnLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHByZXZpb3VzUHJvbWlzZSA9XG4gICAgICAgIC8vIElmIGVucXVldWUgaGFzIGJlZW4gY2FsbGVkIGJlZm9yZSwgdGhlbiB3ZSB3YW50IHRvIHdhaXQgdW50aWxcbiAgICAgICAgLy8gYWxsIHByZXZpb3VzIFByb21pc2VzIGhhdmUgYmVlbiByZXNvbHZlZCBiZWZvcmUgY2FsbGluZyBpbnZva2UsXG4gICAgICAgIC8vIHNvIHRoYXQgcmVzdWx0cyBhcmUgYWx3YXlzIGRlbGl2ZXJlZCBpbiB0aGUgY29ycmVjdCBvcmRlci4gSWZcbiAgICAgICAgLy8gZW5xdWV1ZSBoYXMgbm90IGJlZW4gY2FsbGVkIGJlZm9yZSwgdGhlbiBpdCBpcyBpbXBvcnRhbnQgdG9cbiAgICAgICAgLy8gY2FsbCBpbnZva2UgaW1tZWRpYXRlbHksIHdpdGhvdXQgd2FpdGluZyBvbiBhIGNhbGxiYWNrIHRvIGZpcmUsXG4gICAgICAgIC8vIHNvIHRoYXQgdGhlIGFzeW5jIGdlbmVyYXRvciBmdW5jdGlvbiBoYXMgdGhlIG9wcG9ydHVuaXR5IHRvIGRvXG4gICAgICAgIC8vIGFueSBuZWNlc3Nhcnkgc2V0dXAgaW4gYSBwcmVkaWN0YWJsZSB3YXkuIFRoaXMgcHJlZGljdGFiaWxpdHlcbiAgICAgICAgLy8gaXMgd2h5IHRoZSBQcm9taXNlIGNvbnN0cnVjdG9yIHN5bmNocm9ub3VzbHkgaW52b2tlcyBpdHNcbiAgICAgICAgLy8gZXhlY3V0b3IgY2FsbGJhY2ssIGFuZCB3aHkgYXN5bmMgZnVuY3Rpb25zIHN5bmNocm9ub3VzbHlcbiAgICAgICAgLy8gZXhlY3V0ZSBjb2RlIGJlZm9yZSB0aGUgZmlyc3QgYXdhaXQuIFNpbmNlIHdlIGltcGxlbWVudCBzaW1wbGVcbiAgICAgICAgLy8gYXN5bmMgZnVuY3Rpb25zIGluIHRlcm1zIG9mIGFzeW5jIGdlbmVyYXRvcnMsIGl0IGlzIGVzcGVjaWFsbHlcbiAgICAgICAgLy8gaW1wb3J0YW50IHRvIGdldCB0aGlzIHJpZ2h0LCBldmVuIHRob3VnaCBpdCByZXF1aXJlcyBjYXJlLlxuICAgICAgICBwcmV2aW91c1Byb21pc2UgPyBwcmV2aW91c1Byb21pc2UudGhlbihcbiAgICAgICAgICBjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZyxcbiAgICAgICAgICAvLyBBdm9pZCBwcm9wYWdhdGluZyBmYWlsdXJlcyB0byBQcm9taXNlcyByZXR1cm5lZCBieSBsYXRlclxuICAgICAgICAgIC8vIGludm9jYXRpb25zIG9mIHRoZSBpdGVyYXRvci5cbiAgICAgICAgICBjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZ1xuICAgICAgICApIDogY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmcoKTtcbiAgICB9XG5cbiAgICAvLyBEZWZpbmUgdGhlIHVuaWZpZWQgaGVscGVyIG1ldGhvZCB0aGF0IGlzIHVzZWQgdG8gaW1wbGVtZW50IC5uZXh0LFxuICAgIC8vIC50aHJvdywgYW5kIC5yZXR1cm4gKHNlZSBkZWZpbmVJdGVyYXRvck1ldGhvZHMpLlxuICAgIHRoaXMuX2ludm9rZSA9IGVucXVldWU7XG4gIH1cblxuICBkZWZpbmVJdGVyYXRvck1ldGhvZHMoQXN5bmNJdGVyYXRvci5wcm90b3R5cGUpO1xuICBBc3luY0l0ZXJhdG9yLnByb3RvdHlwZVthc3luY0l0ZXJhdG9yU3ltYm9sXSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgZXhwb3J0cy5Bc3luY0l0ZXJhdG9yID0gQXN5bmNJdGVyYXRvcjtcblxuICAvLyBOb3RlIHRoYXQgc2ltcGxlIGFzeW5jIGZ1bmN0aW9ucyBhcmUgaW1wbGVtZW50ZWQgb24gdG9wIG9mXG4gIC8vIEFzeW5jSXRlcmF0b3Igb2JqZWN0czsgdGhleSBqdXN0IHJldHVybiBhIFByb21pc2UgZm9yIHRoZSB2YWx1ZSBvZlxuICAvLyB0aGUgZmluYWwgcmVzdWx0IHByb2R1Y2VkIGJ5IHRoZSBpdGVyYXRvci5cbiAgZXhwb3J0cy5hc3luYyA9IGZ1bmN0aW9uKGlubmVyRm4sIG91dGVyRm4sIHNlbGYsIHRyeUxvY3NMaXN0LCBQcm9taXNlSW1wbCkge1xuICAgIGlmIChQcm9taXNlSW1wbCA9PT0gdm9pZCAwKSBQcm9taXNlSW1wbCA9IFByb21pc2U7XG5cbiAgICB2YXIgaXRlciA9IG5ldyBBc3luY0l0ZXJhdG9yKFxuICAgICAgd3JhcChpbm5lckZuLCBvdXRlckZuLCBzZWxmLCB0cnlMb2NzTGlzdCksXG4gICAgICBQcm9taXNlSW1wbFxuICAgICk7XG5cbiAgICByZXR1cm4gZXhwb3J0cy5pc0dlbmVyYXRvckZ1bmN0aW9uKG91dGVyRm4pXG4gICAgICA/IGl0ZXIgLy8gSWYgb3V0ZXJGbiBpcyBhIGdlbmVyYXRvciwgcmV0dXJuIHRoZSBmdWxsIGl0ZXJhdG9yLlxuICAgICAgOiBpdGVyLm5leHQoKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgIHJldHVybiByZXN1bHQuZG9uZSA/IHJlc3VsdC52YWx1ZSA6IGl0ZXIubmV4dCgpO1xuICAgICAgICB9KTtcbiAgfTtcblxuICBmdW5jdGlvbiBtYWtlSW52b2tlTWV0aG9kKGlubmVyRm4sIHNlbGYsIGNvbnRleHQpIHtcbiAgICB2YXIgc3RhdGUgPSBHZW5TdGF0ZVN1c3BlbmRlZFN0YXJ0O1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uIGludm9rZShtZXRob2QsIGFyZykge1xuICAgICAgaWYgKHN0YXRlID09PSBHZW5TdGF0ZUV4ZWN1dGluZykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBydW5uaW5nXCIpO1xuICAgICAgfVxuXG4gICAgICBpZiAoc3RhdGUgPT09IEdlblN0YXRlQ29tcGxldGVkKSB7XG4gICAgICAgIGlmIChtZXRob2QgPT09IFwidGhyb3dcIikge1xuICAgICAgICAgIHRocm93IGFyZztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEJlIGZvcmdpdmluZywgcGVyIDI1LjMuMy4zLjMgb2YgdGhlIHNwZWM6XG4gICAgICAgIC8vIGh0dHBzOi8vcGVvcGxlLm1vemlsbGEub3JnL35qb3JlbmRvcmZmL2VzNi1kcmFmdC5odG1sI3NlYy1nZW5lcmF0b3JyZXN1bWVcbiAgICAgICAgcmV0dXJuIGRvbmVSZXN1bHQoKTtcbiAgICAgIH1cblxuICAgICAgY29udGV4dC5tZXRob2QgPSBtZXRob2Q7XG4gICAgICBjb250ZXh0LmFyZyA9IGFyZztcblxuICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgdmFyIGRlbGVnYXRlID0gY29udGV4dC5kZWxlZ2F0ZTtcbiAgICAgICAgaWYgKGRlbGVnYXRlKSB7XG4gICAgICAgICAgdmFyIGRlbGVnYXRlUmVzdWx0ID0gbWF5YmVJbnZva2VEZWxlZ2F0ZShkZWxlZ2F0ZSwgY29udGV4dCk7XG4gICAgICAgICAgaWYgKGRlbGVnYXRlUmVzdWx0KSB7XG4gICAgICAgICAgICBpZiAoZGVsZWdhdGVSZXN1bHQgPT09IENvbnRpbnVlU2VudGluZWwpIGNvbnRpbnVlO1xuICAgICAgICAgICAgcmV0dXJuIGRlbGVnYXRlUmVzdWx0O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjb250ZXh0Lm1ldGhvZCA9PT0gXCJuZXh0XCIpIHtcbiAgICAgICAgICAvLyBTZXR0aW5nIGNvbnRleHQuX3NlbnQgZm9yIGxlZ2FjeSBzdXBwb3J0IG9mIEJhYmVsJ3NcbiAgICAgICAgICAvLyBmdW5jdGlvbi5zZW50IGltcGxlbWVudGF0aW9uLlxuICAgICAgICAgIGNvbnRleHQuc2VudCA9IGNvbnRleHQuX3NlbnQgPSBjb250ZXh0LmFyZztcblxuICAgICAgICB9IGVsc2UgaWYgKGNvbnRleHQubWV0aG9kID09PSBcInRocm93XCIpIHtcbiAgICAgICAgICBpZiAoc3RhdGUgPT09IEdlblN0YXRlU3VzcGVuZGVkU3RhcnQpIHtcbiAgICAgICAgICAgIHN0YXRlID0gR2VuU3RhdGVDb21wbGV0ZWQ7XG4gICAgICAgICAgICB0aHJvdyBjb250ZXh0LmFyZztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb250ZXh0LmRpc3BhdGNoRXhjZXB0aW9uKGNvbnRleHQuYXJnKTtcblxuICAgICAgICB9IGVsc2UgaWYgKGNvbnRleHQubWV0aG9kID09PSBcInJldHVyblwiKSB7XG4gICAgICAgICAgY29udGV4dC5hYnJ1cHQoXCJyZXR1cm5cIiwgY29udGV4dC5hcmcpO1xuICAgICAgICB9XG5cbiAgICAgICAgc3RhdGUgPSBHZW5TdGF0ZUV4ZWN1dGluZztcblxuICAgICAgICB2YXIgcmVjb3JkID0gdHJ5Q2F0Y2goaW5uZXJGbiwgc2VsZiwgY29udGV4dCk7XG4gICAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gXCJub3JtYWxcIikge1xuICAgICAgICAgIC8vIElmIGFuIGV4Y2VwdGlvbiBpcyB0aHJvd24gZnJvbSBpbm5lckZuLCB3ZSBsZWF2ZSBzdGF0ZSA9PT1cbiAgICAgICAgICAvLyBHZW5TdGF0ZUV4ZWN1dGluZyBhbmQgbG9vcCBiYWNrIGZvciBhbm90aGVyIGludm9jYXRpb24uXG4gICAgICAgICAgc3RhdGUgPSBjb250ZXh0LmRvbmVcbiAgICAgICAgICAgID8gR2VuU3RhdGVDb21wbGV0ZWRcbiAgICAgICAgICAgIDogR2VuU3RhdGVTdXNwZW5kZWRZaWVsZDtcblxuICAgICAgICAgIGlmIChyZWNvcmQuYXJnID09PSBDb250aW51ZVNlbnRpbmVsKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdmFsdWU6IHJlY29yZC5hcmcsXG4gICAgICAgICAgICBkb25lOiBjb250ZXh0LmRvbmVcbiAgICAgICAgICB9O1xuXG4gICAgICAgIH0gZWxzZSBpZiAocmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgICAgIHN0YXRlID0gR2VuU3RhdGVDb21wbGV0ZWQ7XG4gICAgICAgICAgLy8gRGlzcGF0Y2ggdGhlIGV4Y2VwdGlvbiBieSBsb29waW5nIGJhY2sgYXJvdW5kIHRvIHRoZVxuICAgICAgICAgIC8vIGNvbnRleHQuZGlzcGF0Y2hFeGNlcHRpb24oY29udGV4dC5hcmcpIGNhbGwgYWJvdmUuXG4gICAgICAgICAgY29udGV4dC5tZXRob2QgPSBcInRocm93XCI7XG4gICAgICAgICAgY29udGV4dC5hcmcgPSByZWNvcmQuYXJnO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIC8vIENhbGwgZGVsZWdhdGUuaXRlcmF0b3JbY29udGV4dC5tZXRob2RdKGNvbnRleHQuYXJnKSBhbmQgaGFuZGxlIHRoZVxuICAvLyByZXN1bHQsIGVpdGhlciBieSByZXR1cm5pbmcgYSB7IHZhbHVlLCBkb25lIH0gcmVzdWx0IGZyb20gdGhlXG4gIC8vIGRlbGVnYXRlIGl0ZXJhdG9yLCBvciBieSBtb2RpZnlpbmcgY29udGV4dC5tZXRob2QgYW5kIGNvbnRleHQuYXJnLFxuICAvLyBzZXR0aW5nIGNvbnRleHQuZGVsZWdhdGUgdG8gbnVsbCwgYW5kIHJldHVybmluZyB0aGUgQ29udGludWVTZW50aW5lbC5cbiAgZnVuY3Rpb24gbWF5YmVJbnZva2VEZWxlZ2F0ZShkZWxlZ2F0ZSwgY29udGV4dCkge1xuICAgIHZhciBtZXRob2QgPSBkZWxlZ2F0ZS5pdGVyYXRvcltjb250ZXh0Lm1ldGhvZF07XG4gICAgaWYgKG1ldGhvZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAvLyBBIC50aHJvdyBvciAucmV0dXJuIHdoZW4gdGhlIGRlbGVnYXRlIGl0ZXJhdG9yIGhhcyBubyAudGhyb3dcbiAgICAgIC8vIG1ldGhvZCBhbHdheXMgdGVybWluYXRlcyB0aGUgeWllbGQqIGxvb3AuXG4gICAgICBjb250ZXh0LmRlbGVnYXRlID0gbnVsbDtcblxuICAgICAgaWYgKGNvbnRleHQubWV0aG9kID09PSBcInRocm93XCIpIHtcbiAgICAgICAgLy8gTm90ZTogW1wicmV0dXJuXCJdIG11c3QgYmUgdXNlZCBmb3IgRVMzIHBhcnNpbmcgY29tcGF0aWJpbGl0eS5cbiAgICAgICAgaWYgKGRlbGVnYXRlLml0ZXJhdG9yW1wicmV0dXJuXCJdKSB7XG4gICAgICAgICAgLy8gSWYgdGhlIGRlbGVnYXRlIGl0ZXJhdG9yIGhhcyBhIHJldHVybiBtZXRob2QsIGdpdmUgaXQgYVxuICAgICAgICAgIC8vIGNoYW5jZSB0byBjbGVhbiB1cC5cbiAgICAgICAgICBjb250ZXh0Lm1ldGhvZCA9IFwicmV0dXJuXCI7XG4gICAgICAgICAgY29udGV4dC5hcmcgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgbWF5YmVJbnZva2VEZWxlZ2F0ZShkZWxlZ2F0ZSwgY29udGV4dCk7XG5cbiAgICAgICAgICBpZiAoY29udGV4dC5tZXRob2QgPT09IFwidGhyb3dcIikge1xuICAgICAgICAgICAgLy8gSWYgbWF5YmVJbnZva2VEZWxlZ2F0ZShjb250ZXh0KSBjaGFuZ2VkIGNvbnRleHQubWV0aG9kIGZyb21cbiAgICAgICAgICAgIC8vIFwicmV0dXJuXCIgdG8gXCJ0aHJvd1wiLCBsZXQgdGhhdCBvdmVycmlkZSB0aGUgVHlwZUVycm9yIGJlbG93LlxuICAgICAgICAgICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29udGV4dC5tZXRob2QgPSBcInRocm93XCI7XG4gICAgICAgIGNvbnRleHQuYXJnID0gbmV3IFR5cGVFcnJvcihcbiAgICAgICAgICBcIlRoZSBpdGVyYXRvciBkb2VzIG5vdCBwcm92aWRlIGEgJ3Rocm93JyBtZXRob2RcIik7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgIH1cblxuICAgIHZhciByZWNvcmQgPSB0cnlDYXRjaChtZXRob2QsIGRlbGVnYXRlLml0ZXJhdG9yLCBjb250ZXh0LmFyZyk7XG5cbiAgICBpZiAocmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgY29udGV4dC5tZXRob2QgPSBcInRocm93XCI7XG4gICAgICBjb250ZXh0LmFyZyA9IHJlY29yZC5hcmc7XG4gICAgICBjb250ZXh0LmRlbGVnYXRlID0gbnVsbDtcbiAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgIH1cblxuICAgIHZhciBpbmZvID0gcmVjb3JkLmFyZztcblxuICAgIGlmICghIGluZm8pIHtcbiAgICAgIGNvbnRleHQubWV0aG9kID0gXCJ0aHJvd1wiO1xuICAgICAgY29udGV4dC5hcmcgPSBuZXcgVHlwZUVycm9yKFwiaXRlcmF0b3IgcmVzdWx0IGlzIG5vdCBhbiBvYmplY3RcIik7XG4gICAgICBjb250ZXh0LmRlbGVnYXRlID0gbnVsbDtcbiAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgIH1cblxuICAgIGlmIChpbmZvLmRvbmUpIHtcbiAgICAgIC8vIEFzc2lnbiB0aGUgcmVzdWx0IG9mIHRoZSBmaW5pc2hlZCBkZWxlZ2F0ZSB0byB0aGUgdGVtcG9yYXJ5XG4gICAgICAvLyB2YXJpYWJsZSBzcGVjaWZpZWQgYnkgZGVsZWdhdGUucmVzdWx0TmFtZSAoc2VlIGRlbGVnYXRlWWllbGQpLlxuICAgICAgY29udGV4dFtkZWxlZ2F0ZS5yZXN1bHROYW1lXSA9IGluZm8udmFsdWU7XG5cbiAgICAgIC8vIFJlc3VtZSBleGVjdXRpb24gYXQgdGhlIGRlc2lyZWQgbG9jYXRpb24gKHNlZSBkZWxlZ2F0ZVlpZWxkKS5cbiAgICAgIGNvbnRleHQubmV4dCA9IGRlbGVnYXRlLm5leHRMb2M7XG5cbiAgICAgIC8vIElmIGNvbnRleHQubWV0aG9kIHdhcyBcInRocm93XCIgYnV0IHRoZSBkZWxlZ2F0ZSBoYW5kbGVkIHRoZVxuICAgICAgLy8gZXhjZXB0aW9uLCBsZXQgdGhlIG91dGVyIGdlbmVyYXRvciBwcm9jZWVkIG5vcm1hbGx5LiBJZlxuICAgICAgLy8gY29udGV4dC5tZXRob2Qgd2FzIFwibmV4dFwiLCBmb3JnZXQgY29udGV4dC5hcmcgc2luY2UgaXQgaGFzIGJlZW5cbiAgICAgIC8vIFwiY29uc3VtZWRcIiBieSB0aGUgZGVsZWdhdGUgaXRlcmF0b3IuIElmIGNvbnRleHQubWV0aG9kIHdhc1xuICAgICAgLy8gXCJyZXR1cm5cIiwgYWxsb3cgdGhlIG9yaWdpbmFsIC5yZXR1cm4gY2FsbCB0byBjb250aW51ZSBpbiB0aGVcbiAgICAgIC8vIG91dGVyIGdlbmVyYXRvci5cbiAgICAgIGlmIChjb250ZXh0Lm1ldGhvZCAhPT0gXCJyZXR1cm5cIikge1xuICAgICAgICBjb250ZXh0Lm1ldGhvZCA9IFwibmV4dFwiO1xuICAgICAgICBjb250ZXh0LmFyZyA9IHVuZGVmaW5lZDtcbiAgICAgIH1cblxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBSZS15aWVsZCB0aGUgcmVzdWx0IHJldHVybmVkIGJ5IHRoZSBkZWxlZ2F0ZSBtZXRob2QuXG4gICAgICByZXR1cm4gaW5mbztcbiAgICB9XG5cbiAgICAvLyBUaGUgZGVsZWdhdGUgaXRlcmF0b3IgaXMgZmluaXNoZWQsIHNvIGZvcmdldCBpdCBhbmQgY29udGludWUgd2l0aFxuICAgIC8vIHRoZSBvdXRlciBnZW5lcmF0b3IuXG4gICAgY29udGV4dC5kZWxlZ2F0ZSA9IG51bGw7XG4gICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7XG4gIH1cblxuICAvLyBEZWZpbmUgR2VuZXJhdG9yLnByb3RvdHlwZS57bmV4dCx0aHJvdyxyZXR1cm59IGluIHRlcm1zIG9mIHRoZVxuICAvLyB1bmlmaWVkIC5faW52b2tlIGhlbHBlciBtZXRob2QuXG4gIGRlZmluZUl0ZXJhdG9yTWV0aG9kcyhHcCk7XG5cbiAgZGVmaW5lKEdwLCB0b1N0cmluZ1RhZ1N5bWJvbCwgXCJHZW5lcmF0b3JcIik7XG5cbiAgLy8gQSBHZW5lcmF0b3Igc2hvdWxkIGFsd2F5cyByZXR1cm4gaXRzZWxmIGFzIHRoZSBpdGVyYXRvciBvYmplY3Qgd2hlbiB0aGVcbiAgLy8gQEBpdGVyYXRvciBmdW5jdGlvbiBpcyBjYWxsZWQgb24gaXQuIFNvbWUgYnJvd3NlcnMnIGltcGxlbWVudGF0aW9ucyBvZiB0aGVcbiAgLy8gaXRlcmF0b3IgcHJvdG90eXBlIGNoYWluIGluY29ycmVjdGx5IGltcGxlbWVudCB0aGlzLCBjYXVzaW5nIHRoZSBHZW5lcmF0b3JcbiAgLy8gb2JqZWN0IHRvIG5vdCBiZSByZXR1cm5lZCBmcm9tIHRoaXMgY2FsbC4gVGhpcyBlbnN1cmVzIHRoYXQgZG9lc24ndCBoYXBwZW4uXG4gIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svcmVnZW5lcmF0b3IvaXNzdWVzLzI3NCBmb3IgbW9yZSBkZXRhaWxzLlxuICBHcFtpdGVyYXRvclN5bWJvbF0gPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICBHcC50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBcIltvYmplY3QgR2VuZXJhdG9yXVwiO1xuICB9O1xuXG4gIGZ1bmN0aW9uIHB1c2hUcnlFbnRyeShsb2NzKSB7XG4gICAgdmFyIGVudHJ5ID0geyB0cnlMb2M6IGxvY3NbMF0gfTtcblxuICAgIGlmICgxIGluIGxvY3MpIHtcbiAgICAgIGVudHJ5LmNhdGNoTG9jID0gbG9jc1sxXTtcbiAgICB9XG5cbiAgICBpZiAoMiBpbiBsb2NzKSB7XG4gICAgICBlbnRyeS5maW5hbGx5TG9jID0gbG9jc1syXTtcbiAgICAgIGVudHJ5LmFmdGVyTG9jID0gbG9jc1szXTtcbiAgICB9XG5cbiAgICB0aGlzLnRyeUVudHJpZXMucHVzaChlbnRyeSk7XG4gIH1cblxuICBmdW5jdGlvbiByZXNldFRyeUVudHJ5KGVudHJ5KSB7XG4gICAgdmFyIHJlY29yZCA9IGVudHJ5LmNvbXBsZXRpb24gfHwge307XG4gICAgcmVjb3JkLnR5cGUgPSBcIm5vcm1hbFwiO1xuICAgIGRlbGV0ZSByZWNvcmQuYXJnO1xuICAgIGVudHJ5LmNvbXBsZXRpb24gPSByZWNvcmQ7XG4gIH1cblxuICBmdW5jdGlvbiBDb250ZXh0KHRyeUxvY3NMaXN0KSB7XG4gICAgLy8gVGhlIHJvb3QgZW50cnkgb2JqZWN0IChlZmZlY3RpdmVseSBhIHRyeSBzdGF0ZW1lbnQgd2l0aG91dCBhIGNhdGNoXG4gICAgLy8gb3IgYSBmaW5hbGx5IGJsb2NrKSBnaXZlcyB1cyBhIHBsYWNlIHRvIHN0b3JlIHZhbHVlcyB0aHJvd24gZnJvbVxuICAgIC8vIGxvY2F0aW9ucyB3aGVyZSB0aGVyZSBpcyBubyBlbmNsb3NpbmcgdHJ5IHN0YXRlbWVudC5cbiAgICB0aGlzLnRyeUVudHJpZXMgPSBbeyB0cnlMb2M6IFwicm9vdFwiIH1dO1xuICAgIHRyeUxvY3NMaXN0LmZvckVhY2gocHVzaFRyeUVudHJ5LCB0aGlzKTtcbiAgICB0aGlzLnJlc2V0KHRydWUpO1xuICB9XG5cbiAgZXhwb3J0cy5rZXlzID0gZnVuY3Rpb24ob2JqZWN0KSB7XG4gICAgdmFyIGtleXMgPSBbXTtcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqZWN0KSB7XG4gICAgICBrZXlzLnB1c2goa2V5KTtcbiAgICB9XG4gICAga2V5cy5yZXZlcnNlKCk7XG5cbiAgICAvLyBSYXRoZXIgdGhhbiByZXR1cm5pbmcgYW4gb2JqZWN0IHdpdGggYSBuZXh0IG1ldGhvZCwgd2Uga2VlcFxuICAgIC8vIHRoaW5ncyBzaW1wbGUgYW5kIHJldHVybiB0aGUgbmV4dCBmdW5jdGlvbiBpdHNlbGYuXG4gICAgcmV0dXJuIGZ1bmN0aW9uIG5leHQoKSB7XG4gICAgICB3aGlsZSAoa2V5cy5sZW5ndGgpIHtcbiAgICAgICAgdmFyIGtleSA9IGtleXMucG9wKCk7XG4gICAgICAgIGlmIChrZXkgaW4gb2JqZWN0KSB7XG4gICAgICAgICAgbmV4dC52YWx1ZSA9IGtleTtcbiAgICAgICAgICBuZXh0LmRvbmUgPSBmYWxzZTtcbiAgICAgICAgICByZXR1cm4gbmV4dDtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBUbyBhdm9pZCBjcmVhdGluZyBhbiBhZGRpdGlvbmFsIG9iamVjdCwgd2UganVzdCBoYW5nIHRoZSAudmFsdWVcbiAgICAgIC8vIGFuZCAuZG9uZSBwcm9wZXJ0aWVzIG9mZiB0aGUgbmV4dCBmdW5jdGlvbiBvYmplY3QgaXRzZWxmLiBUaGlzXG4gICAgICAvLyBhbHNvIGVuc3VyZXMgdGhhdCB0aGUgbWluaWZpZXIgd2lsbCBub3QgYW5vbnltaXplIHRoZSBmdW5jdGlvbi5cbiAgICAgIG5leHQuZG9uZSA9IHRydWU7XG4gICAgICByZXR1cm4gbmV4dDtcbiAgICB9O1xuICB9O1xuXG4gIGZ1bmN0aW9uIHZhbHVlcyhpdGVyYWJsZSkge1xuICAgIGlmIChpdGVyYWJsZSkge1xuICAgICAgdmFyIGl0ZXJhdG9yTWV0aG9kID0gaXRlcmFibGVbaXRlcmF0b3JTeW1ib2xdO1xuICAgICAgaWYgKGl0ZXJhdG9yTWV0aG9kKSB7XG4gICAgICAgIHJldHVybiBpdGVyYXRvck1ldGhvZC5jYWxsKGl0ZXJhYmxlKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHR5cGVvZiBpdGVyYWJsZS5uZXh0ID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgcmV0dXJuIGl0ZXJhYmxlO1xuICAgICAgfVxuXG4gICAgICBpZiAoIWlzTmFOKGl0ZXJhYmxlLmxlbmd0aCkpIHtcbiAgICAgICAgdmFyIGkgPSAtMSwgbmV4dCA9IGZ1bmN0aW9uIG5leHQoKSB7XG4gICAgICAgICAgd2hpbGUgKCsraSA8IGl0ZXJhYmxlLmxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKGhhc093bi5jYWxsKGl0ZXJhYmxlLCBpKSkge1xuICAgICAgICAgICAgICBuZXh0LnZhbHVlID0gaXRlcmFibGVbaV07XG4gICAgICAgICAgICAgIG5leHQuZG9uZSA9IGZhbHNlO1xuICAgICAgICAgICAgICByZXR1cm4gbmV4dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBuZXh0LnZhbHVlID0gdW5kZWZpbmVkO1xuICAgICAgICAgIG5leHQuZG9uZSA9IHRydWU7XG5cbiAgICAgICAgICByZXR1cm4gbmV4dDtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gbmV4dC5uZXh0ID0gbmV4dDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBSZXR1cm4gYW4gaXRlcmF0b3Igd2l0aCBubyB2YWx1ZXMuXG4gICAgcmV0dXJuIHsgbmV4dDogZG9uZVJlc3VsdCB9O1xuICB9XG4gIGV4cG9ydHMudmFsdWVzID0gdmFsdWVzO1xuXG4gIGZ1bmN0aW9uIGRvbmVSZXN1bHQoKSB7XG4gICAgcmV0dXJuIHsgdmFsdWU6IHVuZGVmaW5lZCwgZG9uZTogdHJ1ZSB9O1xuICB9XG5cbiAgQ29udGV4dC5wcm90b3R5cGUgPSB7XG4gICAgY29uc3RydWN0b3I6IENvbnRleHQsXG5cbiAgICByZXNldDogZnVuY3Rpb24oc2tpcFRlbXBSZXNldCkge1xuICAgICAgdGhpcy5wcmV2ID0gMDtcbiAgICAgIHRoaXMubmV4dCA9IDA7XG4gICAgICAvLyBSZXNldHRpbmcgY29udGV4dC5fc2VudCBmb3IgbGVnYWN5IHN1cHBvcnQgb2YgQmFiZWwnc1xuICAgICAgLy8gZnVuY3Rpb24uc2VudCBpbXBsZW1lbnRhdGlvbi5cbiAgICAgIHRoaXMuc2VudCA9IHRoaXMuX3NlbnQgPSB1bmRlZmluZWQ7XG4gICAgICB0aGlzLmRvbmUgPSBmYWxzZTtcbiAgICAgIHRoaXMuZGVsZWdhdGUgPSBudWxsO1xuXG4gICAgICB0aGlzLm1ldGhvZCA9IFwibmV4dFwiO1xuICAgICAgdGhpcy5hcmcgPSB1bmRlZmluZWQ7XG5cbiAgICAgIHRoaXMudHJ5RW50cmllcy5mb3JFYWNoKHJlc2V0VHJ5RW50cnkpO1xuXG4gICAgICBpZiAoIXNraXBUZW1wUmVzZXQpIHtcbiAgICAgICAgZm9yICh2YXIgbmFtZSBpbiB0aGlzKSB7XG4gICAgICAgICAgLy8gTm90IHN1cmUgYWJvdXQgdGhlIG9wdGltYWwgb3JkZXIgb2YgdGhlc2UgY29uZGl0aW9uczpcbiAgICAgICAgICBpZiAobmFtZS5jaGFyQXQoMCkgPT09IFwidFwiICYmXG4gICAgICAgICAgICAgIGhhc093bi5jYWxsKHRoaXMsIG5hbWUpICYmXG4gICAgICAgICAgICAgICFpc05hTigrbmFtZS5zbGljZSgxKSkpIHtcbiAgICAgICAgICAgIHRoaXNbbmFtZV0gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcblxuICAgIHN0b3A6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5kb25lID0gdHJ1ZTtcblxuICAgICAgdmFyIHJvb3RFbnRyeSA9IHRoaXMudHJ5RW50cmllc1swXTtcbiAgICAgIHZhciByb290UmVjb3JkID0gcm9vdEVudHJ5LmNvbXBsZXRpb247XG4gICAgICBpZiAocm9vdFJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgICAgdGhyb3cgcm9vdFJlY29yZC5hcmc7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLnJ2YWw7XG4gICAgfSxcblxuICAgIGRpc3BhdGNoRXhjZXB0aW9uOiBmdW5jdGlvbihleGNlcHRpb24pIHtcbiAgICAgIGlmICh0aGlzLmRvbmUpIHtcbiAgICAgICAgdGhyb3cgZXhjZXB0aW9uO1xuICAgICAgfVxuXG4gICAgICB2YXIgY29udGV4dCA9IHRoaXM7XG4gICAgICBmdW5jdGlvbiBoYW5kbGUobG9jLCBjYXVnaHQpIHtcbiAgICAgICAgcmVjb3JkLnR5cGUgPSBcInRocm93XCI7XG4gICAgICAgIHJlY29yZC5hcmcgPSBleGNlcHRpb247XG4gICAgICAgIGNvbnRleHQubmV4dCA9IGxvYztcblxuICAgICAgICBpZiAoY2F1Z2h0KSB7XG4gICAgICAgICAgLy8gSWYgdGhlIGRpc3BhdGNoZWQgZXhjZXB0aW9uIHdhcyBjYXVnaHQgYnkgYSBjYXRjaCBibG9jayxcbiAgICAgICAgICAvLyB0aGVuIGxldCB0aGF0IGNhdGNoIGJsb2NrIGhhbmRsZSB0aGUgZXhjZXB0aW9uIG5vcm1hbGx5LlxuICAgICAgICAgIGNvbnRleHQubWV0aG9kID0gXCJuZXh0XCI7XG4gICAgICAgICAgY29udGV4dC5hcmcgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gISEgY2F1Z2h0O1xuICAgICAgfVxuXG4gICAgICBmb3IgKHZhciBpID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7XG4gICAgICAgIHZhciBlbnRyeSA9IHRoaXMudHJ5RW50cmllc1tpXTtcbiAgICAgICAgdmFyIHJlY29yZCA9IGVudHJ5LmNvbXBsZXRpb247XG5cbiAgICAgICAgaWYgKGVudHJ5LnRyeUxvYyA9PT0gXCJyb290XCIpIHtcbiAgICAgICAgICAvLyBFeGNlcHRpb24gdGhyb3duIG91dHNpZGUgb2YgYW55IHRyeSBibG9jayB0aGF0IGNvdWxkIGhhbmRsZVxuICAgICAgICAgIC8vIGl0LCBzbyBzZXQgdGhlIGNvbXBsZXRpb24gdmFsdWUgb2YgdGhlIGVudGlyZSBmdW5jdGlvbiB0b1xuICAgICAgICAgIC8vIHRocm93IHRoZSBleGNlcHRpb24uXG4gICAgICAgICAgcmV0dXJuIGhhbmRsZShcImVuZFwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChlbnRyeS50cnlMb2MgPD0gdGhpcy5wcmV2KSB7XG4gICAgICAgICAgdmFyIGhhc0NhdGNoID0gaGFzT3duLmNhbGwoZW50cnksIFwiY2F0Y2hMb2NcIik7XG4gICAgICAgICAgdmFyIGhhc0ZpbmFsbHkgPSBoYXNPd24uY2FsbChlbnRyeSwgXCJmaW5hbGx5TG9jXCIpO1xuXG4gICAgICAgICAgaWYgKGhhc0NhdGNoICYmIGhhc0ZpbmFsbHkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByZXYgPCBlbnRyeS5jYXRjaExvYykge1xuICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlKGVudHJ5LmNhdGNoTG9jLCB0cnVlKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5wcmV2IDwgZW50cnkuZmluYWxseUxvYykge1xuICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlKGVudHJ5LmZpbmFsbHlMb2MpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgfSBlbHNlIGlmIChoYXNDYXRjaCkge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJldiA8IGVudHJ5LmNhdGNoTG9jKSB7XG4gICAgICAgICAgICAgIHJldHVybiBoYW5kbGUoZW50cnkuY2F0Y2hMb2MsIHRydWUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgfSBlbHNlIGlmIChoYXNGaW5hbGx5KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcmV2IDwgZW50cnkuZmluYWxseUxvYykge1xuICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlKGVudHJ5LmZpbmFsbHlMb2MpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInRyeSBzdGF0ZW1lbnQgd2l0aG91dCBjYXRjaCBvciBmaW5hbGx5XCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG5cbiAgICBhYnJ1cHQ6IGZ1bmN0aW9uKHR5cGUsIGFyZykge1xuICAgICAgZm9yICh2YXIgaSA9IHRoaXMudHJ5RW50cmllcy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgICB2YXIgZW50cnkgPSB0aGlzLnRyeUVudHJpZXNbaV07XG4gICAgICAgIGlmIChlbnRyeS50cnlMb2MgPD0gdGhpcy5wcmV2ICYmXG4gICAgICAgICAgICBoYXNPd24uY2FsbChlbnRyeSwgXCJmaW5hbGx5TG9jXCIpICYmXG4gICAgICAgICAgICB0aGlzLnByZXYgPCBlbnRyeS5maW5hbGx5TG9jKSB7XG4gICAgICAgICAgdmFyIGZpbmFsbHlFbnRyeSA9IGVudHJ5O1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChmaW5hbGx5RW50cnkgJiZcbiAgICAgICAgICAodHlwZSA9PT0gXCJicmVha1wiIHx8XG4gICAgICAgICAgIHR5cGUgPT09IFwiY29udGludWVcIikgJiZcbiAgICAgICAgICBmaW5hbGx5RW50cnkudHJ5TG9jIDw9IGFyZyAmJlxuICAgICAgICAgIGFyZyA8PSBmaW5hbGx5RW50cnkuZmluYWxseUxvYykge1xuICAgICAgICAvLyBJZ25vcmUgdGhlIGZpbmFsbHkgZW50cnkgaWYgY29udHJvbCBpcyBub3QganVtcGluZyB0byBhXG4gICAgICAgIC8vIGxvY2F0aW9uIG91dHNpZGUgdGhlIHRyeS9jYXRjaCBibG9jay5cbiAgICAgICAgZmluYWxseUVudHJ5ID0gbnVsbDtcbiAgICAgIH1cblxuICAgICAgdmFyIHJlY29yZCA9IGZpbmFsbHlFbnRyeSA/IGZpbmFsbHlFbnRyeS5jb21wbGV0aW9uIDoge307XG4gICAgICByZWNvcmQudHlwZSA9IHR5cGU7XG4gICAgICByZWNvcmQuYXJnID0gYXJnO1xuXG4gICAgICBpZiAoZmluYWxseUVudHJ5KSB7XG4gICAgICAgIHRoaXMubWV0aG9kID0gXCJuZXh0XCI7XG4gICAgICAgIHRoaXMubmV4dCA9IGZpbmFsbHlFbnRyeS5maW5hbGx5TG9jO1xuICAgICAgICByZXR1cm4gQ29udGludWVTZW50aW5lbDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMuY29tcGxldGUocmVjb3JkKTtcbiAgICB9LFxuXG4gICAgY29tcGxldGU6IGZ1bmN0aW9uKHJlY29yZCwgYWZ0ZXJMb2MpIHtcbiAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgIHRocm93IHJlY29yZC5hcmc7XG4gICAgICB9XG5cbiAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gXCJicmVha1wiIHx8XG4gICAgICAgICAgcmVjb3JkLnR5cGUgPT09IFwiY29udGludWVcIikge1xuICAgICAgICB0aGlzLm5leHQgPSByZWNvcmQuYXJnO1xuICAgICAgfSBlbHNlIGlmIChyZWNvcmQudHlwZSA9PT0gXCJyZXR1cm5cIikge1xuICAgICAgICB0aGlzLnJ2YWwgPSB0aGlzLmFyZyA9IHJlY29yZC5hcmc7XG4gICAgICAgIHRoaXMubWV0aG9kID0gXCJyZXR1cm5cIjtcbiAgICAgICAgdGhpcy5uZXh0ID0gXCJlbmRcIjtcbiAgICAgIH0gZWxzZSBpZiAocmVjb3JkLnR5cGUgPT09IFwibm9ybWFsXCIgJiYgYWZ0ZXJMb2MpIHtcbiAgICAgICAgdGhpcy5uZXh0ID0gYWZ0ZXJMb2M7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgIH0sXG5cbiAgICBmaW5pc2g6IGZ1bmN0aW9uKGZpbmFsbHlMb2MpIHtcbiAgICAgIGZvciAodmFyIGkgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy50cnlFbnRyaWVzW2ldO1xuICAgICAgICBpZiAoZW50cnkuZmluYWxseUxvYyA9PT0gZmluYWxseUxvYykge1xuICAgICAgICAgIHRoaXMuY29tcGxldGUoZW50cnkuY29tcGxldGlvbiwgZW50cnkuYWZ0ZXJMb2MpO1xuICAgICAgICAgIHJlc2V0VHJ5RW50cnkoZW50cnkpO1xuICAgICAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcblxuICAgIFwiY2F0Y2hcIjogZnVuY3Rpb24odHJ5TG9jKSB7XG4gICAgICBmb3IgKHZhciBpID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7XG4gICAgICAgIHZhciBlbnRyeSA9IHRoaXMudHJ5RW50cmllc1tpXTtcbiAgICAgICAgaWYgKGVudHJ5LnRyeUxvYyA9PT0gdHJ5TG9jKSB7XG4gICAgICAgICAgdmFyIHJlY29yZCA9IGVudHJ5LmNvbXBsZXRpb247XG4gICAgICAgICAgaWYgKHJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgICAgICAgIHZhciB0aHJvd24gPSByZWNvcmQuYXJnO1xuICAgICAgICAgICAgcmVzZXRUcnlFbnRyeShlbnRyeSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB0aHJvd247XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gVGhlIGNvbnRleHQuY2F0Y2ggbWV0aG9kIG11c3Qgb25seSBiZSBjYWxsZWQgd2l0aCBhIGxvY2F0aW9uXG4gICAgICAvLyBhcmd1bWVudCB0aGF0IGNvcnJlc3BvbmRzIHRvIGEga25vd24gY2F0Y2ggYmxvY2suXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJpbGxlZ2FsIGNhdGNoIGF0dGVtcHRcIik7XG4gICAgfSxcblxuICAgIGRlbGVnYXRlWWllbGQ6IGZ1bmN0aW9uKGl0ZXJhYmxlLCByZXN1bHROYW1lLCBuZXh0TG9jKSB7XG4gICAgICB0aGlzLmRlbGVnYXRlID0ge1xuICAgICAgICBpdGVyYXRvcjogdmFsdWVzKGl0ZXJhYmxlKSxcbiAgICAgICAgcmVzdWx0TmFtZTogcmVzdWx0TmFtZSxcbiAgICAgICAgbmV4dExvYzogbmV4dExvY1xuICAgICAgfTtcblxuICAgICAgaWYgKHRoaXMubWV0aG9kID09PSBcIm5leHRcIikge1xuICAgICAgICAvLyBEZWxpYmVyYXRlbHkgZm9yZ2V0IHRoZSBsYXN0IHNlbnQgdmFsdWUgc28gdGhhdCB3ZSBkb24ndFxuICAgICAgICAvLyBhY2NpZGVudGFsbHkgcGFzcyBpdCBvbiB0byB0aGUgZGVsZWdhdGUuXG4gICAgICAgIHRoaXMuYXJnID0gdW5kZWZpbmVkO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gQ29udGludWVTZW50aW5lbDtcbiAgICB9XG4gIH07XG5cbiAgLy8gUmVnYXJkbGVzcyBvZiB3aGV0aGVyIHRoaXMgc2NyaXB0IGlzIGV4ZWN1dGluZyBhcyBhIENvbW1vbkpTIG1vZHVsZVxuICAvLyBvciBub3QsIHJldHVybiB0aGUgcnVudGltZSBvYmplY3Qgc28gdGhhdCB3ZSBjYW4gZGVjbGFyZSB0aGUgdmFyaWFibGVcbiAgLy8gcmVnZW5lcmF0b3JSdW50aW1lIGluIHRoZSBvdXRlciBzY29wZSwgd2hpY2ggYWxsb3dzIHRoaXMgbW9kdWxlIHRvIGJlXG4gIC8vIGluamVjdGVkIGVhc2lseSBieSBgYmluL3JlZ2VuZXJhdG9yIC0taW5jbHVkZS1ydW50aW1lIHNjcmlwdC5qc2AuXG4gIHJldHVybiBleHBvcnRzO1xuXG59KFxuICAvLyBJZiB0aGlzIHNjcmlwdCBpcyBleGVjdXRpbmcgYXMgYSBDb21tb25KUyBtb2R1bGUsIHVzZSBtb2R1bGUuZXhwb3J0c1xuICAvLyBhcyB0aGUgcmVnZW5lcmF0b3JSdW50aW1lIG5hbWVzcGFjZS4gT3RoZXJ3aXNlIGNyZWF0ZSBhIG5ldyBlbXB0eVxuICAvLyBvYmplY3QuIEVpdGhlciB3YXksIHRoZSByZXN1bHRpbmcgb2JqZWN0IHdpbGwgYmUgdXNlZCB0byBpbml0aWFsaXplXG4gIC8vIHRoZSByZWdlbmVyYXRvclJ1bnRpbWUgdmFyaWFibGUgYXQgdGhlIHRvcCBvZiB0aGlzIGZpbGUuXG4gIHR5cGVvZiBtb2R1bGUgPT09IFwib2JqZWN0XCIgPyBtb2R1bGUuZXhwb3J0cyA6IHt9XG4pKTtcblxudHJ5IHtcbiAgcmVnZW5lcmF0b3JSdW50aW1lID0gcnVudGltZTtcbn0gY2F0Y2ggKGFjY2lkZW50YWxTdHJpY3RNb2RlKSB7XG4gIC8vIFRoaXMgbW9kdWxlIHNob3VsZCBub3QgYmUgcnVubmluZyBpbiBzdHJpY3QgbW9kZSwgc28gdGhlIGFib3ZlXG4gIC8vIGFzc2lnbm1lbnQgc2hvdWxkIGFsd2F5cyB3b3JrIHVubGVzcyBzb21ldGhpbmcgaXMgbWlzY29uZmlndXJlZC4gSnVzdFxuICAvLyBpbiBjYXNlIHJ1bnRpbWUuanMgYWNjaWRlbnRhbGx5IHJ1bnMgaW4gc3RyaWN0IG1vZGUsIHdlIGNhbiBlc2NhcGVcbiAgLy8gc3RyaWN0IG1vZGUgdXNpbmcgYSBnbG9iYWwgRnVuY3Rpb24gY2FsbC4gVGhpcyBjb3VsZCBjb25jZWl2YWJseSBmYWlsXG4gIC8vIGlmIGEgQ29udGVudCBTZWN1cml0eSBQb2xpY3kgZm9yYmlkcyB1c2luZyBGdW5jdGlvbiwgYnV0IGluIHRoYXQgY2FzZVxuICAvLyB0aGUgcHJvcGVyIHNvbHV0aW9uIGlzIHRvIGZpeCB0aGUgYWNjaWRlbnRhbCBzdHJpY3QgbW9kZSBwcm9ibGVtLiBJZlxuICAvLyB5b3UndmUgbWlzY29uZmlndXJlZCB5b3VyIGJ1bmRsZXIgdG8gZm9yY2Ugc3RyaWN0IG1vZGUgYW5kIGFwcGxpZWQgYVxuICAvLyBDU1AgdG8gZm9yYmlkIEZ1bmN0aW9uLCBhbmQgeW91J3JlIG5vdCB3aWxsaW5nIHRvIGZpeCBlaXRoZXIgb2YgdGhvc2VcbiAgLy8gcHJvYmxlbXMsIHBsZWFzZSBkZXRhaWwgeW91ciB1bmlxdWUgcHJlZGljYW1lbnQgaW4gYSBHaXRIdWIgaXNzdWUuXG4gIEZ1bmN0aW9uKFwiclwiLCBcInJlZ2VuZXJhdG9yUnVudGltZSA9IHJcIikocnVudGltZSk7XG59XG4iLCIvKipcclxuICogQGF1dGhvciBsdGggLyBodHRwczovL2dpdGh1Yi5jb20vbG8tdGhcclxuICovXHJcblxyXG5jb25zdCBUID0ge1xyXG5cclxuICAgIGZyYWc6IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSxcclxuXHJcbiAgICBjb2xvclJpbmc6IG51bGwsXHJcbiAgICBqb3lzdGlja18wOiBudWxsLFxyXG4gICAgam95c3RpY2tfMTogbnVsbCxcclxuICAgIGNpcmN1bGFyOiBudWxsLFxyXG4gICAga25vYjogbnVsbCxcclxuXHJcbiAgICBzdmduczogXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiLFxyXG4gICAgbGlua3M6IFwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1wiLFxyXG4gICAgaHRtbHM6IFwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbFwiLFxyXG5cclxuICAgIERPTV9TSVpFOiBbICdoZWlnaHQnLCAnd2lkdGgnLCAndG9wJywgJ2xlZnQnLCAnYm90dG9tJywgJ3JpZ2h0JywgJ21hcmdpbi1sZWZ0JywgJ21hcmdpbi1yaWdodCcsICdtYXJnaW4tdG9wJywgJ21hcmdpbi1ib3R0b20nXSxcclxuICAgIFNWR19UWVBFX0Q6IFsgJ3BhdHRlcm4nLCAnZGVmcycsICd0cmFuc2Zvcm0nLCAnc3RvcCcsICdhbmltYXRlJywgJ3JhZGlhbEdyYWRpZW50JywgJ2xpbmVhckdyYWRpZW50JywgJ2FuaW1hdGVNb3Rpb24nLCAndXNlJywgJ2ZpbHRlcicsICdmZUNvbG9yTWF0cml4JyBdLFxyXG4gICAgU1ZHX1RZUEVfRzogWyAnc3ZnJywgJ3JlY3QnLCAnY2lyY2xlJywgJ3BhdGgnLCAncG9seWdvbicsICd0ZXh0JywgJ2cnLCAnbGluZScsICdmb3JlaWduT2JqZWN0JyBdLFxyXG5cclxuICAgIFBJOiBNYXRoLlBJLFxyXG4gICAgVHdvUEk6IE1hdGguUEkqMixcclxuICAgIHBpOTA6IE1hdGguUEkgKiAwLjUsXHJcbiAgICBwaTYwOiBNYXRoLlBJLzMsXHJcbiAgICBcclxuICAgIHRvcmFkOiBNYXRoLlBJIC8gMTgwLFxyXG4gICAgdG9kZWc6IDE4MCAvIE1hdGguUEksXHJcblxyXG4gICAgY2xhbXA6IGZ1bmN0aW9uICh2LCBtaW4sIG1heCkge1xyXG5cclxuICAgICAgICB2ID0gdiA8IG1pbiA/IG1pbiA6IHY7XHJcbiAgICAgICAgdiA9IHYgPiBtYXggPyBtYXggOiB2O1xyXG4gICAgICAgIHJldHVybiB2O1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgc2l6ZTogeyAgdzogMjQwLCBoOiAyMCwgcDogMzAsIHM6IDggfSxcclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyAgIENPTE9SXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgY29sb3JzOiB7XHJcblxyXG4gICAgICAgIHRleHQgOiAnI2RjZGNkYycsXHJcbiAgICAgICAgdGV4dE92ZXIgOiAnI0ZGRkZGRicsXHJcbiAgICAgICAgdHh0c2VsZWN0YmcgOiAnbm9uZScsXHJcblxyXG4gICAgICAgIGJhY2tncm91bmQ6ICdyZ2JhKDUwLDUwLDUwLDAuNSknLC8vJ3JnYmEoNDQsNDQsNDQsMC4zKScsXHJcbiAgICAgICAgYmFja2dyb3VuZE92ZXI6ICdyZ2JhKDUwLDUwLDUwLDAuNSknLC8vJ3JnYmEoMTEsMTEsMTEsMC41KScsXHJcblxyXG4gICAgICAgIC8vaW5wdXQ6ICcjMDA1QUFBJyxcclxuXHJcbiAgICAgICAgaW5wdXRCb3JkZXI6ICcjNDU0NTQ1JyxcclxuICAgICAgICBpbnB1dEhvbGRlcjogJyM4MDgwODAnLFxyXG4gICAgICAgIGlucHV0Qm9yZGVyU2VsZWN0OiAnIzAwNUFBQScsXHJcbiAgICAgICAgaW5wdXRCZzogJ3JnYmEoMCwwLDAsMC4xKScsXHJcbiAgICAgICAgaW5wdXRPdmVyOiAncmdiYSgwLDAsMCwwLjIpJyxcclxuXHJcbiAgICAgICAgLy8gaW5wdXQgYm9yZGVyXHJcbiAgICAgICAgYm9yZGVyIDogJyM0NTQ1NDUnLFxyXG4gICAgICAgIGJvcmRlck92ZXIgOiAnIzUwNTBBQScsXHJcbiAgICAgICAgYm9yZGVyU2VsZWN0IDogJyMzMDhBRkYnLFxyXG5cclxuICAgICAgICBidXR0b24gOiAnIzNjM2MzYycsIC8vJyM0MDQwNDAnLFxyXG4gICAgICAgIGJvb2xiZyA6ICcjMTgxODE4JyxcclxuICAgICAgICBib29sb24gOiAnI0MwQzBDMCcsXHJcblxyXG4gICAgICAgIHNlbGVjdCA6ICcjMzA4QUZGJyxcclxuICAgICAgICBtb3ZpbmcgOiAnIzAzYWZmZicsXHJcbiAgICAgICAgZG93biA6ICcjMDI0Njk5JyxcclxuICAgICAgICBvdmVyIDogJyMwMjQ2OTknLFxyXG4gICAgICAgIGFjdGlvbjogJyNGRjMzMDAnLFxyXG5cclxuICAgICAgICBzdHJva2U6ICdyZ2JhKDExLDExLDExLDAuNSknLFxyXG5cclxuICAgICAgICBzY3JvbGw6ICcjMzMzMzMzJyxcclxuICAgICAgICBzY3JvbGxiYWNrOidyZ2JhKDQ0LDQ0LDQ0LDAuMiknLFxyXG4gICAgICAgIHNjcm9sbGJhY2tvdmVyOidyZ2JhKDQ0LDQ0LDQ0LDAuMiknLFxyXG5cclxuICAgICAgICBoaWRlOiAncmdiYSgwLDAsMCwwKScsXHJcblxyXG4gICAgICAgIGdyb3VwQm9yZGVyOiAnIzNlM2UzZScsIC8vJ25vbmUnLFxyXG4gICAgICAgIGJ1dHRvbkJvcmRlcjogJyM0YTRhNGEnLC8vJ25vbmUnLFxyXG5cclxuICAgICAgICBmb250RmFtaWx5OiAnVGFob21hJyxcclxuICAgICAgICBmb250U2hhZG93OiAnbm9uZScsXHJcbiAgICAgICAgZm9udFNpemU6MTEsXHJcblxyXG4gICAgICAgIHJhZGl1czo0LFxyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy8gc3R5bGUgY3NzXHJcblxyXG4gICAgY3NzIDoge1xyXG4gICAgICAgIC8vdW5zZWxlY3Q6ICctby11c2VyLXNlbGVjdDpub25lOyAtbXMtdXNlci1zZWxlY3Q6bm9uZTsgLWtodG1sLXVzZXItc2VsZWN0Om5vbmU7IC13ZWJraXQtdXNlci1zZWxlY3Q6bm9uZTsgLW1vei11c2VyLXNlbGVjdDpub25lOycsIFxyXG4gICAgICAgIGJhc2ljOiAncG9zaXRpb246YWJzb2x1dGU7IHBvaW50ZXItZXZlbnRzOm5vbmU7IGJveC1zaXppbmc6Ym9yZGVyLWJveDsgbWFyZ2luOjA7IHBhZGRpbmc6MDsgb3ZlcmZsb3c6aGlkZGVuOyAnICsgJy1vLXVzZXItc2VsZWN0Om5vbmU7IC1tcy11c2VyLXNlbGVjdDpub25lOyAta2h0bWwtdXNlci1zZWxlY3Q6bm9uZTsgLXdlYmtpdC11c2VyLXNlbGVjdDpub25lOyAtbW96LXVzZXItc2VsZWN0Om5vbmU7JyxcclxuICAgICAgICBidXR0b246J2Rpc3BsYXk6ZmxleDsganVzdGlmeS1jb250ZW50OmNlbnRlcjsgYWxpZ24taXRlbXM6Y2VudGVyOyB0ZXh0LWFsaWduOmNlbnRlcjsnLFxyXG5cclxuICAgICAgICAvKnR4dDogVC5jc3MuYmFzaWMgKyAnZm9udC1mYW1pbHk6JysgVC5jb2xvcnMuZm9udEZhbWlseSArJzsgZm9udC1zaXplOicrVC5jb2xvcnMuZm9udFNpemUrJ3B4OyBjb2xvcjonK1QuY29sb3JzLnRleHQrJzsgcGFkZGluZzoycHggMTBweDsgbGVmdDowOyB0b3A6MnB4OyBoZWlnaHQ6MTZweDsgd2lkdGg6MTAwcHg7IG92ZXJmbG93OmhpZGRlbjsgd2hpdGUtc3BhY2U6IG5vd3JhcDsnLFxyXG4gICAgICAgIHR4dHNlbGVjdDogIFQuY3NzLnR4dCArICdkaXNwbGF5OmZsZXg7IGp1c3RpZnktY29udGVudDpsZWZ0OyBhbGlnbi1pdGVtczpjZW50ZXI7IHRleHQtYWxpZ246bGVmdDsnICsncGFkZGluZzoycHggNXB4OyBib3JkZXI6MXB4IGRhc2hlZCAnICsgVC5jb2xvcnMuYm9yZGVyICsgJzsgYmFja2dyb3VuZDonKyBULmNvbG9ycy50eHRzZWxlY3RiZysnOycsXHJcbiAgICAgICAgaXRlbTogVC5jc3MudHh0ICsgJ3Bvc2l0aW9uOnJlbGF0aXZlOyBiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsMC4yKTsgbWFyZ2luLWJvdHRvbToxcHg7JywqL1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyBzdmcgcGF0aFxyXG5cclxuICAgIHN2Z3M6IHtcclxuXHJcbiAgICAgICAgZ3JvdXA6J00gNyA3IEwgNyA4IDggOCA4IDcgNyA3IE0gNSA3IEwgNSA4IDYgOCA2IDcgNSA3IE0gMyA3IEwgMyA4IDQgOCA0IDcgMyA3IE0gNyA1IEwgNyA2IDggNiA4IDUgNyA1IE0gNiA2IEwgNiA1IDUgNSA1IDYgNiA2IE0gNyAzIEwgNyA0IDggNCA4IDMgNyAzIE0gNiA0IEwgNiAzIDUgMyA1IDQgNiA0IE0gMyA1IEwgMyA2IDQgNiA0IDUgMyA1IE0gMyAzIEwgMyA0IDQgNCA0IDMgMyAzIFonLFxyXG4gICAgICAgIGFycm93OidNIDMgOCBMIDggNSAzIDIgMyA4IFonLFxyXG4gICAgICAgIGFycm93RG93bjonTSA1IDggTCA4IDMgMiAzIDUgOCBaJyxcclxuICAgICAgICBhcnJvd1VwOidNIDUgMiBMIDIgNyA4IDcgNSAyIFonLFxyXG5cclxuICAgICAgICBzb2xpZDonTSAxMyAxMCBMIDEzIDEgNCAxIDEgNCAxIDEzIDEwIDEzIDEzIDEwIE0gMTEgMyBMIDExIDkgOSAxMSAzIDExIDMgNSA1IDMgMTEgMyBaJyxcclxuICAgICAgICBib2R5OidNIDEzIDEwIEwgMTMgMSA0IDEgMSA0IDEgMTMgMTAgMTMgMTMgMTAgTSAxMSAzIEwgMTEgOSA5IDExIDMgMTEgMyA1IDUgMyAxMSAzIE0gNSA0IEwgNCA1IDQgMTAgOSAxMCAxMCA5IDEwIDQgNSA0IFonLFxyXG4gICAgICAgIHZlaGljbGU6J00gMTMgNiBMIDExIDEgMyAxIDEgNiAxIDEzIDMgMTMgMyAxMSAxMSAxMSAxMSAxMyAxMyAxMyAxMyA2IE0gMi40IDYgTCA0IDIgMTAgMiAxMS42IDYgMi40IDYgTSAxMiA4IEwgMTIgMTAgMTAgMTAgMTAgOCAxMiA4IE0gNCA4IEwgNCAxMCAyIDEwIDIgOCA0IDggWicsXHJcbiAgICAgICAgYXJ0aWN1bGF0aW9uOidNIDEzIDkgTCAxMiA5IDkgMiA5IDEgNSAxIDUgMiAyIDkgMSA5IDEgMTMgNSAxMyA1IDkgNCA5IDYgNSA4IDUgMTAgOSA5IDkgOSAxMyAxMyAxMyAxMyA5IFonLFxyXG4gICAgICAgIGNoYXJhY3RlcjonTSAxMyA0IEwgMTIgMyA5IDQgNSA0IDIgMyAxIDQgNSA2IDUgOCA0IDEzIDYgMTMgNyA5IDggMTMgMTAgMTMgOSA4IDkgNiAxMyA0IE0gNiAxIEwgNiAzIDggMyA4IDEgNiAxIFonLFxyXG4gICAgICAgIHRlcnJhaW46J00gMTMgOCBMIDEyIDcgUSA5LjA2IC0zLjY3IDUuOTUgNC44NSA0LjA0IDMuMjcgMiA3IEwgMSA4IDcgMTMgMTMgOCBNIDMgOCBRIDMuNzggNS40MjAgNS40IDYuNiA1LjIwIDcuMjUgNSA4IEwgNyA4IFEgOC4zOSAtMC4xNiAxMSA4IEwgNyAxMSAzIDggWicsXHJcbiAgICAgICAgam9pbnQ6J00gNy43IDcuNyBRIDggNy40NSA4IDcgOCA2LjYgNy43IDYuMyA3LjQ1IDYgNyA2IDYuNiA2IDYuMyA2LjMgNiA2LjYgNiA3IDYgNy40NSA2LjMgNy43IDYuNiA4IDcgOCA3LjQ1IDggNy43IDcuNyBNIDMuMzUgOC42NSBMIDEgMTEgMyAxMyA1LjM1IDEwLjY1IFEgNi4xIDExIDcgMTEgOC4yOCAxMSA5LjI1IDEwLjI1IEwgNy44IDguOCBRIDcuNDUgOSA3IDkgNi4xNSA5IDUuNTUgOC40IDUgNy44NSA1IDcgNSA2LjU0IDUuMTUgNi4xNSBMIDMuNyA0LjcgUSAzIDUuNzEyIDMgNyAzIDcuOSAzLjM1IDguNjUgTSAxMC4yNSA5LjI1IFEgMTEgOC4yOCAxMSA3IDExIDYuMSAxMC42NSA1LjM1IEwgMTMgMyAxMSAxIDguNjUgMy4zNSBRIDcuOSAzIDcgMyA1LjcgMyA0LjcgMy43IEwgNi4xNSA1LjE1IFEgNi41NCA1IDcgNSA3Ljg1IDUgOC40IDUuNTUgOSA2LjE1IDkgNyA5IDcuNDUgOC44IDcuOCBMIDEwLjI1IDkuMjUgWicsXHJcbiAgICAgICAgcmF5OidNIDkgMTEgTCA1IDExIDUgMTIgOSAxMiA5IDExIE0gMTIgNSBMIDExIDUgMTEgOSAxMiA5IDEyIDUgTSAxMS41IDEwIFEgMTAuOSAxMCAxMC40NSAxMC40NSAxMCAxMC45IDEwIDExLjUgMTAgMTIuMiAxMC40NSAxMi41NSAxMC45IDEzIDExLjUgMTMgMTIuMiAxMyAxMi41NSAxMi41NSAxMyAxMi4yIDEzIDExLjUgMTMgMTAuOSAxMi41NSAxMC40NSAxMi4yIDEwIDExLjUgMTAgTSA5IDEwIEwgMTAgOSAyIDEgMSAyIDkgMTAgWicsXHJcbiAgICAgICAgY29sbGlzaW9uOidNIDExIDEyIEwgMTMgMTAgMTAgNyAxMyA0IDExIDIgNy41IDUuNSA5IDcgNy41IDguNSAxMSAxMiBNIDMgMiBMIDEgNCA0IDcgMSAxMCAzIDEyIDggNyAzIDIgWicsXHJcbiAgICAgICAgbWFwOidNIDEzIDEgTCAxIDEgMSAxMyAxMyAxMyAxMyAxIE0gMTIgMiBMIDEyIDcgNyA3IDcgMTIgMiAxMiAyIDcgNyA3IDcgMiAxMiAyIFonLFxyXG4gICAgICAgIG1hdGVyaWFsOidNIDEzIDEgTCAxIDEgMSAxMyAxMyAxMyAxMyAxIE0gMTIgMiBMIDEyIDcgNyA3IDcgMTIgMiAxMiAyIDcgNyA3IDcgMiAxMiAyIFonLFxyXG4gICAgICAgIHRleHR1cmU6J00gMTMgNCBMIDEzIDEgMSAxIDEgNCA1IDQgNSAxMyA5IDEzIDkgNCAxMyA0IFonLFxyXG4gICAgICAgIG9iamVjdDonTSAxMCAxIEwgNyA0IDQgMSAxIDEgMSAxMyA0IDEzIDQgNSA3IDggMTAgNSAxMCAxMyAxMyAxMyAxMyAxIDEwIDEgWicsXHJcbiAgICAgICAgbm9uZTonTSA5IDUgTCA1IDUgNSA5IDkgOSA5IDUgWicsXHJcbiAgICAgICAgY3Vyc29yOidNIDQgNyBMIDEgMTAgMSAxMiAyIDEzIDQgMTMgNyAxMCA5IDE0IDE0IDAgMCA1IDQgNyBaJyxcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHNldFN0eWxlIDogZnVuY3Rpb24gKCBkYXRhICl7XHJcblxyXG4gICAgICAgIGZvciAoIHZhciBvIGluIGRhdGEgKXtcclxuICAgICAgICAgICAgaWYoIFQuY29sb3JzW29dICkgVC5jb2xvcnNbb10gPSBkYXRhW29dO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgVC5zZXRUZXh0KCk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBjdXN0b20gdGV4dFxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIHNldFRleHQgOiBmdW5jdGlvbiggc2l6ZSwgY29sb3IsIGZvbnQsIHNoYWRvdyApe1xyXG5cclxuICAgICAgICBsZXQgYyA9IFQuY29sb3JzO1xyXG5cclxuICAgICAgICBpZiggZm9udCAhPT0gdW5kZWZpbmVkICkgYy5mb250RmFtaWx5ID0gZm9udDtcclxuICAgICAgICBpZiggY29sb3IgIT09IHVuZGVmaW5lZCApIGMudGV4dCA9IGNvbG9yO1xyXG4gICAgICAgIGlmKCBzaXplICE9PSB1bmRlZmluZWQgKSBjLmZvbnRTaXplID0gc2l6ZTtcclxuXHJcbiAgICAgICAgVC5jc3MudHh0ID0gVC5jc3MuYmFzaWMgKyAnZm9udC1mYW1pbHk6JysgYy5mb250RmFtaWx5ICsnOyBmb250LXNpemU6JytjLmZvbnRTaXplKydweDsgY29sb3I6JytjLnRleHQrJzsgcGFkZGluZzoycHggMTBweDsgbGVmdDowOyB0b3A6MnB4OyBoZWlnaHQ6MTZweDsgd2lkdGg6MTAwcHg7IG92ZXJmbG93OmhpZGRlbjsgd2hpdGUtc3BhY2U6IG5vd3JhcDsnO1xyXG4gICAgICAgIGlmKCBzaGFkb3cgIT09IHVuZGVmaW5lZCApIFQuY3NzLnR4dCArPSAnIHRleHQtc2hhZG93OicrIHNoYWRvdyArICc7ICc7IC8vXCIxcHggMXB4IDFweCAjZmYwMDAwXCI7XHJcbiAgICAgICAgaWYoIGMuZm9udFNoYWRvdyAhPT0gJ25vbmUnICkgVC5jc3MudHh0ICs9ICcgdGV4dC1zaGFkb3c6IDFweCAxcHggMXB4ICcrYy5mb250U2hhZG93Kyc7JztcclxuICAgICAgICBULmNzcy50eHRzZWxlY3QgPSBULmNzcy50eHQgKyAnZGlzcGxheTpmbGV4OyBqdXN0aWZ5LWNvbnRlbnQ6bGVmdDsgYWxpZ24taXRlbXM6Y2VudGVyOyB0ZXh0LWFsaWduOmxlZnQ7JyArJ3BhZGRpbmc6MnB4IDVweDsgYm9yZGVyOjFweCBkYXNoZWQgJyArIGMuYm9yZGVyICsgJzsgYmFja2dyb3VuZDonKyBjLnR4dHNlbGVjdGJnKyc7JztcclxuICAgICAgICBULmNzcy5pdGVtID0gVC5jc3MudHh0ICsgJ3Bvc2l0aW9uOnJlbGF0aXZlOyBiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsMC4yKTsgbWFyZ2luLWJvdHRvbToxcHg7JztcclxuXHJcbiAgICB9LFxyXG5cclxuXHJcbiAgICAvLyBpbnRlcm4gZnVuY3Rpb25cclxuXHJcbiAgICBjbG9uZUNvbG9yOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIGxldCBjYyA9IE9iamVjdC5hc3NpZ24oe30sIFQuY29sb3JzICk7XHJcbiAgICAgICAgcmV0dXJuIGNjO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgY2xvbmVDc3M6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgbGV0IGNjID0gT2JqZWN0LmFzc2lnbih7fSwgVC5jc3MgKTtcclxuICAgICAgICByZXR1cm4gY2M7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBjbG9uZTogZnVuY3Rpb24gKCBvICkge1xyXG5cclxuICAgICAgICByZXR1cm4gby5jbG9uZU5vZGUoIHRydWUgKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHNldFN2ZzogZnVuY3Rpb24oIGRvbSwgdHlwZSwgdmFsdWUsIGlkLCBpZDIgKXtcclxuXHJcbiAgICAgICAgaWYoIGlkID09PSAtMSApIGRvbS5zZXRBdHRyaWJ1dGVOUyggbnVsbCwgdHlwZSwgdmFsdWUgKTtcclxuICAgICAgICBlbHNlIGlmKCBpZDIgIT09IHVuZGVmaW5lZCApIGRvbS5jaGlsZE5vZGVzWyBpZCB8fCAwIF0uY2hpbGROb2Rlc1sgaWQyIHx8IDAgXS5zZXRBdHRyaWJ1dGVOUyggbnVsbCwgdHlwZSwgdmFsdWUgKTtcclxuICAgICAgICBlbHNlIGRvbS5jaGlsZE5vZGVzWyBpZCB8fCAwIF0uc2V0QXR0cmlidXRlTlMoIG51bGwsIHR5cGUsIHZhbHVlICk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBzZXRDc3M6IGZ1bmN0aW9uKCBkb20sIGNzcyApe1xyXG5cclxuICAgICAgICBmb3IoIGxldCByIGluIGNzcyApe1xyXG4gICAgICAgICAgICBpZiggVC5ET01fU0laRS5pbmRleE9mKHIpICE9PSAtMSApIGRvbS5zdHlsZVtyXSA9IGNzc1tyXSArICdweCc7XHJcbiAgICAgICAgICAgIGVsc2UgZG9tLnN0eWxlW3JdID0gY3NzW3JdO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHNldDogZnVuY3Rpb24oIGcsIG8gKXtcclxuXHJcbiAgICAgICAgZm9yKCBsZXQgYXR0IGluIG8gKXtcclxuICAgICAgICAgICAgaWYoIGF0dCA9PT0gJ3R4dCcgKSBnLnRleHRDb250ZW50ID0gb1sgYXR0IF07XHJcbiAgICAgICAgICAgIGlmKCBhdHQgPT09ICdsaW5rJyApIGcuc2V0QXR0cmlidXRlTlMoIFQubGlua3MsICd4bGluazpocmVmJywgb1sgYXR0IF0gKTtcclxuICAgICAgICAgICAgZWxzZSBnLnNldEF0dHJpYnV0ZU5TKCBudWxsLCBhdHQsIG9bIGF0dCBdICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgfSxcclxuXHJcbiAgICBnZXQ6IGZ1bmN0aW9uKCBkb20sIGlkICl7XHJcblxyXG4gICAgICAgIGlmKCBpZCA9PT0gdW5kZWZpbmVkICkgcmV0dXJuIGRvbTsgLy8gcm9vdFxyXG4gICAgICAgIGVsc2UgaWYoICFpc05hTiggaWQgKSApIHJldHVybiBkb20uY2hpbGROb2Rlc1sgaWQgXTsgLy8gZmlyc3QgY2hpbGRcclxuICAgICAgICBlbHNlIGlmKCBpZCBpbnN0YW5jZW9mIEFycmF5ICl7XHJcbiAgICAgICAgICAgIGlmKGlkLmxlbmd0aCA9PT0gMikgcmV0dXJuIGRvbS5jaGlsZE5vZGVzWyBpZFswXSBdLmNoaWxkTm9kZXNbIGlkWzFdIF07XHJcbiAgICAgICAgICAgIGlmKGlkLmxlbmd0aCA9PT0gMykgcmV0dXJuIGRvbS5jaGlsZE5vZGVzWyBpZFswXSBdLmNoaWxkTm9kZXNbIGlkWzFdIF0uY2hpbGROb2Rlc1sgaWRbMl0gXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBkb20gOiBmdW5jdGlvbiAoIHR5cGUsIGNzcywgb2JqLCBkb20sIGlkICkge1xyXG5cclxuICAgICAgICB0eXBlID0gdHlwZSB8fCAnZGl2JztcclxuXHJcbiAgICAgICAgaWYoIFQuU1ZHX1RZUEVfRC5pbmRleE9mKHR5cGUpICE9PSAtMSB8fCBULlNWR19UWVBFX0cuaW5kZXhPZih0eXBlKSAhPT0gLTEgKXsgLy8gaXMgc3ZnIGVsZW1lbnRcclxuXHJcbiAgICAgICAgICAgIGlmKCB0eXBlID09PSdzdmcnICl7XHJcblxyXG4gICAgICAgICAgICAgICAgZG9tID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCBULnN2Z25zLCAnc3ZnJyApO1xyXG4gICAgICAgICAgICAgICAgVC5zZXQoIGRvbSwgb2JqICk7XHJcblxyXG4gICAgICAgICAgLyogIH0gZWxzZSBpZiAoIHR5cGUgPT09ICd1c2UnICkge1xyXG5cclxuICAgICAgICAgICAgICAgIGRvbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyggVC5zdmducywgJ3VzZScgKTtcclxuICAgICAgICAgICAgICAgIFQuc2V0KCBkb20sIG9iaiApO1xyXG4qL1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gY3JlYXRlIG5ldyBzdmcgaWYgbm90IGRlZlxyXG4gICAgICAgICAgICAgICAgaWYoIGRvbSA9PT0gdW5kZWZpbmVkICkgZG9tID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCBULnN2Z25zLCAnc3ZnJyApO1xyXG4gICAgICAgICAgICAgICAgVC5hZGRBdHRyaWJ1dGVzKCBkb20sIHR5cGUsIG9iaiwgaWQgKTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfSBlbHNlIHsgLy8gaXMgaHRtbCBlbGVtZW50XHJcblxyXG4gICAgICAgICAgICBpZiggZG9tID09PSB1bmRlZmluZWQgKSBkb20gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoIFQuaHRtbHMsIHR5cGUgKTtcclxuICAgICAgICAgICAgZWxzZSBkb20gPSBkb20uYXBwZW5kQ2hpbGQoIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyggVC5odG1scywgdHlwZSApICk7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoIGNzcyApIGRvbS5zdHlsZS5jc3NUZXh0ID0gY3NzOyBcclxuXHJcbiAgICAgICAgaWYoIGlkID09PSB1bmRlZmluZWQgKSByZXR1cm4gZG9tO1xyXG4gICAgICAgIGVsc2UgcmV0dXJuIGRvbS5jaGlsZE5vZGVzWyBpZCB8fCAwIF07XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBhZGRBdHRyaWJ1dGVzIDogZnVuY3Rpb24oIGRvbSwgdHlwZSwgbywgaWQgKXtcclxuXHJcbiAgICAgICAgbGV0IGcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoIFQuc3ZnbnMsIHR5cGUgKTtcclxuICAgICAgICBULnNldCggZywgbyApO1xyXG4gICAgICAgIFQuZ2V0KCBkb20sIGlkICkuYXBwZW5kQ2hpbGQoIGcgKTtcclxuICAgICAgICBpZiggVC5TVkdfVFlQRV9HLmluZGV4T2YodHlwZSkgIT09IC0xICkgZy5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ25vbmUnO1xyXG4gICAgICAgIHJldHVybiBnO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgY2xlYXIgOiBmdW5jdGlvbiggZG9tICl7XHJcblxyXG4gICAgICAgIFQucHVyZ2UoIGRvbSApO1xyXG4gICAgICAgIHdoaWxlIChkb20uZmlyc3RDaGlsZCkge1xyXG4gICAgICAgICAgICBpZiAoIGRvbS5maXJzdENoaWxkLmZpcnN0Q2hpbGQgKSBULmNsZWFyKCBkb20uZmlyc3RDaGlsZCApO1xyXG4gICAgICAgICAgICBkb20ucmVtb3ZlQ2hpbGQoIGRvbS5maXJzdENoaWxkICk7IFxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHB1cmdlIDogZnVuY3Rpb24gKCBkb20gKSB7XHJcblxyXG4gICAgICAgIGxldCBhID0gZG9tLmF0dHJpYnV0ZXMsIGksIG47XHJcbiAgICAgICAgaWYgKGEpIHtcclxuICAgICAgICAgICAgaSA9IGEubGVuZ3RoO1xyXG4gICAgICAgICAgICB3aGlsZShpLS0pe1xyXG4gICAgICAgICAgICAgICAgbiA9IGFbaV0ubmFtZTtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZG9tW25dID09PSAnZnVuY3Rpb24nKSBkb21bbl0gPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGEgPSBkb20uY2hpbGROb2RlcztcclxuICAgICAgICBpZiAoYSkge1xyXG4gICAgICAgICAgICBpID0gYS5sZW5ndGg7XHJcbiAgICAgICAgICAgIHdoaWxlKGktLSl7IFxyXG4gICAgICAgICAgICAgICAgVC5wdXJnZSggZG9tLmNoaWxkTm9kZXNbaV0gKTsgXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyAgIENvbG9yIGZ1bmN0aW9uXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgQ29sb3JMdW1hIDogZnVuY3Rpb24gKCBoZXgsIGwgKSB7XHJcblxyXG4gICAgICAgIGlmKCBoZXggPT09ICduJyApIGhleCA9ICcjMDAwJztcclxuXHJcbiAgICAgICAgLy8gdmFsaWRhdGUgaGV4IHN0cmluZ1xyXG4gICAgICAgIGhleCA9IFN0cmluZyhoZXgpLnJlcGxhY2UoL1teMC05YS1mXS9naSwgJycpO1xyXG4gICAgICAgIGlmIChoZXgubGVuZ3RoIDwgNikge1xyXG4gICAgICAgICAgICBoZXggPSBoZXhbMF0raGV4WzBdK2hleFsxXStoZXhbMV0raGV4WzJdK2hleFsyXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbCA9IGwgfHwgMDtcclxuXHJcbiAgICAgICAgLy8gY29udmVydCB0byBkZWNpbWFsIGFuZCBjaGFuZ2UgbHVtaW5vc2l0eVxyXG4gICAgICAgIGxldCByZ2IgPSBcIiNcIiwgYywgaTtcclxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgMzsgaSsrKSB7XHJcbiAgICAgICAgICAgIGMgPSBwYXJzZUludChoZXguc3Vic3RyKGkqMiwyKSwgMTYpO1xyXG4gICAgICAgICAgICBjID0gTWF0aC5yb3VuZChNYXRoLm1pbihNYXRoLm1heCgwLCBjICsgKGMgKiBsKSksIDI1NSkpLnRvU3RyaW5nKDE2KTtcclxuICAgICAgICAgICAgcmdiICs9IChcIjAwXCIrYykuc3Vic3RyKGMubGVuZ3RoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiByZ2I7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBmaW5kRGVlcEludmVyOiBmdW5jdGlvbiAoIGMgKSB7IFxyXG5cclxuICAgICAgICByZXR1cm4gKGNbMF0gKiAwLjMgKyBjWzFdICogLjU5ICsgY1syXSAqIC4xMSkgPD0gMC42O1xyXG4gICAgICAgIFxyXG4gICAgfSxcclxuXHJcblxyXG4gICAgaGV4VG9IdG1sOiBmdW5jdGlvbiAoIHYgKSB7IFxyXG4gICAgICAgIHYgPSB2ID09PSB1bmRlZmluZWQgPyAweDAwMDAwMCA6IHY7XHJcbiAgICAgICAgcmV0dXJuIFwiI1wiICsgKFwiMDAwMDAwXCIgKyB2LnRvU3RyaW5nKDE2KSkuc3Vic3RyKC02KTtcclxuICAgICAgICBcclxuICAgIH0sXHJcblxyXG4gICAgaHRtbFRvSGV4OiBmdW5jdGlvbiAoIHYgKSB7IFxyXG5cclxuICAgICAgICByZXR1cm4gdi50b1VwcGVyQ2FzZSgpLnJlcGxhY2UoXCIjXCIsIFwiMHhcIik7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICB1MjU1OiBmdW5jdGlvbiAoYywgaSkge1xyXG5cclxuICAgICAgICByZXR1cm4gcGFyc2VJbnQoYy5zdWJzdHJpbmcoaSwgaSArIDIpLCAxNikgLyAyNTU7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICB1MTY6IGZ1bmN0aW9uICggYywgaSApIHtcclxuXHJcbiAgICAgICAgcmV0dXJuIHBhcnNlSW50KGMuc3Vic3RyaW5nKGksIGkgKyAxKSwgMTYpIC8gMTU7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICB1bnBhY2s6IGZ1bmN0aW9uKCBjICl7XHJcblxyXG4gICAgICAgIGlmIChjLmxlbmd0aCA9PSA3KSByZXR1cm4gWyBULnUyNTUoYywgMSksIFQudTI1NShjLCAzKSwgVC51MjU1KGMsIDUpIF07XHJcbiAgICAgICAgZWxzZSBpZiAoYy5sZW5ndGggPT0gNCkgcmV0dXJuIFsgVC51MTYoYywxKSwgVC51MTYoYywyKSwgVC51MTYoYywzKSBdO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgaHRtbFJnYjogZnVuY3Rpb24oIGMgKXtcclxuXHJcbiAgICAgICAgcmV0dXJuICdyZ2IoJyArIE1hdGgucm91bmQoY1swXSAqIDI1NSkgKyAnLCcrIE1hdGgucm91bmQoY1sxXSAqIDI1NSkgKyAnLCcrIE1hdGgucm91bmQoY1syXSAqIDI1NSkgKyAnKSc7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBwYWQ6IGZ1bmN0aW9uKCBuICl7XHJcbiAgICAgICAgaWYobi5sZW5ndGggPT0gMSluID0gJzAnICsgbjtcclxuICAgICAgICByZXR1cm4gbjtcclxuICAgIH0sXHJcblxyXG4gICAgcmdiVG9IZXggOiBmdW5jdGlvbiggYyApe1xyXG5cclxuICAgICAgICBsZXQgciA9IE1hdGgucm91bmQoY1swXSAqIDI1NSkudG9TdHJpbmcoMTYpO1xyXG4gICAgICAgIGxldCBnID0gTWF0aC5yb3VuZChjWzFdICogMjU1KS50b1N0cmluZygxNik7XHJcbiAgICAgICAgbGV0IGIgPSBNYXRoLnJvdW5kKGNbMl0gKiAyNTUpLnRvU3RyaW5nKDE2KTtcclxuICAgICAgICByZXR1cm4gJyMnICsgVC5wYWQocikgKyBULnBhZChnKSArIFQucGFkKGIpO1xyXG5cclxuICAgICAgIC8vIHJldHVybiAnIycgKyAoICcwMDAwMDAnICsgKCAoIGNbMF0gKiAyNTUgKSA8PCAxNiBeICggY1sxXSAqIDI1NSApIDw8IDggXiAoIGNbMl0gKiAyNTUgKSA8PCAwICkudG9TdHJpbmcoIDE2ICkgKS5zbGljZSggLSA2ICk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBodWVUb1JnYjogZnVuY3Rpb24oIHAsIHEsIHQgKXtcclxuXHJcbiAgICAgICAgaWYgKCB0IDwgMCApIHQgKz0gMTtcclxuICAgICAgICBpZiAoIHQgPiAxICkgdCAtPSAxO1xyXG4gICAgICAgIGlmICggdCA8IDEgLyA2ICkgcmV0dXJuIHAgKyAoIHEgLSBwICkgKiA2ICogdDtcclxuICAgICAgICBpZiAoIHQgPCAxIC8gMiApIHJldHVybiBxO1xyXG4gICAgICAgIGlmICggdCA8IDIgLyAzICkgcmV0dXJuIHAgKyAoIHEgLSBwICkgKiA2ICogKCAyIC8gMyAtIHQgKTtcclxuICAgICAgICByZXR1cm4gcDtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHJnYlRvSHNsOiBmdW5jdGlvbiAoIGMgKSB7XHJcblxyXG4gICAgICAgIGxldCByID0gY1swXSwgZyA9IGNbMV0sIGIgPSBjWzJdLCBtaW4gPSBNYXRoLm1pbihyLCBnLCBiKSwgbWF4ID0gTWF0aC5tYXgociwgZywgYiksIGRlbHRhID0gbWF4IC0gbWluLCBoID0gMCwgcyA9IDAsIGwgPSAobWluICsgbWF4KSAvIDI7XHJcbiAgICAgICAgaWYgKGwgPiAwICYmIGwgPCAxKSBzID0gZGVsdGEgLyAobCA8IDAuNSA/ICgyICogbCkgOiAoMiAtIDIgKiBsKSk7XHJcbiAgICAgICAgaWYgKGRlbHRhID4gMCkge1xyXG4gICAgICAgICAgICBpZiAobWF4ID09IHIgJiYgbWF4ICE9IGcpIGggKz0gKGcgLSBiKSAvIGRlbHRhO1xyXG4gICAgICAgICAgICBpZiAobWF4ID09IGcgJiYgbWF4ICE9IGIpIGggKz0gKDIgKyAoYiAtIHIpIC8gZGVsdGEpO1xyXG4gICAgICAgICAgICBpZiAobWF4ID09IGIgJiYgbWF4ICE9IHIpIGggKz0gKDQgKyAociAtIGcpIC8gZGVsdGEpO1xyXG4gICAgICAgICAgICBoIC89IDY7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBbIGgsIHMsIGwgXTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGhzbFRvUmdiOiBmdW5jdGlvbiAoIGMgKSB7XHJcblxyXG4gICAgICAgIGxldCBwLCBxLCBoID0gY1swXSwgcyA9IGNbMV0sIGwgPSBjWzJdO1xyXG5cclxuICAgICAgICBpZiAoIHMgPT09IDAgKSByZXR1cm4gWyBsLCBsLCBsIF07XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHEgPSBsIDw9IDAuNSA/IGwgKiAocyArIDEpIDogbCArIHMgLSAoIGwgKiBzICk7XHJcbiAgICAgICAgICAgIHAgPSBsICogMiAtIHE7XHJcbiAgICAgICAgICAgIHJldHVybiBbIFQuaHVlVG9SZ2IocCwgcSwgaCArIDAuMzMzMzMpLCBULmh1ZVRvUmdiKHAsIHEsIGgpLCBULmh1ZVRvUmdiKHAsIHEsIGggLSAwLjMzMzMzKSBdO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vICAgU1ZHIE1PREVMXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgbWFrZUdyYWRpYW50OiBmdW5jdGlvbiAoIHR5cGUsIHNldHRpbmdzLCBwYXJlbnQsIGNvbG9ycyApIHtcclxuXHJcbiAgICAgICAgVC5kb20oIHR5cGUsIG51bGwsIHNldHRpbmdzLCBwYXJlbnQsIDAgKTtcclxuXHJcbiAgICAgICAgbGV0IG4gPSBwYXJlbnQuY2hpbGROb2Rlc1swXS5jaGlsZE5vZGVzLmxlbmd0aCAtIDEsIGM7XHJcblxyXG4gICAgICAgIGZvciggbGV0IGkgPSAwOyBpIDwgY29sb3JzLmxlbmd0aDsgaSsrICl7XHJcblxyXG4gICAgICAgICAgICBjID0gY29sb3JzW2ldO1xyXG4gICAgICAgICAgICAvL1QuZG9tKCAnc3RvcCcsIG51bGwsIHsgb2Zmc2V0OmNbMF0rJyUnLCBzdHlsZTonc3RvcC1jb2xvcjonK2NbMV0rJzsgc3RvcC1vcGFjaXR5OicrY1syXSsnOycgfSwgcGFyZW50LCBbMCxuXSApO1xyXG4gICAgICAgICAgICBULmRvbSggJ3N0b3AnLCBudWxsLCB7IG9mZnNldDpjWzBdKyclJywgJ3N0b3AtY29sb3InOmNbMV0sICAnc3RvcC1vcGFjaXR5JzpjWzJdIH0sIHBhcmVudCwgWzAsbl0gKTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLyptYWtlR3JhcGg6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgbGV0IHcgPSAxMjg7XHJcbiAgICAgICAgbGV0IHJhZGl1cyA9IDM0O1xyXG4gICAgICAgIGxldCBzdmcgPSBULmRvbSggJ3N2ZycsIFQuY3NzLmJhc2ljICwgeyB2aWV3Qm94OicwIDAgJyt3KycgJyt3LCB3aWR0aDp3LCBoZWlnaHQ6dywgcHJlc2VydmVBc3BlY3RSYXRpbzonbm9uZScgfSApO1xyXG4gICAgICAgIFQuZG9tKCAncGF0aCcsICcnLCB7IGQ6JycsIHN0cm9rZTpULmNvbG9ycy50ZXh0LCAnc3Ryb2tlLXdpZHRoJzo0LCBmaWxsOidub25lJywgJ3N0cm9rZS1saW5lY2FwJzonYnV0dCcgfSwgc3ZnICk7Ly8wXHJcbiAgICAgICAgLy9ULmRvbSggJ3JlY3QnLCAnJywgeyB4OjEwLCB5OjEwLCB3aWR0aDoxMDgsIGhlaWdodDoxMDgsIHN0cm9rZToncmdiYSgwLDAsMCwwLjMpJywgJ3N0cm9rZS13aWR0aCc6MiAsIGZpbGw6J25vbmUnfSwgc3ZnICk7Ly8xXHJcbiAgICAgICAgLy9ULmRvbSggJ2NpcmNsZScsICcnLCB7IGN4OjY0LCBjeTo2NCwgcjpyYWRpdXMsIGZpbGw6VC5jb2xvcnMuYnV0dG9uLCBzdHJva2U6J3JnYmEoMCwwLDAsMC4zKScsICdzdHJva2Utd2lkdGgnOjggfSwgc3ZnICk7Ly8wXHJcbiAgICAgICAgXHJcbiAgICAgICAgLy9ULmRvbSggJ2NpcmNsZScsICcnLCB7IGN4OjY0LCBjeTo2NCwgcjpyYWRpdXMrNywgc3Ryb2tlOidyZ2JhKDAsMCwwLDAuMyknLCAnc3Ryb2tlLXdpZHRoJzo3ICwgZmlsbDonbm9uZSd9LCBzdmcgKTsvLzJcclxuICAgICAgICAvL1QuZG9tKCAncGF0aCcsICcnLCB7IGQ6JycsIHN0cm9rZToncmdiYSgyNTUsMjU1LDI1NSwwLjMpJywgJ3N0cm9rZS13aWR0aCc6MiwgZmlsbDonbm9uZScsICdzdHJva2UtbGluZWNhcCc6J3JvdW5kJywgJ3N0cm9rZS1vcGFjaXR5JzowLjUgfSwgc3ZnICk7Ly8zXHJcbiAgICAgICAgVC5ncmFwaCA9IHN2ZztcclxuXHJcbiAgICB9LCovXHJcblxyXG4gICAgbWFrZUtub2I6IGZ1bmN0aW9uICggbW9kZWwgKSB7XHJcblxyXG4gICAgICAgIGxldCB3ID0gMTI4O1xyXG4gICAgICAgIGxldCByYWRpdXMgPSAzNDtcclxuICAgICAgICBsZXQgc3ZnID0gVC5kb20oICdzdmcnLCBULmNzcy5iYXNpYyAsIHsgdmlld0JveDonMCAwICcrdysnICcrdywgd2lkdGg6dywgaGVpZ2h0OncsIHByZXNlcnZlQXNwZWN0UmF0aW86J25vbmUnIH0gKTtcclxuICAgICAgICBULmRvbSggJ2NpcmNsZScsICcnLCB7IGN4OjY0LCBjeTo2NCwgcjpyYWRpdXMsIGZpbGw6VC5jb2xvcnMuYnV0dG9uLCBzdHJva2U6J3JnYmEoMCwwLDAsMC4zKScsICdzdHJva2Utd2lkdGgnOjggfSwgc3ZnICk7Ly8wXHJcbiAgICAgICAgVC5kb20oICdwYXRoJywgJycsIHsgZDonJywgc3Ryb2tlOlQuY29sb3JzLnRleHQsICdzdHJva2Utd2lkdGgnOjQsIGZpbGw6J25vbmUnLCAnc3Ryb2tlLWxpbmVjYXAnOidyb3VuZCcgfSwgc3ZnICk7Ly8xXHJcbiAgICAgICAgVC5kb20oICdjaXJjbGUnLCAnJywgeyBjeDo2NCwgY3k6NjQsIHI6cmFkaXVzKzcsIHN0cm9rZToncmdiYSgwLDAsMCwwLjEpJywgJ3N0cm9rZS13aWR0aCc6NyAsIGZpbGw6J25vbmUnfSwgc3ZnICk7Ly8yXHJcbiAgICAgICAgVC5kb20oICdwYXRoJywgJycsIHsgZDonJywgc3Ryb2tlOidyZ2JhKDI1NSwyNTUsMjU1LDAuMyknLCAnc3Ryb2tlLXdpZHRoJzoyLCBmaWxsOidub25lJywgJ3N0cm9rZS1saW5lY2FwJzoncm91bmQnLCAnc3Ryb2tlLW9wYWNpdHknOjAuNSB9LCBzdmcgKTsvLzNcclxuICAgICAgICBULmtub2IgPSBzdmc7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBtYWtlQ2lyY3VsYXI6IGZ1bmN0aW9uICggbW9kZWwgKSB7XHJcblxyXG4gICAgICAgIGxldCB3ID0gMTI4O1xyXG4gICAgICAgIGxldCByYWRpdXMgPSA0MDtcclxuICAgICAgICBsZXQgc3ZnID0gVC5kb20oICdzdmcnLCBULmNzcy5iYXNpYyAsIHsgdmlld0JveDonMCAwICcrdysnICcrdywgd2lkdGg6dywgaGVpZ2h0OncsIHByZXNlcnZlQXNwZWN0UmF0aW86J25vbmUnIH0gKTtcclxuICAgICAgICBULmRvbSggJ2NpcmNsZScsICcnLCB7IGN4OjY0LCBjeTo2NCwgcjpyYWRpdXMsIHN0cm9rZToncmdiYSgwLDAsMCwwLjEpJywgJ3N0cm9rZS13aWR0aCc6MTAsIGZpbGw6J25vbmUnIH0sIHN2ZyApOy8vMFxyXG4gICAgICAgIFQuZG9tKCAncGF0aCcsICcnLCB7IGQ6JycsIHN0cm9rZTpULmNvbG9ycy50ZXh0LCAnc3Ryb2tlLXdpZHRoJzo3LCBmaWxsOidub25lJywgJ3N0cm9rZS1saW5lY2FwJzonYnV0dCcgfSwgc3ZnICk7Ly8xXHJcbiAgICAgICAgVC5jaXJjdWxhciA9IHN2ZztcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIG1ha2VKb3lzdGljazogZnVuY3Rpb24gKCBtb2RlbCApIHtcclxuXHJcbiAgICAgICAgLy8rJyBiYWNrZ3JvdW5kOiNmMDA7J1xyXG5cclxuICAgICAgICBsZXQgdyA9IDEyOCwgY2NjO1xyXG4gICAgICAgIGxldCByYWRpdXMgPSBNYXRoLmZsb29yKCh3LTMwKSowLjUpO1xyXG4gICAgICAgIGxldCBpbm5lclJhZGl1cyA9IE1hdGguZmxvb3IocmFkaXVzKjAuNik7XHJcbiAgICAgICAgbGV0IHN2ZyA9IFQuZG9tKCAnc3ZnJywgVC5jc3MuYmFzaWMgLCB7IHZpZXdCb3g6JzAgMCAnK3crJyAnK3csIHdpZHRoOncsIGhlaWdodDp3LCBwcmVzZXJ2ZUFzcGVjdFJhdGlvOidub25lJyB9ICk7XHJcbiAgICAgICAgVC5kb20oICdkZWZzJywgbnVsbCwge30sIHN2ZyApO1xyXG4gICAgICAgIFQuZG9tKCAnZycsIG51bGwsIHt9LCBzdmcgKTtcclxuXHJcbiAgICAgICAgaWYoIG1vZGVsID09PSAwICl7XHJcblxyXG4gICAgICAgIFxyXG5cclxuICAgICAgICAgICAgLy8gZ3JhZGlhbiBiYWNrZ3JvdW5kXHJcbiAgICAgICAgICAgIGNjYyA9IFsgWzQwLCAncmdiKDAsMCwwKScsIDAuM10sIFs4MCwgJ3JnYigwLDAsMCknLCAwXSwgWzkwLCAncmdiKDUwLDUwLDUwKScsIDAuNF0sIFsxMDAsICdyZ2IoNTAsNTAsNTApJywgMF0gXTtcclxuICAgICAgICAgICAgVC5tYWtlR3JhZGlhbnQoICdyYWRpYWxHcmFkaWVudCcsIHsgaWQ6J2dyYWQnLCBjeDonNTAlJywgY3k6JzUwJScsIHI6JzUwJScsIGZ4Oic1MCUnLCBmeTonNTAlJyB9LCBzdmcsIGNjYyApO1xyXG5cclxuICAgICAgICAgICAgLy8gZ3JhZGlhbiBzaGFkb3dcclxuICAgICAgICAgICAgY2NjID0gWyBbNjAsICdyZ2IoMCwwLDApJywgMC41XSwgWzEwMCwgJ3JnYigwLDAsMCknLCAwXSBdO1xyXG4gICAgICAgICAgICBULm1ha2VHcmFkaWFudCggJ3JhZGlhbEdyYWRpZW50JywgeyBpZDonZ3JhZFMnLCBjeDonNTAlJywgY3k6JzUwJScsIHI6JzUwJScsIGZ4Oic1MCUnLCBmeTonNTAlJyB9LCBzdmcsIGNjYyApO1xyXG5cclxuICAgICAgICAgICAgLy8gZ3JhZGlhbiBzdGlja1xyXG4gICAgICAgICAgICBsZXQgY2MwID0gWydyZ2IoNDAsNDAsNDApJywgJ3JnYig0OCw0OCw0OCknLCAncmdiKDMwLDMwLDMwKSddO1xyXG4gICAgICAgICAgICBsZXQgY2MxID0gWydyZ2IoMSw5MCwxOTcpJywgJ3JnYigzLDk1LDIwNyknLCAncmdiKDAsNjUsMTY3KSddO1xyXG5cclxuICAgICAgICAgICAgY2NjID0gWyBbMzAsIGNjMFswXSwgMV0sIFs2MCwgY2MwWzFdLCAxXSwgWzgwLCBjYzBbMV0sIDFdLCBbMTAwLCBjYzBbMl0sIDFdIF07XHJcbiAgICAgICAgICAgIFQubWFrZUdyYWRpYW50KCAncmFkaWFsR3JhZGllbnQnLCB7IGlkOidncmFkSW4nLCBjeDonNTAlJywgY3k6JzUwJScsIHI6JzUwJScsIGZ4Oic1MCUnLCBmeTonNTAlJyB9LCBzdmcsIGNjYyApO1xyXG5cclxuICAgICAgICAgICAgY2NjID0gWyBbMzAsIGNjMVswXSwgMV0sIFs2MCwgY2MxWzFdLCAxXSwgWzgwLCBjYzFbMV0sIDFdLCBbMTAwLCBjYzFbMl0sIDFdIF07XHJcbiAgICAgICAgICAgIFQubWFrZUdyYWRpYW50KCAncmFkaWFsR3JhZGllbnQnLCB7IGlkOidncmFkSW4yJywgY3g6JzUwJScsIGN5Oic1MCUnLCByOic1MCUnLCBmeDonNTAlJywgZnk6JzUwJScgfSwgc3ZnLCBjY2MgKTtcclxuXHJcbiAgICAgICAgICAgIC8vIGdyYXBoXHJcblxyXG4gICAgICAgICAgICBULmRvbSggJ2NpcmNsZScsICcnLCB7IGN4OjY0LCBjeTo2NCwgcjpyYWRpdXMsIGZpbGw6J3VybCgjZ3JhZCknIH0sIHN2ZyApOy8vMlxyXG4gICAgICAgICAgICBULmRvbSggJ2NpcmNsZScsICcnLCB7IGN4OjY0KzUsIGN5OjY0KzEwLCByOmlubmVyUmFkaXVzKzEwLCBmaWxsOid1cmwoI2dyYWRTKScgfSwgc3ZnICk7Ly8zXHJcbiAgICAgICAgICAgIFQuZG9tKCAnY2lyY2xlJywgJycsIHsgY3g6NjQsIGN5OjY0LCByOmlubmVyUmFkaXVzLCBmaWxsOid1cmwoI2dyYWRJbiknIH0sIHN2ZyApOy8vNFxyXG5cclxuICAgICAgICAgICAgVC5qb3lzdGlja18wID0gc3ZnO1xyXG5cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgLy8gZ3JhZGlhbiBzaGFkb3dcclxuICAgICAgICAgICAgY2NjID0gWyBbNjksICdyZ2IoMCwwLDApJywgMF0sWzcwLCAncmdiKDAsMCwwKScsIDAuM10sIFsxMDAsICdyZ2IoMCwwLDApJywgMF0gXTtcclxuICAgICAgICAgICAgVC5tYWtlR3JhZGlhbnQoICdyYWRpYWxHcmFkaWVudCcsIHsgaWQ6J2dyYWRYJywgY3g6JzUwJScsIGN5Oic1MCUnLCByOic1MCUnLCBmeDonNTAlJywgZnk6JzUwJScgfSwgc3ZnLCBjY2MgKTtcclxuXHJcbiAgICAgICAgICAgIFQuZG9tKCAnY2lyY2xlJywgJycsIHsgY3g6NjQsIGN5OjY0LCByOnJhZGl1cywgZmlsbDonbm9uZScsIHN0cm9rZToncmdiYSgxMDAsMTAwLDEwMCwwLjI1KScsICdzdHJva2Utd2lkdGgnOic0JyB9LCBzdmcgKTsvLzJcclxuICAgICAgICAgICAgVC5kb20oICdjaXJjbGUnLCAnJywgeyBjeDo2NCwgY3k6NjQsIHI6aW5uZXJSYWRpdXMrMTQsIGZpbGw6J3VybCgjZ3JhZFgpJyB9LCBzdmcgKTsvLzNcclxuICAgICAgICAgICAgVC5kb20oICdjaXJjbGUnLCAnJywgeyBjeDo2NCwgY3k6NjQsIHI6aW5uZXJSYWRpdXMsIGZpbGw6J25vbmUnLCBzdHJva2U6J3JnYigxMDAsMTAwLDEwMCknLCAnc3Ryb2tlLXdpZHRoJzonNCcgfSwgc3ZnICk7Ly80XHJcblxyXG4gICAgICAgICAgICBULmpveXN0aWNrXzEgPSBzdmc7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIG1ha2VDb2xvclJpbmc6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgbGV0IHcgPSAyNTY7XHJcbiAgICAgICAgbGV0IHN2ZyA9IFQuZG9tKCAnc3ZnJywgVC5jc3MuYmFzaWMgLCB7IHZpZXdCb3g6JzAgMCAnK3crJyAnK3csIHdpZHRoOncsIGhlaWdodDp3LCBwcmVzZXJ2ZUFzcGVjdFJhdGlvOidub25lJyB9ICk7XHJcbiAgICAgICAgVC5kb20oICdkZWZzJywgbnVsbCwge30sIHN2ZyApO1xyXG4gICAgICAgIFQuZG9tKCAnZycsIG51bGwsIHt9LCBzdmcgKTtcclxuXHJcbiAgICAgICAgbGV0IHMgPSAzMDsvL3N0cm9rZVxyXG4gICAgICAgIGxldCByID0oIHctcyApKjAuNTtcclxuICAgICAgICBsZXQgbWlkID0gdyowLjU7XHJcbiAgICAgICAgbGV0IG4gPSAyNCwgbnVkZ2UgPSA4IC8gciAvIG4gKiBNYXRoLlBJLCBhMSA9IDAsIGQxO1xyXG4gICAgICAgIGxldCBhbSwgdGFuLCBkMiwgYTIsIGFyLCBpLCBqLCBwYXRoLCBjY2M7XHJcbiAgICAgICAgbGV0IGNvbG9yID0gW107XHJcbiAgICAgICAgXHJcbiAgICAgICAgZm9yICggaSA9IDA7IGkgPD0gbjsgKytpKSB7XHJcblxyXG4gICAgICAgICAgICBkMiA9IGkgLyBuO1xyXG4gICAgICAgICAgICBhMiA9IGQyICogVC5Ud29QSTtcclxuICAgICAgICAgICAgYW0gPSAoYTEgKyBhMikgKiAwLjU7XHJcbiAgICAgICAgICAgIHRhbiA9IDEgLyBNYXRoLmNvcygoYTIgLSBhMSkgKiAwLjUpO1xyXG5cclxuICAgICAgICAgICAgYXIgPSBbXHJcbiAgICAgICAgICAgICAgICBNYXRoLnNpbihhMSksIC1NYXRoLmNvcyhhMSksIFxyXG4gICAgICAgICAgICAgICAgTWF0aC5zaW4oYW0pICogdGFuLCAtTWF0aC5jb3MoYW0pICogdGFuLCBcclxuICAgICAgICAgICAgICAgIE1hdGguc2luKGEyKSwgLU1hdGguY29zKGEyKVxyXG4gICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29sb3JbMV0gPSBULnJnYlRvSGV4KCBULmhzbFRvUmdiKFtkMiwgMSwgMC41XSkgKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChpID4gMCkge1xyXG5cclxuICAgICAgICAgICAgICAgIGogPSA2O1xyXG4gICAgICAgICAgICAgICAgd2hpbGUoai0tKXtcclxuICAgICAgICAgICAgICAgICAgIGFyW2pdID0gKChhcltqXSpyKSttaWQpLnRvRml4ZWQoMik7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgcGF0aCA9ICcgTScgKyBhclswXSArICcgJyArIGFyWzFdICsgJyBRJyArIGFyWzJdICsgJyAnICsgYXJbM10gKyAnICcgKyBhcls0XSArICcgJyArIGFyWzVdO1xyXG5cclxuICAgICAgICAgICAgICAgIGNjYyA9IFsgWzAsY29sb3JbMF0sMV0sIFsxMDAsY29sb3JbMV0sMV0gXTtcclxuICAgICAgICAgICAgICAgIFQubWFrZUdyYWRpYW50KCAnbGluZWFyR3JhZGllbnQnLCB7IGlkOidHJytpLCB4MTphclswXSwgeTE6YXJbMV0sIHgyOmFyWzRdLCB5Mjphcls1XSwgZ3JhZGllbnRVbml0czpcInVzZXJTcGFjZU9uVXNlXCIgfSwgc3ZnLCBjY2MgKTtcclxuXHJcbiAgICAgICAgICAgICAgICBULmRvbSggJ3BhdGgnLCAnJywgeyBkOnBhdGgsICdzdHJva2Utd2lkdGgnOnMsIHN0cm9rZTondXJsKCNHJytpKycpJywgJ3N0cm9rZS1saW5lY2FwJzpcImJ1dHRcIiB9LCBzdmcsIDEgKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGExID0gYTIgLSBudWRnZTsgXHJcbiAgICAgICAgICAgIGNvbG9yWzBdID0gY29sb3JbMV07XHJcbiAgICAgICAgICAgIGQxID0gZDI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgYnIgPSAoMTI4IC0gcyApICsgMjtcclxuICAgICAgICBsZXQgYncgPSA2MDtcclxuXHJcbiAgICAgICAgbGV0IHR3ID0gODQuOTA7XHJcblxyXG4gICAgICAgIC8vIGJsYWNrIC8gd2hpdGVcclxuICAgICAgICBjY2MgPSBbIFswLCAnI0ZGRkZGRicsIDFdLCBbNTAsICcjRkZGRkZGJywgMF0sIFs1MCwgJyMwMDAwMDAnLCAwXSwgWzEwMCwgJyMwMDAwMDAnLCAxXSBdO1xyXG4gICAgICAgIFQubWFrZUdyYWRpYW50KCAnbGluZWFyR3JhZGllbnQnLCB7IGlkOidHTDAnLCB4MTowLCB5MTptaWQtdHcsIHgyOjAsIHkyOm1pZCt0dywgZ3JhZGllbnRVbml0czpcInVzZXJTcGFjZU9uVXNlXCIgfSwgc3ZnLCBjY2MgKTtcclxuXHJcbiAgICAgICAgY2NjID0gWyBbMCwgJyM3ZjdmN2YnLCAxXSwgWzUwLCAnIzdmN2Y3ZicsIDAuNV0sIFsxMDAsICcjN2Y3ZjdmJywgMF0gXTtcclxuICAgICAgICBULm1ha2VHcmFkaWFudCggJ2xpbmVhckdyYWRpZW50JywgeyBpZDonR0wxJywgeDE6bWlkLTQ5LjA1LCB5MTowLCB4MjptaWQrOTgsIHkyOjAsIGdyYWRpZW50VW5pdHM6XCJ1c2VyU3BhY2VPblVzZVwiIH0sIHN2ZywgY2NjICk7XHJcblxyXG4gICAgICAgIFQuZG9tKCAnZycsIG51bGwsIHsgJ3RyYW5zZm9ybS1vcmlnaW4nOiAnMTI4cHggMTI4cHgnLCAndHJhbnNmb3JtJzoncm90YXRlKDApJyB9LCBzdmcgKTsvLzJcclxuICAgICAgICBULmRvbSggJ3BvbHlnb24nLCAnJywgeyBwb2ludHM6Jzc4Ljk1IDQzLjEgNzguOTUgMjEyLjg1IDIyNiAxMjgnLCAgZmlsbDoncmVkJyAgfSwgc3ZnLCAyICk7Ly8gMiwwXHJcbiAgICAgICAgVC5kb20oICdwb2x5Z29uJywgJycsIHsgcG9pbnRzOic3OC45NSA0My4xIDc4Ljk1IDIxMi44NSAyMjYgMTI4JywgIGZpbGw6J3VybCgjR0wxKScsJ3N0cm9rZS13aWR0aCc6MSwgc3Ryb2tlOid1cmwoI0dMMSknICB9LCBzdmcsIDIgKTsvLzIsMVxyXG4gICAgICAgIFQuZG9tKCAncG9seWdvbicsICcnLCB7IHBvaW50czonNzguOTUgNDMuMSA3OC45NSAyMTIuODUgMjI2IDEyOCcsICBmaWxsOid1cmwoI0dMMCknLCdzdHJva2Utd2lkdGgnOjEsIHN0cm9rZTondXJsKCNHTDApJyAgfSwgc3ZnLCAyICk7Ly8yLDJcclxuICAgICAgICBULmRvbSggJ3BhdGgnLCAnJywgeyBkOidNIDI1NS43NSAxMzYuNSBRIDI1NiAxMzIuMyAyNTYgMTI4IDI1NiAxMjMuNyAyNTUuNzUgMTE5LjUgTCAyNDEgMTI4IDI1NS43NSAxMzYuNSBaJywgIGZpbGw6J25vbmUnLCdzdHJva2Utd2lkdGgnOjIsIHN0cm9rZTonIzAwMCcgIH0sIHN2ZywgMiApOy8vMiwzXHJcbiAgICAgICAgLy9ULmRvbSggJ2NpcmNsZScsICcnLCB7IGN4OjEyOCsxMTMsIGN5OjEyOCwgcjo2LCAnc3Ryb2tlLXdpZHRoJzozLCBzdHJva2U6JyMwMDAnLCBmaWxsOidub25lJyB9LCBzdmcsIDIgKTsvLzIuM1xyXG5cclxuICAgICAgICBULmRvbSggJ2NpcmNsZScsICcnLCB7IGN4OjEyOCwgY3k6MTI4LCByOjYsICdzdHJva2Utd2lkdGgnOjIsIHN0cm9rZTonIzAwMCcsIGZpbGw6J25vbmUnIH0sIHN2ZyApOy8vM1xyXG5cclxuICAgICAgICBULmNvbG9yUmluZyA9IHN2ZztcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGljb246IGZ1bmN0aW9uICggdHlwZSwgY29sb3IsIHcgKXtcclxuXHJcbiAgICAgICAgdyA9IHcgfHwgNDA7XHJcbiAgICAgICAgY29sb3IgPSBjb2xvciB8fCAnI0RFREVERSc7XHJcbiAgICAgICAgbGV0IHZpZXdCb3ggPSAnMCAwIDI1NiAyNTYnO1xyXG4gICAgICAgIGxldCB0ID0gW1wiPHN2ZyB4bWxucz0nXCIrVC5zdmducytcIicgdmVyc2lvbj0nMS4xJyB4bWxuczp4bGluaz0nXCIrVC5odG1scytcIicgc3R5bGU9J3BvaW50ZXItZXZlbnRzOm5vbmU7JyBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSd4TWluWU1heCBtZWV0JyB4PScwcHgnIHk9JzBweCcgd2lkdGg9J1wiK3crXCJweCcgaGVpZ2h0PSdcIit3K1wicHgnIHZpZXdCb3g9J1wiK3ZpZXdCb3grXCInPjxnPlwiXTtcclxuICAgICAgICBzd2l0Y2godHlwZSl7XHJcbiAgICAgICAgICAgIGNhc2UgJ2xvZ28nOlxyXG4gICAgICAgICAgICB0WzFdPVwiPHBhdGggaWQ9J2xvZ29pbicgZmlsbD0nXCIrY29sb3IrXCInIHN0cm9rZT0nbm9uZScgZD0nXCIrVC5sb2dvRmlsbF9kK1wiJy8+XCI7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdzYXZlJzpcclxuICAgICAgICAgICAgdFsxXT1cIjxwYXRoIHN0cm9rZT0nXCIrY29sb3IrXCInIHN0cm9rZS13aWR0aD0nNCcgc3Ryb2tlLWxpbmVqb2luPSdyb3VuZCcgc3Ryb2tlLWxpbmVjYXA9J3JvdW5kJyBmaWxsPSdub25lJyBkPSdNIDI2LjEyNSAxNyBMIDIwIDIyLjk1IDE0LjA1IDE3IE0gMjAgOS45NSBMIDIwIDIyLjk1Jy8+PHBhdGggc3Ryb2tlPSdcIitjb2xvcjtcclxuICAgICAgICAgICAgdFsxXSs9XCInIHN0cm9rZS13aWR0aD0nMi41JyBzdHJva2UtbGluZWpvaW49J3JvdW5kJyBzdHJva2UtbGluZWNhcD0ncm91bmQnIGZpbGw9J25vbmUnIGQ9J00gMzIuNiAyMyBMIDMyLjYgMjUuNSBRIDMyLjYgMjguNSAyOS42IDI4LjUgTCAxMC42IDI4LjUgUSA3LjYgMjguNSA3LjYgMjUuNSBMIDcuNiAyMycvPlwiO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgICAgdFsyXSA9IFwiPC9nPjwvc3ZnPlwiO1xyXG4gICAgICAgIHJldHVybiB0LmpvaW4oXCJcXG5cIik7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBsb2dvRmlsbF9kOiBbXHJcbiAgICBcIk0gMTcxIDE1MC43NSBMIDE3MSAzMy4yNSAxNTUuNSAzMy4yNSAxNTUuNSAxNTAuNzUgUSAxNTUuNSAxNjIuMiAxNDcuNDUgMTcwLjIgMTM5LjQ1IDE3OC4yNSAxMjggMTc4LjI1IDExNi42IDE3OC4yNSAxMDguNTUgMTcwLjIgMTAwLjUgMTYyLjIgMTAwLjUgMTUwLjc1IFwiLFxyXG4gICAgXCJMIDEwMC41IDMzLjI1IDg1IDMzLjI1IDg1IDE1MC43NSBRIDg1IDE2OC42NSA5Ny41NSAxODEuMTUgMTEwLjE1IDE5My43NSAxMjggMTkzLjc1IDE0NS45IDE5My43NSAxNTguNCAxODEuMTUgMTcxIDE2OC42NSAxNzEgMTUwLjc1IFwiLFxyXG4gICAgXCJNIDIwMCAzMy4yNSBMIDE4NCAzMy4yNSAxODQgMTUwLjggUSAxODQgMTc0LjEgMTY3LjYgMTkwLjQgMTUxLjMgMjA2LjggMTI4IDIwNi44IDEwNC43NSAyMDYuOCA4OC4zIDE5MC40IDcyIDE3NC4xIDcyIDE1MC44IEwgNzIgMzMuMjUgNTYgMzMuMjUgNTYgMTUwLjc1IFwiLFxyXG4gICAgXCJRIDU2IDE4MC41NSA3Ny4wNSAyMDEuNiA5OC4yIDIyMi43NSAxMjggMjIyLjc1IDE1Ny44IDIyMi43NSAxNzguOSAyMDEuNiAyMDAgMTgwLjU1IDIwMCAxNTAuNzUgTCAyMDAgMzMuMjUgWlwiLFxyXG4gICAgXS5qb2luKCdcXG4nKSxcclxuXHJcbn1cclxuXHJcblQuc2V0VGV4dCgpO1xyXG5cclxuZXhwb3J0IGNvbnN0IFRvb2xzID0gVDsiLCJcclxuLyoqXHJcbiAqIEBhdXRob3IgbHRoIC8gaHR0cHM6Ly9naXRodWIuY29tL2xvLXRoXHJcbiAqL1xyXG5cclxuLy8gSU5URU5BTCBGVU5DVElPTlxyXG5cclxuY29uc3QgUiA9IHtcclxuXHJcblx0dWk6IFtdLFxyXG5cclxuXHRJRDogbnVsbCxcclxuICAgIGxvY2s6ZmFsc2UsXHJcbiAgICB3bG9jazpmYWxzZSxcclxuICAgIGN1cnJlbnQ6LTEsXHJcblxyXG5cdG5lZWRSZVpvbmU6IHRydWUsXHJcblx0aXNFdmVudHNJbml0OiBmYWxzZSxcclxuXHJcbiAgICBwcmV2RGVmYXVsdDogWydjb250ZXh0bWVudScsICdtb3VzZWRvd24nLCAnbW91c2Vtb3ZlJywgJ21vdXNldXAnXSxcclxuICAgIHBvaW50ZXJFdmVudDogWydwb2ludGVyZG93bicsICdwb2ludGVybW92ZScsICdwb2ludGVydXAnXSxcclxuXHJcblx0eG1sc2VyaWFsaXplcjogbmV3IFhNTFNlcmlhbGl6ZXIoKSxcclxuXHR0bXBUaW1lOiBudWxsLFxyXG4gICAgdG1wSW1hZ2U6IG51bGwsXHJcblxyXG4gICAgb2xkQ3Vyc29yOidhdXRvJyxcclxuXHJcbiAgICBpbnB1dDogbnVsbCxcclxuICAgIHBhcmVudDogbnVsbCxcclxuICAgIGZpcnN0SW1wdXQ6IHRydWUsXHJcbiAgICAvL2NhbGxiYWNrSW1wdXQ6IG51bGwsXHJcbiAgICBoaWRkZW5JbXB1dDpudWxsLFxyXG4gICAgaGlkZGVuU2l6ZXI6bnVsbCxcclxuICAgIGhhc0ZvY3VzOmZhbHNlLFxyXG4gICAgc3RhcnRJbnB1dDpmYWxzZSxcclxuICAgIGlucHV0UmFuZ2UgOiBbMCwwXSxcclxuICAgIGN1cnNvcklkIDogMCxcclxuICAgIHN0cjonJyxcclxuICAgIHBvczowLFxyXG4gICAgc3RhcnRYOi0xLFxyXG4gICAgbW92ZVg6LTEsXHJcblxyXG4gICAgZGVidWdJbnB1dDpmYWxzZSxcclxuXHJcbiAgICBpc0xvb3A6IGZhbHNlLFxyXG4gICAgbGlzdGVuczogW10sXHJcblxyXG4gICAgZTp7XHJcbiAgICAgICAgdHlwZTpudWxsLFxyXG4gICAgICAgIGNsaWVudFg6MCxcclxuICAgICAgICBjbGllbnRZOjAsXHJcbiAgICAgICAga2V5Q29kZTpOYU4sXHJcbiAgICAgICAga2V5Om51bGwsXHJcbiAgICAgICAgZGVsdGE6MCxcclxuICAgIH0sXHJcblxyXG4gICAgaXNNb2JpbGU6IGZhbHNlLFxyXG5cclxuICAgIFxyXG5cclxuXHRhZGQ6IGZ1bmN0aW9uICggbyApIHtcclxuXHJcbiAgICAgICAgUi51aS5wdXNoKCBvICk7XHJcbiAgICAgICAgUi5nZXRab25lKCBvICk7XHJcblxyXG4gICAgICAgIGlmKCAhUi5pc0V2ZW50c0luaXQgKSBSLmluaXRFdmVudHMoKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHRlc3RNb2JpbGU6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgbGV0IG4gPSBuYXZpZ2F0b3IudXNlckFnZW50O1xyXG4gICAgICAgIGlmIChuLm1hdGNoKC9BbmRyb2lkL2kpIHx8IG4ubWF0Y2goL3dlYk9TL2kpIHx8IG4ubWF0Y2goL2lQaG9uZS9pKSB8fCBuLm1hdGNoKC9pUGFkL2kpIHx8IG4ubWF0Y2goL2lQb2QvaSkgfHwgbi5tYXRjaCgvQmxhY2tCZXJyeS9pKSB8fCBuLm1hdGNoKC9XaW5kb3dzIFBob25lL2kpKSByZXR1cm4gdHJ1ZTtcclxuICAgICAgICBlbHNlIHJldHVybiBmYWxzZTsgIFxyXG5cclxuICAgIH0sXHJcblxyXG4gICAgcmVtb3ZlOiBmdW5jdGlvbiAoIG8gKSB7XHJcblxyXG4gICAgICAgIGxldCBpID0gUi51aS5pbmRleE9mKCBvICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKCBpICE9PSAtMSApIHtcclxuICAgICAgICAgICAgUi5yZW1vdmVMaXN0ZW4oIG8gKTtcclxuICAgICAgICAgICAgUi51aS5zcGxpY2UoIGksIDEgKTsgXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiggUi51aS5sZW5ndGggPT09IDAgKXtcclxuICAgICAgICAgICAgUi5yZW1vdmVFdmVudHMoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyAgIEVWRU5UU1xyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIGluaXRFdmVudHM6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgaWYoIFIuaXNFdmVudHNJbml0ICkgcmV0dXJuO1xyXG5cclxuICAgICAgICBsZXQgZG9tID0gZG9jdW1lbnQuYm9keTtcclxuXHJcbiAgICAgICAgUi5pc01vYmlsZSA9IFIudGVzdE1vYmlsZSgpO1xyXG5cclxuICAgICAgICBpZiggUi5pc01vYmlsZSApe1xyXG4gICAgICAgICAgICBkb20uYWRkRXZlbnRMaXN0ZW5lciggJ3RvdWNoc3RhcnQnLCBSLCBmYWxzZSApO1xyXG4gICAgICAgICAgICBkb20uYWRkRXZlbnRMaXN0ZW5lciggJ3RvdWNoZW5kJywgUiwgZmFsc2UgKTtcclxuICAgICAgICAgICAgZG9tLmFkZEV2ZW50TGlzdGVuZXIoICd0b3VjaG1vdmUnLCBSLCBmYWxzZSApO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZG9tLmFkZEV2ZW50TGlzdGVuZXIoICdjb250ZXh0bWVudScsIFIsIGZhbHNlICk7XHJcbiAgICAgICAgICAgIGRvbS5hZGRFdmVudExpc3RlbmVyKCAnd2hlZWwnLCBSLCBmYWxzZSApO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ2NsaWNrJywgUiwgZmFsc2UgKTtcclxuXHJcbiAgICAgICAgICAgIC8qZG9tLmFkZEV2ZW50TGlzdGVuZXIoICdtb3VzZWRvd24nLCBSLCBmYWxzZSApO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCAnbW91c2Vtb3ZlJywgUiwgZmFsc2UgKTtcclxuICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ21vdXNldXAnLCBSLCBmYWxzZSApOyovXHJcblxyXG4gICAgICAgICAgICBkb20uYWRkRXZlbnRMaXN0ZW5lciggJ3BvaW50ZXJkb3duJywgUiwgZmFsc2UgKTtcclxuICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ3BvaW50ZXJtb3ZlJywgUiwgZmFsc2UgKTtcclxuICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ3BvaW50ZXJ1cCcsIFIsIGZhbHNlICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciggJ2tleWRvd24nLCBSLCBmYWxzZSApO1xyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCAna2V5dXAnLCBSLCBmYWxzZSApO1xyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCAncmVzaXplJywgUi5yZXNpemUgLCBmYWxzZSApO1xyXG5cclxuICAgICAgICAvL3dpbmRvdy5vbmJsdXIgPSBSLm91dDtcclxuICAgICAgICAvL3dpbmRvdy5vbmZvY3VzID0gUi5pbjtcclxuXHJcbiAgICAgICAgUi5pc0V2ZW50c0luaXQgPSB0cnVlO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgcmVtb3ZlRXZlbnRzOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIGlmKCAhUi5pc0V2ZW50c0luaXQgKSByZXR1cm47XHJcblxyXG4gICAgICAgIGxldCBkb20gPSBkb2N1bWVudC5ib2R5O1xyXG5cclxuICAgICAgICBpZiggUi5pc01vYmlsZSApe1xyXG4gICAgICAgICAgICBkb20ucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ3RvdWNoc3RhcnQnLCBSLCBmYWxzZSApO1xyXG4gICAgICAgICAgICBkb20ucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ3RvdWNoZW5kJywgUiwgZmFsc2UgKTtcclxuICAgICAgICAgICAgZG9tLnJlbW92ZUV2ZW50TGlzdGVuZXIoICd0b3VjaG1vdmUnLCBSLCBmYWxzZSApO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZG9tLnJlbW92ZUV2ZW50TGlzdGVuZXIoICdjb250ZXh0bWVudScsIFIsIGZhbHNlICk7XHJcbiAgICAgICAgICAgIGRvbS5yZW1vdmVFdmVudExpc3RlbmVyKCAnd2hlZWwnLCBSLCBmYWxzZSApO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnY2xpY2snLCBSLCBmYWxzZSApO1xyXG5cclxuICAgICAgICAgICAgLypkb20ucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ21vdXNlZG93bicsIFIsIGZhbHNlICk7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICdtb3VzZW1vdmUnLCBSLCBmYWxzZSApO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnbW91c2V1cCcsIFIsIGZhbHNlICk7Ki9cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGRvbS5yZW1vdmVFdmVudExpc3RlbmVyKCAncG9pbnRlcmRvd24nLCBSLCBmYWxzZSApO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAncG9pbnRlcm1vdmUnLCBSLCBmYWxzZSApO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAncG9pbnRlcnVwJywgUiwgZmFsc2UgKTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ2tleWRvd24nLCBSICk7XHJcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoICdrZXl1cCcsIFIgKTtcclxuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ3Jlc2l6ZScsIFIucmVzaXplICApO1xyXG5cclxuICAgICAgICBSLmlzRXZlbnRzSW5pdCA9IGZhbHNlO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgcmVzaXplOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIFIubmVlZFJlWm9uZSA9IHRydWU7XHJcblxyXG4gICAgICAgIGxldCBpID0gUi51aS5sZW5ndGgsIHU7XHJcbiAgICAgICAgXHJcbiAgICAgICAgd2hpbGUoIGktLSApe1xyXG5cclxuICAgICAgICAgICAgdSA9IFIudWlbaV07XHJcbiAgICAgICAgICAgIGlmKCB1LmlzR3VpICYmICF1LmlzQ2FudmFzT25seSAmJiB1LmF1dG9SZXNpemUgKSB1LnNldEhlaWdodCgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9LFxyXG5cclxuICAgIG91dDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICBjb25zb2xlLmxvZygnaW0gYW0gb3V0JylcclxuICAgICAgICBSLmNsZWFyT2xkSUQoKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGluOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIGNvbnNvbGUubG9nKCdpbSBhbSBpbicpXHJcbiAgICAgIC8vICBSLmNsZWFyT2xkSUQoKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vICAgSEFORExFIEVWRU5UU1xyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgXHJcblxyXG4gICAgaGFuZGxlRXZlbnQ6IGZ1bmN0aW9uICggZXZlbnQgKSB7XHJcblxyXG4gICAgICAgIC8vaWYoIWV2ZW50LnR5cGUpIHJldHVybjtcclxuXHJcbiAgICAgIC8vICBjb25zb2xlLmxvZyggZXZlbnQudHlwZSApXHJcblxyXG4gICAgICAgIGlmKCBldmVudC50eXBlLmluZGV4T2YoIFIucHJldkRlZmF1bHQgKSAhPT0gLTEgKSBldmVudC5wcmV2ZW50RGVmYXVsdCgpOyBcclxuXHJcblxyXG4gICAgICAgIGlmKCBldmVudC50eXBlLmluZGV4T2YoIFIucG9pbnRlckV2ZW50ICkgIT09IC0xICkge1xyXG5cclxuICAgICAgICAgICAgaWYoIGV2ZW50LnBvaW50ZXJUeXBlIT09J21vdXNlJyB8fCBldmVudC5wb2ludGVyVHlwZSE9PSdwZW4nICkgcmV0dXJuO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKCBldmVudC50eXBlID09PSAnY29udGV4dG1lbnUnICkgcmV0dXJuOyBcclxuXHJcbiAgICAgICAgLy9pZiggZXZlbnQudHlwZSA9PT0gJ2tleWRvd24nKXsgUi5lZGl0VGV4dCggZXZlbnQgKTsgcmV0dXJuO31cclxuXHJcbiAgICAgICAgLy9pZiggZXZlbnQudHlwZSAhPT0gJ2tleWRvd24nICYmIGV2ZW50LnR5cGUgIT09ICd3aGVlbCcgKSBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIC8vZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblxyXG4gICAgICAgIFIuZmluZFpvbmUoKTtcclxuICAgICAgIFxyXG4gICAgICAgIGxldCBlID0gUi5lO1xyXG5cclxuICAgICAgICBpZiggZXZlbnQudHlwZSA9PT0gJ2tleWRvd24nKSBSLmtleWRvd24oIGV2ZW50ICk7XHJcbiAgICAgICAgaWYoIGV2ZW50LnR5cGUgPT09ICdrZXl1cCcpIFIua2V5dXAoIGV2ZW50ICk7XHJcblxyXG4gICAgICAgIGlmKCBldmVudC50eXBlID09PSAnd2hlZWwnICkgZS5kZWx0YSA9IGV2ZW50LmRlbHRhWSA+IDAgPyAxIDogLTE7XHJcbiAgICAgICAgZWxzZSBlLmRlbHRhID0gMDtcclxuICAgICAgICBcclxuICAgICAgICBlLmNsaWVudFggPSBldmVudC5jbGllbnRYIHx8IDA7XHJcbiAgICAgICAgZS5jbGllbnRZID0gZXZlbnQuY2xpZW50WSB8fCAwO1xyXG4gICAgICAgIGUudHlwZSA9IGV2ZW50LnR5cGU7XHJcblxyXG4gICAgICAgIC8vIG1vYmlsZVxyXG5cclxuICAgICAgICBpZiggUi5pc01vYmlsZSApe1xyXG5cclxuICAgICAgICAgICAgaWYoIGV2ZW50LnRvdWNoZXMgJiYgZXZlbnQudG91Y2hlcy5sZW5ndGggPiAwICl7XHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBlLmNsaWVudFggPSBldmVudC50b3VjaGVzWyAwIF0uY2xpZW50WCB8fCAwO1xyXG4gICAgICAgICAgICAgICAgZS5jbGllbnRZID0gZXZlbnQudG91Y2hlc1sgMCBdLmNsaWVudFkgfHwgMDtcclxuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmKCBldmVudC50eXBlID09PSAndG91Y2hzdGFydCcpIGUudHlwZSA9ICdtb3VzZWRvd24nO1xyXG4gICAgICAgICAgICBpZiggZXZlbnQudHlwZSA9PT0gJ3RvdWNoZW5kJykgZS50eXBlID0gJ21vdXNldXAnXHJcbiAgICAgICAgICAgIGlmKCBldmVudC50eXBlID09PSAndG91Y2htb3ZlJykgZS50eXBlID0gJ21vdXNlbW92ZSc7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoIGV2ZW50LnR5cGUgPT09ICdwb2ludGVyZG93bicpIGUudHlwZSA9ICdtb3VzZWRvd24nO1xyXG4gICAgICAgIGlmKCBldmVudC50eXBlID09PSAncG9pbnRlcnVwJykgZS50eXBlID0gJ21vdXNldXAnO1xyXG4gICAgICAgIGlmKCBldmVudC50eXBlID09PSAncG9pbnRlcm1vdmUnKSBlLnR5cGUgPSAnbW91c2Vtb3ZlJztcclxuXHJcbiAgICAgICAvL2lmKCAncG9pbnRlcmRvd24nICdwb2ludGVybW92ZScsICdwb2ludGVydXAnKVxyXG4gICAgICAgIFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qXHJcbiAgICAgICAgaWYoIGV2ZW50LnR5cGUgPT09ICd0b3VjaHN0YXJ0Jyl7IGUudHlwZSA9ICdtb3VzZWRvd24nOyBSLmZpbmRJRCggZSApOyB9XHJcbiAgICAgICAgaWYoIGV2ZW50LnR5cGUgPT09ICd0b3VjaGVuZCcpeyBlLnR5cGUgPSAnbW91c2V1cCc7ICBpZiggUi5JRCAhPT0gbnVsbCApIFIuSUQuaGFuZGxlRXZlbnQoIGUgKTsgUi5jbGVhck9sZElEKCk7IH1cclxuICAgICAgICBpZiggZXZlbnQudHlwZSA9PT0gJ3RvdWNobW92ZScpeyBlLnR5cGUgPSAnbW91c2Vtb3ZlJzsgIH1cclxuICAgICAgICAqL1xyXG5cclxuXHJcbiAgICAgICAgaWYoIGUudHlwZSA9PT0gJ21vdXNlZG93bicgKSBSLmxvY2sgPSB0cnVlO1xyXG4gICAgICAgIGlmKCBlLnR5cGUgPT09ICdtb3VzZXVwJyApIFIubG9jayA9IGZhbHNlO1xyXG5cclxuICAgICAgICBpZiggUi5pc01vYmlsZSAmJiBlLnR5cGUgPT09ICdtb3VzZWRvd24nICkgUi5maW5kSUQoIGUgKTtcclxuICAgICAgICBpZiggZS50eXBlID09PSAnbW91c2Vtb3ZlJyAmJiAhUi5sb2NrICkgUi5maW5kSUQoIGUgKTtcclxuICAgICAgICBcclxuXHJcbiAgICAgICAgaWYoIFIuSUQgIT09IG51bGwgKXtcclxuXHJcbiAgICAgICAgICAgIGlmKCBSLklELmlzQ2FudmFzT25seSApIHtcclxuXHJcbiAgICAgICAgICAgICAgICBlLmNsaWVudFggPSBSLklELm1vdXNlLng7XHJcbiAgICAgICAgICAgICAgICBlLmNsaWVudFkgPSBSLklELm1vdXNlLnk7XHJcblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBSLklELmhhbmRsZUV2ZW50KCBlICk7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoIFIuaXNNb2JpbGUgJiYgZS50eXBlID09PSAnbW91c2V1cCcgKSBSLmNsZWFyT2xkSUQoKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vICAgSURcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBmaW5kSUQ6IGZ1bmN0aW9uICggZSApIHtcclxuXHJcbiAgICAgICAgbGV0IGkgPSBSLnVpLmxlbmd0aCwgbmV4dCA9IC0xLCB1LCB4LCB5O1xyXG5cclxuICAgICAgICB3aGlsZSggaS0tICl7XHJcblxyXG4gICAgICAgICAgICB1ID0gUi51aVtpXTtcclxuXHJcbiAgICAgICAgICAgIGlmKCB1LmlzQ2FudmFzT25seSApIHtcclxuXHJcbiAgICAgICAgICAgICAgICB4ID0gdS5tb3VzZS54O1xyXG4gICAgICAgICAgICAgICAgeSA9IHUubW91c2UueTtcclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgICAgICAgICAgeCA9IGUuY2xpZW50WDtcclxuICAgICAgICAgICAgICAgIHkgPSBlLmNsaWVudFk7XHJcblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiggUi5vblpvbmUoIHUsIHgsIHkgKSApeyBcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgbmV4dCA9IGk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGlmKCBuZXh0ICE9PSBSLmN1cnJlbnQgKXtcclxuICAgICAgICAgICAgICAgICAgICBSLmNsZWFyT2xkSUQoKTtcclxuICAgICAgICAgICAgICAgICAgICBSLmN1cnJlbnQgPSBuZXh0O1xyXG4gICAgICAgICAgICAgICAgICAgIFIuSUQgPSB1O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoIG5leHQgPT09IC0xICkgUi5jbGVhck9sZElEKCk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBjbGVhck9sZElEOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIGlmKCAhUi5JRCApIHJldHVybjtcclxuICAgICAgICBSLmN1cnJlbnQgPSAtMTtcclxuICAgICAgICBSLklELnJlc2V0KCk7XHJcbiAgICAgICAgUi5JRCA9IG51bGw7XHJcbiAgICAgICAgUi5jdXJzb3IoKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vICAgR1VJIC8gR1JPVVAgRlVOQ1RJT05cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBjYWxjVWlzOiBmdW5jdGlvbiAoIHVpcywgem9uZSwgcHkgKSB7XHJcblxyXG4gICAgICAgIGxldCBsbmcgPSB1aXMubGVuZ3RoLCB1LCBpLCBweCA9IDAsIG15ID0gMDtcclxuXHJcbiAgICAgICAgZm9yKCBpID0gMDsgaSA8IGxuZzsgaSsrICl7XHJcblxyXG4gICAgICAgICAgICB1ID0gdWlzW2ldO1xyXG5cclxuICAgICAgICAgICAgdS56b25lLncgPSB1Lnc7XHJcbiAgICAgICAgICAgIHUuem9uZS5oID0gdS5oO1xyXG5cclxuICAgICAgICAgICAgaWYoICF1LmF1dG9XaWR0aCApe1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKCBweCA9PT0gMCApIHB5ICs9IHUuaCArIDE7XHJcblxyXG4gICAgICAgICAgICAgICAgdS56b25lLnggPSB6b25lLnggKyBweDtcclxuICAgICAgICAgICAgICAgIHUuem9uZS55ID0gcHggPT09IDAgPyBweSAtIHUuaCA6IG15O1xyXG5cclxuICAgICAgICAgICAgICAgIG15ID0gdS56b25lLnk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIHB4ICs9IHUudztcclxuICAgICAgICAgICAgICAgIGlmKCBweCArIHUudyA+IHpvbmUudyApIHB4ID0gMDtcclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgICAgICAgICAgdS56b25lLnggPSB6b25lLng7XHJcbiAgICAgICAgICAgICAgICB1LnpvbmUueSA9IHB5O1xyXG4gICAgICAgICAgICAgICAgcHkgKz0gdS5oICsgMTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmKCB1LmlzR3JvdXAgKSB1LmNhbGNVaXMoKTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0sXHJcblxyXG5cclxuXHRmaW5kVGFyZ2V0OiBmdW5jdGlvbiAoIHVpcywgZSApIHtcclxuXHJcbiAgICAgICAgbGV0IGkgPSB1aXMubGVuZ3RoO1xyXG5cclxuICAgICAgICB3aGlsZSggaS0tICl7XHJcbiAgICAgICAgICAgIGlmKCBSLm9uWm9uZSggdWlzW2ldLCBlLmNsaWVudFgsIGUuY2xpZW50WSApICkgcmV0dXJuIGk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gLTE7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyAgIFpPTkVcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBmaW5kWm9uZTogZnVuY3Rpb24gKCBmb3JjZSApIHtcclxuXHJcbiAgICAgICAgaWYoICFSLm5lZWRSZVpvbmUgJiYgIWZvcmNlICkgcmV0dXJuO1xyXG5cclxuICAgICAgICB2YXIgaSA9IFIudWkubGVuZ3RoLCB1O1xyXG5cclxuICAgICAgICB3aGlsZSggaS0tICl7IFxyXG5cclxuICAgICAgICAgICAgdSA9IFIudWlbaV07XHJcbiAgICAgICAgICAgIFIuZ2V0Wm9uZSggdSApO1xyXG4gICAgICAgICAgICBpZiggdS5pc0d1aSApIHUuY2FsY1VpcygpO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIFIubmVlZFJlWm9uZSA9IGZhbHNlO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgb25ab25lOiBmdW5jdGlvbiAoIG8sIHgsIHkgKSB7XHJcblxyXG4gICAgICAgIGlmKCB4ID09PSB1bmRlZmluZWQgfHwgeSA9PT0gdW5kZWZpbmVkICkgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICBsZXQgeiA9IG8uem9uZTtcclxuICAgICAgICBsZXQgbXggPSB4IC0gei54O1xyXG4gICAgICAgIGxldCBteSA9IHkgLSB6Lnk7XHJcblxyXG4gICAgICAgIGxldCBvdmVyID0gKCBteCA+PSAwICkgJiYgKCBteSA+PSAwICkgJiYgKCBteCA8PSB6LncgKSAmJiAoIG15IDw9IHouaCApO1xyXG5cclxuICAgICAgICBpZiggb3ZlciApIG8ubG9jYWwuc2V0KCBteCwgbXkgKTtcclxuICAgICAgICBlbHNlIG8ubG9jYWwubmVnKCk7XHJcblxyXG4gICAgICAgIHJldHVybiBvdmVyO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgZ2V0Wm9uZTogZnVuY3Rpb24gKCBvICkge1xyXG5cclxuICAgICAgICBpZiggby5pc0NhbnZhc09ubHkgKSByZXR1cm47XHJcbiAgICAgICAgbGV0IHIgPSBvLmdldERvbSgpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgIG8uem9uZSA9IHsgeDpyLmxlZnQsIHk6ci50b3AsIHc6ci53aWR0aCwgaDpyLmhlaWdodCB9O1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBDVVJTT1JcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBjdXJzb3I6IGZ1bmN0aW9uICggbmFtZSApIHtcclxuXHJcbiAgICAgICAgbmFtZSA9IG5hbWUgPyBuYW1lIDogJ2F1dG8nO1xyXG4gICAgICAgIGlmKCBuYW1lICE9PSBSLm9sZEN1cnNvciApe1xyXG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLmN1cnNvciA9IG5hbWU7XHJcbiAgICAgICAgICAgIFIub2xkQ3Vyc29yID0gbmFtZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyAgIENBTlZBU1xyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIHRvQ2FudmFzOiBmdW5jdGlvbiAoIG8sIHcsIGgsIGZvcmNlICkge1xyXG5cclxuICAgICAgICAvLyBwcmV2ZW50IGV4ZXNpdmUgcmVkcmF3XHJcblxyXG4gICAgICAgIGlmKCBmb3JjZSAmJiBSLnRtcFRpbWUgIT09IG51bGwgKSB7IGNsZWFyVGltZW91dChSLnRtcFRpbWUpOyBSLnRtcFRpbWUgPSBudWxsOyAgfVxyXG5cclxuICAgICAgICBpZiggUi50bXBUaW1lICE9PSBudWxsICkgcmV0dXJuO1xyXG5cclxuICAgICAgICBpZiggUi5sb2NrICkgUi50bXBUaW1lID0gc2V0VGltZW91dCggZnVuY3Rpb24oKXsgUi50bXBUaW1lID0gbnVsbDsgfSwgMTAgKTtcclxuXHJcbiAgICAgICAgLy8vXHJcblxyXG4gICAgICAgIGxldCBpc05ld1NpemUgPSBmYWxzZTtcclxuICAgICAgICBpZiggdyAhPT0gby5jYW52YXMud2lkdGggfHwgaCAhPT0gby5jYW52YXMuaGVpZ2h0ICkgaXNOZXdTaXplID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgaWYoIFIudG1wSW1hZ2UgPT09IG51bGwgKSBSLnRtcEltYWdlID0gbmV3IEltYWdlKCk7XHJcblxyXG4gICAgICAgIGxldCBpbWcgPSBSLnRtcEltYWdlOyAvL25ldyBJbWFnZSgpO1xyXG5cclxuICAgICAgICBsZXQgaHRtbFN0cmluZyA9IFIueG1sc2VyaWFsaXplci5zZXJpYWxpemVUb1N0cmluZyggby5jb250ZW50ICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IHN2ZyA9ICc8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIicrdysnXCIgaGVpZ2h0PVwiJytoKydcIj48Zm9yZWlnbk9iamVjdCBzdHlsZT1cInBvaW50ZXItZXZlbnRzOiBub25lOyBsZWZ0OjA7XCIgd2lkdGg9XCIxMDAlXCIgaGVpZ2h0PVwiMTAwJVwiPicrIGh0bWxTdHJpbmcgKyc8L2ZvcmVpZ25PYmplY3Q+PC9zdmc+JztcclxuXHJcbiAgICAgICAgaW1nLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgbGV0IGN0eCA9IG8uY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGlmKCBpc05ld1NpemUgKXsgXHJcbiAgICAgICAgICAgICAgICBvLmNhbnZhcy53aWR0aCA9IHc7XHJcbiAgICAgICAgICAgICAgICBvLmNhbnZhcy5oZWlnaHQgPSBoXHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgY3R4LmNsZWFyUmVjdCggMCwgMCwgdywgaCApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoIHRoaXMsIDAsIDAgKTtcclxuXHJcbiAgICAgICAgICAgIG8ub25EcmF3KCk7XHJcblxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGltZy5zcmMgPSBcImRhdGE6aW1hZ2Uvc3ZnK3htbDtjaGFyc2V0PXV0Zi04LFwiICsgZW5jb2RlVVJJQ29tcG9uZW50KHN2Zyk7XHJcbiAgICAgICAgLy9pbWcuc3JjID0gJ2RhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsJysgd2luZG93LmJ0b2EoIHN2ZyApO1xyXG4gICAgICAgIGltZy5jcm9zc09yaWdpbiA9ICcnO1xyXG5cclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vICAgSU5QVVRcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBzZXRIaWRkZW46IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgaWYoIFIuaGlkZGVuSW1wdXQgPT09IG51bGwgKXtcclxuXHJcbiAgICAgICAgICAgIGxldCBoaWRlID0gUi5kZWJ1Z0lucHV0ID8gJycgOiAnb3BhY2l0eTowOyB6SW5kZXg6MDsnO1xyXG5cclxuICAgICAgICAgICAgbGV0IGNzcyA9IFIucGFyZW50LmNzcy50eHQgKyAncGFkZGluZzowOyB3aWR0aDphdXRvOyBoZWlnaHQ6YXV0bzsgdGV4dC1zaGFkb3c6bm9uZTsnXHJcbiAgICAgICAgICAgIGNzcyArPSAnbGVmdDoxMHB4OyB0b3A6YXV0bzsgYm9yZGVyOm5vbmU7IGNvbG9yOiNGRkY7IGJhY2tncm91bmQ6IzAwMDsnICsgaGlkZTtcclxuXHJcbiAgICAgICAgICAgIFIuaGlkZGVuSW1wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xyXG4gICAgICAgICAgICBSLmhpZGRlbkltcHV0LnR5cGUgPSAndGV4dCc7XHJcbiAgICAgICAgICAgIFIuaGlkZGVuSW1wdXQuc3R5bGUuY3NzVGV4dCA9IGNzcyArICdib3R0b206MzBweDsnICsgKFIuZGVidWdJbnB1dCA/ICcnIDogJ3RyYW5zZm9ybTpzY2FsZSgwKTsnKTs7XHJcblxyXG4gICAgICAgICAgICBSLmhpZGRlblNpemVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIFIuaGlkZGVuU2l6ZXIuc3R5bGUuY3NzVGV4dCA9IGNzcyArICdib3R0b206NjBweDsnO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCggUi5oaWRkZW5JbXB1dCApO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKCBSLmhpZGRlblNpemVyICk7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgUi5oaWRkZW5JbXB1dC5zdHlsZS53aWR0aCA9IFIuaW5wdXQuY2xpZW50V2lkdGggKyAncHgnO1xyXG4gICAgICAgIFIuaGlkZGVuSW1wdXQudmFsdWUgPSBSLnN0cjtcclxuICAgICAgICBSLmhpZGRlblNpemVyLmlubmVySFRNTCA9IFIuc3RyO1xyXG5cclxuICAgICAgICBSLmhhc0ZvY3VzID0gdHJ1ZTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGNsZWFySGlkZGVuOiBmdW5jdGlvbiAoIHAgKSB7XHJcblxyXG4gICAgICAgIGlmKCBSLmhpZGRlbkltcHV0ID09PSBudWxsICkgcmV0dXJuO1xyXG4gICAgICAgIFIuaGFzRm9jdXMgPSBmYWxzZTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGNsaWNrUG9zOiBmdW5jdGlvbiggeCApe1xyXG5cclxuICAgICAgICBsZXQgaSA9IFIuc3RyLmxlbmd0aCwgbCA9IDAsIG4gPSAwO1xyXG4gICAgICAgIHdoaWxlKCBpLS0gKXtcclxuICAgICAgICAgICAgbCArPSBSLnRleHRXaWR0aCggUi5zdHJbbl0gKTtcclxuICAgICAgICAgICAgaWYoIGwgPj0geCApIGJyZWFrO1xyXG4gICAgICAgICAgICBuKys7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgdXBJbnB1dDogZnVuY3Rpb24gKCB4LCBkb3duICkge1xyXG5cclxuICAgICAgICBpZiggUi5wYXJlbnQgPT09IG51bGwgKSByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgICAgIGxldCB1cCA9IGZhbHNlO1xyXG4gICAgIFxyXG4gICAgICAgIGlmKCBkb3duICl7XHJcblxyXG4gICAgICAgICAgICBsZXQgaWQgPSBSLmNsaWNrUG9zKCB4ICk7XHJcblxyXG4gICAgICAgICAgICBSLm1vdmVYID0gaWQ7XHJcblxyXG4gICAgICAgICAgICBpZiggUi5zdGFydFggPT09IC0xICl7IFxyXG5cclxuICAgICAgICAgICAgICAgIFIuc3RhcnRYID0gaWQ7XHJcbiAgICAgICAgICAgICAgICBSLmN1cnNvcklkID0gaWQ7XHJcbiAgICAgICAgICAgICAgICBSLmlucHV0UmFuZ2UgPSBbIFIuc3RhcnRYLCBSLnN0YXJ0WCBdO1xyXG5cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBsZXQgaXNTZWxlY3Rpb24gPSBSLm1vdmVYICE9PSBSLnN0YXJ0WDtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiggaXNTZWxlY3Rpb24gKXtcclxuICAgICAgICAgICAgICAgICAgICBpZiggUi5zdGFydFggPiBSLm1vdmVYICkgUi5pbnB1dFJhbmdlID0gWyBSLm1vdmVYLCBSLnN0YXJ0WCBdO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgUi5pbnB1dFJhbmdlID0gWyBSLnN0YXJ0WCwgUi5tb3ZlWCBdOyAgICBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdXAgPSB0cnVlO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgaWYoIFIuc3RhcnRYICE9PSAtMSApe1xyXG5cclxuICAgICAgICAgICAgICAgIFIuaGFzRm9jdXMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgUi5oaWRkZW5JbXB1dC5mb2N1cygpO1xyXG4gICAgICAgICAgICAgICAgUi5oaWRkZW5JbXB1dC5zZWxlY3Rpb25TdGFydCA9IFIuaW5wdXRSYW5nZVswXTtcclxuICAgICAgICAgICAgICAgIFIuaGlkZGVuSW1wdXQuc2VsZWN0aW9uRW5kID0gUi5pbnB1dFJhbmdlWzFdO1xyXG4gICAgICAgICAgICAgICAgUi5zdGFydFggPSAtMTtcclxuXHJcbiAgICAgICAgICAgICAgICB1cCA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoIHVwICkgUi5zZWxlY3RQYXJlbnQoKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHVwO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgc2VsZWN0UGFyZW50OiBmdW5jdGlvbiAoKXtcclxuXHJcbiAgICAgICAgdmFyIGMgPSBSLnRleHRXaWR0aCggUi5zdHIuc3Vic3RyaW5nKCAwLCBSLmN1cnNvcklkICkpO1xyXG4gICAgICAgIHZhciBlID0gUi50ZXh0V2lkdGgoIFIuc3RyLnN1YnN0cmluZyggMCwgUi5pbnB1dFJhbmdlWzBdICkpO1xyXG4gICAgICAgIHZhciBzID0gUi50ZXh0V2lkdGgoIFIuc3RyLnN1YnN0cmluZyggUi5pbnB1dFJhbmdlWzBdLCAgUi5pbnB1dFJhbmdlWzFdICkpO1xyXG5cclxuICAgICAgICBSLnBhcmVudC5zZWxlY3QoIGMsIGUsIHMgKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHRleHRXaWR0aDogZnVuY3Rpb24gKCB0ZXh0ICl7XHJcblxyXG4gICAgICAgIGlmKCBSLmhpZGRlblNpemVyID09PSBudWxsICkgcmV0dXJuIDA7XHJcbiAgICAgICAgdGV4dCA9IHRleHQucmVwbGFjZSgvIC9nLCAnJm5ic3A7Jyk7XHJcbiAgICAgICAgUi5oaWRkZW5TaXplci5pbm5lckhUTUwgPSB0ZXh0O1xyXG4gICAgICAgIHJldHVybiBSLmhpZGRlblNpemVyLmNsaWVudFdpZHRoO1xyXG5cclxuICAgIH0sXHJcblxyXG5cclxuICAgIGNsZWFySW5wdXQ6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgaWYoIFIucGFyZW50ID09PSBudWxsICkgcmV0dXJuO1xyXG4gICAgICAgIGlmKCAhUi5maXJzdEltcHV0ICkgUi5wYXJlbnQudmFsaWRhdGUoIHRydWUgKTtcclxuXHJcbiAgICAgICAgUi5jbGVhckhpZGRlbigpO1xyXG4gICAgICAgIFIucGFyZW50LnVuc2VsZWN0KCk7XHJcblxyXG4gICAgICAgIC8vUi5pbnB1dC5zdHlsZS5iYWNrZ3JvdW5kID0gJ25vbmUnO1xyXG4gICAgICAgIFIuaW5wdXQuc3R5bGUuYmFja2dyb3VuZCA9IFIucGFyZW50LmNvbG9ycy5pbnB1dEJnO1xyXG4gICAgICAgIFIuaW5wdXQuc3R5bGUuYm9yZGVyQ29sb3IgPSBSLnBhcmVudC5jb2xvcnMuaW5wdXRCb3JkZXI7XHJcbiAgICAgICAgUi5wYXJlbnQuaXNFZGl0ID0gZmFsc2U7XHJcblxyXG4gICAgICAgIFIuaW5wdXQgPSBudWxsO1xyXG4gICAgICAgIFIucGFyZW50ID0gbnVsbDtcclxuICAgICAgICBSLnN0ciA9ICcnLFxyXG4gICAgICAgIFIuZmlyc3RJbXB1dCA9IHRydWU7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBzZXRJbnB1dDogZnVuY3Rpb24gKCBJbnB1dCwgcGFyZW50ICkge1xyXG5cclxuICAgICAgICBSLmNsZWFySW5wdXQoKTtcclxuICAgICAgICBcclxuICAgICAgICBSLmlucHV0ID0gSW5wdXQ7XHJcbiAgICAgICAgUi5wYXJlbnQgPSBwYXJlbnQ7XHJcblxyXG4gICAgICAgIFIuaW5wdXQuc3R5bGUuYmFja2dyb3VuZCA9IFIucGFyZW50LmNvbG9ycy5pbnB1dE92ZXI7XHJcbiAgICAgICAgUi5pbnB1dC5zdHlsZS5ib3JkZXJDb2xvciA9IFIucGFyZW50LmNvbG9ycy5pbnB1dEJvcmRlclNlbGVjdDtcclxuICAgICAgICBSLnN0ciA9IFIuaW5wdXQudGV4dENvbnRlbnQ7XHJcblxyXG4gICAgICAgIFIuc2V0SGlkZGVuKCk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICAvKnNlbGVjdDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICBkb2N1bWVudC5leGVjQ29tbWFuZCggXCJzZWxlY3RhbGxcIiwgbnVsbCwgZmFsc2UgKTtcclxuXHJcbiAgICB9LCovXHJcblxyXG4gICAga2V5ZG93bjogZnVuY3Rpb24gKCBlICkge1xyXG5cclxuICAgICAgICBpZiggUi5wYXJlbnQgPT09IG51bGwgKSByZXR1cm47XHJcblxyXG4gICAgICAgIGxldCBrZXlDb2RlID0gZS53aGljaCwgaXNTaGlmdCA9IGUuc2hpZnRLZXk7XHJcblxyXG4gICAgICAgIC8vY29uc29sZS5sb2coIGtleUNvZGUgKVxyXG5cclxuICAgICAgICBSLmZpcnN0SW1wdXQgPSBmYWxzZTtcclxuXHJcblxyXG4gICAgICAgIGlmIChSLmhhc0ZvY3VzKSB7XHJcbiAgICAgICAgICAgIC8vIGhhY2sgdG8gZml4IHRvdWNoIGV2ZW50IGJ1ZyBpbiBpT1MgU2FmYXJpXHJcbiAgICAgICAgICAgIHdpbmRvdy5mb2N1cygpO1xyXG4gICAgICAgICAgICBSLmhpZGRlbkltcHV0LmZvY3VzKCk7XHJcblxyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIFIucGFyZW50LmlzRWRpdCA9IHRydWU7XHJcblxyXG4gICAgICAgLy8gZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICAvLyBhZGQgc3VwcG9ydCBmb3IgQ3RybC9DbWQrQSBzZWxlY3Rpb25cclxuICAgICAgICAvL2lmICgga2V5Q29kZSA9PT0gNjUgJiYgKGUuY3RybEtleSB8fCBlLm1ldGFLZXkgKSkge1xyXG4gICAgICAgICAgICAvL1Iuc2VsZWN0VGV4dCgpO1xyXG4gICAgICAgICAgICAvL2UucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgLy9yZXR1cm4gc2VsZi5yZW5kZXIoKTtcclxuICAgICAgICAvL31cclxuXHJcbiAgICAgICAgaWYoIGtleUNvZGUgPT09IDEzICl7IC8vZW50ZXJcclxuXHJcbiAgICAgICAgICAgIFIuY2xlYXJJbnB1dCgpO1xyXG5cclxuICAgICAgICAvL30gZWxzZSBpZigga2V5Q29kZSA9PT0gOSApeyAvL3RhYiBrZXlcclxuXHJcbiAgICAgICAgICAgLy8gUi5pbnB1dC50ZXh0Q29udGVudCA9ICcnO1xyXG5cclxuICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgaWYoIFIuaW5wdXQuaXNOdW0gKXtcclxuICAgICAgICAgICAgICAgIGlmICggKChlLmtleUNvZGUgPiA0NykgJiYgKGUua2V5Q29kZSA8IDU4KSkgfHwgKChlLmtleUNvZGUgPiA5NSkgJiYgKGUua2V5Q29kZSA8IDEwNikpIHx8IGUua2V5Q29kZSA9PT0gMTkwIHx8IGUua2V5Q29kZSA9PT0gMTEwIHx8IGUua2V5Q29kZSA9PT0gOCB8fCBlLmtleUNvZGUgPT09IDEwOSApe1xyXG4gICAgICAgICAgICAgICAgICAgIFIuaGlkZGVuSW1wdXQucmVhZE9ubHkgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgUi5oaWRkZW5JbXB1dC5yZWFkT25seSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBSLmhpZGRlbkltcHV0LnJlYWRPbmx5ID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0sXHJcblxyXG4gICAga2V5dXA6IGZ1bmN0aW9uICggZSApIHtcclxuXHJcbiAgICAgICAgaWYoIFIucGFyZW50ID09PSBudWxsICkgcmV0dXJuO1xyXG5cclxuICAgICAgICBSLnN0ciA9IFIuaGlkZGVuSW1wdXQudmFsdWU7XHJcblxyXG4gICAgICAgIGlmKCBSLnBhcmVudC5hbGxFcXVhbCApIFIucGFyZW50LnNhbWVTdHIoIFIuc3RyICk7Ly8gbnVtZXJpYyBzYW3DuWUgdmFsdWVcclxuICAgICAgICBlbHNlIFIuaW5wdXQudGV4dENvbnRlbnQgPSBSLnN0cjtcclxuXHJcbiAgICAgICAgUi5jdXJzb3JJZCA9IFIuaGlkZGVuSW1wdXQuc2VsZWN0aW9uU3RhcnQ7XHJcbiAgICAgICAgUi5pbnB1dFJhbmdlID0gWyBSLmhpZGRlbkltcHV0LnNlbGVjdGlvblN0YXJ0LCBSLmhpZGRlbkltcHV0LnNlbGVjdGlvbkVuZCBdO1xyXG5cclxuICAgICAgICBSLnNlbGVjdFBhcmVudCgpO1xyXG5cclxuICAgICAgICAvL2lmKCBSLnBhcmVudC5hbGx3YXkgKSBcclxuICAgICAgICBSLnBhcmVudC52YWxpZGF0ZSgpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy9cclxuICAgIC8vICAgTElTVEVOSU5HXHJcbiAgICAvL1xyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIGxvb3A6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgaWYoIFIuaXNMb29wICkgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCBSLmxvb3AgKTtcclxuICAgICAgICBSLnVwZGF0ZSgpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIGxldCBpID0gUi5saXN0ZW5zLmxlbmd0aDtcclxuICAgICAgICB3aGlsZSggaS0tICkgUi5saXN0ZW5zW2ldLmxpc3RlbmluZygpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgcmVtb3ZlTGlzdGVuOiBmdW5jdGlvbiAoIHByb3RvICkge1xyXG5cclxuICAgICAgICBsZXQgaWQgPSBSLmxpc3RlbnMuaW5kZXhPZiggcHJvdG8gKTtcclxuICAgICAgICBpZiggaWQgIT09IC0xICkgUi5saXN0ZW5zLnNwbGljZShpZCwgMSk7XHJcbiAgICAgICAgaWYoIFIubGlzdGVucy5sZW5ndGggPT09IDAgKSBSLmlzTG9vcCA9IGZhbHNlO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgYWRkTGlzdGVuOiBmdW5jdGlvbiAoIHByb3RvICkge1xyXG5cclxuICAgICAgICBsZXQgaWQgPSBSLmxpc3RlbnMuaW5kZXhPZiggcHJvdG8gKTtcclxuXHJcbiAgICAgICAgaWYoIGlkICE9PSAtMSApIHJldHVybiBmYWxzZTsgXHJcblxyXG4gICAgICAgIFIubGlzdGVucy5wdXNoKCBwcm90byApO1xyXG5cclxuICAgICAgICBpZiggIVIuaXNMb29wICl7XHJcbiAgICAgICAgICAgIFIuaXNMb29wID0gdHJ1ZTtcclxuICAgICAgICAgICAgUi5sb29wKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuXHJcbiAgICB9LFxyXG5cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IFJvb3RzID0gUjsiLCJleHBvcnQgY2xhc3MgVjIge1xyXG5cclxuXHRjb25zdHJ1Y3RvciggeCA9IDAsIHkgPSAwICkge1xyXG5cclxuXHRcdHRoaXMueCA9IHg7XHJcblx0XHR0aGlzLnkgPSB5O1xyXG5cclxuXHR9XHJcblxyXG5cdHNldCAoIHgsIHkgKSB7XHJcblxyXG5cdFx0dGhpcy54ID0geDtcclxuXHRcdHRoaXMueSA9IHk7XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHJcblx0fVxyXG5cclxuXHRkaXZpZGUgKCB2ICkge1xyXG5cclxuXHRcdHRoaXMueCAvPSB2Lng7XHJcblx0XHR0aGlzLnkgLz0gdi55O1xyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblxyXG5cdH1cclxuXHJcblx0bXVsdGlwbHkgKCB2ICkge1xyXG5cclxuXHRcdHRoaXMueCAqPSB2Lng7XHJcblx0XHR0aGlzLnkgKj0gdi55O1xyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblxyXG5cdH1cclxuXHJcblx0bXVsdGlwbHlTY2FsYXIgKCBzY2FsYXIgKSB7XHJcblxyXG5cdFx0dGhpcy54ICo9IHNjYWxhcjtcclxuXHRcdHRoaXMueSAqPSBzY2FsYXI7XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHJcblx0fVxyXG5cclxuXHRkaXZpZGVTY2FsYXIgKCBzY2FsYXIgKSB7XHJcblxyXG5cdFx0cmV0dXJuIHRoaXMubXVsdGlwbHlTY2FsYXIoIDEgLyBzY2FsYXIgKTtcclxuXHJcblx0fVxyXG5cclxuXHRsZW5ndGggKCkge1xyXG5cclxuXHRcdHJldHVybiBNYXRoLnNxcnQoIHRoaXMueCAqIHRoaXMueCArIHRoaXMueSAqIHRoaXMueSApO1xyXG5cclxuXHR9XHJcblxyXG5cdGFuZ2xlICgpIHtcclxuXHJcblx0XHQvLyBjb21wdXRlcyB0aGUgYW5nbGUgaW4gcmFkaWFucyB3aXRoIHJlc3BlY3QgdG8gdGhlIHBvc2l0aXZlIHgtYXhpc1xyXG5cclxuXHRcdHZhciBhbmdsZSA9IE1hdGguYXRhbjIoIHRoaXMueSwgdGhpcy54ICk7XHJcblxyXG5cdFx0aWYgKCBhbmdsZSA8IDAgKSBhbmdsZSArPSAyICogTWF0aC5QSTtcclxuXHJcblx0XHRyZXR1cm4gYW5nbGU7XHJcblxyXG5cdH1cclxuXHJcblx0YWRkU2NhbGFyICggcyApIHtcclxuXHJcblx0XHR0aGlzLnggKz0gcztcclxuXHRcdHRoaXMueSArPSBzO1xyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblxyXG5cdH1cclxuXHJcblx0bmVnYXRlICgpIHtcclxuXHJcblx0XHR0aGlzLnggKj0gLTE7XHJcblx0XHR0aGlzLnkgKj0gLTE7XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHJcblx0fVxyXG5cclxuXHRuZWcgKCkge1xyXG5cclxuXHRcdHRoaXMueCA9IC0xO1xyXG5cdFx0dGhpcy55ID0gLTE7XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHJcblx0fVxyXG5cclxuXHRpc1plcm8gKCkge1xyXG5cclxuXHRcdHJldHVybiAoIHRoaXMueCA9PT0gMCAmJiB0aGlzLnkgPT09IDAgKTtcclxuXHJcblx0fVxyXG5cclxuXHRjb3B5ICggdiApIHtcclxuXHJcblx0XHR0aGlzLnggPSB2Lng7XHJcblx0XHR0aGlzLnkgPSB2Lnk7XHJcblxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblxyXG5cdH1cclxuXHJcblx0ZXF1YWxzICggdiApIHtcclxuXHJcblx0XHRyZXR1cm4gKCAoIHYueCA9PT0gdGhpcy54ICkgJiYgKCB2LnkgPT09IHRoaXMueSApICk7XHJcblxyXG5cdH1cclxuXHJcblx0bmVhckVxdWFscyAoIHYsIG4gKSB7XHJcblxyXG5cdFx0cmV0dXJuICggKCB2LngudG9GaXhlZChuKSA9PT0gdGhpcy54LnRvRml4ZWQobikgKSAmJiAoIHYueS50b0ZpeGVkKG4pID09PSB0aGlzLnkudG9GaXhlZChuKSApICk7XHJcblxyXG5cdH1cclxuXHJcblx0bGVycCAoIHYsIGFscGhhICkge1xyXG5cclxuXHRcdGlmKCB2ID09PSBudWxsICl7XHJcblx0XHRcdHRoaXMueCAtPSB0aGlzLnggKiBhbHBoYTtcclxuXHRcdCAgICB0aGlzLnkgLT0gdGhpcy55ICogYWxwaGE7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0aGlzLnggKz0gKCB2LnggLSB0aGlzLnggKSAqIGFscGhhO1xyXG5cdFx0ICAgIHRoaXMueSArPSAoIHYueSAtIHRoaXMueSApICogYWxwaGE7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblxyXG5cdH1cclxuXHJcbn0iLCJcclxuaW1wb3J0IHsgUm9vdHMgfSBmcm9tICcuL1Jvb3RzJztcclxuaW1wb3J0IHsgVG9vbHMgfSBmcm9tICcuL1Rvb2xzJztcclxuaW1wb3J0IHsgVjIgfSBmcm9tICcuL1YyJztcclxuXHJcbi8qKlxyXG4gKiBAYXV0aG9yIGx0aCAvIGh0dHBzOi8vZ2l0aHViLmNvbS9sby10aFxyXG4gKi9cclxuXHJcbmNsYXNzIFByb3RvIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvciggbyA9IHt9ICkge1xyXG5cclxuICAgICAgICAvLyBpZiBpcyBvbiBndWkgb3IgZ3JvdXBcclxuICAgICAgICB0aGlzLm1haW4gPSBvLm1haW4gfHwgbnVsbDtcclxuICAgICAgICB0aGlzLmlzVUkgPSBvLmlzVUkgfHwgZmFsc2U7XHJcbiAgICAgICAgdGhpcy5ncm91cCA9IG51bGw7XHJcblxyXG4gICAgICAgIHRoaXMuaXNMaXN0ZW4gPSBmYWxzZTtcclxuICAgICAgICAvL3RoaXMucGFyZW50R3JvdXAgPSBudWxsO1xyXG5cclxuICAgICAgICB0aGlzLm9udG9wID0gby5vbnRvcCA/IG8ub250b3AgOiBmYWxzZTsgLy8gJ2JlZm9yZWJlZ2luJyAnYWZ0ZXJiZWdpbicgJ2JlZm9yZWVuZCcgJ2FmdGVyZW5kJ1xyXG5cclxuICAgICAgICB0aGlzLmNzcyA9IHRoaXMubWFpbiA/IHRoaXMubWFpbi5jc3MgOiBUb29scy5jc3M7XHJcbiAgICAgICAgdGhpcy5jb2xvcnMgPSB0aGlzLm1haW4gPyB0aGlzLm1haW4uY29sb3JzIDogVG9vbHMuY29sb3JzO1xyXG5cclxuICAgICAgICB0aGlzLmRlZmF1bHRCb3JkZXJDb2xvciA9IHRoaXMuY29sb3JzLmJvcmRlcjtcclxuICAgICAgICB0aGlzLnN2Z3MgPSBUb29scy5zdmdzO1xyXG5cclxuICAgICAgICAvLyBvbmx5IHNwYWNlIFxyXG4gICAgICAgIHRoaXMuaXNTcGFjZSA9IG8uaXNTcGFjZSB8fCBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy56b25lID0geyB4OjAsIHk6MCwgdzowLCBoOjAgfTtcclxuICAgICAgICB0aGlzLmxvY2FsID0gbmV3IFYyKCkubmVnKCk7XHJcblxyXG4gICAgICAgIHRoaXMuaXNDYW52YXNPbmx5ID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMuaXNTZWxlY3QgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgLy8gcGVyY2VudCBvZiB0aXRsZVxyXG4gICAgICAgIHRoaXMucCA9IG8ucCAhPT0gdW5kZWZpbmVkID8gby5wIDogVG9vbHMuc2l6ZS5wO1xyXG5cclxuICAgICAgICB0aGlzLncgPSB0aGlzLmlzVUkgPyB0aGlzLm1haW4uc2l6ZS53IDogVG9vbHMuc2l6ZS53O1xyXG4gICAgICAgIGlmKCBvLncgIT09IHVuZGVmaW5lZCApIHRoaXMudyA9IG8udztcclxuXHJcbiAgICAgICAgdGhpcy5oID0gdGhpcy5pc1VJID8gdGhpcy5tYWluLnNpemUuaCA6IFRvb2xzLnNpemUuaDtcclxuICAgICAgICBpZiggby5oICE9PSB1bmRlZmluZWQgKSB0aGlzLmggPSBvLmg7XHJcbiAgICAgICAgaWYoICF0aGlzLmlzU3BhY2UgKSB0aGlzLmggPSB0aGlzLmggPCAxMSA/IDExIDogdGhpcy5oO1xyXG5cclxuICAgICAgICAvLyBpZiBuZWVkIHJlc2l6ZSB3aWR0aFxyXG4gICAgICAgIHRoaXMuYXV0b1dpZHRoID0gby5hdXRvIHx8IHRydWU7XHJcblxyXG4gICAgICAgIC8vIG9wZW4gc3RhdHVcclxuICAgICAgICB0aGlzLmlzT3BlbiA9IGZhbHNlO1xyXG5cclxuICAgICAgICAvLyByYWRpdXMgZm9yIHRvb2xib3hcclxuICAgICAgICB0aGlzLnJhZGl1cyA9IG8ucmFkaXVzIHx8IHRoaXMuY29sb3JzLnJhZGl1cztcclxuXHJcbiAgICAgICAgLy8gb25seSBmb3IgbnVtYmVyXHJcbiAgICAgICAgdGhpcy5pc051bWJlciA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMubm9OZWcgPSBvLm5vTmVnIHx8IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuYWxsRXF1YWwgPSBvLmFsbEVxdWFsIHx8IGZhbHNlO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIG9ubHkgbW9zdCBzaW1wbGUgXHJcbiAgICAgICAgdGhpcy5tb25vID0gZmFsc2U7XHJcblxyXG4gICAgICAgIC8vIHN0b3AgbGlzdGVuaW5nIGZvciBlZGl0IHNsaWRlIHRleHRcclxuICAgICAgICB0aGlzLmlzRWRpdCA9IGZhbHNlO1xyXG5cclxuICAgICAgICAvLyBubyB0aXRsZSBcclxuICAgICAgICB0aGlzLnNpbXBsZSA9IG8uc2ltcGxlIHx8IGZhbHNlO1xyXG4gICAgICAgIGlmKCB0aGlzLnNpbXBsZSApIHRoaXMuc2EgPSAwO1xyXG5cclxuICAgICAgICBcclxuXHJcbiAgICAgICAgLy8gZGVmaW5lIG9iaiBzaXplXHJcbiAgICAgICAgdGhpcy5zZXRTaXplKCB0aGlzLncgKTtcclxuXHJcbiAgICAgICAgLy8gdGl0bGUgc2l6ZVxyXG4gICAgICAgIGlmKG8uc2EgIT09IHVuZGVmaW5lZCApIHRoaXMuc2EgPSBvLnNhO1xyXG4gICAgICAgIGlmKG8uc2IgIT09IHVuZGVmaW5lZCApIHRoaXMuc2IgPSBvLnNiO1xyXG5cclxuICAgICAgICBpZiggdGhpcy5zaW1wbGUgKSB0aGlzLnNiID0gdGhpcy53IC0gdGhpcy5zYTtcclxuXHJcbiAgICAgICAgLy8gbGFzdCBudW1iZXIgc2l6ZSBmb3Igc2xpZGVcclxuICAgICAgICB0aGlzLnNjID0gby5zYyA9PT0gdW5kZWZpbmVkID8gNDcgOiBvLnNjO1xyXG5cclxuICAgICAgICAvLyBmb3IgbGlzdGVuaW5nIG9iamVjdFxyXG4gICAgICAgIHRoaXMub2JqZWN0TGluayA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5pc1NlbmQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnZhbCA9IG51bGw7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQmFja2dyb3VuZFxyXG4gICAgICAgIHRoaXMuYmcgPSB0aGlzLmNvbG9ycy5iYWNrZ3JvdW5kO1xyXG4gICAgICAgIHRoaXMuYmdPdmVyID0gdGhpcy5jb2xvcnMuYmFja2dyb3VuZE92ZXI7XHJcbiAgICAgICAgaWYoIG8uYmcgIT09IHVuZGVmaW5lZCApeyB0aGlzLmJnID0gby5iZzsgdGhpcy5iZ092ZXIgPSBvLmJnOyB9XHJcbiAgICAgICAgaWYoIG8uYmdPdmVyICE9PSB1bmRlZmluZWQgKXsgdGhpcy5iZ092ZXIgPSBvLmJnT3ZlcjsgfVxyXG5cclxuICAgICAgICAvLyBGb250IENvbG9yO1xyXG4gICAgICAgIHRoaXMudGl0bGVDb2xvciA9IG8udGl0bGVDb2xvciB8fCB0aGlzLmNvbG9ycy50ZXh0O1xyXG4gICAgICAgIHRoaXMuZm9udENvbG9yID0gby5mb250Q29sb3IgfHwgdGhpcy5jb2xvcnMudGV4dDtcclxuICAgICAgICB0aGlzLmZvbnRTZWxlY3QgPSBvLmZvbnRTZWxlY3QgfHwgdGhpcy5jb2xvcnMudGV4dE92ZXI7XHJcblxyXG4gICAgICAgIGlmKCBvLmNvbG9yICE9PSB1bmRlZmluZWQgKSB0aGlzLmZvbnRDb2xvciA9IG8uY29sb3I7XHJcbiAgICAgICAgICAgIC8qeyBcclxuXHJcbiAgICAgICAgICAgIGlmKG8uY29sb3IgPT09ICduJykgby5jb2xvciA9ICcjZmYwMDAwJztcclxuXHJcbiAgICAgICAgICAgIGlmKCBvLmNvbG9yICE9PSAnbm8nICkge1xyXG4gICAgICAgICAgICAgICAgaWYoICFpc05hTihvLmNvbG9yKSApIHRoaXMuZm9udENvbG9yID0gVG9vbHMuaGV4VG9IdG1sKG8uY29sb3IpO1xyXG4gICAgICAgICAgICAgICAgZWxzZSB0aGlzLmZvbnRDb2xvciA9IG8uY29sb3I7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRpdGxlQ29sb3IgPSB0aGlzLmZvbnRDb2xvcjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICB9Ki9cclxuICAgICAgICBcclxuICAgICAgICAvKmlmKCBvLmNvbG9yICE9PSB1bmRlZmluZWQgKXsgXHJcbiAgICAgICAgICAgIGlmKCAhaXNOYU4oby5jb2xvcikgKSB0aGlzLmZvbnRDb2xvciA9IFRvb2xzLmhleFRvSHRtbChvLmNvbG9yKTtcclxuICAgICAgICAgICAgZWxzZSB0aGlzLmZvbnRDb2xvciA9IG8uY29sb3I7XHJcbiAgICAgICAgICAgIHRoaXMudGl0bGVDb2xvciA9IHRoaXMuZm9udENvbG9yO1xyXG4gICAgICAgIH0qL1xyXG5cclxuICAgICAgICB0aGlzLmNvbG9yUGx1cyA9IFRvb2xzLkNvbG9yTHVtYSggdGhpcy5mb250Q29sb3IsIDAuMyApO1xyXG5cclxuICAgICAgICB0aGlzLnR4dCA9IG8ubmFtZSB8fCAnJztcclxuICAgICAgICB0aGlzLnJlbmFtZSA9IG8ucmVuYW1lIHx8ICcnO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0ID0gby50YXJnZXQgfHwgbnVsbDtcclxuXHJcbiAgICAgICAgdGhpcy5jYWxsYmFjayA9IG8uY2FsbGJhY2sgPT09IHVuZGVmaW5lZCA/IG51bGwgOiBvLmNhbGxiYWNrO1xyXG4gICAgICAgIHRoaXMuZW5kQ2FsbGJhY2sgPSBudWxsO1xyXG5cclxuICAgICAgICBpZiggdGhpcy5jYWxsYmFjayA9PT0gbnVsbCAmJiB0aGlzLmlzVUkgJiYgdGhpcy5tYWluLmNhbGxiYWNrICE9PSBudWxsICkgdGhpcy5jYWxsYmFjayA9IHRoaXMubWFpbi5jYWxsYmFjaztcclxuXHJcbiAgICAgICAgLy8gZWxlbWVudHNcclxuICAgICAgICB0aGlzLmMgPSBbXTtcclxuXHJcbiAgICAgICAgLy8gc3R5bGUgXHJcbiAgICAgICAgdGhpcy5zID0gW107XHJcblxyXG5cclxuICAgICAgICB0aGlzLmNbMF0gPSBUb29scy5kb20oICdkaXYnLCB0aGlzLmNzcy5iYXNpYyArICdwb3NpdGlvbjpyZWxhdGl2ZTsgaGVpZ2h0OjIwcHg7IGZsb2F0OmxlZnQ7IG92ZXJmbG93OmhpZGRlbjsnKTtcclxuICAgICAgICB0aGlzLnNbMF0gPSB0aGlzLmNbMF0uc3R5bGU7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmlzVUkgKSB0aGlzLnNbMF0ubWFyZ2luQm90dG9tID0gJzFweCc7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gd2l0aCB0aXRsZVxyXG4gICAgICAgIGlmKCAhdGhpcy5zaW1wbGUgKXsgXHJcbiAgICAgICAgICAgIHRoaXMuY1sxXSA9IFRvb2xzLmRvbSggJ2RpdicsIHRoaXMuY3NzLnR4dCApO1xyXG4gICAgICAgICAgICB0aGlzLnNbMV0gPSB0aGlzLmNbMV0uc3R5bGU7XHJcbiAgICAgICAgICAgIHRoaXMuY1sxXS50ZXh0Q29udGVudCA9IHRoaXMucmVuYW1lID09PSAnJyA/IHRoaXMudHh0IDogdGhpcy5yZW5hbWU7XHJcbiAgICAgICAgICAgIHRoaXMuc1sxXS5jb2xvciA9IHRoaXMudGl0bGVDb2xvcjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKCBvLnBvcyApe1xyXG4gICAgICAgICAgICB0aGlzLnNbMF0ucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xyXG4gICAgICAgICAgICBmb3IobGV0IHAgaW4gby5wb3Mpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zWzBdW3BdID0gby5wb3NbcF07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5tb25vID0gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKCBvLmNzcyApIHRoaXMuc1swXS5jc3NUZXh0ID0gby5jc3M7IFxyXG4gICAgICAgIFxyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBtYWtlIHRoZSBub2RlXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICBcclxuICAgIGluaXQgKCkge1xyXG5cclxuICAgICAgICB0aGlzLnpvbmUuaCA9IHRoaXMuaDtcclxuXHJcbiAgICAgICAgbGV0IHMgPSB0aGlzLnM7IC8vIHN0eWxlIGNhY2hlXHJcbiAgICAgICAgbGV0IGMgPSB0aGlzLmM7IC8vIGRpdiBjYWNoXHJcblxyXG4gICAgICAgIHNbMF0uaGVpZ2h0ID0gdGhpcy5oICsgJ3B4JztcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuaXNVSSAgKSBzWzBdLmJhY2tncm91bmQgPSB0aGlzLmJnO1xyXG4gICAgICAgIC8vaWYoIHRoaXMuaXNTcGFjZSAgKSBzWzBdLmJhY2tncm91bmQgPSAnbm9uZSc7XHJcblxyXG4gICAgICAgIC8vaWYoIHRoaXMuYXV0b0hlaWdodCApIHNbMF0udHJhbnNpdGlvbiA9ICdoZWlnaHQgMC4wMXMgZWFzZS1vdXQnO1xyXG4gICAgICAgIGlmKCBjWzFdICE9PSB1bmRlZmluZWQgJiYgdGhpcy5hdXRvV2lkdGggKXtcclxuICAgICAgICAgICAgc1sxXSA9IGNbMV0uc3R5bGU7XHJcbiAgICAgICAgICAgIHNbMV0uaGVpZ2h0ID0gKHRoaXMuaC00KSArICdweCc7XHJcbiAgICAgICAgICAgIHNbMV0ubGluZUhlaWdodCA9ICh0aGlzLmgtOCkgKyAncHgnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IGZyYWcgPSBUb29scy5mcmFnO1xyXG5cclxuICAgICAgICBmb3IoIGxldCBpID0gMSwgbG5nID0gYy5sZW5ndGg7IGkgIT09IGxuZzsgaSsrICl7XHJcbiAgICAgICAgICAgIGlmKCBjW2ldICE9PSB1bmRlZmluZWQgKSB7XHJcbiAgICAgICAgICAgICAgICBmcmFnLmFwcGVuZENoaWxkKCBjW2ldICk7XHJcbiAgICAgICAgICAgICAgICBzW2ldID0gY1tpXS5zdHlsZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IHBwID0gdGhpcy50YXJnZXQgIT09IG51bGwgPyB0aGlzLnRhcmdldCA6ICh0aGlzLmlzVUkgPyB0aGlzLm1haW4uaW5uZXIgOiBkb2N1bWVudC5ib2R5KTtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMub250b3AgKSBwcC5pbnNlcnRBZGphY2VudEVsZW1lbnQoICdhZnRlcmJlZ2luJywgY1swXSApO1xyXG4gICAgICAgIGVsc2UgcHAuYXBwZW5kQ2hpbGQoIGNbMF0gKTtcclxuXHJcbiAgICAgICAgXHJcblxyXG4gICAgICAgIC8qaWYoIHRoaXMudGFyZ2V0ICE9PSBudWxsICl7IFxyXG4gICAgICAgICAgICB0aGlzLnRhcmdldC5hcHBlbmRDaGlsZCggY1swXSApO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmKCB0aGlzLmlzVUkgKSB0aGlzLm1haW4uaW5uZXIuYXBwZW5kQ2hpbGQoIGNbMF0gKTtcclxuICAgICAgICAgICAgZWxzZSBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKCBjWzBdICk7XHJcbiAgICAgICAgfSovXHJcblxyXG4gICAgICAgIGNbMF0uYXBwZW5kQ2hpbGQoIGZyYWcgKTtcclxuXHJcbiAgICAgICAgdGhpcy5yU2l6ZSgpO1xyXG5cclxuICAgICAgICAvLyAhIHNvbG8gcHJvdG9cclxuICAgICAgICBpZiggIXRoaXMuaXNVSSApe1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jWzBdLnN0eWxlLnBvaW50ZXJFdmVudHMgPSAnYXV0byc7XHJcbiAgICAgICAgICAgIFJvb3RzLmFkZCggdGhpcyApO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIGZyb20gVG9vbHNcclxuXHJcbiAgICBkb20gKCB0eXBlLCBjc3MsIG9iaiwgZG9tLCBpZCApIHtcclxuXHJcbiAgICAgICAgcmV0dXJuIFRvb2xzLmRvbSggdHlwZSwgY3NzLCBvYmosIGRvbSwgaWQgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgc2V0U3ZnICggZG9tLCB0eXBlLCB2YWx1ZSwgaWQsIGlkMiApIHtcclxuXHJcbiAgICAgICAgVG9vbHMuc2V0U3ZnKCBkb20sIHR5cGUsIHZhbHVlLCBpZCwgaWQyICk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHNldENzcyAoIGRvbSwgY3NzICkge1xyXG5cclxuICAgICAgICBUb29scy5zZXRDc3MoIGRvbSwgY3NzICk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGNsYW1wICggdmFsdWUsIG1pbiwgbWF4ICkge1xyXG5cclxuICAgICAgICByZXR1cm4gVG9vbHMuY2xhbXAoIHZhbHVlLCBtaW4sIG1heCApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBnZXRDb2xvclJpbmcgKCkge1xyXG5cclxuICAgICAgICBpZiggIVRvb2xzLmNvbG9yUmluZyApIFRvb2xzLm1ha2VDb2xvclJpbmcoKTtcclxuICAgICAgICByZXR1cm4gVG9vbHMuY2xvbmUoIFRvb2xzLmNvbG9yUmluZyApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBnZXRKb3lzdGljayAoIG1vZGVsICkge1xyXG5cclxuICAgICAgICBpZiggIVRvb2xzWyAnam95c3RpY2tfJysgbW9kZWwgXSApIFRvb2xzLm1ha2VKb3lzdGljayggbW9kZWwgKTtcclxuICAgICAgICByZXR1cm4gVG9vbHMuY2xvbmUoIFRvb2xzWyAnam95c3RpY2tfJysgbW9kZWwgXSApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBnZXRDaXJjdWxhciAoIG1vZGVsICkge1xyXG5cclxuICAgICAgICBpZiggIVRvb2xzLmNpcmN1bGFyICkgVG9vbHMubWFrZUNpcmN1bGFyKCBtb2RlbCApO1xyXG4gICAgICAgIHJldHVybiBUb29scy5jbG9uZSggVG9vbHMuY2lyY3VsYXIgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0S25vYiAoIG1vZGVsICkge1xyXG5cclxuICAgICAgICBpZiggIVRvb2xzLmtub2IgKSBUb29scy5tYWtlS25vYiggbW9kZWwgKTtcclxuICAgICAgICByZXR1cm4gVG9vbHMuY2xvbmUoIFRvb2xzLmtub2IgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gZnJvbSBSb290c1xyXG5cclxuICAgIGN1cnNvciAoIG5hbWUgKSB7XHJcblxyXG4gICAgICAgICBSb290cy5jdXJzb3IoIG5hbWUgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgXHJcblxyXG4gICAgLy8vLy8vLy8vXHJcblxyXG4gICAgdXBkYXRlICgpIHt9XHJcblxyXG4gICAgcmVzZXQgKCkge31cclxuXHJcbiAgICAvLy8vLy8vLy9cclxuXHJcbiAgICBnZXREb20gKCkge1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5jWzBdO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB1aW91dCAoKSB7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmlzU3BhY2UgKSByZXR1cm47XHJcblxyXG4gICAgICAgIGlmKHRoaXMucykgdGhpcy5zWzBdLmJhY2tncm91bmQgPSB0aGlzLmJnO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB1aW92ZXIgKCkge1xyXG5cclxuICAgICAgICBpZiggdGhpcy5pc1NwYWNlICkgcmV0dXJuO1xyXG5cclxuICAgICAgICBpZih0aGlzLnMpIHRoaXMuc1swXS5iYWNrZ3JvdW5kID0gdGhpcy5iZ092ZXI7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHJlbmFtZSAoIHMgKSB7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmNbMV0gIT09IHVuZGVmaW5lZCkgdGhpcy5jWzFdLnRleHRDb250ZW50ID0gcztcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbGlzdGVuICgpIHtcclxuXHJcbiAgICAgICAgdGhpcy5pc0xpc3RlbiA9IFJvb3RzLmFkZExpc3RlbiggdGhpcyApO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBsaXN0ZW5pbmcgKCkge1xyXG5cclxuICAgICAgICBpZiggdGhpcy5vYmplY3RMaW5rID09PSBudWxsICkgcmV0dXJuO1xyXG4gICAgICAgIGlmKCB0aGlzLmlzU2VuZCApIHJldHVybjtcclxuICAgICAgICBpZiggdGhpcy5pc0VkaXQgKSByZXR1cm47XHJcblxyXG4gICAgICAgIHRoaXMuc2V0VmFsdWUoIHRoaXMub2JqZWN0TGlua1sgdGhpcy52YWwgXSApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBzZXRWYWx1ZSAoIHYgKSB7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmlzTnVtYmVyICkgdGhpcy52YWx1ZSA9IHRoaXMubnVtVmFsdWUoIHYgKTtcclxuICAgICAgICAvL2Vsc2UgaWYoIHYgaW5zdGFuY2VvZiBBcnJheSAmJiB2Lmxlbmd0aCA9PT0gMSApIHYgPSB2WzBdO1xyXG4gICAgICAgIGVsc2UgdGhpcy52YWx1ZSA9IHY7XHJcbiAgICAgICAgdGhpcy51cGRhdGUoKTtcclxuXHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIHVwZGF0ZSBldmVyeSBjaGFuZ2VcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBvbkNoYW5nZSAoIGYgKSB7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmlzU3BhY2UgKSByZXR1cm47XHJcblxyXG4gICAgICAgIHRoaXMuY2FsbGJhY2sgPSBmIHx8IG51bGw7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIHVwZGF0ZSBvbmx5IG9uIGVuZFxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIG9uRmluaXNoQ2hhbmdlICggZiApIHtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuaXNTcGFjZSApIHJldHVybjtcclxuXHJcbiAgICAgICAgdGhpcy5jYWxsYmFjayA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5lbmRDYWxsYmFjayA9IGY7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHNlbmQgKCB2ICkge1xyXG5cclxuICAgICAgICB2ID0gdiB8fCB0aGlzLnZhbHVlO1xyXG4gICAgICAgIGlmKCB2IGluc3RhbmNlb2YgQXJyYXkgJiYgdi5sZW5ndGggPT09IDEgKSB2ID0gdlswXTtcclxuXHJcbiAgICAgICAgdGhpcy5pc1NlbmQgPSB0cnVlO1xyXG4gICAgICAgIGlmKCB0aGlzLm9iamVjdExpbmsgIT09IG51bGwgKSB0aGlzLm9iamVjdExpbmtbIHRoaXMudmFsIF0gPSB2O1xyXG4gICAgICAgIGlmKCB0aGlzLmNhbGxiYWNrICkgdGhpcy5jYWxsYmFjayggdiwgdGhpcy52YWwgKTtcclxuICAgICAgICB0aGlzLmlzU2VuZCA9IGZhbHNlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBzZW5kRW5kICggdiApIHtcclxuXHJcbiAgICAgICAgdiA9IHYgfHwgdGhpcy52YWx1ZTtcclxuICAgICAgICBpZiggdiBpbnN0YW5jZW9mIEFycmF5ICYmIHYubGVuZ3RoID09PSAxICkgdiA9IHZbMF07XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmVuZENhbGxiYWNrICkgdGhpcy5lbmRDYWxsYmFjayggdiApO1xyXG4gICAgICAgIGlmKCB0aGlzLm9iamVjdExpbmsgIT09IG51bGwgKSB0aGlzLm9iamVjdExpbmtbIHRoaXMudmFsIF0gPSB2O1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBjbGVhciBub2RlXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICBcclxuICAgIGNsZWFyICggbm9mdWxsICkge1xyXG5cclxuICAgICAgICBpZiggdGhpcy5pc0xpc3RlbiApIFJvb3RzLnJlbW92ZUxpc3RlbiggdGhpcyApO1xyXG5cclxuICAgICAgICBUb29scy5jbGVhciggdGhpcy5jWzBdICk7XHJcblxyXG4gICAgICAgIGlmKCAhbm9mdWxsICl7XHJcblxyXG4gICAgICAgICAgICBpZiggdGhpcy50YXJnZXQgIT09IG51bGwgKXsgXHJcblxyXG4gICAgICAgICAgICAgICAgaWYoIHRoaXMuZ3JvdXAgIT09IG51bGwgICkgdGhpcy5ncm91cC5jbGVhck9uZSggdGhpcyApO1xyXG4gICAgICAgICAgICAgICAgZWxzZSB0aGlzLnRhcmdldC5yZW1vdmVDaGlsZCggdGhpcy5jWzBdICk7XHJcblxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKCB0aGlzLmlzVUkgKSB0aGlzLm1haW4uY2xlYXJPbmUoIHRoaXMgKTtcclxuICAgICAgICAgICAgICAgIGVsc2UgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZCggdGhpcy5jWzBdICk7XHJcblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiggIXRoaXMuaXNVSSApIFJvb3RzLnJlbW92ZSggdGhpcyApO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuYyA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5zID0gbnVsbDtcclxuICAgICAgICB0aGlzLmNhbGxiYWNrID0gbnVsbDtcclxuICAgICAgICB0aGlzLnRhcmdldCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5pc0xpc3RlbiA9IGZhbHNlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBjaGFuZ2Ugc2l6ZSBcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBzZXRTaXplICggc3ggKSB7XHJcblxyXG4gICAgICAgIGlmKCAhdGhpcy5hdXRvV2lkdGggKSByZXR1cm47XHJcblxyXG4gICAgICAgIHRoaXMudyA9IHN4O1xyXG5cclxuICAgICAgICBpZiggdGhpcy5zaW1wbGUgKXtcclxuICAgICAgICAgICAgdGhpcy5zYiA9IHRoaXMudyAtIHRoaXMuc2E7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbGV0IHBwID0gdGhpcy53ICogKCB0aGlzLnAgLyAxMDAgKTtcclxuICAgICAgICAgICAgdGhpcy5zYSA9IE1hdGguZmxvb3IoIHBwICsgMTAgKTtcclxuICAgICAgICAgICAgdGhpcy5zYiA9IE1hdGguZmxvb3IoIHRoaXMudyAtIHBwIC0gMjAgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHJTaXplICgpIHtcclxuXHJcbiAgICAgICAgaWYoICF0aGlzLmF1dG9XaWR0aCApIHJldHVybjtcclxuICAgICAgICB0aGlzLnNbMF0ud2lkdGggPSB0aGlzLncgKyAncHgnO1xyXG4gICAgICAgIGlmKCAhdGhpcy5zaW1wbGUgKSB0aGlzLnNbMV0ud2lkdGggPSB0aGlzLnNhICsgJ3B4JztcclxuICAgIFxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIGZvciBudW1lcmljIHZhbHVlXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgc2V0VHlwZU51bWJlciAoIG8gKSB7XHJcblxyXG4gICAgICAgIHRoaXMuaXNOdW1iZXIgPSB0cnVlO1xyXG5cclxuICAgICAgICB0aGlzLnZhbHVlID0gMDtcclxuICAgICAgICBpZihvLnZhbHVlICE9PSB1bmRlZmluZWQpe1xyXG4gICAgICAgICAgICBpZiggdHlwZW9mIG8udmFsdWUgPT09ICdzdHJpbmcnICkgdGhpcy52YWx1ZSA9IG8udmFsdWUgKiAxO1xyXG4gICAgICAgICAgICBlbHNlIHRoaXMudmFsdWUgPSBvLnZhbHVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5taW4gPSBvLm1pbiA9PT0gdW5kZWZpbmVkID8gLUluZmluaXR5IDogby5taW47XHJcbiAgICAgICAgdGhpcy5tYXggPSBvLm1heCA9PT0gdW5kZWZpbmVkID8gIEluZmluaXR5IDogby5tYXg7XHJcbiAgICAgICAgdGhpcy5wcmVjaXNpb24gPSBvLnByZWNpc2lvbiA9PT0gdW5kZWZpbmVkID8gMiA6IG8ucHJlY2lzaW9uO1xyXG5cclxuICAgICAgICBsZXQgcztcclxuXHJcbiAgICAgICAgc3dpdGNoKHRoaXMucHJlY2lzaW9uKXtcclxuICAgICAgICAgICAgY2FzZSAwOiBzID0gMTsgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMTogcyA9IDAuMTsgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMjogcyA9IDAuMDE7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDM6IHMgPSAwLjAwMTsgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgNDogcyA9IDAuMDAwMTsgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgNTogcyA9IDAuMDAwMDE7IGJyZWFrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5zdGVwID0gby5zdGVwID09PSB1bmRlZmluZWQgPyAgcyA6IG8uc3RlcDtcclxuICAgICAgICB0aGlzLnJhbmdlID0gdGhpcy5tYXggLSB0aGlzLm1pbjtcclxuICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy5udW1WYWx1ZSggdGhpcy52YWx1ZSApO1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIG51bVZhbHVlICggbiApIHtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMubm9OZWcgKSBuID0gTWF0aC5hYnMoIG4gKTtcclxuICAgICAgICByZXR1cm4gTWF0aC5taW4oIHRoaXMubWF4LCBNYXRoLm1heCggdGhpcy5taW4sIG4gKSApLnRvRml4ZWQoIHRoaXMucHJlY2lzaW9uICkgKiAxO1xyXG5cclxuICAgIH1cclxuXHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBFVkVOVFMgREVGQVVMVFxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIGhhbmRsZUV2ZW50ICggZSApe1xyXG5cclxuICAgICAgICBpZiggdGhpcy5pc1NwYWNlICkgcmV0dXJuO1xyXG4gICAgICAgIHJldHVybiB0aGlzW2UudHlwZV0oZSk7XHJcbiAgICBcclxuICAgIH1cclxuXHJcbiAgICB3aGVlbCAoIGUgKSB7IHJldHVybiBmYWxzZTsgfVxyXG5cclxuICAgIG1vdXNlZG93biAoIGUgKSB7IHJldHVybiBmYWxzZTsgfVxyXG5cclxuICAgIG1vdXNlbW92ZSAoIGUgKSB7IHJldHVybiBmYWxzZTsgfVxyXG5cclxuICAgIG1vdXNldXAgKCBlICkgeyByZXR1cm4gZmFsc2U7IH1cclxuXHJcbiAgICBrZXlkb3duICggZSApIHsgcmV0dXJuIGZhbHNlOyB9XHJcblxyXG4gICAgY2xpY2sgKCBlICkgeyByZXR1cm4gZmFsc2U7IH1cclxuXHJcbiAgICBrZXl1cCAoIGUgKSB7IHJldHVybiBmYWxzZTsgfVxyXG5cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBvYmplY3QgcmVmZXJlbmN5XHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgc2V0UmVmZXJlbmN5ICggb2JqLCB2YWwgKSB7XHJcblxyXG4gICAgICAgIHRoaXMub2JqZWN0TGluayA9IG9iajtcclxuICAgICAgICB0aGlzLnZhbCA9IHZhbDtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgZGlzcGxheSAoIHYgKSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdiA9IHYgfHwgZmFsc2U7XHJcbiAgICAgICAgdGhpcy5zWzBdLmRpc3BsYXkgPSB2ID8gJ2Jsb2NrJyA6ICdub25lJztcclxuICAgICAgICAvL3RoaXMuaXNSZWFkeSA9IHYgPyBmYWxzZSA6IHRydWU7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIHJlc2l6ZSBoZWlnaHQgXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgb3BlbiAoKSB7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmlzT3BlbiApIHJldHVybjtcclxuICAgICAgICB0aGlzLmlzT3BlbiA9IHRydWU7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlICgpIHtcclxuXHJcbiAgICAgICAgaWYoICF0aGlzLmlzT3BlbiApIHJldHVybjtcclxuICAgICAgICB0aGlzLmlzT3BlbiA9IGZhbHNlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBuZWVkWm9uZSAoKSB7XHJcblxyXG4gICAgICAgIFJvb3RzLm5lZWRSZVpvbmUgPSB0cnVlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICByZXpvbmUgKCkge1xyXG5cclxuICAgICAgICBSb290cy5uZWVkUmVab25lID0gdHJ1ZTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gIElOUFVUXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgc2VsZWN0ICgpIHtcclxuICAgIFxyXG4gICAgfVxyXG5cclxuICAgIHVuc2VsZWN0ICgpIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgc2V0SW5wdXQgKCBJbnB1dCApIHtcclxuICAgICAgICBcclxuICAgICAgICBSb290cy5zZXRJbnB1dCggSW5wdXQsIHRoaXMgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgdXBJbnB1dCAoIHgsIGRvd24gKSB7XHJcblxyXG4gICAgICAgIHJldHVybiBSb290cy51cElucHV0KCB4LCBkb3duICk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIHNwZWNpYWwgaXRlbSBcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBzZWxlY3RlZCAoIGIgKXtcclxuXHJcbiAgICAgICAgdGhpcy5pc1NlbGVjdCA9IGIgfHwgZmFsc2U7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgeyBQcm90byB9OyIsImltcG9ydCB7IFByb3RvIH0gZnJvbSAnLi4vY29yZS9Qcm90byc7XHJcblxyXG5leHBvcnQgY2xhc3MgQm9vbCBleHRlbmRzIFByb3RvIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvciggbyA9IHt9ICkge1xyXG5cclxuICAgICAgICBzdXBlciggbyApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMudmFsdWUgPSBvLnZhbHVlIHx8IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLmJ1dHRvbkNvbG9yID0gby5iQ29sb3IgfHwgdGhpcy5jb2xvcnMuYnV0dG9uO1xyXG5cclxuICAgICAgICB0aGlzLmluaCA9IG8uaW5oIHx8IE1hdGguZmxvb3IoIHRoaXMuaCowLjggKTtcclxuICAgICAgICB0aGlzLmludyA9IG8uaW53IHx8IDM2O1xyXG5cclxuICAgICAgICBsZXQgdCA9IE1hdGguZmxvb3IodGhpcy5oKjAuNSktKCh0aGlzLmluaC0yKSowLjUpO1xyXG5cclxuICAgICAgICB0aGlzLmNbMl0gPSB0aGlzLmRvbSggJ2RpdicsIHRoaXMuY3NzLmJhc2ljICsgJ2JhY2tncm91bmQ6JysgdGhpcy5jb2xvcnMuYm9vbGJnICsnOyBoZWlnaHQ6JysodGhpcy5pbmgtMikrJ3B4OyB3aWR0aDonK3RoaXMuaW53KydweDsgdG9wOicrdCsncHg7IGJvcmRlci1yYWRpdXM6MTBweDsgYm9yZGVyOjJweCBzb2xpZCAnK3RoaXMuYm9vbGJnICk7XHJcbiAgICAgICAgdGhpcy5jWzNdID0gdGhpcy5kb20oICdkaXYnLCB0aGlzLmNzcy5iYXNpYyArICdoZWlnaHQ6JysodGhpcy5pbmgtNikrJ3B4OyB3aWR0aDoxNnB4OyB0b3A6JysodCsyKSsncHg7IGJvcmRlci1yYWRpdXM6MTBweDsgYmFja2dyb3VuZDonK3RoaXMuYnV0dG9uQ29sb3IrJzsnICk7XHJcblxyXG4gICAgICAgIHRoaXMuaW5pdCgpO1xyXG4gICAgICAgIHRoaXMudXBkYXRlKCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vICAgRVZFTlRTXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgbW91c2Vtb3ZlICggZSApIHtcclxuXHJcbiAgICAgICAgdGhpcy5jdXJzb3IoJ3BvaW50ZXInKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW91c2Vkb3duICggZSApIHtcclxuXHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IHRoaXMudmFsdWUgPyBmYWxzZSA6IHRydWU7XHJcbiAgICAgICAgdGhpcy51cGRhdGUoKTtcclxuICAgICAgICB0aGlzLnNlbmQoKTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIHVwZGF0ZSAoKSB7XHJcblxyXG4gICAgICAgIGxldCBzID0gdGhpcy5zO1xyXG5cclxuICAgICAgICBpZiggdGhpcy52YWx1ZSApe1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgc1syXS5iYWNrZ3JvdW5kID0gdGhpcy5jb2xvcnMuYm9vbG9uO1xyXG4gICAgICAgICAgICBzWzJdLmJvcmRlckNvbG9yID0gdGhpcy5jb2xvcnMuYm9vbG9uO1xyXG4gICAgICAgICAgICBzWzNdLm1hcmdpbkxlZnQgPSAnMTdweCc7XHJcblxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBzWzJdLmJhY2tncm91bmQgPSB0aGlzLmNvbG9ycy5ib29sYmc7XHJcbiAgICAgICAgICAgIHNbMl0uYm9yZGVyQ29sb3IgPSB0aGlzLmNvbG9ycy5ib29sYmc7XHJcbiAgICAgICAgICAgIHNbM10ubWFyZ2luTGVmdCA9ICcycHgnO1xyXG5cclxuICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIHJTaXplICgpIHtcclxuXHJcbiAgICAgICAgc3VwZXIuclNpemUoKTtcclxuICAgICAgICBsZXQgcyA9IHRoaXMucztcclxuICAgICAgICBsZXQgdyA9ICh0aGlzLncgLSAxMCApIC0gdGhpcy5pbnc7XHJcbiAgICAgICAgc1syXS5sZWZ0ID0gdyArICdweCc7XHJcbiAgICAgICAgc1szXS5sZWZ0ID0gdyArICdweCc7XHJcblxyXG4gICAgfVxyXG5cclxufSIsImltcG9ydCB7IFByb3RvIH0gZnJvbSAnLi4vY29yZS9Qcm90byc7XHJcblxyXG5cclxuZXhwb3J0IGNsYXNzIEJ1dHRvbiBleHRlbmRzIFByb3RvIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvciggbyA9IHt9ICkge1xyXG5cclxuICAgICAgICBzdXBlciggbyApO1xyXG5cclxuICAgICAgICB0aGlzLnZhbHVlID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMudmFsdWVzID0gby52YWx1ZSB8fCB0aGlzLnR4dDtcclxuXHJcbiAgICAgICAgdGhpcy5vbk5hbWUgPSBvLm9uTmFtZSB8fCAnJztcclxuXHJcbiAgICAgICAgdGhpcy5vbiA9IGZhbHNlO1xyXG5cclxuICAgICAgICBpZiggdHlwZW9mIHRoaXMudmFsdWVzID09PSAnc3RyaW5nJyApIHRoaXMudmFsdWVzID0gWyB0aGlzLnZhbHVlcyBdO1xyXG5cclxuICAgICAgICAvL3RoaXMuc2VsZWN0ZWQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuaXNEb3duID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMuaXNMaW5rID0gby5saW5rIHx8IGZhbHNlO1xyXG5cclxuICAgICAgICAvLyBjdXN0b20gY29sb3JcclxuICAgICAgICB0aGlzLmNjID0gWyB0aGlzLmNvbG9ycy5idXR0b24sIHRoaXMuY29sb3JzLnNlbGVjdCwgdGhpcy5jb2xvcnMuZG93biBdO1xyXG5cclxuICAgICAgICBpZiggby5jQmcgIT09IHVuZGVmaW5lZCApIHRoaXMuY2NbMF0gPSBvLmNCZztcclxuICAgICAgICBpZiggby5iQ29sb3IgIT09IHVuZGVmaW5lZCApIHRoaXMuY2NbMF0gPSBvLmJDb2xvcjtcclxuICAgICAgICBpZiggby5jU2VsZWN0ICE9PSB1bmRlZmluZWQgKSB0aGlzLmNjWzFdID0gby5jU2VsZWN0O1xyXG4gICAgICAgIGlmKCBvLmNEb3duICE9PSB1bmRlZmluZWQgKSB0aGlzLmNjWzJdID0gby5jRG93bjtcclxuXHJcbiAgICAgICAgdGhpcy5pc0xvYWRCdXR0b24gPSBvLmxvYWRlciB8fCBmYWxzZTtcclxuICAgICAgICB0aGlzLmlzRHJhZ0J1dHRvbiA9IG8uZHJhZyB8fCBmYWxzZTtcclxuICAgICAgICBcclxuICAgICAgICBpZiggdGhpcy5pc0RyYWdCdXR0b24gKSB0aGlzLmlzTG9hZEJ1dHRvbiA9IHRydWU7XHJcblxyXG4gICAgICAgIHRoaXMubG5nID0gdGhpcy52YWx1ZXMubGVuZ3RoO1xyXG4gICAgICAgIHRoaXMudG1wID0gW107XHJcbiAgICAgICAgdGhpcy5zdGF0ID0gW107XHJcblxyXG4gICAgICAgIGZvciggbGV0IGkgPSAwOyBpIDwgdGhpcy5sbmc7IGkrKyApe1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jW2krMl0gPSB0aGlzLmRvbSggJ2RpdicsIHRoaXMuY3NzLnR4dCArIHRoaXMuY3NzLmJ1dHRvbiArICd0b3A6MXB4OyBiYWNrZ3JvdW5kOicrdGhpcy5jY1swXSsnOyBoZWlnaHQ6JysodGhpcy5oLTIpKydweDsgYm9yZGVyOicrdGhpcy5jb2xvcnMuYnV0dG9uQm9yZGVyKyc7IGJvcmRlci1yYWRpdXM6Jyt0aGlzLnJhZGl1cysncHg7JyApO1xyXG4gICAgICAgICAgICB0aGlzLmNbaSsyXS5zdHlsZS5jb2xvciA9IHRoaXMuZm9udENvbG9yO1xyXG4gICAgICAgICAgICB0aGlzLmNbaSsyXS5pbm5lckhUTUwgPSB0aGlzLnZhbHVlc1tpXTtcclxuICAgICAgICAgICAgdGhpcy5zdGF0W2ldID0gMTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiggdGhpcy5jWzFdICE9PSB1bmRlZmluZWQgKSB0aGlzLmNbMV0udGV4dENvbnRlbnQgPSAnJztcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuaXNMb2FkQnV0dG9uICkgdGhpcy5pbml0TG9hZGVyKCk7XHJcbiAgICAgICAgaWYoIHRoaXMuaXNEcmFnQnV0dG9uICl7IFxyXG4gICAgICAgICAgICB0aGlzLmxuZyArKztcclxuICAgICAgICAgICAgdGhpcy5pbml0RHJhZ2VyKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmluaXQoKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgb25PZmYgKCApe1xyXG5cclxuICAgICAgICB0aGlzLm9uID0gIXRoaXMub247XHJcbiAgICAgICAgdGhpcy5jWzJdLmlubmVySFRNTCA9IHRoaXMub24gPyB0aGlzLm9uTmFtZSA6IHRoaXMudmFsdWVzWzBdO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB0ZXN0Wm9uZSAoIGUgKSB7XHJcblxyXG4gICAgICAgIGxldCBsID0gdGhpcy5sb2NhbDtcclxuICAgICAgICBpZiggbC54ID09PSAtMSAmJiBsLnkgPT09IC0xICkgcmV0dXJuICcnO1xyXG5cclxuICAgICAgICBsZXQgaSA9IHRoaXMubG5nO1xyXG4gICAgICAgIGxldCB0ID0gdGhpcy50bXA7XHJcbiAgICAgICAgXHJcbiAgICAgICAgd2hpbGUoIGktLSApe1xyXG4gICAgICAgIFx0aWYoIGwueD50W2ldWzBdICYmIGwueDx0W2ldWzJdICkgcmV0dXJuIGkrMjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiAnJ1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyAgIEVWRU5UU1xyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIGNsaWNrICggZSApIHtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMub25OYW1lIT09ICcnICkgdGhpcy5vbk9mZigpO1xyXG5cclxuICAgICAgICBpZiggdGhpcy5pc0xpbmsgKXtcclxuXHJcbiAgICAgICAgICAgIGxldCBuYW1lID0gdGhpcy50ZXN0Wm9uZSggZSApO1xyXG4gICAgICAgICAgICBpZiggIW5hbWUgKSByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy52YWx1ZXNbbmFtZS0yXVxyXG4gICAgICAgICAgICB0aGlzLnNlbmQoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVzZXQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vdXNldXAgKCBlICkge1xyXG4gICAgXHJcbiAgICAgICAgaWYoIHRoaXMuaXNEb3duICl7XHJcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5pc0Rvd24gPSBmYWxzZTtcclxuICAgICAgICAgICAgLy90aGlzLnNlbmQoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubW91c2Vtb3ZlKCBlICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vdXNlZG93biAoIGUgKSB7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmlzTGluayApIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICBcdGxldCBuYW1lID0gdGhpcy50ZXN0Wm9uZSggZSApO1xyXG5cclxuICAgICAgICBpZiggIW5hbWUgKSByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgXHR0aGlzLmlzRG93biA9IHRydWU7XHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IHRoaXMudmFsdWVzW25hbWUtMl1cclxuICAgICAgICBpZiggIXRoaXMuaXNMb2FkQnV0dG9uICkgdGhpcy5zZW5kKCk7XHJcbiAgICAgICAgLy9lbHNlIHRoaXMuZmlsZVNlbGVjdCggZS50YXJnZXQuZmlsZXNbMF0gKTtcclxuICAgIFx0cmV0dXJuIHRoaXMubW91c2Vtb3ZlKCBlICk7XHJcbiBcclxuICAgICAgICAvLyB0cnVlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb3VzZW1vdmUgKCBlICkge1xyXG5cclxuICAgICAgICBsZXQgdXAgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgbGV0IG5hbWUgPSB0aGlzLnRlc3Rab25lKCBlICk7XHJcblxyXG4gICAgICAgLy8gY29uc29sZS5sb2cobmFtZSlcclxuXHJcbiAgICAgICAgaWYoIG5hbWUgIT09ICcnICl7XHJcbiAgICAgICAgICAgIHRoaXMuY3Vyc29yKCdwb2ludGVyJyk7XHJcbiAgICAgICAgICAgIHVwID0gdGhpcy5tb2RlcyggdGhpcy5pc0Rvd24gPyAzIDogMiwgbmFtZSApO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgXHR1cCA9IHRoaXMucmVzZXQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vY29uc29sZS5sb2codXApXHJcblxyXG4gICAgICAgIHJldHVybiB1cDtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIG1vZGVzICggbiwgbmFtZSApIHtcclxuXHJcbiAgICAgICAgbGV0IHYsIHIgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgZm9yKCBsZXQgaSA9IDA7IGkgPCB0aGlzLmxuZzsgaSsrICl7XHJcblxyXG4gICAgICAgICAgICBpZiggaSA9PT0gbmFtZS0yICkgdiA9IHRoaXMubW9kZSggbiwgaSsyICk7XHJcbiAgICAgICAgICAgIGVsc2UgdiA9IHRoaXMubW9kZSggMSwgaSsyICk7XHJcblxyXG4gICAgICAgICAgICBpZih2KSByID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcjtcclxuXHJcbiAgICB9XHJcblxyXG5cclxuICAgIG1vZGUgKCBuLCBuYW1lICkge1xyXG5cclxuICAgICAgICBsZXQgY2hhbmdlID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGxldCBpID0gbmFtZSAtIDI7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLnN0YXRbaV0gIT09IG4gKXtcclxuICAgICAgICBcclxuICAgICAgICAgICAgc3dpdGNoKCBuICl7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSAxOiB0aGlzLnN0YXRbaV0gPSAxOyB0aGlzLnNbIGkrMiBdLmNvbG9yID0gdGhpcy5mb250Q29sb3I7IHRoaXMuc1sgaSsyIF0uYmFja2dyb3VuZCA9IHRoaXMuY2NbMF07IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAyOiB0aGlzLnN0YXRbaV0gPSAyOyB0aGlzLnNbIGkrMiBdLmNvbG9yID0gdGhpcy5mb250U2VsZWN0OyB0aGlzLnNbIGkrMiBdLmJhY2tncm91bmQgPSB0aGlzLmNjWzFdOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgMzogdGhpcy5zdGF0W2ldID0gMzsgdGhpcy5zWyBpKzIgXS5jb2xvciA9IHRoaXMuZm9udFNlbGVjdDsgdGhpcy5zWyBpKzIgXS5iYWNrZ3JvdW5kID0gdGhpcy5jY1syXTsgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjaGFuZ2UgPSB0cnVlO1xyXG5cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcblxyXG4gICAgICAgIHJldHVybiBjaGFuZ2U7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICByZXNldCAoKSB7XHJcblxyXG4gICAgICAgIHRoaXMuY3Vyc29yKCk7XHJcblxyXG4gICAgICAgIC8qbGV0IHYsIHIgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgZm9yKCBsZXQgaSA9IDA7IGkgPCB0aGlzLmxuZzsgaSsrICl7XHJcbiAgICAgICAgICAgIHYgPSB0aGlzLm1vZGUoIDEsIGkrMiApO1xyXG4gICAgICAgICAgICBpZih2KSByID0gdHJ1ZTtcclxuICAgICAgICB9Ki9cclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMubW9kZXMoIDEgLCAyICk7XHJcblxyXG4gICAgXHQvKmlmKCB0aGlzLnNlbGVjdGVkICl7XHJcbiAgICBcdFx0dGhpcy5zWyB0aGlzLnNlbGVjdGVkIF0uY29sb3IgPSB0aGlzLmZvbnRDb2xvcjtcclxuICAgICAgICAgICAgdGhpcy5zWyB0aGlzLnNlbGVjdGVkIF0uYmFja2dyb3VuZCA9IHRoaXMuYnV0dG9uQ29sb3I7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWQgPSBudWxsO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICBcdH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7Ki9cclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIGRyYWdvdmVyICggZSApIHtcclxuXHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICB0aGlzLnNbNF0uYm9yZGVyQ29sb3IgPSB0aGlzLmNvbG9ycy5zZWxlY3Q7XHJcbiAgICAgICAgdGhpcy5zWzRdLmNvbG9yID0gdGhpcy5jb2xvcnMuc2VsZWN0O1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBkcmFnZW5kICggZSApIHtcclxuXHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICB0aGlzLnNbNF0uYm9yZGVyQ29sb3IgPSB0aGlzLmZvbnRDb2xvcjtcclxuICAgICAgICB0aGlzLnNbNF0uY29sb3IgPSB0aGlzLmZvbnRDb2xvcjtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgZHJvcCAoIGUgKSB7XHJcblxyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgdGhpcy5kcmFnZW5kKGUpO1xyXG4gICAgICAgIHRoaXMuZmlsZVNlbGVjdCggZS5kYXRhVHJhbnNmZXIuZmlsZXNbMF0gKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgaW5pdERyYWdlciAoKSB7XHJcblxyXG4gICAgICAgIHRoaXMuY1s0XSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MudHh0ICsnIHRleHQtYWxpZ246Y2VudGVyOyBsaW5lLWhlaWdodDonKyh0aGlzLmgtOCkrJ3B4OyBib3JkZXI6MXB4IGRhc2hlZCAnK3RoaXMuZm9udENvbG9yKyc7IHRvcDoycHg7ICBoZWlnaHQ6JysodGhpcy5oLTQpKydweDsgYm9yZGVyLXJhZGl1czonK3RoaXMucmFkaXVzKydweDsgcG9pbnRlci1ldmVudHM6YXV0bzsnICk7Ly8gY3Vyc29yOmRlZmF1bHQ7XHJcbiAgICAgICAgdGhpcy5jWzRdLnRleHRDb250ZW50ID0gJ0RSQUcnO1xyXG5cclxuICAgICAgICB0aGlzLmNbNF0uYWRkRXZlbnRMaXN0ZW5lciggJ2RyYWdvdmVyJywgZnVuY3Rpb24oZSl7IHRoaXMuZHJhZ292ZXIoZSk7IH0uYmluZCh0aGlzKSwgZmFsc2UgKTtcclxuICAgICAgICB0aGlzLmNbNF0uYWRkRXZlbnRMaXN0ZW5lciggJ2RyYWdlbmQnLCBmdW5jdGlvbihlKXsgdGhpcy5kcmFnZW5kKGUpOyB9LmJpbmQodGhpcyksIGZhbHNlICk7XHJcbiAgICAgICAgdGhpcy5jWzRdLmFkZEV2ZW50TGlzdGVuZXIoICdkcmFnbGVhdmUnLCBmdW5jdGlvbihlKXsgdGhpcy5kcmFnZW5kKGUpOyB9LmJpbmQodGhpcyksIGZhbHNlICk7XHJcbiAgICAgICAgdGhpcy5jWzRdLmFkZEV2ZW50TGlzdGVuZXIoICdkcm9wJywgZnVuY3Rpb24oZSl7IHRoaXMuZHJvcChlKTsgfS5iaW5kKHRoaXMpLCBmYWxzZSApO1xyXG5cclxuICAgICAgICAvL3RoaXMuY1syXS5ldmVudHMgPSBbICBdO1xyXG4gICAgICAgIC8vdGhpcy5jWzRdLmV2ZW50cyA9IFsgJ2RyYWdvdmVyJywgJ2RyYWdlbmQnLCAnZHJhZ2xlYXZlJywgJ2Ryb3AnIF07XHJcblxyXG5cclxuICAgIH1cclxuXHJcbiAgICBpbml0TG9hZGVyICgpIHtcclxuXHJcbiAgICAgICAgdGhpcy5jWzNdID0gdGhpcy5kb20oICdpbnB1dCcsIHRoaXMuY3NzLmJhc2ljICsndG9wOjBweDsgb3BhY2l0eTowOyBoZWlnaHQ6JysodGhpcy5oKSsncHg7IHBvaW50ZXItZXZlbnRzOmF1dG87IGN1cnNvcjpwb2ludGVyOycgKTsvL1xyXG4gICAgICAgIHRoaXMuY1szXS5uYW1lID0gJ2xvYWRlcic7XHJcbiAgICAgICAgdGhpcy5jWzNdLnR5cGUgPSBcImZpbGVcIjtcclxuXHJcbiAgICAgICAgdGhpcy5jWzNdLmFkZEV2ZW50TGlzdGVuZXIoICdjaGFuZ2UnLCBmdW5jdGlvbihlKXsgdGhpcy5maWxlU2VsZWN0KCBlLnRhcmdldC5maWxlc1swXSApOyB9LmJpbmQodGhpcyksIGZhbHNlICk7XHJcbiAgICAgICAgLy90aGlzLmNbM10uYWRkRXZlbnRMaXN0ZW5lciggJ21vdXNlZG93bicsIGZ1bmN0aW9uKGUpeyAgfS5iaW5kKHRoaXMpLCBmYWxzZSApO1xyXG5cclxuICAgICAgICAvL3RoaXMuY1syXS5ldmVudHMgPSBbICBdO1xyXG4gICAgICAgIC8vdGhpcy5jWzNdLmV2ZW50cyA9IFsgJ2NoYW5nZScsICdtb3VzZW92ZXInLCAnbW91c2Vkb3duJywgJ21vdXNldXAnLCAnbW91c2VvdXQnIF07XHJcblxyXG4gICAgICAgIC8vdGhpcy5oaWRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgZmlsZVNlbGVjdCAoIGZpbGUgKSB7XHJcblxyXG4gICAgICAgIGxldCBkYXRhVXJsID0gWyAncG5nJywgJ2pwZycsICdtcDQnLCAnd2VibScsICdvZ2cnIF07XHJcbiAgICAgICAgbGV0IGRhdGFCdWYgPSBbICdzZWEnLCAneicsICdoZXgnLCAnYnZoJywgJ0JWSCcsICdnbGInIF07XHJcblxyXG4gICAgICAgIC8vaWYoICEgZS50YXJnZXQuZmlsZXMgKSByZXR1cm47XHJcblxyXG4gICAgICAgIC8vbGV0IGZpbGUgPSBlLnRhcmdldC5maWxlc1swXTtcclxuICAgICAgIFxyXG4gICAgICAgIC8vdGhpcy5jWzNdLnR5cGUgPSBcIm51bGxcIjtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyggdGhpcy5jWzRdIClcclxuXHJcbiAgICAgICAgaWYoIGZpbGUgPT09IHVuZGVmaW5lZCApIHJldHVybjtcclxuXHJcbiAgICAgICAgbGV0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XHJcbiAgICAgICAgbGV0IGZuYW1lID0gZmlsZS5uYW1lO1xyXG4gICAgICAgIGxldCB0eXBlID0gZm5hbWUuc3Vic3RyaW5nKGZuYW1lLmxhc3RJbmRleE9mKCcuJykrMSwgZm5hbWUubGVuZ3RoICk7XHJcblxyXG4gICAgICAgIGlmKCBkYXRhVXJsLmluZGV4T2YoIHR5cGUgKSAhPT0gLTEgKSByZWFkZXIucmVhZEFzRGF0YVVSTCggZmlsZSApO1xyXG4gICAgICAgIGVsc2UgaWYoIGRhdGFCdWYuaW5kZXhPZiggdHlwZSApICE9PSAtMSApIHJlYWRlci5yZWFkQXNBcnJheUJ1ZmZlciggZmlsZSApOy8vcmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKCBmaWxlICk7XHJcbiAgICAgICAgZWxzZSByZWFkZXIucmVhZEFzVGV4dCggZmlsZSApO1xyXG5cclxuICAgICAgICAvLyBpZiggdHlwZSA9PT0gJ3BuZycgfHwgdHlwZSA9PT0gJ2pwZycgfHwgdHlwZSA9PT0gJ21wNCcgfHwgdHlwZSA9PT0gJ3dlYm0nIHx8IHR5cGUgPT09ICdvZ2cnICkgcmVhZGVyLnJlYWRBc0RhdGFVUkwoIGZpbGUgKTtcclxuICAgICAgICAvL2Vsc2UgaWYoIHR5cGUgPT09ICd6JyApIHJlYWRlci5yZWFkQXNCaW5hcnlTdHJpbmcoIGZpbGUgKTtcclxuICAgICAgICAvL2Vsc2UgaWYoIHR5cGUgPT09ICdzZWEnIHx8IHR5cGUgPT09ICdidmgnIHx8IHR5cGUgPT09ICdCVkgnIHx8IHR5cGUgPT09ICd6JykgcmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKCBmaWxlICk7XHJcbiAgICAgICAgLy9lbHNlIGlmKCAgKSByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoIGZpbGUgKTtcclxuICAgICAgICAvL2Vsc2UgcmVhZGVyLnJlYWRBc1RleHQoIGZpbGUgKTtcclxuXHJcbiAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiggdGhpcy5jYWxsYmFjayApIHRoaXMuY2FsbGJhY2soIGUudGFyZ2V0LnJlc3VsdCwgZm5hbWUsIHR5cGUgKTtcclxuICAgICAgICAgICAgLy90aGlzLmNbM10udHlwZSA9IFwiZmlsZVwiO1xyXG4gICAgICAgICAgICAvL3RoaXMuc2VuZCggZS50YXJnZXQucmVzdWx0ICk7IFxyXG4gICAgICAgIH0uYmluZCh0aGlzKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbGFiZWwgKCBzdHJpbmcsIG4gKSB7XHJcblxyXG4gICAgICAgIG4gPSBuIHx8IDI7XHJcbiAgICAgICAgdGhpcy5jW25dLnRleHRDb250ZW50ID0gc3RyaW5nO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBpY29uICggc3RyaW5nLCB5LCBuICkge1xyXG5cclxuICAgICAgICBuID0gbiB8fCAyO1xyXG4gICAgICAgIHRoaXMuc1tuXS5wYWRkaW5nID0gKCB5IHx8IDAgKSArJ3B4IDBweCc7XHJcbiAgICAgICAgdGhpcy5jW25dLmlubmVySFRNTCA9IHN0cmluZztcclxuXHJcbiAgICB9XHJcblxyXG4gICAgclNpemUgKCkge1xyXG5cclxuICAgICAgICBzdXBlci5yU2l6ZSgpO1xyXG5cclxuICAgICAgICBsZXQgcyA9IHRoaXMucztcclxuICAgICAgICBsZXQgdyA9IHRoaXMuc2I7XHJcbiAgICAgICAgbGV0IGQgPSB0aGlzLnNhO1xyXG5cclxuICAgICAgICBsZXQgaSA9IHRoaXMubG5nO1xyXG4gICAgICAgIGxldCBkYyA9ICAzO1xyXG4gICAgICAgIGxldCBzaXplID0gTWF0aC5mbG9vciggKCB3LShkYyooaS0xKSkgKSAvIGkgKTtcclxuXHJcbiAgICAgICAgd2hpbGUoIGktLSApe1xyXG5cclxuICAgICAgICBcdHRoaXMudG1wW2ldID0gWyBNYXRoLmZsb29yKCBkICsgKCBzaXplICogaSApICsgKCBkYyAqIGkgKSksIHNpemUgXTtcclxuICAgICAgICBcdHRoaXMudG1wW2ldWzJdID0gdGhpcy50bXBbaV1bMF0gKyB0aGlzLnRtcFtpXVsxXTtcclxuXHJcbiAgICAgICAgICAgIHNbaSsyXS5sZWZ0ID0gdGhpcy50bXBbaV1bMF0gKyAncHgnO1xyXG4gICAgICAgICAgICBzW2krMl0ud2lkdGggPSB0aGlzLnRtcFtpXVsxXSArICdweCc7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoIHRoaXMuaXNEcmFnQnV0dG9uICl7IFxyXG4gICAgICAgICAgICBzWzRdLmxlZnQgPSAoZCtzaXplK2RjKSArICdweCc7XHJcbiAgICAgICAgICAgIHNbNF0ud2lkdGggPSBzaXplICsgJ3B4JztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmlzTG9hZEJ1dHRvbiApe1xyXG4gICAgICAgICAgICBzWzNdLmxlZnQgPSBkICsgJ3B4JztcclxuICAgICAgICAgICAgc1szXS53aWR0aCA9IHNpemUgKyAncHgnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG59IiwiaW1wb3J0IHsgUHJvdG8gfSBmcm9tICcuLi9jb3JlL1Byb3RvJztcclxuaW1wb3J0IHsgVjIgfSBmcm9tICcuLi9jb3JlL1YyJztcclxuXHJcbmV4cG9ydCBjbGFzcyBDaXJjdWxhciBleHRlbmRzIFByb3RvIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvciggbyA9IHt9ICkge1xyXG5cclxuICAgICAgICBzdXBlciggbyApO1xyXG5cclxuICAgICAgICB0aGlzLmF1dG9XaWR0aCA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLmJ1dHRvbkNvbG9yID0gdGhpcy5jb2xvcnMuYnV0dG9uO1xyXG5cclxuICAgICAgICB0aGlzLnNldFR5cGVOdW1iZXIoIG8gKTtcclxuXHJcbiAgICAgICAgdGhpcy5yYWRpdXMgPSB0aGlzLncgKiAwLjU7Ly9NYXRoLmZsb29yKCh0aGlzLnctMjApKjAuNSk7XHJcblxyXG4gICAgICAgIHRoaXMudHdvUGkgPSBNYXRoLlBJICogMjtcclxuICAgICAgICB0aGlzLnBpOTAgPSBNYXRoLlBJICogMC41O1xyXG5cclxuICAgICAgICB0aGlzLm9mZnNldCA9IG5ldyBWMigpO1xyXG5cclxuICAgICAgICB0aGlzLmggPSBvLmggfHwgdGhpcy53ICsgMTA7XHJcbiAgICAgICAgdGhpcy50b3AgPSAwO1xyXG5cclxuICAgICAgICB0aGlzLmNbMF0uc3R5bGUud2lkdGggPSB0aGlzLncgKydweCc7XHJcblxyXG4gICAgICAgIGlmKHRoaXMuY1sxXSAhPT0gdW5kZWZpbmVkKSB7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmNbMV0uc3R5bGUud2lkdGggPSB0aGlzLncgKydweCc7XHJcbiAgICAgICAgICAgIHRoaXMuY1sxXS5zdHlsZS50ZXh0QWxpZ24gPSAnY2VudGVyJztcclxuICAgICAgICAgICAgdGhpcy50b3AgPSAxMDtcclxuICAgICAgICAgICAgdGhpcy5oICs9IDEwO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucGVyY2VudCA9IDA7XHJcblxyXG4gICAgICAgIHRoaXMuY21vZGUgPSAwO1xyXG5cclxuICAgICAgICB0aGlzLmNbMl0gPSB0aGlzLmRvbSggJ2RpdicsIHRoaXMuY3NzLnR4dCArICd0ZXh0LWFsaWduOmNlbnRlcjsgdG9wOicrKHRoaXMuaC0yMCkrJ3B4OyB3aWR0aDonK3RoaXMudysncHg7IGNvbG9yOicrIHRoaXMuZm9udENvbG9yICk7XHJcbiAgICAgICAgdGhpcy5jWzNdID0gdGhpcy5nZXRDaXJjdWxhcigpO1xyXG5cclxuICAgICAgICB0aGlzLnNldFN2ZyggdGhpcy5jWzNdLCAnZCcsIHRoaXMubWFrZVBhdGgoKSwgMSApO1xyXG4gICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdzdHJva2UnLCB0aGlzLmZvbnRDb2xvciwgMSApO1xyXG5cclxuICAgICAgICB0aGlzLnNldFN2ZyggdGhpcy5jWzNdLCAndmlld0JveCcsICcwIDAgJyt0aGlzLncrJyAnK3RoaXMudyApO1xyXG4gICAgICAgIHRoaXMuc2V0Q3NzKCB0aGlzLmNbM10sIHsgd2lkdGg6dGhpcy53LCBoZWlnaHQ6dGhpcy53LCBsZWZ0OjAsIHRvcDp0aGlzLnRvcCB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5pbml0KCk7XHJcbiAgICAgICAgdGhpcy51cGRhdGUoKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW9kZSAoIG1vZGUgKSB7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmNtb2RlID09PSBtb2RlICkgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICBzd2l0Y2goIG1vZGUgKXtcclxuICAgICAgICAgICAgY2FzZSAwOiAvLyBiYXNlXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNbMl0uY29sb3IgPSB0aGlzLmZvbnRDb2xvcjtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdzdHJva2UnLCdyZ2JhKDAsMCwwLDAuMSknLCAwKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdzdHJva2UnLCB0aGlzLmZvbnRDb2xvciwgMSApO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAxOiAvLyBvdmVyXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNbMl0uY29sb3IgPSB0aGlzLmNvbG9yUGx1cztcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdzdHJva2UnLCdyZ2JhKDAsMCwwLDAuMyknLCAwKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdzdHJva2UnLCB0aGlzLmNvbG9yUGx1cywgMSApO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuY21vZGUgPSBtb2RlO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG5cclxuICAgIH1cclxuXHJcblxyXG4gICAgcmVzZXQgKCkge1xyXG5cclxuICAgICAgICB0aGlzLmlzRG93biA9IGZhbHNlO1xyXG4gICAgICAgIFxyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyAgIEVWRU5UU1xyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIG1vdXNldXAgKCBlICkge1xyXG5cclxuICAgICAgICB0aGlzLmlzRG93biA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuc2VuZEVuZCgpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLm1vZGUoMCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vdXNlZG93biAoIGUgKSB7XHJcblxyXG4gICAgICAgIHRoaXMuaXNEb3duID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLm9sZCA9IHRoaXMudmFsdWU7XHJcbiAgICAgICAgdGhpcy5vbGRyID0gbnVsbDtcclxuICAgICAgICB0aGlzLm1vdXNlbW92ZSggZSApO1xyXG4gICAgICAgIHJldHVybiB0aGlzLm1vZGUoMSk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vdXNlbW92ZSAoIGUgKSB7XHJcblxyXG4gICAgICAgIC8vdGhpcy5tb2RlKDEpO1xyXG5cclxuICAgICAgICBpZiggIXRoaXMuaXNEb3duICkgcmV0dXJuO1xyXG5cclxuICAgICAgICB2YXIgb2ZmID0gdGhpcy5vZmZzZXQ7XHJcblxyXG4gICAgICAgIG9mZi54ID0gdGhpcy5yYWRpdXMgLSAoZS5jbGllbnRYIC0gdGhpcy56b25lLnggKTtcclxuICAgICAgICBvZmYueSA9IHRoaXMucmFkaXVzIC0gKGUuY2xpZW50WSAtIHRoaXMuem9uZS55IC0gdGhpcy50b3AgKTtcclxuXHJcbiAgICAgICAgdGhpcy5yID0gb2ZmLmFuZ2xlKCkgLSB0aGlzLnBpOTA7XHJcbiAgICAgICAgdGhpcy5yID0gKCgodGhpcy5yJXRoaXMudHdvUGkpK3RoaXMudHdvUGkpJXRoaXMudHdvUGkpO1xyXG5cclxuICAgICAgICBpZiggdGhpcy5vbGRyICE9PSBudWxsICl7IFxyXG5cclxuICAgICAgICAgICAgdmFyIGRpZiA9IHRoaXMuciAtIHRoaXMub2xkcjtcclxuICAgICAgICAgICAgdGhpcy5yID0gTWF0aC5hYnMoZGlmKSA+IE1hdGguUEkgPyB0aGlzLm9sZHIgOiB0aGlzLnI7XHJcblxyXG4gICAgICAgICAgICBpZiggZGlmID4gNiApIHRoaXMuciA9IDA7XHJcbiAgICAgICAgICAgIGlmKCBkaWYgPCAtNiApIHRoaXMuciA9IHRoaXMudHdvUGk7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHN0ZXBzID0gMSAvIHRoaXMudHdvUGk7XHJcbiAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5yICogc3RlcHM7XHJcblxyXG4gICAgICAgIHZhciBuID0gKCAoIHRoaXMucmFuZ2UgKiB2YWx1ZSApICsgdGhpcy5taW4gKSAtIHRoaXMub2xkO1xyXG5cclxuICAgICAgICBpZihuID49IHRoaXMuc3RlcCB8fCBuIDw9IHRoaXMuc3RlcCl7IFxyXG4gICAgICAgICAgICBuID0gfn4gKCBuIC8gdGhpcy5zdGVwICk7XHJcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLm51bVZhbHVlKCB0aGlzLm9sZCArICggbiAqIHRoaXMuc3RlcCApICk7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlKCB0cnVlICk7XHJcbiAgICAgICAgICAgIHRoaXMub2xkID0gdGhpcy52YWx1ZTtcclxuICAgICAgICAgICAgdGhpcy5vbGRyID0gdGhpcy5yO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIG1ha2VQYXRoICgpIHtcclxuXHJcbiAgICAgICAgdmFyIHIgPSA0MDtcclxuICAgICAgICB2YXIgZCA9IDI0O1xyXG4gICAgICAgIHZhciBhID0gdGhpcy5wZXJjZW50ICogdGhpcy50d29QaSAtIDAuMDAxO1xyXG4gICAgICAgIHZhciB4MiA9IChyICsgciAqIE1hdGguc2luKGEpKSArIGQ7XHJcbiAgICAgICAgdmFyIHkyID0gKHIgLSByICogTWF0aC5jb3MoYSkpICsgZDtcclxuICAgICAgICB2YXIgYmlnID0gYSA+IE1hdGguUEkgPyAxIDogMDtcclxuICAgICAgICByZXR1cm4gXCJNIFwiICsgKHIrZCkgKyBcIixcIiArIGQgKyBcIiBBIFwiICsgciArIFwiLFwiICsgciArIFwiIDAgXCIgKyBiaWcgKyBcIiAxIFwiICsgeDIgKyBcIixcIiArIHkyO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGUgKCB1cCApIHtcclxuXHJcbiAgICAgICAgdGhpcy5jWzJdLnRleHRDb250ZW50ID0gdGhpcy52YWx1ZTtcclxuICAgICAgICB0aGlzLnBlcmNlbnQgPSAoIHRoaXMudmFsdWUgLSB0aGlzLm1pbiApIC8gdGhpcy5yYW5nZTtcclxuXHJcbiAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ2QnLCB0aGlzLm1ha2VQYXRoKCksIDEgKTtcclxuICAgICAgICBpZiggdXAgKSB0aGlzLnNlbmQoKTtcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbn0iLCJpbXBvcnQgeyBUb29scyB9IGZyb20gJy4uL2NvcmUvVG9vbHMnO1xyXG5pbXBvcnQgeyBQcm90byB9IGZyb20gJy4uL2NvcmUvUHJvdG8nO1xyXG5pbXBvcnQgeyBWMiB9IGZyb20gJy4uL2NvcmUvVjInO1xyXG5cclxuZXhwb3J0IGNsYXNzIENvbG9yIGV4dGVuZHMgUHJvdG8ge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCBvID0ge30gKSB7XHJcblxyXG4gICAgICAgIHN1cGVyKCBvICk7XHJcblxyXG5cdCAgICAvL3RoaXMuYXV0b0hlaWdodCA9IHRydWU7XHJcblxyXG5cdCAgICB0aGlzLmN0eXBlID0gby5jdHlwZSB8fCAnaGV4JztcclxuXHJcblx0ICAgIHRoaXMud2ZpeGUgPSAyNTY7XHJcblxyXG5cdCAgICB0aGlzLmN3ID0gdGhpcy5zYiA+IDI1NiA/IDI1NiA6IHRoaXMuc2I7XHJcblx0ICAgIGlmKG8uY3cgIT0gdW5kZWZpbmVkICkgdGhpcy5jdyA9IG8uY3c7XHJcblxyXG5cdCAgICAvLyBjb2xvciB1cCBvciBkb3duXHJcblx0ICAgIHRoaXMuc2lkZSA9IG8uc2lkZSB8fCAnZG93bic7XHJcblx0ICAgIHRoaXMudXAgPSB0aGlzLnNpZGUgPT09ICdkb3duJyA/IDAgOiAxO1xyXG5cdCAgICBcclxuXHQgICAgdGhpcy5iYXNlSCA9IHRoaXMuaDtcclxuXHJcblx0ICAgIHRoaXMub2Zmc2V0ID0gbmV3IFYyKCk7XHJcblx0ICAgIHRoaXMuZGVjYWwgPSBuZXcgVjIoKTtcclxuXHQgICAgdGhpcy5wcCA9IG5ldyBWMigpO1xyXG5cclxuXHQgICAgdGhpcy5jWzJdID0gdGhpcy5kb20oICdkaXYnLCB0aGlzLmNzcy50eHQgKyAnaGVpZ2h0OicrKHRoaXMuaC00KSsncHg7JyArICdib3JkZXItcmFkaXVzOicrdGhpcy5yYWRpdXMrJ3B4OyBsaW5lLWhlaWdodDonKyh0aGlzLmgtOCkrJ3B4OycgKTtcclxuXHQgICAgdGhpcy5zWzJdID0gdGhpcy5jWzJdLnN0eWxlO1xyXG5cclxuXHQgICAgaWYoIHRoaXMudXAgKXtcclxuXHQgICAgICAgIHRoaXMuc1syXS50b3AgPSAnYXV0byc7XHJcblx0ICAgICAgICB0aGlzLnNbMl0uYm90dG9tID0gJzJweCc7XHJcblx0ICAgIH1cclxuXHJcblx0ICAgIHRoaXMuY1szXSA9IHRoaXMuZ2V0Q29sb3JSaW5nKCk7XHJcblx0ICAgIHRoaXMuY1szXS5zdHlsZS52aXNpYmlsaXR5ICA9ICdoaWRkZW4nO1xyXG5cclxuXHQgICAgdGhpcy5oc2wgPSBudWxsO1xyXG5cdCAgICB0aGlzLnZhbHVlID0gJyNmZmZmZmYnO1xyXG5cdCAgICBpZiggby52YWx1ZSAhPT0gdW5kZWZpbmVkICl7XHJcblx0ICAgICAgICBpZiggby52YWx1ZSBpbnN0YW5jZW9mIEFycmF5ICkgdGhpcy52YWx1ZSA9IFRvb2xzLnJnYlRvSGV4KCBvLnZhbHVlICk7XHJcblx0ICAgICAgICBlbHNlIGlmKCFpc05hTihvLnZhbHVlKSkgdGhpcy52YWx1ZSA9IFRvb2xzLmhleFRvSHRtbCggby52YWx1ZSApO1xyXG5cdCAgICAgICAgZWxzZSB0aGlzLnZhbHVlID0gby52YWx1ZTtcclxuXHQgICAgfVxyXG5cclxuXHQgICAgdGhpcy5iY29sb3IgPSBudWxsO1xyXG5cdCAgICB0aGlzLmlzRG93biA9IGZhbHNlO1xyXG5cdCAgICB0aGlzLmZpc3REb3duID0gZmFsc2U7XHJcblxyXG5cdCAgICB0aGlzLnRyID0gOTg7XHJcblx0ICAgIHRoaXMudHNsID0gTWF0aC5zcXJ0KDMpICogdGhpcy50cjtcclxuXHJcblx0ICAgIHRoaXMuaHVlID0gMDtcclxuXHQgICAgdGhpcy5kID0gMjU2O1xyXG5cclxuXHQgICAgdGhpcy5zZXRDb2xvciggdGhpcy52YWx1ZSApO1xyXG5cclxuXHQgICAgdGhpcy5pbml0KCk7XHJcblxyXG5cdCAgICBpZiggby5vcGVuICE9PSB1bmRlZmluZWQgKSB0aGlzLm9wZW4oKTtcclxuXHJcblx0fVxyXG5cclxuXHR0ZXN0Wm9uZSAoIG14LCBteSApIHtcclxuXHJcblx0XHRsZXQgbCA9IHRoaXMubG9jYWw7XHJcblx0XHRpZiggbC54ID09PSAtMSAmJiBsLnkgPT09IC0xICkgcmV0dXJuICcnO1xyXG5cclxuXHJcblxyXG5cdFx0aWYoIHRoaXMudXAgJiYgdGhpcy5pc09wZW4gKXtcclxuXHJcblx0XHRcdGlmKCBsLnkgPiB0aGlzLndmaXhlICkgcmV0dXJuICd0aXRsZSc7XHJcblx0XHQgICAgZWxzZSByZXR1cm4gJ2NvbG9yJztcclxuXHJcblx0XHR9IGVsc2Uge1xyXG5cclxuXHRcdFx0aWYoIGwueSA8IHRoaXMuYmFzZUgrMiApIHJldHVybiAndGl0bGUnO1xyXG5cdCAgICBcdGVsc2UgaWYoIHRoaXMuaXNPcGVuICkgcmV0dXJuICdjb2xvcic7XHJcblxyXG5cclxuXHRcdH1cclxuXHJcbiAgICB9XHJcblxyXG5cdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vICAgRVZFTlRTXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG5cdG1vdXNldXAgKCBlICkge1xyXG5cclxuXHQgICAgdGhpcy5pc0Rvd24gPSBmYWxzZTtcclxuXHQgICAgdGhpcy5kID0gMjU2O1xyXG5cclxuXHR9XHJcblxyXG5cdG1vdXNlZG93biAoIGUgKSB7XHJcblxyXG5cclxuXHRcdGxldCBuYW1lID0gdGhpcy50ZXN0Wm9uZSggZS5jbGllbnRYLCBlLmNsaWVudFkgKTtcclxuXHJcblxyXG5cdFx0Ly9pZiggIW5hbWUgKSByZXR1cm47XHJcblx0XHRpZihuYW1lID09PSAndGl0bGUnKXtcclxuXHRcdFx0aWYoICF0aGlzLmlzT3BlbiApIHRoaXMub3BlbigpO1xyXG5cdCAgICAgICAgZWxzZSB0aGlzLmNsb3NlKCk7XHJcblx0ICAgICAgICByZXR1cm4gdHJ1ZTtcclxuXHRcdH1cclxuXHJcblxyXG5cdFx0aWYoIG5hbWUgPT09ICdjb2xvcicgKXtcclxuXHJcblx0XHRcdHRoaXMuaXNEb3duID0gdHJ1ZTtcclxuXHRcdFx0dGhpcy5maXN0RG93biA9IHRydWVcclxuXHRcdFx0dGhpcy5tb3VzZW1vdmUoIGUgKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdG1vdXNlbW92ZSAoIGUgKSB7XHJcblxyXG5cdCAgICBsZXQgbmFtZSA9IHRoaXMudGVzdFpvbmUoIGUuY2xpZW50WCwgZS5jbGllbnRZICk7XHJcblxyXG5cdCAgICBsZXQgb2ZmLCBkLCBodWUsIHNhdCwgbHVtLCByYWQsIHgsIHksIHJyLCBUID0gVG9vbHM7XHJcblxyXG5cdCAgICBpZiggbmFtZSA9PT0gJ3RpdGxlJyApIHRoaXMuY3Vyc29yKCdwb2ludGVyJyk7XHJcblxyXG5cdCAgICBpZiggbmFtZSA9PT0gJ2NvbG9yJyApe1xyXG5cclxuXHQgICAgXHRvZmYgPSB0aGlzLm9mZnNldDtcclxuXHRcdCAgICBvZmYueCA9IGUuY2xpZW50WCAtICggdGhpcy56b25lLnggKyB0aGlzLmRlY2FsLnggKyB0aGlzLm1pZCApO1xyXG5cdFx0ICAgIG9mZi55ID0gZS5jbGllbnRZIC0gKCB0aGlzLnpvbmUueSArIHRoaXMuZGVjYWwueSArIHRoaXMubWlkICk7XHJcblx0XHRcdGQgPSBvZmYubGVuZ3RoKCkgKiB0aGlzLnJhdGlvO1xyXG5cdFx0XHRyciA9IG9mZi5hbmdsZSgpO1xyXG5cdFx0XHRpZihyciA8IDApIHJyICs9IDIgKiBULlBJO1xyXG5cdFx0XHRcdFx0XHRcclxuXHJcblx0ICAgIFx0aWYgKCBkIDwgMTI4ICkgdGhpcy5jdXJzb3IoJ2Nyb3NzaGFpcicpO1xyXG5cdCAgICBcdGVsc2UgaWYoICF0aGlzLmlzRG93biApIHRoaXMuY3Vyc29yKClcclxuXHJcblx0ICAgIFx0aWYoIHRoaXMuaXNEb3duICl7XHJcblxyXG5cdFx0XHQgICAgaWYoIHRoaXMuZmlzdERvd24gKXtcclxuXHRcdFx0ICAgIFx0dGhpcy5kID0gZDtcclxuXHRcdFx0ICAgIFx0dGhpcy5maXN0RG93biA9IGZhbHNlO1xyXG5cdFx0XHQgICAgfVxyXG5cclxuXHRcdFx0ICAgIGlmICggdGhpcy5kIDwgMTI4ICkge1xyXG5cclxuXHRcdFx0XHQgICAgaWYgKCB0aGlzLmQgPiB0aGlzLnRyICkgeyAvLyBvdXRzaWRlIGh1ZVxyXG5cclxuXHRcdFx0XHQgICAgICAgIGh1ZSA9ICggcnIgKyBULnBpOTAgKSAvIFQuVHdvUEk7XHJcblx0XHRcdFx0ICAgICAgICB0aGlzLmh1ZSA9IChodWUgKyAxKSAlIDE7XHJcblx0XHRcdFx0ICAgICAgICB0aGlzLnNldEhTTChbKGh1ZSArIDEpICUgMSwgdGhpcy5oc2xbMV0sIHRoaXMuaHNsWzJdXSk7XHJcblxyXG5cdFx0XHRcdCAgICB9IGVsc2UgeyAvLyB0cmlhbmdsZVxyXG5cclxuXHRcdFx0XHQgICAgXHR4ID0gb2ZmLnggKiB0aGlzLnJhdGlvO1xyXG5cdFx0XHRcdCAgICBcdHkgPSBvZmYueSAqIHRoaXMucmF0aW87XHJcblxyXG5cdFx0XHRcdCAgICBcdGxldCByciA9ICh0aGlzLmh1ZSAqIFQuVHdvUEkpICsgVC5QSTtcclxuXHRcdFx0XHQgICAgXHRpZihyciA8IDApIHJyICs9IDIgKiBULlBJO1xyXG5cclxuXHRcdFx0XHQgICAgXHRyYWQgPSBNYXRoLmF0YW4yKC15LCB4KTtcclxuXHRcdFx0XHQgICAgXHRpZihyYWQgPCAwKSByYWQgKz0gMiAqIFQuUEk7XHJcblx0XHRcdFx0XHRcdFxyXG5cdFx0XHRcdCAgICBcdGxldCByYWQwID0gKCByYWQgKyBULnBpOTAgKyBULlR3b1BJICsgcnIgKSAlIChULlR3b1BJKSxcclxuXHRcdFx0XHQgICAgXHRyYWQxID0gcmFkMCAlICgoMi8zKSAqIFQuUEkpIC0gKFQucGk2MCksXHJcblx0XHRcdFx0ICAgIFx0YSAgICA9IDAuNSAqIHRoaXMudHIsXHJcblx0XHRcdFx0ICAgIFx0YiAgICA9IE1hdGgudGFuKHJhZDEpICogYSxcclxuXHRcdFx0XHQgICAgXHRyICAgID0gTWF0aC5zcXJ0KHgqeCArIHkqeSksXHJcblx0XHRcdFx0ICAgIFx0bWF4UiA9IE1hdGguc3FydChhKmEgKyBiKmIpO1xyXG5cclxuXHRcdFx0XHQgICAgXHRpZiggciA+IG1heFIgKSB7XHJcblx0XHRcdFx0XHRcdFx0bGV0IGR4ID0gTWF0aC50YW4ocmFkMSkgKiByO1xyXG5cdFx0XHRcdFx0XHRcdGxldCByYWQyID0gTWF0aC5hdGFuKGR4IC8gbWF4Uik7XHJcblx0XHRcdFx0XHRcdFx0aWYocmFkMiA+IFQucGk2MCkgIHJhZDIgPSBULnBpNjA7XHJcblx0XHRcdFx0XHRcdCAgICBlbHNlIGlmKCByYWQyIDwgLVQucGk2MCApIHJhZDIgPSAtVC5waTYwO1xyXG5cdFx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdFx0XHRyYWQgKz0gcmFkMiAtIHJhZDE7XHJcblxyXG5cdFx0XHRcdFx0XHRcdHJhZDAgPSAocmFkICsgVC5waTkwICArIFQuVHdvUEkgKyBycikgJSAoVC5Ud29QSSksXHJcblx0XHRcdFx0XHRcdFx0cmFkMSA9IHJhZDAgJSAoKDIvMykgKiBULlBJKSAtIChULnBpNjApO1xyXG5cdFx0XHRcdFx0XHRcdGIgPSBNYXRoLnRhbihyYWQxKSAqIGE7XHJcblx0XHRcdFx0XHRcdFx0ciA9IG1heFIgPSBNYXRoLnNxcnQoYSphICsgYipiKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdFx0bHVtID0gKChNYXRoLnNpbihyYWQwKSAqIHIpIC8gdGhpcy50c2wpICsgMC41O1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdFx0XHRsZXQgdyA9IDEgLSAoTWF0aC5hYnMobHVtIC0gMC41KSAqIDIpO1xyXG5cdFx0XHRcdFx0XHRzYXQgPSAoKChNYXRoLmNvcyhyYWQwKSAqIHIpICsgKHRoaXMudHIgLyAyKSkgLyAoMS41ICogdGhpcy50cikpIC8gdztcclxuXHRcdFx0XHRcdFx0c2F0ID0gVC5jbGFtcCggc2F0LCAwLCAxICk7XHJcblx0XHRcdFx0XHRcdFxyXG5cdFx0XHRcdCAgICAgICAgdGhpcy5zZXRIU0woW3RoaXMuaHNsWzBdLCBzYXQsIGx1bV0pO1xyXG5cclxuXHRcdFx0XHQgICAgfVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHR9XHJcblxyXG5cdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcblx0c2V0SGVpZ2h0ICgpIHtcclxuXHJcblx0XHR0aGlzLmggPSB0aGlzLmlzT3BlbiA/IHRoaXMud2ZpeGUgKyB0aGlzLmJhc2VIICsgNSA6IHRoaXMuYmFzZUg7XHJcblx0XHR0aGlzLnNbMF0uaGVpZ2h0ID0gdGhpcy5oICsgJ3B4JztcclxuXHRcdHRoaXMuem9uZS5oID0gdGhpcy5oO1xyXG5cclxuXHR9XHJcblxyXG5cdHBhcmVudEhlaWdodCAoIHQgKSB7XHJcblxyXG5cdFx0aWYgKCB0aGlzLmdyb3VwICE9PSBudWxsICkgdGhpcy5ncm91cC5jYWxjKCB0ICk7XHJcblx0ICAgIGVsc2UgaWYgKCB0aGlzLmlzVUkgKSB0aGlzLm1haW4uY2FsYyggdCApO1xyXG5cclxuXHR9XHJcblxyXG5cdG9wZW4gKCkge1xyXG5cclxuXHRcdHN1cGVyLm9wZW4oKTtcclxuXHJcblx0XHR0aGlzLnNldEhlaWdodCgpO1xyXG5cclxuXHRcdGlmKCB0aGlzLnVwICkgdGhpcy56b25lLnkgLT0gdGhpcy53Zml4ZSArIDU7XHJcblxyXG5cdFx0bGV0IHQgPSB0aGlzLmggLSB0aGlzLmJhc2VIO1xyXG5cclxuXHQgICAgdGhpcy5zWzNdLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7XHJcblx0ICAgIC8vdGhpcy5zWzNdLmRpc3BsYXkgPSAnYmxvY2snO1xyXG5cdCAgICB0aGlzLnBhcmVudEhlaWdodCggdCApO1xyXG5cclxuXHR9XHJcblxyXG5cdGNsb3NlICgpIHtcclxuXHJcblx0XHRzdXBlci5jbG9zZSgpO1xyXG5cclxuXHRcdGlmKCB0aGlzLnVwICkgdGhpcy56b25lLnkgKz0gdGhpcy53Zml4ZSArIDU7XHJcblxyXG5cdFx0bGV0IHQgPSB0aGlzLmggLSB0aGlzLmJhc2VIO1xyXG5cclxuXHRcdHRoaXMuc2V0SGVpZ2h0KCk7XHJcblxyXG5cdCAgICB0aGlzLnNbM10udmlzaWJpbGl0eSAgPSAnaGlkZGVuJztcclxuXHQgICAgLy90aGlzLnNbM10uZGlzcGxheSA9ICdub25lJztcclxuXHQgICAgdGhpcy5wYXJlbnRIZWlnaHQoIC10ICk7XHJcblxyXG5cdH1cclxuXHJcblx0dXBkYXRlICggdXAgKSB7XHJcblxyXG5cdCAgICBsZXQgY2MgPSBUb29scy5yZ2JUb0hleCggVG9vbHMuaHNsVG9SZ2IoWyB0aGlzLmhzbFswXSwgMSwgMC41IF0pICk7XHJcblxyXG5cdCAgICB0aGlzLm1vdmVNYXJrZXJzKCk7XHJcblx0ICAgIFxyXG5cdCAgICB0aGlzLnZhbHVlID0gdGhpcy5iY29sb3I7XHJcblxyXG5cdCAgICB0aGlzLnNldFN2ZyggdGhpcy5jWzNdLCAnZmlsbCcsIGNjLCAyLCAwICk7XHJcblxyXG5cclxuXHQgICAgdGhpcy5zWzJdLmJhY2tncm91bmQgPSB0aGlzLmJjb2xvcjtcclxuXHQgICAgdGhpcy5jWzJdLnRleHRDb250ZW50ID0gVG9vbHMuaHRtbFRvSGV4KCB0aGlzLmJjb2xvciApO1xyXG5cclxuXHQgICAgdGhpcy5pbnZlcnQgPSBUb29scy5maW5kRGVlcEludmVyKCB0aGlzLnJnYiApO1xyXG5cdCAgICB0aGlzLnNbMl0uY29sb3IgPSB0aGlzLmludmVydCA/ICcjZmZmJyA6ICcjMDAwJztcclxuXHJcblx0ICAgIGlmKCF1cCkgcmV0dXJuO1xyXG5cclxuXHQgICAgaWYoIHRoaXMuY3R5cGUgPT09ICdhcnJheScgKSB0aGlzLnNlbmQoIHRoaXMucmdiICk7XHJcblx0ICAgIGlmKCB0aGlzLmN0eXBlID09PSAncmdiJyApIHRoaXMuc2VuZCggVG9vbHMuaHRtbFJnYiggdGhpcy5yZ2IgKSApO1xyXG5cdCAgICBpZiggdGhpcy5jdHlwZSA9PT0gJ2hleCcgKSB0aGlzLnNlbmQoIFRvb2xzLmh0bWxUb0hleCggdGhpcy52YWx1ZSApICk7XHJcblx0ICAgIGlmKCB0aGlzLmN0eXBlID09PSAnaHRtbCcgKSB0aGlzLnNlbmQoKTtcclxuXHJcblx0fVxyXG5cclxuXHRzZXRDb2xvciAoIGNvbG9yICkge1xyXG5cclxuXHQgICAgbGV0IHVucGFjayA9IFRvb2xzLnVucGFjayhjb2xvcik7XHJcblx0ICAgIGlmICh0aGlzLmJjb2xvciAhPSBjb2xvciAmJiB1bnBhY2spIHtcclxuXHJcblx0ICAgICAgICB0aGlzLmJjb2xvciA9IGNvbG9yO1xyXG5cdCAgICAgICAgdGhpcy5yZ2IgPSB1bnBhY2s7XHJcblx0ICAgICAgICB0aGlzLmhzbCA9IFRvb2xzLnJnYlRvSHNsKCB0aGlzLnJnYiApO1xyXG5cclxuXHQgICAgICAgIHRoaXMuaHVlID0gdGhpcy5oc2xbMF07XHJcblxyXG5cdCAgICAgICAgdGhpcy51cGRhdGUoKTtcclxuXHQgICAgfVxyXG5cdCAgICByZXR1cm4gdGhpcztcclxuXHJcblx0fVxyXG5cclxuXHRzZXRIU0wgKCBoc2wgKSB7XHJcblxyXG5cdCAgICB0aGlzLmhzbCA9IGhzbDtcclxuXHQgICAgdGhpcy5yZ2IgPSBUb29scy5oc2xUb1JnYiggaHNsICk7XHJcblx0ICAgIHRoaXMuYmNvbG9yID0gVG9vbHMucmdiVG9IZXgoIHRoaXMucmdiICk7XHJcblx0ICAgIHRoaXMudXBkYXRlKCB0cnVlICk7XHJcblx0ICAgIHJldHVybiB0aGlzO1xyXG5cclxuXHR9XHJcblxyXG5cdG1vdmVNYXJrZXJzICgpIHtcclxuXHJcblx0XHRsZXQgcCA9IHRoaXMucHA7XHJcblx0XHRsZXQgVCA9IFRvb2xzO1xyXG5cclxuXHQgICAgbGV0IGMxID0gdGhpcy5pbnZlcnQgPyAnI2ZmZicgOiAnIzAwMCc7XHJcblx0ICAgIGxldCBhID0gdGhpcy5oc2xbMF0gKiBULlR3b1BJO1xyXG5cdCAgICBsZXQgdGhpcmQgPSAoMi8zKSAqIFQuUEk7XHJcblx0ICAgIGxldCByID0gdGhpcy50cjtcclxuXHQgICAgbGV0IGggPSB0aGlzLmhzbFswXTtcclxuXHQgICAgbGV0IHMgPSB0aGlzLmhzbFsxXTtcclxuXHQgICAgbGV0IGwgPSB0aGlzLmhzbFsyXTtcclxuXHJcblx0ICAgIGxldCBhbmdsZSA9ICggYSAtIFQucGk5MCApICogVC50b2RlZztcclxuXHJcblx0ICAgIGggPSAtIGEgKyBULnBpOTA7XHJcblxyXG5cdFx0bGV0IGh4ID0gTWF0aC5jb3MoaCkgKiByO1xyXG5cdFx0bGV0IGh5ID0gLU1hdGguc2luKGgpICogcjtcclxuXHRcdGxldCBzeCA9IE1hdGguY29zKGggLSB0aGlyZCkgKiByO1xyXG5cdFx0bGV0IHN5ID0gLU1hdGguc2luKGggLSB0aGlyZCkgKiByO1xyXG5cdFx0bGV0IHZ4ID0gTWF0aC5jb3MoaCArIHRoaXJkKSAqIHI7XHJcblx0XHRsZXQgdnkgPSAtTWF0aC5zaW4oaCArIHRoaXJkKSAqIHI7XHJcblx0XHRsZXQgbXggPSAoc3ggKyB2eCkgLyAyLCBteSA9IChzeSArIHZ5KSAvIDI7XHJcblx0XHRhICA9ICgxIC0gMiAqIE1hdGguYWJzKGwgLSAuNSkpICogcztcclxuXHRcdGxldCB4ID0gc3ggKyAodnggLSBzeCkgKiBsICsgKGh4IC0gbXgpICogYTtcclxuXHRcdGxldCB5ID0gc3kgKyAodnkgLSBzeSkgKiBsICsgKGh5IC0gbXkpICogYTtcclxuXHJcblx0ICAgIHAuc2V0KCB4LCB5ICkuYWRkU2NhbGFyKDEyOCk7XHJcblxyXG5cdCAgICAvL2xldCBmZiA9ICgxLWwpKjI1NTtcclxuXHQgICAgLy8gdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ3N0cm9rZScsICdyZ2IoJytmZisnLCcrZmYrJywnK2ZmKycpJywgMyApO1xyXG5cclxuXHQgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ3RyYW5zZm9ybScsICdyb3RhdGUoJythbmdsZSsnICknLCAyICk7XHJcblxyXG5cdCAgICB0aGlzLnNldFN2ZyggdGhpcy5jWzNdLCAnY3gnLCBwLngsIDMgKTtcclxuXHQgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ2N5JywgcC55LCAzICk7XHJcblx0ICAgIFxyXG5cdCAgICB0aGlzLnNldFN2ZyggdGhpcy5jWzNdLCAnc3Ryb2tlJywgdGhpcy5pbnZlcnQgPyAnI2ZmZicgOiAnIzAwMCcsIDIsIDMgKTtcclxuXHQgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ3N0cm9rZScsIHRoaXMuaW52ZXJ0ID8gJyNmZmYnIDogJyMwMDAnLCAzICk7XHJcblx0ICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdmaWxsJyx0aGlzLmJjb2xvciwgMyApO1xyXG5cclxuXHR9XHJcblxyXG5cdHJTaXplICgpIHtcclxuXHJcblx0ICAgIC8vUHJvdG8ucHJvdG90eXBlLnJTaXplLmNhbGwoIHRoaXMgKTtcclxuXHQgICAgc3VwZXIuclNpemUoKTtcclxuXHJcblx0ICAgIGxldCBzID0gdGhpcy5zO1xyXG5cclxuXHQgICAgc1syXS53aWR0aCA9IHRoaXMuc2IgKyAncHgnO1xyXG5cdCAgICBzWzJdLmxlZnQgPSB0aGlzLnNhICsgJ3B4JztcclxuXHJcblx0ICAgIHRoaXMuclNpemVDb2xvciggdGhpcy5jdyApO1xyXG5cclxuXHQgICAgdGhpcy5kZWNhbC54ID0gTWF0aC5mbG9vcigodGhpcy53IC0gdGhpcy53Zml4ZSkgKiAwLjUpO1xyXG5cdCAgICBzWzNdLmxlZnQgPSB0aGlzLmRlY2FsLnggKyAncHgnO1xyXG5cdCAgICBcclxuXHR9XHJcblxyXG5cdHJTaXplQ29sb3IgKCB3ICkge1xyXG5cclxuXHRcdGlmKCB3ID09PSB0aGlzLndmaXhlICkgcmV0dXJuO1xyXG5cclxuXHRcdHRoaXMud2ZpeGUgPSB3O1xyXG5cclxuXHRcdGxldCBzID0gdGhpcy5zO1xyXG5cclxuXHRcdC8vdGhpcy5kZWNhbC54ID0gTWF0aC5mbG9vcigodGhpcy53IC0gdGhpcy53Zml4ZSkgKiAwLjUpO1xyXG5cdCAgICB0aGlzLmRlY2FsLnkgPSB0aGlzLnNpZGUgPT09ICd1cCcgPyAyIDogdGhpcy5iYXNlSCArIDI7XHJcblx0ICAgIHRoaXMubWlkID0gTWF0aC5mbG9vciggdGhpcy53Zml4ZSAqIDAuNSApO1xyXG5cclxuXHQgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ3ZpZXdCb3gnLCAnMCAwICcrIHRoaXMud2ZpeGUgKyAnICcrIHRoaXMud2ZpeGUgKTtcclxuXHQgICAgc1szXS53aWR0aCA9IHRoaXMud2ZpeGUgKyAncHgnO1xyXG5cdCAgICBzWzNdLmhlaWdodCA9IHRoaXMud2ZpeGUgKyAncHgnO1xyXG4gICAgXHQvL3NbM10ubGVmdCA9IHRoaXMuZGVjYWwueCArICdweCc7XHJcblx0ICAgIHNbM10udG9wID0gdGhpcy5kZWNhbC55ICsgJ3B4JztcclxuXHJcblx0ICAgIHRoaXMucmF0aW8gPSAyNTYgLyB0aGlzLndmaXhlO1xyXG5cdCAgICB0aGlzLnNxdWFyZSA9IDEgLyAoNjAqKHRoaXMud2ZpeGUvMjU2KSk7XHJcblx0ICAgIHRoaXMuc2V0SGVpZ2h0KCk7XHJcblxyXG5cdH1cclxuXHJcblxyXG59IiwiaW1wb3J0IHsgUm9vdHMgfSBmcm9tICcuLi9jb3JlL1Jvb3RzJztcclxuaW1wb3J0IHsgUHJvdG8gfSBmcm9tICcuLi9jb3JlL1Byb3RvJztcclxuXHJcbmV4cG9ydCBjbGFzcyBGcHMgZXh0ZW5kcyBQcm90byB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoIG8gPSB7fSApIHtcclxuXHJcbiAgICAgICAgc3VwZXIoIG8gKTtcclxuXHJcbiAgICAgICAgdGhpcy5yb3VuZCA9IE1hdGgucm91bmQ7XHJcblxyXG4gICAgICAgIC8vdGhpcy5hdXRvSGVpZ2h0ID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgdGhpcy5iYXNlSCA9IHRoaXMuaDtcclxuICAgICAgICB0aGlzLmhwbHVzID0gby5ocGx1cyB8fCA1MDtcclxuXHJcbiAgICAgICAgdGhpcy5yZXMgPSBvLnJlcyB8fCA0MDtcclxuICAgICAgICB0aGlzLmwgPSAxO1xyXG5cclxuICAgICAgICB0aGlzLnByZWNpc2lvbiA9IG8ucHJlY2lzaW9uIHx8IDA7XHJcbiAgICAgICAgXHJcblxyXG4gICAgICAgIHRoaXMuY3VzdG9tID0gby5jdXN0b20gfHwgZmFsc2U7XHJcbiAgICAgICAgdGhpcy5uYW1lcyA9IG8ubmFtZXMgfHwgWydGUFMnLCAnTVMnXTtcclxuICAgICAgICBsZXQgY2MgPSBvLmNjIHx8IFsnMjIwLDIyMCwyMjAnLCAnMjU1LDI1NSwwJ107XHJcblxyXG4gICAgICAgLy8gdGhpcy5kaXZpZCA9IFsgMTAwLCAxMDAsIDEwMCBdO1xyXG4gICAgICAgLy8gdGhpcy5tdWx0eSA9IFsgMzAsIDMwLCAzMCBdO1xyXG5cclxuICAgICAgICB0aGlzLmFkZGluZyA9IG8uYWRkaW5nIHx8IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLnJhbmdlID0gby5yYW5nZSB8fCBbIDE2NSwgMTAwLCAxMDAgXTtcclxuXHJcbiAgICAgICAgdGhpcy5hbHBoYSA9IG8uYWxwaGEgfHwgMC4yNTtcclxuXHJcbiAgICAgICAgdGhpcy52YWx1ZXMgPSBbXTtcclxuICAgICAgICB0aGlzLnBvaW50cyA9IFtdO1xyXG4gICAgICAgIHRoaXMudGV4dERpc3BsYXkgPSBbXTtcclxuXHJcbiAgICAgICAgaWYoIXRoaXMuY3VzdG9tKXtcclxuXHJcbiAgICAgICAgICAgIHRoaXMubm93ID0gKCBzZWxmLnBlcmZvcm1hbmNlICYmIHNlbGYucGVyZm9ybWFuY2Uubm93ICkgPyBzZWxmLnBlcmZvcm1hbmNlLm5vdy5iaW5kKCBwZXJmb3JtYW5jZSApIDogRGF0ZS5ub3c7XHJcbiAgICAgICAgICAgIHRoaXMuc3RhcnRUaW1lID0gMDsvL3RoaXMubm93KClcclxuICAgICAgICAgICAgdGhpcy5wcmV2VGltZSA9IDA7Ly90aGlzLnN0YXJ0VGltZTtcclxuICAgICAgICAgICAgdGhpcy5mcmFtZXMgPSAwO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5tcyA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMuZnBzID0gMDtcclxuICAgICAgICAgICAgdGhpcy5tZW0gPSAwO1xyXG4gICAgICAgICAgICB0aGlzLm1tID0gMDtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuaXNNZW0gPSAoIHNlbGYucGVyZm9ybWFuY2UgJiYgc2VsZi5wZXJmb3JtYW5jZS5tZW1vcnkgKSA/IHRydWUgOiBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgLy8gdGhpcy5kaXZpZCA9IFsgMTAwLCAyMDAsIDEgXTtcclxuICAgICAgICAgICAvLyB0aGlzLm11bHR5ID0gWyAzMCwgMzAsIDMwIF07XHJcblxyXG4gICAgICAgICAgICBpZiggdGhpcy5pc01lbSApe1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMubmFtZXMucHVzaCgnTUVNJyk7XHJcbiAgICAgICAgICAgICAgICBjYy5wdXNoKCcwLDI1NSwyNTUnKTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMudHh0ID0gby5uYW1lIHx8ICdGcHMnXHJcblxyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIGxldCBmbHRvcCA9IE1hdGguZmxvb3IodGhpcy5oKjAuNSktNjtcclxuXHJcbiAgICAgICAgdGhpcy5jWzFdLnRleHRDb250ZW50ID0gdGhpcy50eHQ7XHJcbiAgICAgICAgdGhpcy5jWzBdLnN0eWxlLmN1cnNvciA9ICdwb2ludGVyJztcclxuICAgICAgICB0aGlzLmNbMF0uc3R5bGUucG9pbnRlckV2ZW50cyA9ICdhdXRvJztcclxuXHJcbiAgICAgICAgbGV0IHBhbmVsQ3NzID0gJ2Rpc3BsYXk6bm9uZTsgbGVmdDoxMHB4OyB0b3A6JysgdGhpcy5oICsgJ3B4OyBoZWlnaHQ6JysodGhpcy5ocGx1cyAtIDgpKydweDsgYm94LXNpemluZzpib3JkZXItYm94OyBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuMik7IGJvcmRlcjonICsgKHRoaXMuY29sb3JzLmdyb3VwQm9yZGVyICE9PSAnbm9uZSc/IHRoaXMuY29sb3JzLmdyb3VwQm9yZGVyKyc7JyA6ICcxcHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjIpOycpO1xyXG5cclxuICAgICAgICBpZiggdGhpcy5yYWRpdXMgIT09IDAgKSBwYW5lbENzcyArPSAnYm9yZGVyLXJhZGl1czonICsgdGhpcy5yYWRpdXMrJ3B4Oyc7IFxyXG5cclxuICAgICAgICB0aGlzLmNbMl0gPSB0aGlzLmRvbSggJ3BhdGgnLCB0aGlzLmNzcy5iYXNpYyArIHBhbmVsQ3NzICwge30gKTtcclxuXHJcbiAgICAgICAgdGhpcy5jWzJdLnNldEF0dHJpYnV0ZSgndmlld0JveCcsICcwIDAgJyt0aGlzLnJlcysnIDUwJyApO1xyXG4gICAgICAgIHRoaXMuY1syXS5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsICcxMDAlJyApO1xyXG4gICAgICAgIHRoaXMuY1syXS5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgJzEwMCUnICk7XHJcbiAgICAgICAgdGhpcy5jWzJdLnNldEF0dHJpYnV0ZSgncHJlc2VydmVBc3BlY3RSYXRpbycsICdub25lJyApO1xyXG5cclxuXHJcbiAgICAgICAgLy90aGlzLmRvbSggJ3BhdGgnLCBudWxsLCB7IGZpbGw6J3JnYmEoMjU1LDI1NSwwLDAuMyknLCAnc3Ryb2tlLXdpZHRoJzoxLCBzdHJva2U6JyNGRjAnLCAndmVjdG9yLWVmZmVjdCc6J25vbi1zY2FsaW5nLXN0cm9rZScgfSwgdGhpcy5jWzJdICk7XHJcbiAgICAgICAgLy90aGlzLmRvbSggJ3BhdGgnLCBudWxsLCB7IGZpbGw6J3JnYmEoMCwyNTUsMjU1LDAuMyknLCAnc3Ryb2tlLXdpZHRoJzoxLCBzdHJva2U6JyMwRkYnLCAndmVjdG9yLWVmZmVjdCc6J25vbi1zY2FsaW5nLXN0cm9rZScgfSwgdGhpcy5jWzJdICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gYXJyb3dcclxuICAgICAgICB0aGlzLmNbM10gPSB0aGlzLmRvbSggJ3BhdGgnLCB0aGlzLmNzcy5iYXNpYyArICdwb3NpdGlvbjphYnNvbHV0ZTsgd2lkdGg6MTBweDsgaGVpZ2h0OjEwcHg7IGxlZnQ6NHB4OyB0b3A6JytmbHRvcCsncHg7JywgeyBkOnRoaXMuc3Zncy5hcnJvdywgZmlsbDp0aGlzLmZvbnRDb2xvciwgc3Ryb2tlOidub25lJ30pO1xyXG5cclxuICAgICAgICAvLyByZXN1bHQgdGVzdFxyXG4gICAgICAgIHRoaXMuY1s0XSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MudHh0ICsgJ3Bvc2l0aW9uOmFic29sdXRlOyBsZWZ0OjEwcHg7IHRvcDonKyh0aGlzLmgrMikgKydweDsgZGlzcGxheTpub25lOyB3aWR0aDoxMDAlOyB0ZXh0LWFsaWduOmNlbnRlcjsnICk7XHJcblxyXG4gICAgICAgIC8vIGJvdHRvbSBsaW5lXHJcbiAgICAgICAgaWYoIG8uYm90dG9tTGluZSApIHRoaXMuY1s0XSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MuYmFzaWMgKyAnd2lkdGg6MTAwJTsgYm90dG9tOjBweDsgaGVpZ2h0OjFweDsgYmFja2dyb3VuZDogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjIpOycpO1xyXG5cclxuICAgICAgICB0aGlzLmlzU2hvdyA9IGZhbHNlO1xyXG5cclxuICAgICAgICBsZXQgcyA9IHRoaXMucztcclxuXHJcbiAgICAgICAgc1sxXS5tYXJnaW5MZWZ0ID0gJzEwcHgnO1xyXG4gICAgICAgIHNbMV0ubGluZUhlaWdodCA9IHRoaXMuaC00O1xyXG4gICAgICAgIHNbMV0uY29sb3IgPSB0aGlzLmZvbnRDb2xvcjtcclxuICAgICAgICBzWzFdLmZvbnRXZWlnaHQgPSAnYm9sZCc7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLnJhZGl1cyAhPT0gMCApICBzWzBdLmJvcmRlclJhZGl1cyA9IHRoaXMucmFkaXVzKydweCc7IFxyXG4gICAgICAgIHNbMF0uYm9yZGVyID0gdGhpcy5jb2xvcnMuZ3JvdXBCb3JkZXI7XHJcblxyXG5cclxuXHJcblxyXG4gICAgICAgIGxldCBqID0gMDtcclxuXHJcbiAgICAgICAgZm9yKCBqPTA7IGo8dGhpcy5uYW1lcy5sZW5ndGg7IGorKyApe1xyXG5cclxuICAgICAgICAgICAgbGV0IGJhc2UgPSBbXTtcclxuICAgICAgICAgICAgbGV0IGkgPSB0aGlzLnJlcysxO1xyXG4gICAgICAgICAgICB3aGlsZSggaS0tICkgYmFzZS5wdXNoKDUwKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMucmFuZ2Vbal0gPSAoIDEgLyB0aGlzLnJhbmdlW2pdICkgKiA0OTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMucG9pbnRzLnB1c2goIGJhc2UgKTtcclxuICAgICAgICAgICAgdGhpcy52YWx1ZXMucHVzaCgwKTtcclxuICAgICAgICAgICAvLyAgdGhpcy5kb20oICdwYXRoJywgbnVsbCwgeyBmaWxsOidyZ2JhKCcrY2Nbal0rJywwLjUpJywgJ3N0cm9rZS13aWR0aCc6MSwgc3Ryb2tlOidyZ2JhKCcrY2Nbal0rJywxKScsICd2ZWN0b3ItZWZmZWN0Jzonbm9uLXNjYWxpbmctc3Ryb2tlJyB9LCB0aGlzLmNbMl0gKTtcclxuICAgICAgICAgICAgdGhpcy50ZXh0RGlzcGxheS5wdXNoKCBcIjxzcGFuIHN0eWxlPSdjb2xvcjpyZ2IoXCIrY2Nbal0rXCIpJz4gXCIgKyB0aGlzLm5hbWVzW2pdICtcIiBcIik7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaiA9IHRoaXMubmFtZXMubGVuZ3RoO1xyXG4gICAgICAgIHdoaWxlKGotLSl7XHJcbiAgICAgICAgICAgIHRoaXMuZG9tKCAncGF0aCcsIG51bGwsIHsgZmlsbDoncmdiYSgnK2NjW2pdKycsJyt0aGlzLmFscGhhKycpJywgJ3N0cm9rZS13aWR0aCc6MSwgc3Ryb2tlOidyZ2JhKCcrY2Nbal0rJywxKScsICd2ZWN0b3ItZWZmZWN0Jzonbm9uLXNjYWxpbmctc3Ryb2tlJyB9LCB0aGlzLmNbMl0gKTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICB0aGlzLmluaXQoKTtcclxuXHJcbiAgICAgICAgLy9pZiggdGhpcy5pc1Nob3cgKSB0aGlzLnNob3coKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBFVkVOVFNcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBtb3VzZWRvd24gKCBlICkge1xyXG5cclxuICAgICAgICBpZiggdGhpcy5pc1Nob3cgKSB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgZWxzZSB0aGlzLm9wZW4oKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIC8qbW9kZTogZnVuY3Rpb24gKCBtb2RlICkge1xyXG5cclxuICAgICAgICBsZXQgcyA9IHRoaXMucztcclxuXHJcbiAgICAgICAgc3dpdGNoKG1vZGUpe1xyXG4gICAgICAgICAgICBjYXNlIDA6IC8vIGJhc2VcclxuICAgICAgICAgICAgICAgIHNbMV0uY29sb3IgPSB0aGlzLmZvbnRDb2xvcjtcclxuICAgICAgICAgICAgICAgIC8vc1sxXS5iYWNrZ3JvdW5kID0gJ25vbmUnO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAxOiAvLyBvdmVyXHJcbiAgICAgICAgICAgICAgICBzWzFdLmNvbG9yID0gJyNGRkYnO1xyXG4gICAgICAgICAgICAgICAgLy9zWzFdLmJhY2tncm91bmQgPSBVSUwuU0VMRUNUO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAyOiAvLyBlZGl0IC8gZG93blxyXG4gICAgICAgICAgICAgICAgc1sxXS5jb2xvciA9IHRoaXMuZm9udENvbG9yO1xyXG4gICAgICAgICAgICAgICAgLy9zWzFdLmJhY2tncm91bmQgPSBVSUwuU0VMRUNURE9XTjtcclxuICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgIH1cclxuICAgIH0sKi9cclxuXHJcbiAgICB0aWNrICggdiApIHtcclxuXHJcbiAgICAgICAgdGhpcy52YWx1ZXMgPSB2O1xyXG4gICAgICAgIGlmKCAhdGhpcy5pc1Nob3cgKSByZXR1cm47XHJcbiAgICAgICAgdGhpcy5kcmF3R3JhcGgoKTtcclxuICAgICAgICB0aGlzLnVwVGV4dCgpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBtYWtlUGF0aCAoIHBvaW50ICkge1xyXG5cclxuICAgICAgICBsZXQgcCA9ICcnO1xyXG4gICAgICAgIHAgKz0gJ00gJyArICgtMSkgKyAnICcgKyA1MDtcclxuICAgICAgICBmb3IgKCBsZXQgaSA9IDA7IGkgPCB0aGlzLnJlcyArIDE7IGkgKysgKSB7IHAgKz0gJyBMICcgKyBpICsgJyAnICsgcG9pbnRbaV07IH1cclxuICAgICAgICBwICs9ICcgTCAnICsgKHRoaXMucmVzICsgMSkgKyAnICcgKyA1MDtcclxuICAgICAgICByZXR1cm4gcDtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgdXBUZXh0ICggdmFsICkge1xyXG5cclxuICAgICAgICBsZXQgdiA9IHZhbCB8fCB0aGlzLnZhbHVlcywgdCA9ICcnO1xyXG4gICAgICAgIGZvciggbGV0IGo9MCwgbG5nID10aGlzLm5hbWVzLmxlbmd0aDsgajxsbmc7IGorKyApIHQgKz0gdGhpcy50ZXh0RGlzcGxheVtqXSArICh2W2pdKS50b0ZpeGVkKHRoaXMucHJlY2lzaW9uKSArICc8L3NwYW4+JztcclxuICAgICAgICB0aGlzLmNbNF0uaW5uZXJIVE1MID0gdDtcclxuICAgIFxyXG4gICAgfVxyXG5cclxuICAgIGRyYXdHcmFwaCAoKSB7XHJcblxyXG4gICAgICAgIGxldCBzdmcgPSB0aGlzLmNbMl07XHJcbiAgICAgICAgbGV0IGkgPSB0aGlzLm5hbWVzLmxlbmd0aCwgdiwgb2xkID0gMCwgbiA9IDA7XHJcblxyXG4gICAgICAgIHdoaWxlKCBpLS0gKXtcclxuICAgICAgICAgICAgaWYoIHRoaXMuYWRkaW5nICkgdiA9ICh0aGlzLnZhbHVlc1tuXStvbGQpICogdGhpcy5yYW5nZVtuXTtcclxuICAgICAgICAgICAgZWxzZSAgdiA9ICh0aGlzLnZhbHVlc1tuXSAqIHRoaXMucmFuZ2Vbbl0pO1xyXG4gICAgICAgICAgICB0aGlzLnBvaW50c1tuXS5zaGlmdCgpO1xyXG4gICAgICAgICAgICB0aGlzLnBvaW50c1tuXS5wdXNoKCA1MCAtIHYgKTtcclxuICAgICAgICAgICAgdGhpcy5zZXRTdmcoIHN2ZywgJ2QnLCB0aGlzLm1ha2VQYXRoKCB0aGlzLnBvaW50c1tuXSApLCBpKzEgKTtcclxuICAgICAgICAgICAgb2xkICs9IHRoaXMudmFsdWVzW25dO1xyXG4gICAgICAgICAgICBuKys7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgb3BlbiAoKSB7XHJcblxyXG4gICAgICAgIHN1cGVyLm9wZW4oKTtcclxuXHJcbiAgICAgICAgdGhpcy5oID0gdGhpcy5ocGx1cyArIHRoaXMuYmFzZUg7XHJcblxyXG4gICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdkJywgdGhpcy5zdmdzLmFycm93RG93biApO1xyXG5cclxuICAgICAgICBpZiggdGhpcy5ncm91cCAhPT0gbnVsbCApeyB0aGlzLmdyb3VwLmNhbGMoIHRoaXMuaHBsdXMgKTt9XHJcbiAgICAgICAgZWxzZSBpZiggdGhpcy5pc1VJICkgdGhpcy5tYWluLmNhbGMoIHRoaXMuaHBsdXMgKTtcclxuXHJcbiAgICAgICAgdGhpcy5zWzBdLmhlaWdodCA9IHRoaXMuaCArJ3B4JztcclxuICAgICAgICB0aGlzLnNbMl0uZGlzcGxheSA9ICdibG9jayc7IFxyXG4gICAgICAgIHRoaXMuc1s0XS5kaXNwbGF5ID0gJ2Jsb2NrJztcclxuICAgICAgICB0aGlzLmlzU2hvdyA9IHRydWU7XHJcblxyXG4gICAgICAgIGlmKCAhdGhpcy5jdXN0b20gKSBSb290cy5hZGRMaXN0ZW4oIHRoaXMgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UgKCkge1xyXG5cclxuICAgICAgICBzdXBlci5jbG9zZSgpO1xyXG5cclxuICAgICAgICB0aGlzLmggPSB0aGlzLmJhc2VIO1xyXG5cclxuICAgICAgICB0aGlzLnNldFN2ZyggdGhpcy5jWzNdLCAnZCcsIHRoaXMuc3Zncy5hcnJvdyApO1xyXG5cclxuICAgICAgICBpZiggdGhpcy5ncm91cCAhPT0gbnVsbCApeyB0aGlzLmdyb3VwLmNhbGMoIC10aGlzLmhwbHVzICk7fVxyXG4gICAgICAgIGVsc2UgaWYoIHRoaXMuaXNVSSApIHRoaXMubWFpbi5jYWxjKCAtdGhpcy5ocGx1cyApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuc1swXS5oZWlnaHQgPSB0aGlzLmggKydweCc7XHJcbiAgICAgICAgdGhpcy5zWzJdLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICAgICAgdGhpcy5zWzRdLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICAgICAgdGhpcy5pc1Nob3cgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgaWYoICF0aGlzLmN1c3RvbSApIFJvb3RzLnJlbW92ZUxpc3RlbiggdGhpcyApO1xyXG5cclxuICAgICAgICB0aGlzLmNbNF0uaW5uZXJIVE1MID0gJyc7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8vLy8vIEFVVE8gRlBTIC8vLy8vL1xyXG5cclxuICAgIGJlZ2luICgpIHtcclxuXHJcbiAgICAgICAgdGhpcy5zdGFydFRpbWUgPSB0aGlzLm5vdygpO1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIGVuZCAoKSB7XHJcblxyXG4gICAgICAgIGxldCB0aW1lID0gdGhpcy5ub3coKTtcclxuICAgICAgICB0aGlzLm1zID0gdGltZSAtIHRoaXMuc3RhcnRUaW1lO1xyXG5cclxuICAgICAgICB0aGlzLmZyYW1lcyArKztcclxuXHJcbiAgICAgICAgaWYgKCB0aW1lID4gdGhpcy5wcmV2VGltZSArIDEwMDAgKSB7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmZwcyA9IHRoaXMucm91bmQoICggdGhpcy5mcmFtZXMgKiAxMDAwICkgLyAoIHRpbWUgLSB0aGlzLnByZXZUaW1lICkgKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMucHJldlRpbWUgPSB0aW1lO1xyXG4gICAgICAgICAgICB0aGlzLmZyYW1lcyA9IDA7XHJcblxyXG4gICAgICAgICAgICBpZiAoIHRoaXMuaXNNZW0gKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IGhlYXBTaXplID0gcGVyZm9ybWFuY2UubWVtb3J5LnVzZWRKU0hlYXBTaXplO1xyXG4gICAgICAgICAgICAgICAgbGV0IGhlYXBTaXplTGltaXQgPSBwZXJmb3JtYW5jZS5tZW1vcnkuanNIZWFwU2l6ZUxpbWl0O1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMubWVtID0gdGhpcy5yb3VuZCggaGVhcFNpemUgKiAwLjAwMDAwMDk1NCApO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tbSA9IGhlYXBTaXplIC8gaGVhcFNpemVMaW1pdDtcclxuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnZhbHVlcyA9IFsgdGhpcy5mcHMsIHRoaXMubXMgLCB0aGlzLm1tIF07XHJcblxyXG4gICAgICAgIHRoaXMuZHJhd0dyYXBoKCk7XHJcbiAgICAgICAgdGhpcy51cFRleHQoIFsgdGhpcy5mcHMsIHRoaXMubXMsIHRoaXMubWVtIF0gKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRpbWU7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGxpc3RlbmluZyAoKSB7XHJcblxyXG4gICAgICAgIGlmKCAhdGhpcy5jdXN0b20gKSB0aGlzLnN0YXJ0VGltZSA9IHRoaXMuZW5kKCk7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgclNpemUgKCkge1xyXG5cclxuICAgICAgICBsZXQgcyA9IHRoaXMucztcclxuICAgICAgICBsZXQgdyA9IHRoaXMudztcclxuXHJcbiAgICAgICAgc1swXS53aWR0aCA9IHcgKyAncHgnO1xyXG4gICAgICAgIHNbMV0ud2lkdGggPSB3ICsgJ3B4JztcclxuICAgICAgICBzWzJdLmxlZnQgPSAxMCArICdweCc7XHJcbiAgICAgICAgc1syXS53aWR0aCA9ICh3LTIwKSArICdweCc7XHJcbiAgICAgICAgc1s0XS53aWR0aCA9ICh3LTIwKSArICdweCc7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcbiAgICBcclxufSIsImltcG9ydCB7IFByb3RvIH0gZnJvbSAnLi4vY29yZS9Qcm90byc7XHJcbmltcG9ydCB7IFYyIH0gZnJvbSAnLi4vY29yZS9WMic7XHJcblxyXG5leHBvcnQgY2xhc3MgR3JhcGggZXh0ZW5kcyBQcm90byB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoIG8gPSB7fSApIHtcclxuXHJcbiAgICAgICAgc3VwZXIoIG8gKTtcclxuXHJcbiAgICBcdHRoaXMudmFsdWUgPSBvLnZhbHVlICE9PSB1bmRlZmluZWQgPyBvLnZhbHVlIDogWzAsMCwwXTtcclxuICAgICAgICB0aGlzLmxuZyA9IHRoaXMudmFsdWUubGVuZ3RoO1xyXG5cclxuICAgICAgICB0aGlzLnByZWNpc2lvbiA9IG8ucHJlY2lzaW9uICE9PSB1bmRlZmluZWQgPyBvLnByZWNpc2lvbiA6IDI7XHJcbiAgICAgICAgdGhpcy5tdWx0aXBsaWNhdG9yID0gby5tdWx0aXBsaWNhdG9yIHx8IDE7XHJcbiAgICAgICAgdGhpcy5uZWcgPSBvLm5lZyB8fCBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy5saW5lID0gby5saW5lICE9PSB1bmRlZmluZWQgPyAgby5saW5lIDogdHJ1ZTtcclxuXHJcbiAgICAgICAgLy9pZih0aGlzLm5lZyl0aGlzLm11bHRpcGxpY2F0b3IqPTI7XHJcblxyXG4gICAgICAgIHRoaXMuYXV0b1dpZHRoID0gby5hdXRvV2lkdGggIT09IHVuZGVmaW5lZCA/IG8uYXV0b1dpZHRoIDogdHJ1ZTtcclxuICAgICAgICB0aGlzLmlzTnVtYmVyID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMuaXNEb3duID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMuaCA9IG8uaCB8fCAxMjggKyAxMDtcclxuICAgICAgICB0aGlzLnJoID0gdGhpcy5oIC0gMTA7XHJcbiAgICAgICAgdGhpcy50b3AgPSAwO1xyXG5cclxuICAgICAgICB0aGlzLmNbMF0uc3R5bGUud2lkdGggPSB0aGlzLncgKydweCc7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmNbMV0gIT09IHVuZGVmaW5lZCApIHsgLy8gd2l0aCB0aXRsZVxyXG5cclxuICAgICAgICAgICAgdGhpcy5jWzFdLnN0eWxlLndpZHRoID0gdGhpcy53ICsncHgnO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vdGhpcy5jWzFdLnN0eWxlLmJhY2tncm91bmQgPSAnI2ZmMDAwMCc7XHJcbiAgICAgICAgICAgIC8vdGhpcy5jWzFdLnN0eWxlLnRleHRBbGlnbiA9ICdjZW50ZXInO1xyXG4gICAgICAgICAgICB0aGlzLnRvcCA9IDEwO1xyXG4gICAgICAgICAgICB0aGlzLmggKz0gMTA7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5naCA9IHRoaXMucmggLSAyODtcclxuICAgICAgICB0aGlzLmd3ID0gdGhpcy53IC0gMjg7XHJcblxyXG4gICAgICAgIHRoaXMuY1syXSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MudHh0ICsgJ3RleHQtYWxpZ246Y2VudGVyOyB0b3A6JysodGhpcy5oLTIwKSsncHg7IHdpZHRoOicrdGhpcy53KydweDsgY29sb3I6JysgdGhpcy5mb250Q29sb3IgKTtcclxuICAgICAgICB0aGlzLmNbMl0udGV4dENvbnRlbnQgPSB0aGlzLnZhbHVlO1xyXG5cclxuICAgICAgICBsZXQgc3ZnID0gdGhpcy5kb20oICdzdmcnLCB0aGlzLmNzcy5iYXNpYyAsIHsgdmlld0JveDonMCAwICcrdGhpcy53KycgJyt0aGlzLnJoLCB3aWR0aDp0aGlzLncsIGhlaWdodDp0aGlzLnJoLCBwcmVzZXJ2ZUFzcGVjdFJhdGlvOidub25lJyB9ICk7XHJcbiAgICAgICAgdGhpcy5zZXRDc3MoIHN2ZywgeyB3aWR0aDp0aGlzLncsIGhlaWdodDp0aGlzLnJoLCBsZWZ0OjAsIHRvcDp0aGlzLnRvcCB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5kb20oICdwYXRoJywgJycsIHsgZDonJywgc3Ryb2tlOnRoaXMuY29sb3JzLnRleHQsICdzdHJva2Utd2lkdGgnOjIsIGZpbGw6J25vbmUnLCAnc3Ryb2tlLWxpbmVjYXAnOididXR0JyB9LCBzdmcgKTtcclxuICAgICAgICB0aGlzLmRvbSggJ3JlY3QnLCAnJywgeyB4OjEwLCB5OjEwLCB3aWR0aDp0aGlzLmd3KzgsIGhlaWdodDp0aGlzLmdoKzgsIHN0cm9rZToncmdiYSgwLDAsMCwwLjMpJywgJ3N0cm9rZS13aWR0aCc6MSAsIGZpbGw6J25vbmUnfSwgc3ZnICk7XHJcblxyXG4gICAgICAgIHRoaXMuaXcgPSAoKHRoaXMuZ3ctKDQqKHRoaXMubG5nLTEpKSkvdGhpcy5sbmcpO1xyXG4gICAgICAgIGxldCB0ID0gW107XHJcbiAgICAgICAgdGhpcy5jTW9kZSA9IFtdO1xyXG5cclxuICAgICAgICB0aGlzLnYgPSBbXTtcclxuXHJcbiAgICAgICAgZm9yKCBsZXQgaSA9IDA7IGkgPCB0aGlzLmxuZzsgaSsrICl7XHJcblxyXG4gICAgICAgIFx0dFtpXSA9IFsgMTQgKyAoaSp0aGlzLml3KSArIChpKjQpLCB0aGlzLml3IF07XHJcbiAgICAgICAgXHR0W2ldWzJdID0gdFtpXVswXSArIHRbaV1bMV07XHJcbiAgICAgICAgXHR0aGlzLmNNb2RlW2ldID0gMDtcclxuXHJcbiAgICAgICAgICAgIGlmKCB0aGlzLm5lZyApIHRoaXMudltpXSA9ICgoMSsodGhpcy52YWx1ZVtpXSAvIHRoaXMubXVsdGlwbGljYXRvcikpKjAuNSk7XHJcbiAgICAgICAgXHRlbHNlIHRoaXMudltpXSA9IHRoaXMudmFsdWVbaV0gLyB0aGlzLm11bHRpcGxpY2F0b3I7XHJcblxyXG4gICAgICAgIFx0dGhpcy5kb20oICdyZWN0JywgJycsIHsgeDp0W2ldWzBdLCB5OjE0LCB3aWR0aDp0W2ldWzFdLCBoZWlnaHQ6MSwgZmlsbDp0aGlzLmZvbnRDb2xvciwgJ2ZpbGwtb3BhY2l0eSc6MC4zIH0sIHN2ZyApO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMudG1wID0gdDtcclxuICAgICAgICB0aGlzLmNbM10gPSBzdmc7XHJcblxyXG4gICAgICAgIC8vY29uc29sZS5sb2codGhpcy53KVxyXG5cclxuICAgICAgICB0aGlzLmluaXQoKTtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuY1sxXSAhPT0gdW5kZWZpbmVkICl7XHJcbiAgICAgICAgICAgIHRoaXMuY1sxXS5zdHlsZS50b3AgPSAwICsncHgnO1xyXG4gICAgICAgICAgICB0aGlzLmNbMV0uc3R5bGUuaGVpZ2h0ID0gMjAgKydweCc7XHJcbiAgICAgICAgICAgIHRoaXMuc1sxXS5saW5lSGVpZ2h0ID0gKDIwLTUpKydweCdcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMudXBkYXRlKCBmYWxzZSApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGVTVkcgKCkge1xyXG5cclxuICAgICAgICBpZiggdGhpcy5saW5lICkgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ2QnLCB0aGlzLm1ha2VQYXRoKCksIDAgKTtcclxuXHJcbiAgICAgICAgZm9yKGxldCBpID0gMDsgaTx0aGlzLmxuZzsgaSsrICl7XHJcblxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ2hlaWdodCcsIHRoaXMudltpXSp0aGlzLmdoLCBpKzIgKTtcclxuICAgICAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ3knLCAxNCArICh0aGlzLmdoIC0gdGhpcy52W2ldKnRoaXMuZ2gpLCBpKzIgKTtcclxuICAgICAgICAgICAgaWYoIHRoaXMubmVnICkgdGhpcy52YWx1ZVtpXSA9ICggKCh0aGlzLnZbaV0qMiktMSkgKiB0aGlzLm11bHRpcGxpY2F0b3IgKS50b0ZpeGVkKCB0aGlzLnByZWNpc2lvbiApICogMTtcclxuICAgICAgICAgICAgZWxzZSB0aGlzLnZhbHVlW2ldID0gKCAodGhpcy52W2ldICogdGhpcy5tdWx0aXBsaWNhdG9yKSApLnRvRml4ZWQoIHRoaXMucHJlY2lzaW9uICkgKiAxO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuY1syXS50ZXh0Q29udGVudCA9IHRoaXMudmFsdWU7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHRlc3Rab25lICggZSApIHtcclxuXHJcbiAgICAgICAgbGV0IGwgPSB0aGlzLmxvY2FsO1xyXG4gICAgICAgIGlmKCBsLnggPT09IC0xICYmIGwueSA9PT0gLTEgKSByZXR1cm4gJyc7XHJcblxyXG4gICAgICAgIGxldCBpID0gdGhpcy5sbmc7XHJcbiAgICAgICAgbGV0IHQgPSB0aGlzLnRtcDtcclxuICAgICAgICBcclxuXHQgICAgaWYoIGwueT50aGlzLnRvcCAmJiBsLnk8dGhpcy5oLTIwICl7XHJcblx0ICAgICAgICB3aGlsZSggaS0tICl7XHJcblx0ICAgICAgICAgICAgaWYoIGwueD50W2ldWzBdICYmIGwueDx0W2ldWzJdICkgcmV0dXJuIGk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuICcnXHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vZGUgKCBuLCBuYW1lICkge1xyXG5cclxuICAgIFx0aWYoIG4gPT09IHRoaXMuY01vZGVbbmFtZV0gKSByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgXHRsZXQgYTtcclxuXHJcbiAgICAgICAgc3dpdGNoKG4pe1xyXG4gICAgICAgICAgICBjYXNlIDA6IGE9MC4zOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAxOiBhPTAuNjsgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMjogYT0xOyBicmVhaztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucmVzZXQoKTtcclxuXHJcbiAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ2ZpbGwtb3BhY2l0eScsIGEsIG5hbWUgKyAyICk7XHJcbiAgICAgICAgdGhpcy5jTW9kZVtuYW1lXSA9IG47XHJcblxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG5cclxuXHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vICAgRVZFTlRTXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgcmVzZXQgKCkge1xyXG5cclxuICAgIFx0bGV0IG51cCA9IGZhbHNlO1xyXG4gICAgICAgIC8vdGhpcy5pc0Rvd24gPSBmYWxzZTtcclxuXHJcbiAgICAgICAgbGV0IGkgPSB0aGlzLmxuZztcclxuICAgICAgICB3aGlsZShpLS0peyBcclxuICAgICAgICAgICAgaWYoIHRoaXMuY01vZGVbaV0gIT09IDAgKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuY01vZGVbaV0gPSAwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ2ZpbGwtb3BhY2l0eScsIDAuMywgaSArIDIgKTtcclxuICAgICAgICAgICAgICAgIG51cCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBudXA7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vdXNldXAgKCBlICkge1xyXG5cclxuICAgICAgICB0aGlzLmlzRG93biA9IGZhbHNlO1xyXG4gICAgICAgIGlmKCB0aGlzLmN1cnJlbnQgIT09IC0xICkgcmV0dXJuIHRoaXMucmVzZXQoKTtcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBtb3VzZWRvd24gKCBlICkge1xyXG5cclxuICAgIFx0dGhpcy5pc0Rvd24gPSB0cnVlO1xyXG4gICAgICAgIHJldHVybiB0aGlzLm1vdXNlbW92ZSggZSApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb3VzZW1vdmUgKCBlICkge1xyXG5cclxuICAgIFx0bGV0IG51cCA9IGZhbHNlO1xyXG5cclxuICAgIFx0bGV0IG5hbWUgPSB0aGlzLnRlc3Rab25lKGUpO1xyXG5cclxuICAgIFx0aWYoIG5hbWUgPT09ICcnICl7XHJcblxyXG4gICAgICAgICAgICBudXAgPSB0aGlzLnJlc2V0KCk7XHJcbiAgICAgICAgICAgIC8vdGhpcy5jdXJzb3IoKTtcclxuXHJcbiAgICAgICAgfSBlbHNlIHsgXHJcblxyXG4gICAgICAgICAgICBudXAgPSB0aGlzLm1vZGUoIHRoaXMuaXNEb3duID8gMiA6IDEsIG5hbWUgKTtcclxuICAgICAgICAgICAgLy90aGlzLmN1cnNvciggdGhpcy5jdXJyZW50ICE9PSAtMSA/ICdtb3ZlJyA6ICdwb2ludGVyJyApO1xyXG4gICAgICAgICAgICBpZih0aGlzLmlzRG93bil7XHJcbiAgICAgICAgICAgIFx0dGhpcy52W25hbWVdID0gdGhpcy5jbGFtcCggMSAtICgoIGUuY2xpZW50WSAtIHRoaXMuem9uZS55IC0gdGhpcy50b3AgLSAxMCApIC8gdGhpcy5naCkgLCAwLCAxICk7XHJcbiAgICAgICAgICAgIFx0dGhpcy51cGRhdGUoIHRydWUgKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBudXA7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICB1cGRhdGUgKCB1cCApIHtcclxuXHJcbiAgICBcdHRoaXMudXBkYXRlU1ZHKCk7XHJcblxyXG4gICAgICAgIGlmKCB1cCApIHRoaXMuc2VuZCgpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBtYWtlUGF0aCAoKSB7XHJcblxyXG4gICAgXHRsZXQgcCA9IFwiXCIsIGgsIHcsIHduLCB3bSwgb3csIG9oO1xyXG4gICAgXHQvL2xldCBnID0gdGhpcy5pdyowLjVcclxuXHJcbiAgICBcdGZvcihsZXQgaSA9IDA7IGk8dGhpcy5sbmc7IGkrKyApe1xyXG5cclxuICAgIFx0XHRoID0gMTQgKyAodGhpcy5naCAtIHRoaXMudltpXSp0aGlzLmdoKTtcclxuICAgIFx0XHR3ID0gKDE0ICsgKGkqdGhpcy5pdykgKyAoaSo0KSk7XHJcblxyXG4gICAgXHRcdHdtID0gdyArIHRoaXMuaXcqMC41O1xyXG4gICAgXHRcdHduID0gdyArIHRoaXMuaXc7XHJcblxyXG4gICAgXHRcdGlmKGk9PT0wKSBwKz0nTSAnK3crJyAnKyBoICsgJyBUICcgKyB3bSArJyAnKyBoO1xyXG4gICAgXHRcdGVsc2UgcCArPSAnIEMgJyArIG93ICsnICcrIG9oICsgJywnICsgdyArJyAnKyBoICsgJywnICsgd20gKycgJysgaDtcclxuICAgIFx0XHRpZihpID09PSB0aGlzLmxuZy0xKSBwKz0nIFQgJyArIHduICsnICcrIGg7XHJcblxyXG4gICAgXHRcdG93ID0gd25cclxuICAgIFx0XHRvaCA9IGggXHJcblxyXG4gICAgXHR9XHJcblxyXG4gICAgXHRyZXR1cm4gcDtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgclNpemUgKCkge1xyXG5cclxuICAgICAgICBzdXBlci5yU2l6ZSgpO1xyXG5cclxuICAgICAgICBsZXQgcyA9IHRoaXMucztcclxuICAgICAgICBpZiggdGhpcy5jWzFdICE9PSB1bmRlZmluZWQgKSBzWzFdLndpZHRoID0gdGhpcy53ICsgJ3B4JztcclxuICAgICAgICBzWzJdLndpZHRoID0gdGhpcy53ICsgJ3B4JztcclxuICAgICAgICBzWzNdLndpZHRoID0gdGhpcy53ICsgJ3B4JztcclxuXHJcbiAgICAgICAgbGV0IGd3ID0gdGhpcy53IC0gMjg7XHJcbiAgICAgICAgbGV0IGl3ID0gKChndy0oNCoodGhpcy5sbmctMSkpKS90aGlzLmxuZyk7XHJcblxyXG4gICAgICAgIGxldCB0ID0gW107XHJcblxyXG4gICAgICAgIGZvciggbGV0IGkgPSAwOyBpIDwgdGhpcy5sbmc7IGkrKyApe1xyXG5cclxuICAgICAgICAgICAgdFtpXSA9IFsgMTQgKyAoaSppdykgKyAoaSo0KSwgaXcgXTtcclxuICAgICAgICAgICAgdFtpXVsyXSA9IHRbaV1bMF0gKyB0W2ldWzFdO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMudG1wID0gdDtcclxuXHJcbiAgICB9XHJcblxyXG59IiwiXHJcbmltcG9ydCB7IFJvb3RzIH0gZnJvbSAnLi4vY29yZS9Sb290cyc7XHJcbmltcG9ydCB7IFByb3RvIH0gZnJvbSAnLi4vY29yZS9Qcm90byc7XHJcblxyXG5leHBvcnQgY2xhc3MgR3JvdXAgZXh0ZW5kcyBQcm90byB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoIG8gPSB7fSApIHtcclxuXHJcbiAgICAgICAgc3VwZXIoIG8gKTtcclxuXHJcbiAgICAgICAgdGhpcy5BREQgPSBvLmFkZDtcclxuXHJcbiAgICAgICAgdGhpcy51aXMgPSBbXTtcclxuXHJcbiAgICAgICAgdGhpcy5pc0VtcHR5ID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgdGhpcy5hdXRvSGVpZ2h0ID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmN1cnJlbnQgPSAtMTtcclxuICAgICAgICB0aGlzLnRhcmdldCA9IG51bGw7XHJcblxyXG4gICAgICAgIHRoaXMuZGVjYWwgPSAwO1xyXG5cclxuICAgICAgICB0aGlzLmJhc2VIID0gdGhpcy5oO1xyXG5cclxuICAgICAgICBsZXQgZmx0b3AgPSBNYXRoLmZsb29yKHRoaXMuaCowLjUpLTY7XHJcblxyXG4gICAgICAgIHRoaXMuaXNMaW5lID0gby5saW5lICE9PSB1bmRlZmluZWQgPyBvLmxpbmUgOiBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy5jWzJdID0gdGhpcy5kb20oICdkaXYnLCB0aGlzLmNzcy5iYXNpYyArICd3aWR0aDoxMDAlOyBsZWZ0OjA7IGhlaWdodDphdXRvOyBvdmVyZmxvdzpoaWRkZW47IHRvcDonK3RoaXMuaCsncHgnKTtcclxuICAgICAgICB0aGlzLmNbM10gPSB0aGlzLmRvbSggJ3BhdGgnLCB0aGlzLmNzcy5iYXNpYyArICdwb3NpdGlvbjphYnNvbHV0ZTsgd2lkdGg6MTBweDsgaGVpZ2h0OjEwcHg7IGxlZnQ6MDsgdG9wOicrZmx0b3ArJ3B4OycsIHsgZDp0aGlzLnN2Z3MuZ3JvdXAsIGZpbGw6dGhpcy5mb250Q29sb3IsIHN0cm9rZTonbm9uZSd9KTtcclxuICAgICAgICB0aGlzLmNbNF0gPSB0aGlzLmRvbSggJ3BhdGgnLCB0aGlzLmNzcy5iYXNpYyArICdwb3NpdGlvbjphYnNvbHV0ZTsgd2lkdGg6MTBweDsgaGVpZ2h0OjEwcHg7IGxlZnQ6NHB4OyB0b3A6JytmbHRvcCsncHg7JywgeyBkOnRoaXMuc3Zncy5hcnJvdywgZmlsbDp0aGlzLmZvbnRDb2xvciwgc3Ryb2tlOidub25lJ30pO1xyXG4gICAgICAgIC8vIGJvdHRvbSBsaW5lXHJcbiAgICAgICAgaWYoIHRoaXMuaXNMaW5lICkgdGhpcy5jWzVdID0gdGhpcy5kb20oICdkaXYnLCB0aGlzLmNzcy5iYXNpYyArICAnYmFja2dyb3VuZDpyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMik7IHdpZHRoOjEwMCU7IGxlZnQ6MDsgaGVpZ2h0OjFweDsgYm90dG9tOjBweCcpO1xyXG5cclxuICAgICAgICBsZXQgcyA9IHRoaXMucztcclxuXHJcblxyXG5cclxuICAgICAgICBzWzBdLmhlaWdodCA9IHRoaXMuaCArICdweCc7XHJcbiAgICAgICAgc1sxXS5oZWlnaHQgPSB0aGlzLmggKyAncHgnO1xyXG4gICAgICAgIHRoaXMuY1sxXS5uYW1lID0gJ2dyb3VwJztcclxuXHJcbiAgICAgICAgc1sxXS5tYXJnaW5MZWZ0ID0gJzEwcHgnO1xyXG4gICAgICAgIHNbMV0ubGluZUhlaWdodCA9IHRoaXMuaC00O1xyXG4gICAgICAgIHNbMV0uY29sb3IgPSB0aGlzLmZvbnRDb2xvcjtcclxuICAgICAgICBzWzFdLmZvbnRXZWlnaHQgPSAnYm9sZCc7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLnJhZGl1cyAhPT0gMCApIHNbMF0uYm9yZGVyUmFkaXVzID0gdGhpcy5yYWRpdXMrJ3B4JzsgXHJcbiAgICAgICAgc1swXS5ib3JkZXIgPSB0aGlzLmNvbG9ycy5ncm91cEJvcmRlcjtcclxuXHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5pbml0KCk7XHJcblxyXG4gICAgICAgIC8vaWYoIG8uYmcgIT09IHVuZGVmaW5lZCApIHRoaXMuc2V0Qkcoby5iZyk7XHJcbiAgICAgICAgdGhpcy5zZXRCRyggdGhpcy5iZyApO1xyXG4gICAgICAgIGlmKCBvLm9wZW4gIT09IHVuZGVmaW5lZCApIHRoaXMub3BlbigpO1xyXG5cclxuXHJcbiAgICAgICAgLy9zWzBdLmJhY2tncm91bmQgPSB0aGlzLmJnO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB0ZXN0Wm9uZSAoIGUgKSB7XHJcblxyXG4gICAgICAgIGxldCBsID0gdGhpcy5sb2NhbDtcclxuICAgICAgICBpZiggbC54ID09PSAtMSAmJiBsLnkgPT09IC0xICkgcmV0dXJuICcnO1xyXG5cclxuICAgICAgICBsZXQgbmFtZSA9ICcnO1xyXG5cclxuICAgICAgICBpZiggbC55IDwgdGhpcy5iYXNlSCApIG5hbWUgPSAndGl0bGUnO1xyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBpZiggdGhpcy5pc09wZW4gKSBuYW1lID0gJ2NvbnRlbnQnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIG5hbWU7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGNsZWFyVGFyZ2V0ICgpIHtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuY3VycmVudCA9PT0gLTEgKSByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgICAgLy8gaWYoIXRoaXMudGFyZ2V0KSByZXR1cm47XHJcbiAgICAgICAgdGhpcy50YXJnZXQudWlvdXQoKTtcclxuICAgICAgICB0aGlzLnRhcmdldC5yZXNldCgpO1xyXG4gICAgICAgIHRoaXMuY3VycmVudCA9IC0xO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0ID0gbnVsbDtcclxuICAgICAgICB0aGlzLmN1cnNvcigpO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICByZXNldCAoKSB7XHJcblxyXG4gICAgICAgIHRoaXMuY2xlYXJUYXJnZXQoKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBFVkVOVFNcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBoYW5kbGVFdmVudCAoIGUgKSB7XHJcblxyXG4gICAgICAgIGxldCB0eXBlID0gZS50eXBlO1xyXG5cclxuICAgICAgICBsZXQgY2hhbmdlID0gZmFsc2U7XHJcbiAgICAgICAgbGV0IHRhcmdldENoYW5nZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICBsZXQgbmFtZSA9IHRoaXMudGVzdFpvbmUoIGUgKTtcclxuXHJcbiAgICAgICAgaWYoICFuYW1lICkgcmV0dXJuO1xyXG5cclxuICAgICAgICBzd2l0Y2goIG5hbWUgKXtcclxuXHJcbiAgICAgICAgICAgIGNhc2UgJ2NvbnRlbnQnOlxyXG4gICAgICAgICAgICB0aGlzLmN1cnNvcigpO1xyXG5cclxuICAgICAgICAgICAgaWYoIFJvb3RzLmlzTW9iaWxlICYmIHR5cGUgPT09ICdtb3VzZWRvd24nICkgdGhpcy5nZXROZXh0KCBlLCBjaGFuZ2UgKTtcclxuXHJcbiAgICAgICAgICAgIGlmKCB0aGlzLnRhcmdldCApIHRhcmdldENoYW5nZSA9IHRoaXMudGFyZ2V0LmhhbmRsZUV2ZW50KCBlICk7XHJcblxyXG4gICAgICAgICAgICAvL2lmKCB0eXBlID09PSAnbW91c2Vtb3ZlJyApIGNoYW5nZSA9IHRoaXMuc3R5bGVzKCdkZWYnKTtcclxuXHJcbiAgICAgICAgICAgIGlmKCAhUm9vdHMubG9jayApIHRoaXMuZ2V0TmV4dCggZSwgY2hhbmdlICk7XHJcblxyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAndGl0bGUnOlxyXG4gICAgICAgICAgICB0aGlzLmN1cnNvcigncG9pbnRlcicpO1xyXG4gICAgICAgICAgICBpZiggdHlwZSA9PT0gJ21vdXNlZG93bicgKXtcclxuICAgICAgICAgICAgICAgIGlmKCB0aGlzLmlzT3BlbiApIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgIGVsc2UgdGhpcy5vcGVuKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYnJlYWs7XHJcblxyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmlzRG93biApIGNoYW5nZSA9IHRydWU7XHJcbiAgICAgICAgaWYoIHRhcmdldENoYW5nZSApIGNoYW5nZSA9IHRydWU7XHJcblxyXG4gICAgICAgIHJldHVybiBjaGFuZ2U7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGdldE5leHQgKCBlLCBjaGFuZ2UgKSB7XHJcblxyXG4gICAgICAgIGxldCBuZXh0ID0gUm9vdHMuZmluZFRhcmdldCggdGhpcy51aXMsIGUgKTtcclxuXHJcbiAgICAgICAgaWYoIG5leHQgIT09IHRoaXMuY3VycmVudCApe1xyXG4gICAgICAgICAgICB0aGlzLmNsZWFyVGFyZ2V0KCk7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudCA9IG5leHQ7XHJcbiAgICAgICAgICAgIGNoYW5nZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiggbmV4dCAhPT0gLTEgKXsgXHJcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0ID0gdGhpcy51aXNbIHRoaXMuY3VycmVudCBdO1xyXG4gICAgICAgICAgICB0aGlzLnRhcmdldC51aW92ZXIoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBjYWxjSCAoKSB7XHJcblxyXG4gICAgICAgIGxldCBsbmcgPSB0aGlzLnVpcy5sZW5ndGgsIGksIHUsICBoPTAsIHB4PTAsIHRtcGg9MDtcclxuICAgICAgICBmb3IoIGkgPSAwOyBpIDwgbG5nOyBpKyspe1xyXG4gICAgICAgICAgICB1ID0gdGhpcy51aXNbaV07XHJcbiAgICAgICAgICAgIGlmKCAhdS5hdXRvV2lkdGggKXtcclxuXHJcbiAgICAgICAgICAgICAgICBpZihweD09PTApIGggKz0gdS5oKzE7XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZih0bXBoPHUuaCkgaCArPSB1LmgtdG1waDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRtcGggPSB1Lmg7XHJcblxyXG4gICAgICAgICAgICAgICAgLy90bXBoID0gdG1waCA8IHUuaCA/IHUuaCA6IHRtcGg7XHJcbiAgICAgICAgICAgICAgICBweCArPSB1Lnc7XHJcbiAgICAgICAgICAgICAgICBpZiggcHgrdS53ID4gdGhpcy53ICkgcHggPSAwO1xyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGggKz0gdS5oKzE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gaDtcclxuICAgIH1cclxuXHJcbiAgICBjYWxjVWlzICgpIHtcclxuXHJcbiAgICAgICAgaWYoICF0aGlzLmlzT3BlbiApIHJldHVybjtcclxuXHJcbiAgICAgICAgUm9vdHMuY2FsY1VpcyggdGhpcy51aXMsIHRoaXMuem9uZSwgdGhpcy56b25lLnkgKyB0aGlzLmJhc2VIICk7XHJcblxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBzZXRCRyAoIGMgKSB7XHJcblxyXG4gICAgICAgIHRoaXMuc1swXS5iYWNrZ3JvdW5kID0gYztcclxuXHJcbiAgICAgICAgbGV0IGkgPSB0aGlzLnVpcy5sZW5ndGg7XHJcbiAgICAgICAgd2hpbGUoaS0tKXtcclxuICAgICAgICAgICAgdGhpcy51aXNbaV0uc2V0QkcoIGMgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGFkZCAoKSB7XHJcblxyXG4gICAgICAgIGxldCBhID0gYXJndW1lbnRzO1xyXG5cclxuICAgICAgICBpZiggdHlwZW9mIGFbMV0gPT09ICdvYmplY3QnICl7IFxyXG4gICAgICAgICAgICBhWzFdLmlzVUkgPSB0aGlzLmlzVUk7XHJcbiAgICAgICAgICAgIGFbMV0udGFyZ2V0ID0gdGhpcy5jWzJdO1xyXG4gICAgICAgICAgICBhWzFdLm1haW4gPSB0aGlzLm1haW47XHJcbiAgICAgICAgfSBlbHNlIGlmKCB0eXBlb2YgYXJndW1lbnRzWzFdID09PSAnc3RyaW5nJyApe1xyXG4gICAgICAgICAgICBpZiggYVsyXSA9PT0gdW5kZWZpbmVkICkgW10ucHVzaC5jYWxsKCBhLCB7IGlzVUk6dHJ1ZSwgdGFyZ2V0OnRoaXMuY1syXSwgbWFpbjp0aGlzLm1haW4gfSk7XHJcbiAgICAgICAgICAgIGVsc2V7IFxyXG4gICAgICAgICAgICAgICAgYVsyXS5pc1VJID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGFbMl0udGFyZ2V0ID0gdGhpcy5jWzJdO1xyXG4gICAgICAgICAgICAgICAgYVsyXS5tYWluID0gdGhpcy5tYWluO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvL2xldCBuID0gYWRkLmFwcGx5KCB0aGlzLCBhICk7XHJcbiAgICAgICAgbGV0IHUgPSB0aGlzLkFERC5hcHBseSggdGhpcywgYSApO1xyXG5cclxuICAgICAgICB0aGlzLnVpcy5wdXNoKCB1ICk7XHJcblxyXG4gICAgICAgIC8vaWYoIHUuYXV0b0hlaWdodCApIHUucGFyZW50R3JvdXAgPSB0aGlzO1xyXG4gICAgICAgIC8vaWYoIHUuaXNHcm91cCApIFxyXG5cclxuICAgICAgICB1Lmdyb3VwID0gdGhpcztcclxuXHJcbiAgICAgICAgdGhpcy5pc0VtcHR5ID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHJldHVybiB1O1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyByZW1vdmUgb25lIG5vZGVcclxuXHJcbiAgICByZW1vdmUgKCBuICkge1xyXG5cclxuICAgICAgICBpZiggbi5jbGVhciApIG4uY2xlYXIoKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gY2xlYXIgYWxsIGluZXIgXHJcblxyXG4gICAgZW1wdHkgKCkge1xyXG5cclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcblxyXG4gICAgICAgIGxldCBpID0gdGhpcy51aXMubGVuZ3RoLCBpdGVtO1xyXG5cclxuICAgICAgICB3aGlsZSggaS0tICl7XHJcbiAgICAgICAgICAgIGl0ZW0gPSB0aGlzLnVpcy5wb3AoKTtcclxuICAgICAgICAgICAgdGhpcy5jWzJdLnJlbW92ZUNoaWxkKCBpdGVtLmNbMF0gKTtcclxuICAgICAgICAgICAgaXRlbS5jbGVhciggdHJ1ZSApO1xyXG5cclxuICAgICAgICAgICAgLy90aGlzLnVpc1tpXS5jbGVhcigpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmlzRW1wdHkgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuaCA9IHRoaXMuYmFzZUg7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIGNsZWFyIG9uZSBlbGVtZW50XHJcblxyXG4gICAgY2xlYXJPbmUgKCBuICkgeyBcclxuXHJcbiAgICAgICAgbGV0IGlkID0gdGhpcy51aXMuaW5kZXhPZiggbiApO1xyXG5cclxuICAgICAgICBpZiAoIGlkICE9PSAtMSApIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxjKCAtICggdGhpcy51aXNbIGlkIF0uaCArIDEgKSApO1xyXG4gICAgICAgICAgICB0aGlzLmNbMl0ucmVtb3ZlQ2hpbGQoIHRoaXMudWlzWyBpZCBdLmNbMF0gKTtcclxuICAgICAgICAgICAgdGhpcy51aXMuc3BsaWNlKCBpZCwgMSApOyBcclxuXHJcbiAgICAgICAgICAgIGlmKCB0aGlzLnVpcy5sZW5ndGggPT09IDAgKXsgXHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzRW1wdHkgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBwYXJlbnRIZWlnaHQgKCB0ICkge1xyXG5cclxuICAgICAgICAvL2lmICggdGhpcy5wYXJlbnRHcm91cCAhPT0gbnVsbCApIHRoaXMucGFyZW50R3JvdXAuY2FsYyggdCApO1xyXG4gICAgICAgIGlmICggdGhpcy5ncm91cCAhPT0gbnVsbCApIHRoaXMuZ3JvdXAuY2FsYyggdCApO1xyXG4gICAgICAgIGVsc2UgaWYgKCB0aGlzLmlzVUkgKSB0aGlzLm1haW4uY2FsYyggdCApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBvcGVuICgpIHtcclxuXHJcbiAgICAgICAgc3VwZXIub3BlbigpO1xyXG5cclxuICAgICAgICB0aGlzLnNldFN2ZyggdGhpcy5jWzRdLCAnZCcsIHRoaXMuc3Zncy5hcnJvd0Rvd24gKTtcclxuICAgICAgICB0aGlzLnJTaXplQ29udGVudCgpO1xyXG5cclxuICAgICAgICBsZXQgdCA9IHRoaXMuaCAtIHRoaXMuYmFzZUg7XHJcblxyXG4gICAgICAgIHRoaXMucGFyZW50SGVpZ2h0KCB0ICk7XHJcblxyXG4gICAgICAgIC8vY29uc29sZS5sb2coIHRoaXMudWlzICk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlICgpIHtcclxuXHJcbiAgICAgICAgc3VwZXIuY2xvc2UoKTtcclxuXHJcbiAgICAgICAgbGV0IHQgPSB0aGlzLmggLSB0aGlzLmJhc2VIO1xyXG5cclxuICAgICAgICB0aGlzLnNldFN2ZyggdGhpcy5jWzRdLCAnZCcsIHRoaXMuc3Zncy5hcnJvdyApO1xyXG4gICAgICAgIHRoaXMuaCA9IHRoaXMuYmFzZUg7XHJcbiAgICAgICAgdGhpcy5zWzBdLmhlaWdodCA9IHRoaXMuaCArICdweCc7XHJcblxyXG4gICAgICAgIHRoaXMucGFyZW50SGVpZ2h0KCAtdCApO1xyXG5cclxuICAgICAgICAvL2NvbnNvbGUubG9nKCB0aGlzLnVpcyApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBjbGVhciAoKSB7XHJcblxyXG4gICAgICAgIHRoaXMuZW1wdHkoKTtcclxuICAgICAgICBpZiggdGhpcy5pc1VJICkgdGhpcy5tYWluLmNhbGMoIC0oIHRoaXMuaCArIDEgKSk7XHJcbiAgICAgICAgUHJvdG8ucHJvdG90eXBlLmNsZWFyLmNhbGwoIHRoaXMgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgY2xlYXJHcm91cCAoKSB7XHJcblxyXG4gICAgICAgIHRoaXMuZW1wdHkoKTtcclxuXHJcbiAgICAgICAgLyp0aGlzLmNsb3NlKCk7XHJcblxyXG4gICAgICAgIGxldCBpID0gdGhpcy51aXMubGVuZ3RoO1xyXG4gICAgICAgIHdoaWxlKGktLSl7XHJcbiAgICAgICAgICAgIHRoaXMudWlzW2ldLmNsZWFyKCk7ICAgXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMudWlzID0gW107XHJcbiAgICAgICAgdGhpcy5oID0gdGhpcy5iYXNlSDsqL1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBjYWxjICggeSApIHtcclxuXHJcbiAgICAgICAgaWYoICF0aGlzLmlzT3BlbiApIHJldHVybjtcclxuXHJcbiAgICAgICAgaWYoIHkgIT09IHVuZGVmaW5lZCApeyBcclxuICAgICAgICAgICAgdGhpcy5oICs9IHk7XHJcbiAgICAgICAgICAgIGlmKCB0aGlzLmlzVUkgKSB0aGlzLm1haW4uY2FsYyggeSApO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuaCA9IHRoaXMuY2FsY0goKSArIHRoaXMuYmFzZUg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc1swXS5oZWlnaHQgPSB0aGlzLmggKyAncHgnO1xyXG5cclxuICAgICAgICAvL2lmKHRoaXMuaXNPcGVuKSB0aGlzLmNhbGNVaXMoKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgclNpemVDb250ZW50ICgpIHtcclxuXHJcbiAgICAgICAgbGV0IGkgPSB0aGlzLnVpcy5sZW5ndGg7XHJcbiAgICAgICAgd2hpbGUoaS0tKXtcclxuICAgICAgICAgICAgdGhpcy51aXNbaV0uc2V0U2l6ZSggdGhpcy53ICk7XHJcbiAgICAgICAgICAgIHRoaXMudWlzW2ldLnJTaXplKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY2FsYygpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICByU2l6ZSAoKSB7XHJcblxyXG4gICAgICAgIHN1cGVyLnJTaXplKCk7XHJcblxyXG4gICAgICAgIGxldCBzID0gdGhpcy5zO1xyXG5cclxuICAgICAgICBzWzNdLmxlZnQgPSAoIHRoaXMuc2EgKyB0aGlzLnNiIC0gMTcgKSArICdweCc7XHJcbiAgICAgICAgc1sxXS53aWR0aCA9IHRoaXMudyArICdweCc7XHJcbiAgICAgICAgc1syXS53aWR0aCA9IHRoaXMudyArICdweCc7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmlzT3BlbiApIHRoaXMuclNpemVDb250ZW50KCk7XHJcblxyXG4gICAgfVxyXG5cclxufVxyXG5cclxuR3JvdXAucHJvdG90eXBlLmlzR3JvdXAgPSB0cnVlOyIsImltcG9ydCB7IFByb3RvIH0gZnJvbSAnLi4vY29yZS9Qcm90byc7XHJcbmltcG9ydCB7IFYyIH0gZnJvbSAnLi4vY29yZS9WMic7XHJcblxyXG5leHBvcnQgY2xhc3MgSm95c3RpY2sgZXh0ZW5kcyBQcm90byB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoIG8gPSB7fSApIHtcclxuXHJcbiAgICAgICAgc3VwZXIoIG8gKTtcclxuXHJcbiAgICAgICAgdGhpcy5hdXRvV2lkdGggPSBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IFswLDBdO1xyXG5cclxuICAgICAgICB0aGlzLmpveVR5cGUgPSAnYW5hbG9naXF1ZSc7XHJcbiAgICAgICAgdGhpcy5tb2RlbCA9IG8ubW9kZSAhPT0gdW5kZWZpbmVkID8gby5tb2RlIDogMDtcclxuXHJcbiAgICAgICAgdGhpcy5wcmVjaXNpb24gPSBvLnByZWNpc2lvbiB8fCAyO1xyXG4gICAgICAgIHRoaXMubXVsdGlwbGljYXRvciA9IG8ubXVsdGlwbGljYXRvciB8fCAxO1xyXG5cclxuICAgICAgICB0aGlzLnBvcyA9IG5ldyBWMigpO1xyXG4gICAgICAgIHRoaXMudG1wID0gbmV3IFYyKCk7XHJcblxyXG4gICAgICAgIHRoaXMuaW50ZXJ2YWwgPSBudWxsO1xyXG5cclxuICAgICAgICB0aGlzLnJhZGl1cyA9IHRoaXMudyAqIDAuNTtcclxuICAgICAgICB0aGlzLmRpc3RhbmNlID0gdGhpcy5yYWRpdXMqMC4yNTtcclxuXHJcbiAgICAgICAgdGhpcy5oID0gby5oIHx8IHRoaXMudyArIDEwO1xyXG4gICAgICAgIHRoaXMudG9wID0gMDtcclxuXHJcbiAgICAgICAgdGhpcy5jWzBdLnN0eWxlLndpZHRoID0gdGhpcy53ICsncHgnO1xyXG5cclxuICAgICAgICBpZiggdGhpcy5jWzFdICE9PSB1bmRlZmluZWQgKSB7IC8vIHdpdGggdGl0bGVcclxuXHJcbiAgICAgICAgICAgIHRoaXMuY1sxXS5zdHlsZS53aWR0aCA9IHRoaXMudyArJ3B4JztcclxuICAgICAgICAgICAgdGhpcy5jWzFdLnN0eWxlLnRleHRBbGlnbiA9ICdjZW50ZXInO1xyXG4gICAgICAgICAgICB0aGlzLnRvcCA9IDEwO1xyXG4gICAgICAgICAgICB0aGlzLmggKz0gMTA7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5jWzJdID0gdGhpcy5kb20oICdkaXYnLCB0aGlzLmNzcy50eHQgKyAndGV4dC1hbGlnbjpjZW50ZXI7IHRvcDonKyh0aGlzLmgtMjApKydweDsgd2lkdGg6Jyt0aGlzLncrJ3B4OyBjb2xvcjonKyB0aGlzLmZvbnRDb2xvciApO1xyXG4gICAgICAgIHRoaXMuY1syXS50ZXh0Q29udGVudCA9IHRoaXMudmFsdWU7XHJcblxyXG4gICAgICAgIHRoaXMuY1szXSA9IHRoaXMuZ2V0Sm95c3RpY2soIHRoaXMubW9kZWwgKTtcclxuICAgICAgICB0aGlzLnNldFN2ZyggdGhpcy5jWzNdLCAndmlld0JveCcsICcwIDAgJyt0aGlzLncrJyAnK3RoaXMudyApO1xyXG4gICAgICAgIHRoaXMuc2V0Q3NzKCB0aGlzLmNbM10sIHsgd2lkdGg6dGhpcy53LCBoZWlnaHQ6dGhpcy53LCBsZWZ0OjAsIHRvcDp0aGlzLnRvcCB9KTtcclxuXHJcblxyXG4gICAgICAgIHRoaXMucmF0aW8gPSAxMjgvdGhpcy53O1xyXG5cclxuICAgICAgICB0aGlzLmluaXQoKTtcclxuXHJcbiAgICAgICAgdGhpcy51cGRhdGUoZmFsc2UpO1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIG1vZGUgKCBtb2RlICkge1xyXG5cclxuICAgICAgICBzd2l0Y2gobW9kZSl7XHJcbiAgICAgICAgICAgIGNhc2UgMDogLy8gYmFzZVxyXG4gICAgICAgICAgICAgICAgaWYodGhpcy5tb2RlbD09PTApe1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdmaWxsJywgJ3VybCgjZ3JhZEluKScsIDQgKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN2ZyggdGhpcy5jWzNdLCAnc3Ryb2tlJywgJyMwMDAnLCA0ICk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdzdHJva2UnLCAncmdiYSgxMDAsMTAwLDEwMCwwLjI1KScsIDIgKTtcclxuICAgICAgICAgICAgICAgICAgICAvL3RoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdzdHJva2UnLCAncmdiKDAsMCwwLDAuMSknLCAzICk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ3N0cm9rZScsICcjNjY2JywgNCApO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdmaWxsJywgJ25vbmUnLCA0ICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMTogLy8gb3ZlclxyXG4gICAgICAgICAgICAgICAgaWYodGhpcy5tb2RlbD09PTApe1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdmaWxsJywgJ3VybCgjZ3JhZEluMiknLCA0ICk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ3N0cm9rZScsICdyZ2JhKDAsMCwwLDApJywgNCApO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN2ZyggdGhpcy5jWzNdLCAnc3Ryb2tlJywgJ3JnYmEoNDgsMTM4LDI1NSwwLjI1KScsIDIgKTtcclxuICAgICAgICAgICAgICAgICAgICAvL3RoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdzdHJva2UnLCAncmdiKDAsMCwwLDAuMyknLCAzICk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ3N0cm9rZScsIHRoaXMuY29sb3JzLnNlbGVjdCwgNCApO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdmaWxsJywgJ3JnYmEoNDgsMTM4LDI1NSwwLjI1KScsIDQgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMjogLy8gZWRpdFxyXG4gICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vICAgRVZFTlRTXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgYWRkSW50ZXJ2YWwgKCl7XHJcbiAgICAgICAgaWYoIHRoaXMuaW50ZXJ2YWwgIT09IG51bGwgKSB0aGlzLnN0b3BJbnRlcnZhbCgpO1xyXG4gICAgICAgIGlmKCB0aGlzLnBvcy5pc1plcm8oKSApIHJldHVybjtcclxuICAgICAgICB0aGlzLmludGVydmFsID0gc2V0SW50ZXJ2YWwoIGZ1bmN0aW9uKCl7IHRoaXMudXBkYXRlKCk7IH0uYmluZCh0aGlzKSwgMTAgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgc3RvcEludGVydmFsICgpe1xyXG5cclxuICAgICAgICBpZiggdGhpcy5pbnRlcnZhbCA9PT0gbnVsbCApIHJldHVybjtcclxuICAgICAgICBjbGVhckludGVydmFsKCB0aGlzLmludGVydmFsICk7XHJcbiAgICAgICAgdGhpcy5pbnRlcnZhbCA9IG51bGw7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHJlc2V0ICgpIHtcclxuXHJcbiAgICAgICAgdGhpcy5hZGRJbnRlcnZhbCgpO1xyXG4gICAgICAgIHRoaXMubW9kZSgwKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW91c2V1cCAoIGUgKSB7XHJcblxyXG4gICAgICAgIHRoaXMuYWRkSW50ZXJ2YWwoKTtcclxuICAgICAgICB0aGlzLmlzRG93biA9IGZhbHNlO1xyXG4gICAgXHJcbiAgICB9XHJcblxyXG4gICAgbW91c2Vkb3duICggZSApIHtcclxuXHJcbiAgICAgICAgdGhpcy5pc0Rvd24gPSB0cnVlO1xyXG4gICAgICAgIHRoaXMubW91c2Vtb3ZlKCBlICk7XHJcbiAgICAgICAgdGhpcy5tb2RlKCAyICk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vdXNlbW92ZSAoIGUgKSB7XHJcblxyXG4gICAgICAgIHRoaXMubW9kZSgxKTtcclxuXHJcbiAgICAgICAgaWYoICF0aGlzLmlzRG93biApIHJldHVybjtcclxuXHJcbiAgICAgICAgdGhpcy50bXAueCA9IHRoaXMucmFkaXVzIC0gKCBlLmNsaWVudFggLSB0aGlzLnpvbmUueCApO1xyXG4gICAgICAgIHRoaXMudG1wLnkgPSB0aGlzLnJhZGl1cyAtICggZS5jbGllbnRZIC0gdGhpcy56b25lLnkgLSB0aGlzLnRvcCApO1xyXG5cclxuICAgICAgICBsZXQgZGlzdGFuY2UgPSB0aGlzLnRtcC5sZW5ndGgoKTtcclxuXHJcbiAgICAgICAgaWYgKCBkaXN0YW5jZSA+IHRoaXMuZGlzdGFuY2UgKSB7XHJcbiAgICAgICAgICAgIGxldCBhbmdsZSA9IE1hdGguYXRhbjIodGhpcy50bXAueCwgdGhpcy50bXAueSk7XHJcbiAgICAgICAgICAgIHRoaXMudG1wLnggPSBNYXRoLnNpbiggYW5nbGUgKSAqIHRoaXMuZGlzdGFuY2U7XHJcbiAgICAgICAgICAgIHRoaXMudG1wLnkgPSBNYXRoLmNvcyggYW5nbGUgKSAqIHRoaXMuZGlzdGFuY2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnBvcy5jb3B5KCB0aGlzLnRtcCApLmRpdmlkZVNjYWxhciggdGhpcy5kaXN0YW5jZSApLm5lZ2F0ZSgpO1xyXG5cclxuICAgICAgICB0aGlzLnVwZGF0ZSgpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBzZXRWYWx1ZSAoIHYgKSB7XHJcblxyXG4gICAgICAgIGlmKHY9PT11bmRlZmluZWQpIHY9WzAsMF07XHJcblxyXG4gICAgICAgIHRoaXMucG9zLnNldCggdlswXSB8fCAwLCB2WzFdICB8fCAwICk7XHJcbiAgICAgICAgdGhpcy51cGRhdGVTVkcoKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlICggdXAgKSB7XHJcblxyXG4gICAgICAgIGlmKCB1cCA9PT0gdW5kZWZpbmVkICkgdXAgPSB0cnVlO1xyXG5cclxuICAgICAgICBpZiggdGhpcy5pbnRlcnZhbCAhPT0gbnVsbCApe1xyXG5cclxuICAgICAgICAgICAgaWYoICF0aGlzLmlzRG93biApe1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMucG9zLmxlcnAoIG51bGwsIDAuMyApO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMucG9zLnggPSBNYXRoLmFicyggdGhpcy5wb3MueCApIDwgMC4wMSA/IDAgOiB0aGlzLnBvcy54O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wb3MueSA9IE1hdGguYWJzKCB0aGlzLnBvcy55ICkgPCAwLjAxID8gMCA6IHRoaXMucG9zLnk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoIHRoaXMuaXNVSSAmJiB0aGlzLm1haW4uaXNDYW52YXMgKSB0aGlzLm1haW4uZHJhdygpO1xyXG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMudXBkYXRlU1ZHKCk7XHJcblxyXG4gICAgICAgIGlmKCB1cCApIHRoaXMuc2VuZCgpO1xyXG4gICAgICAgIFxyXG5cclxuICAgICAgICBpZiggdGhpcy5wb3MuaXNaZXJvKCkgKSB0aGlzLnN0b3BJbnRlcnZhbCgpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGVTVkcgKCkge1xyXG5cclxuICAgICAgICBsZXQgeCA9IHRoaXMucmFkaXVzIC0gKCAtdGhpcy5wb3MueCAqIHRoaXMuZGlzdGFuY2UgKTtcclxuICAgICAgICBsZXQgeSA9IHRoaXMucmFkaXVzIC0gKCAtdGhpcy5wb3MueSAqIHRoaXMuZGlzdGFuY2UgKTtcclxuXHJcbiAgICAgICAgIGlmKHRoaXMubW9kZWwgPT09IDApe1xyXG5cclxuICAgICAgICAgICAgbGV0IHN4ID0geCArICgodGhpcy5wb3MueCkqNSkgKyA1O1xyXG4gICAgICAgICAgICBsZXQgc3kgPSB5ICsgKCh0aGlzLnBvcy55KSo1KSArIDEwO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ2N4Jywgc3gqdGhpcy5yYXRpbywgMyApO1xyXG4gICAgICAgICAgICB0aGlzLnNldFN2ZyggdGhpcy5jWzNdLCAnY3knLCBzeSp0aGlzLnJhdGlvLCAzICk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ2N4JywgeCp0aGlzLnJhdGlvLCAzICk7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdjeScsIHkqdGhpcy5yYXRpbywgMyApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgXHJcblxyXG4gICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdjeCcsIHgqdGhpcy5yYXRpbywgNCApO1xyXG4gICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdjeScsIHkqdGhpcy5yYXRpbywgNCApO1xyXG5cclxuICAgICAgICB0aGlzLnZhbHVlWzBdID0gICggdGhpcy5wb3MueCAqIHRoaXMubXVsdGlwbGljYXRvciApLnRvRml4ZWQoIHRoaXMucHJlY2lzaW9uICkgKiAxO1xyXG4gICAgICAgIHRoaXMudmFsdWVbMV0gPSAgKCB0aGlzLnBvcy55ICogdGhpcy5tdWx0aXBsaWNhdG9yICkudG9GaXhlZCggdGhpcy5wcmVjaXNpb24gKSAqIDE7XHJcblxyXG4gICAgICAgIHRoaXMuY1syXS50ZXh0Q29udGVudCA9IHRoaXMudmFsdWU7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGNsZWFyICgpIHtcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLnN0b3BJbnRlcnZhbCgpO1xyXG4gICAgICAgIHN1cGVyLmNsZWFyKCk7XHJcblxyXG4gICAgfVxyXG5cclxufSIsImltcG9ydCB7IFByb3RvIH0gZnJvbSAnLi4vY29yZS9Qcm90byc7XHJcbmltcG9ydCB7IFYyIH0gZnJvbSAnLi4vY29yZS9WMic7XHJcblxyXG5leHBvcnQgY2xhc3MgS25vYiBleHRlbmRzIFByb3RvIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvciggbyA9IHt9ICkge1xyXG5cclxuICAgICAgICBzdXBlciggbyApO1xyXG5cclxuICAgICAgICB0aGlzLmF1dG9XaWR0aCA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLmJ1dHRvbkNvbG9yID0gdGhpcy5jb2xvcnMuYnV0dG9uO1xyXG5cclxuICAgICAgICB0aGlzLnNldFR5cGVOdW1iZXIoIG8gKTtcclxuXHJcbiAgICAgICAgdGhpcy5tUEkgPSBNYXRoLlBJICogMC44O1xyXG4gICAgICAgIHRoaXMudG9EZWcgPSAxODAgLyBNYXRoLlBJO1xyXG4gICAgICAgIHRoaXMuY2lyUmFuZ2UgPSB0aGlzLm1QSSAqIDI7XHJcblxyXG4gICAgICAgIHRoaXMub2Zmc2V0ID0gbmV3IFYyKCk7XHJcblxyXG4gICAgICAgIHRoaXMucmFkaXVzID0gdGhpcy53ICogMC41Oy8vTWF0aC5mbG9vcigodGhpcy53LTIwKSowLjUpO1xyXG5cclxuICAgICAgICAvL3RoaXMud3cgPSB0aGlzLmhlaWdodCA9IHRoaXMucmFkaXVzICogMjtcclxuICAgICAgICB0aGlzLmggPSBvLmggfHwgdGhpcy53ICsgMTA7XHJcbiAgICAgICAgdGhpcy50b3AgPSAwO1xyXG5cclxuICAgICAgICB0aGlzLmNbMF0uc3R5bGUud2lkdGggPSB0aGlzLncgKydweCc7XHJcblxyXG4gICAgICAgIGlmKHRoaXMuY1sxXSAhPT0gdW5kZWZpbmVkKSB7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmNbMV0uc3R5bGUud2lkdGggPSB0aGlzLncgKydweCc7XHJcbiAgICAgICAgICAgIHRoaXMuY1sxXS5zdHlsZS50ZXh0QWxpZ24gPSAnY2VudGVyJztcclxuICAgICAgICAgICAgdGhpcy50b3AgPSAxMDtcclxuICAgICAgICAgICAgdGhpcy5oICs9IDEwO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucGVyY2VudCA9IDA7XHJcblxyXG4gICAgICAgIHRoaXMuY21vZGUgPSAwO1xyXG5cclxuICAgICAgICB0aGlzLmNbMl0gPSB0aGlzLmRvbSggJ2RpdicsIHRoaXMuY3NzLnR4dCArICd0ZXh0LWFsaWduOmNlbnRlcjsgdG9wOicrKHRoaXMuaC0yMCkrJ3B4OyB3aWR0aDonK3RoaXMudysncHg7IGNvbG9yOicrIHRoaXMuZm9udENvbG9yICk7XHJcblxyXG4gICAgICAgIHRoaXMuY1szXSA9IHRoaXMuZ2V0S25vYigpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdzdHJva2UnLCB0aGlzLmZvbnRDb2xvciwgMSApO1xyXG4gICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdzdHJva2UnLCB0aGlzLmZvbnRDb2xvciwgMyApO1xyXG4gICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdkJywgdGhpcy5tYWtlR3JhZCgpLCAzICk7XHJcbiAgICAgICAgXHJcblxyXG4gICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICd2aWV3Qm94JywgJzAgMCAnK3RoaXMud3crJyAnK3RoaXMud3cgKTtcclxuICAgICAgICB0aGlzLnNldENzcyggdGhpcy5jWzNdLCB7IHdpZHRoOnRoaXMudywgaGVpZ2h0OnRoaXMudywgbGVmdDowLCB0b3A6dGhpcy50b3AgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuciA9IDA7XHJcblxyXG4gICAgICAgIHRoaXMuaW5pdCgpO1xyXG5cclxuICAgICAgICB0aGlzLnVwZGF0ZSgpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb2RlICggbW9kZSApIHtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuY21vZGUgPT09IG1vZGUgKSByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgICAgIHN3aXRjaChtb2RlKXtcclxuICAgICAgICAgICAgY2FzZSAwOiAvLyBiYXNlXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNbMl0uY29sb3IgPSB0aGlzLmZvbnRDb2xvcjtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdmaWxsJyx0aGlzLmNvbG9ycy5idXR0b24sIDApO1xyXG4gICAgICAgICAgICAgICAgLy90aGlzLnNldFN2ZyggdGhpcy5jWzNdLCAnc3Ryb2tlJywncmdiYSgwLDAsMCwwLjIpJywgMik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN2ZyggdGhpcy5jWzNdLCAnc3Ryb2tlJywgdGhpcy5mb250Q29sb3IsIDEgKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMTogLy8gb3ZlclxyXG4gICAgICAgICAgICAgICAgdGhpcy5zWzJdLmNvbG9yID0gdGhpcy5jb2xvclBsdXM7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN2ZyggdGhpcy5jWzNdLCAnZmlsbCcsdGhpcy5jb2xvcnMuc2VsZWN0LCAwKTtcclxuICAgICAgICAgICAgICAgIC8vdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ3N0cm9rZScsJ3JnYmEoMCwwLDAsMC42KScsIDIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ3N0cm9rZScsIHRoaXMuY29sb3JQbHVzLCAxICk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5jbW9kZSA9IG1vZGU7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vICAgRVZFTlRTXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgbW91c2V1cCAoIGUgKSB7XHJcblxyXG4gICAgICAgIHRoaXMuaXNEb3duID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5zZW5kRW5kKCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubW9kZSgwKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW91c2Vkb3duICggZSApIHtcclxuXHJcbiAgICAgICAgdGhpcy5pc0Rvd24gPSB0cnVlO1xyXG4gICAgICAgIHRoaXMub2xkID0gdGhpcy52YWx1ZTtcclxuICAgICAgICB0aGlzLm9sZHIgPSBudWxsO1xyXG4gICAgICAgIHRoaXMubW91c2Vtb3ZlKCBlICk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubW9kZSgxKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW91c2Vtb3ZlICggZSApIHtcclxuXHJcbiAgICAgICAgLy90aGlzLm1vZGUoMSk7XHJcblxyXG4gICAgICAgIGlmKCAhdGhpcy5pc0Rvd24gKSByZXR1cm47XHJcblxyXG4gICAgICAgIGxldCBvZmYgPSB0aGlzLm9mZnNldDtcclxuXHJcbiAgICAgICAgb2ZmLnggPSB0aGlzLnJhZGl1cyAtICggZS5jbGllbnRYIC0gdGhpcy56b25lLnggKTtcclxuICAgICAgICBvZmYueSA9IHRoaXMucmFkaXVzIC0gKCBlLmNsaWVudFkgLSB0aGlzLnpvbmUueSAtIHRoaXMudG9wICk7XHJcblxyXG4gICAgICAgIHRoaXMuciA9IC0gTWF0aC5hdGFuMiggb2ZmLngsIG9mZi55ICk7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLm9sZHIgIT09IG51bGwgKSB0aGlzLnIgPSBNYXRoLmFicyh0aGlzLnIgLSB0aGlzLm9sZHIpID4gTWF0aC5QSSA/IHRoaXMub2xkciA6IHRoaXMucjtcclxuXHJcbiAgICAgICAgdGhpcy5yID0gdGhpcy5yID4gdGhpcy5tUEkgPyB0aGlzLm1QSSA6IHRoaXMucjtcclxuICAgICAgICB0aGlzLnIgPSB0aGlzLnIgPCAtdGhpcy5tUEkgPyAtdGhpcy5tUEkgOiB0aGlzLnI7XHJcblxyXG4gICAgICAgIGxldCBzdGVwcyA9IDEgLyB0aGlzLmNpclJhbmdlO1xyXG4gICAgICAgIGxldCB2YWx1ZSA9ICh0aGlzLnIgKyB0aGlzLm1QSSkgKiBzdGVwcztcclxuXHJcbiAgICAgICAgbGV0IG4gPSAoICggdGhpcy5yYW5nZSAqIHZhbHVlICkgKyB0aGlzLm1pbiApIC0gdGhpcy5vbGQ7XHJcblxyXG4gICAgICAgIGlmKG4gPj0gdGhpcy5zdGVwIHx8IG4gPD0gdGhpcy5zdGVwKXsgXHJcbiAgICAgICAgICAgIG4gPSBNYXRoLmZsb29yKCBuIC8gdGhpcy5zdGVwICk7XHJcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLm51bVZhbHVlKCB0aGlzLm9sZCArICggbiAqIHRoaXMuc3RlcCApICk7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlKCB0cnVlICk7XHJcbiAgICAgICAgICAgIHRoaXMub2xkID0gdGhpcy52YWx1ZTtcclxuICAgICAgICAgICAgdGhpcy5vbGRyID0gdGhpcy5yO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgbWFrZUdyYWQgKCkge1xyXG5cclxuICAgICAgICBsZXQgZCA9ICcnLCBzdGVwLCByYW5nZSwgYSwgeCwgeSwgeDIsIHkyLCByID0gNjQ7XHJcbiAgICAgICAgbGV0IHN0YXJ0YW5nbGUgPSBNYXRoLlBJICsgdGhpcy5tUEk7XHJcbiAgICAgICAgbGV0IGVuZGFuZ2xlID0gTWF0aC5QSSAtIHRoaXMubVBJO1xyXG4gICAgICAgIC8vbGV0IHN0ZXAgPSB0aGlzLnN0ZXA+NSA/IHRoaXMuc3RlcCA6IDE7XHJcblxyXG4gICAgICAgIGlmKHRoaXMuc3RlcD41KXtcclxuICAgICAgICAgICAgcmFuZ2UgPSAgdGhpcy5yYW5nZSAvIHRoaXMuc3RlcDtcclxuICAgICAgICAgICAgc3RlcCA9ICggc3RhcnRhbmdsZSAtIGVuZGFuZ2xlICkgLyByYW5nZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzdGVwID0gKCggc3RhcnRhbmdsZSAtIGVuZGFuZ2xlICkgLyByKSoyO1xyXG4gICAgICAgICAgICByYW5nZSA9IHIqMC41O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZm9yICggbGV0IGkgPSAwOyBpIDw9IHJhbmdlOyArK2kgKSB7XHJcblxyXG4gICAgICAgICAgICBhID0gc3RhcnRhbmdsZSAtICggc3RlcCAqIGkgKTtcclxuICAgICAgICAgICAgeCA9IHIgKyBNYXRoLnNpbiggYSApICogKCByIC0gMjAgKTtcclxuICAgICAgICAgICAgeSA9IHIgKyBNYXRoLmNvcyggYSApICogKCByIC0gMjAgKTtcclxuICAgICAgICAgICAgeDIgPSByICsgTWF0aC5zaW4oIGEgKSAqICggciAtIDI0ICk7XHJcbiAgICAgICAgICAgIHkyID0gciArIE1hdGguY29zKCBhICkgKiAoIHIgLSAyNCApO1xyXG4gICAgICAgICAgICBkICs9ICdNJyArIHggKyAnICcgKyB5ICsgJyBMJyArIHgyICsgJyAnK3kyICsgJyAnO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBkO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGUgKCB1cCApIHtcclxuXHJcbiAgICAgICAgdGhpcy5jWzJdLnRleHRDb250ZW50ID0gdGhpcy52YWx1ZTtcclxuICAgICAgICB0aGlzLnBlcmNlbnQgPSAodGhpcy52YWx1ZSAtIHRoaXMubWluKSAvIHRoaXMucmFuZ2U7XHJcblxyXG4gICAgICAgLy8gbGV0IHIgPSA1MDtcclxuICAgICAgIC8vIGxldCBkID0gNjQ7IFxyXG4gICAgICAgIGxldCByID0gKCAodGhpcy5wZXJjZW50ICogdGhpcy5jaXJSYW5nZSkgLSAodGhpcy5tUEkpKS8vKiB0aGlzLnRvRGVnO1xyXG5cclxuICAgICAgICBsZXQgc2luID0gTWF0aC5zaW4ocik7XHJcbiAgICAgICAgbGV0IGNvcyA9IE1hdGguY29zKHIpO1xyXG5cclxuICAgICAgICBsZXQgeDEgPSAoMjUgKiBzaW4pICsgNjQ7XHJcbiAgICAgICAgbGV0IHkxID0gLSgyNSAqIGNvcykgKyA2NDtcclxuICAgICAgICBsZXQgeDIgPSAoMjAgKiBzaW4pICsgNjQ7XHJcbiAgICAgICAgbGV0IHkyID0gLSgyMCAqIGNvcykgKyA2NDtcclxuXHJcbiAgICAgICAgLy90aGlzLnNldFN2ZyggdGhpcy5jWzNdLCAnY3gnLCB4LCAxICk7XHJcbiAgICAgICAgLy90aGlzLnNldFN2ZyggdGhpcy5jWzNdLCAnY3knLCB5LCAxICk7XHJcblxyXG4gICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdkJywgJ00gJyArIHgxICsnICcgKyB5MSArICcgTCAnICsgeDIgKycgJyArIHkyLCAxICk7XHJcblxyXG4gICAgICAgIC8vdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ3RyYW5zZm9ybScsICdyb3RhdGUoJysgciArJyAnKzY0KycgJys2NCsnKScsIDEgKTtcclxuXHJcbiAgICAgICAgaWYoIHVwICkgdGhpcy5zZW5kKCk7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG59IiwiaW1wb3J0IHsgUHJvdG8gfSBmcm9tICcuLi9jb3JlL1Byb3RvJztcclxuXHJcbmV4cG9ydCBjbGFzcyBMaXN0IGV4dGVuZHMgUHJvdG8ge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCBvID0ge30gKSB7XHJcblxyXG4gICAgICAgIHN1cGVyKCBvICk7XHJcblxyXG4gICAgICAgIC8vIGltYWdlc1xyXG4gICAgICAgIHRoaXMucGF0aCA9IG8ucGF0aCB8fCAnJztcclxuICAgICAgICB0aGlzLmZvcm1hdCA9IG8uZm9ybWF0IHx8ICcnO1xyXG4gICAgICAgIHRoaXMuaW1hZ2VTaXplID0gby5pbWFnZVNpemUgfHwgWzIwLDIwXTtcclxuXHJcbiAgICAgICAgdGhpcy5pc1dpdGhJbWFnZSA9IHRoaXMucGF0aCAhPT0gJycgPyB0cnVlOmZhbHNlO1xyXG4gICAgICAgIHRoaXMucHJlTG9hZENvbXBsZXRlID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMudG1wSW1hZ2UgPSB7fTtcclxuICAgICAgICB0aGlzLnRtcFVybCA9IFtdO1xyXG5cclxuICAgICAgICAvL3RoaXMuYXV0b0hlaWdodCA9IGZhbHNlO1xyXG5cclxuICAgICAgICBsZXQgYWxpZ24gPSBvLmFsaWduIHx8ICdjZW50ZXInO1xyXG5cclxuICAgICAgICB0aGlzLnNNb2RlID0gMDtcclxuICAgICAgICB0aGlzLnRNb2RlID0gMDtcclxuXHJcbiAgICAgICAgdGhpcy5saXN0T25seSA9IG8ubGlzdE9ubHkgfHwgZmFsc2U7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLnR4dCA9PT0gJycgKSB0aGlzLnAgPSAwO1xyXG5cclxuICAgICAgICB0aGlzLmJ1dHRvbkNvbG9yID0gby5iQ29sb3IgfHwgdGhpcy5jb2xvcnMuYnV0dG9uO1xyXG5cclxuICAgICAgICBsZXQgZmx0b3AgPSBNYXRoLmZsb29yKHRoaXMuaCowLjUpLTU7XHJcblxyXG4gICAgICAgIHRoaXMuY1syXSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MuYmFzaWMgKyAndG9wOjA7IGRpc3BsYXk6bm9uZTsnICk7XHJcbiAgICAgICAgdGhpcy5jWzNdID0gdGhpcy5kb20oICdkaXYnLCB0aGlzLmNzcy50eHQgKyAndGV4dC1hbGlnbjonK2FsaWduKyc7IGxpbmUtaGVpZ2h0OicrKHRoaXMuaC00KSsncHg7IHRvcDoxcHg7IGJhY2tncm91bmQ6Jyt0aGlzLmJ1dHRvbkNvbG9yKyc7IGhlaWdodDonKyh0aGlzLmgtMikrJ3B4OyBib3JkZXItcmFkaXVzOicrdGhpcy5yYWRpdXMrJ3B4OycgKTtcclxuICAgICAgICB0aGlzLmNbNF0gPSB0aGlzLmRvbSggJ3BhdGgnLCB0aGlzLmNzcy5iYXNpYyArICdwb3NpdGlvbjphYnNvbHV0ZTsgd2lkdGg6MTBweDsgaGVpZ2h0OjEwcHg7IHRvcDonK2ZsdG9wKydweDsnLCB7IGQ6dGhpcy5zdmdzLmFycm93LCBmaWxsOnRoaXMuZm9udENvbG9yLCBzdHJva2U6J25vbmUnfSk7XHJcblxyXG4gICAgICAgIHRoaXMuc2Nyb2xsZXIgPSB0aGlzLmRvbSggJ2RpdicsIHRoaXMuY3NzLmJhc2ljICsgJ3JpZ2h0OjVweDsgIHdpZHRoOjEwcHg7IGJhY2tncm91bmQ6IzY2NjsgZGlzcGxheTpub25lOycpO1xyXG5cclxuICAgICAgICB0aGlzLmNbM10uc3R5bGUuY29sb3IgPSB0aGlzLmZvbnRDb2xvcjtcclxuXHJcbiAgICAgICAgdGhpcy5saXN0ID0gby5saXN0IHx8IFtdO1xyXG4gICAgICAgIHRoaXMuaXRlbXMgPSBbXTtcclxuXHJcbiAgICAgICAgdGhpcy5wcmV2TmFtZSA9ICcnO1xyXG5cclxuICAgICAgICB0aGlzLmJhc2VIID0gdGhpcy5oO1xyXG5cclxuICAgICAgICB0aGlzLml0ZW1IZWlnaHQgPSBvLml0ZW1IZWlnaHQgfHwgKHRoaXMuaC0zKTtcclxuXHJcbiAgICAgICAgLy8gZm9yY2UgZnVsbCBsaXN0IFxyXG4gICAgICAgIHRoaXMuZnVsbCA9IG8uZnVsbCB8fCBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy5weSA9IDA7XHJcbiAgICAgICAgdGhpcy53dyA9IHRoaXMuc2I7XHJcbiAgICAgICAgdGhpcy5zY3JvbGwgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmlzRG93biA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLmN1cnJlbnQgPSBudWxsO1xyXG5cclxuICAgICAgICAvLyBsaXN0IHVwIG9yIGRvd25cclxuICAgICAgICB0aGlzLnNpZGUgPSBvLnNpZGUgfHwgJ2Rvd24nO1xyXG4gICAgICAgIHRoaXMudXAgPSB0aGlzLnNpZGUgPT09ICdkb3duJyA/IDAgOiAxO1xyXG5cclxuICAgICAgICBpZiggdGhpcy51cCApe1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jWzJdLnN0eWxlLnRvcCA9ICdhdXRvJztcclxuICAgICAgICAgICAgdGhpcy5jWzNdLnN0eWxlLnRvcCA9ICdhdXRvJztcclxuICAgICAgICAgICAgdGhpcy5jWzRdLnN0eWxlLnRvcCA9ICdhdXRvJztcclxuICAgICAgICAgICAgLy90aGlzLmNbNV0uc3R5bGUudG9wID0gJ2F1dG8nO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jWzJdLnN0eWxlLmJvdHRvbSA9IHRoaXMuaC0yICsgJ3B4JztcclxuICAgICAgICAgICAgdGhpcy5jWzNdLnN0eWxlLmJvdHRvbSA9ICcxcHgnO1xyXG4gICAgICAgICAgICB0aGlzLmNbNF0uc3R5bGUuYm90dG9tID0gZmx0b3AgKyAncHgnO1xyXG5cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmNbMl0uc3R5bGUudG9wID0gdGhpcy5iYXNlSCArICdweCc7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmxpc3RJbiA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MuYmFzaWMgKyAnbGVmdDowOyB0b3A6MDsgd2lkdGg6MTAwJTsgYmFja2dyb3VuZDpyZ2JhKDAsMCwwLDAuMik7Jyk7XHJcbiAgICAgICAgdGhpcy5saXN0SW4ubmFtZSA9ICdsaXN0JztcclxuXHJcbiAgICAgICAgdGhpcy50b3BMaXN0ID0gMDtcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLmNbMl0uYXBwZW5kQ2hpbGQoIHRoaXMubGlzdEluICk7XHJcbiAgICAgICAgdGhpcy5jWzJdLmFwcGVuZENoaWxkKCB0aGlzLnNjcm9sbGVyICk7XHJcblxyXG4gICAgICAgIGlmKCBvLnZhbHVlICE9PSB1bmRlZmluZWQgKXtcclxuICAgICAgICAgICAgaWYoIWlzTmFOKG8udmFsdWUpKSB0aGlzLnZhbHVlID0gdGhpcy5saXN0WyBvLnZhbHVlIF07XHJcbiAgICAgICAgICAgIGVsc2UgdGhpcy52YWx1ZSA9IG8udmFsdWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLmxpc3RbMF07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmlzT3Blbk9uU3RhcnQgPSBvLm9wZW4gfHwgZmFsc2U7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmxpc3RPbmx5ICl7XHJcbiAgICAgICAgICAgIHRoaXMuYmFzZUggPSA1O1xyXG4gICAgICAgICAgICB0aGlzLmNbM10uc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgICAgICAgICAgdGhpcy5jWzRdLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICAgICAgICAgIHRoaXMuY1syXS5zdHlsZS50b3AgPSB0aGlzLmJhc2VIKydweCdcclxuICAgICAgICAgICAgdGhpcy5pc09wZW5PblN0YXJ0ID0gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIFxyXG5cclxuICAgICAgICAvL3RoaXMuY1swXS5zdHlsZS5iYWNrZ3JvdW5kID0gJyNGRjAwMDAnXHJcbiAgICAgICAgaWYoIHRoaXMuaXNXaXRoSW1hZ2UgKSB0aGlzLnByZWxvYWRJbWFnZSgpO1xyXG4gICAgICAgLy8gfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gcG9wdWxhdGUgbGlzdFxyXG4gICAgICAgICAgICB0aGlzLnNldExpc3QoIHRoaXMubGlzdCApO1xyXG4gICAgICAgICAgICB0aGlzLmluaXQoKTtcclxuICAgICAgICAgICAgaWYoIHRoaXMuaXNPcGVuT25TdGFydCApIHRoaXMub3BlbiggdHJ1ZSApO1xyXG4gICAgICAgLy8gfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyBpbWFnZSBsaXN0XHJcblxyXG4gICAgcHJlbG9hZEltYWdlICgpIHtcclxuXHJcbiAgICAgICAgdGhpcy5wcmVMb2FkQ29tcGxldGUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy50bXBJbWFnZSA9IHt9O1xyXG4gICAgICAgIGZvciggbGV0IGk9MDsgaTx0aGlzLmxpc3QubGVuZ3RoOyBpKysgKSB0aGlzLnRtcFVybC5wdXNoKCB0aGlzLmxpc3RbaV0gKTtcclxuICAgICAgICB0aGlzLmxvYWRPbmUoKTtcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBuZXh0SW1nICgpIHtcclxuXHJcbiAgICAgICAgdGhpcy50bXBVcmwuc2hpZnQoKTtcclxuICAgICAgICBpZiggdGhpcy50bXBVcmwubGVuZ3RoID09PSAwICl7IFxyXG5cclxuICAgICAgICAgICAgdGhpcy5wcmVMb2FkQ29tcGxldGUgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5hZGRJbWFnZXMoKTtcclxuICAgICAgICAgICAgLyp0aGlzLnNldExpc3QoIHRoaXMubGlzdCApO1xyXG4gICAgICAgICAgICB0aGlzLmluaXQoKTtcclxuICAgICAgICAgICAgaWYoIHRoaXMuaXNPcGVuT25TdGFydCApIHRoaXMub3BlbigpOyovXHJcblxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHRoaXMubG9hZE9uZSgpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBsb2FkT25lKCl7XHJcblxyXG4gICAgICAgIGxldCBzZWxmID0gdGhpc1xyXG4gICAgICAgIGxldCBuYW1lID0gdGhpcy50bXBVcmxbMF07XHJcbiAgICAgICAgbGV0IGltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xyXG4gICAgICAgIGltZy5zdHlsZS5jc3NUZXh0ID0gJ3Bvc2l0aW9uOmFic29sdXRlOyB3aWR0aDonK3NlbGYuaW1hZ2VTaXplWzBdKydweDsgaGVpZ2h0Oicrc2VsZi5pbWFnZVNpemVbMV0rJ3B4JztcclxuICAgICAgICBpbWcuc2V0QXR0cmlidXRlKCdzcmMnLCB0aGlzLnBhdGggKyBuYW1lICsgdGhpcy5mb3JtYXQgKTtcclxuXHJcbiAgICAgICAgaW1nLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgIHNlbGYuaW1hZ2VTaXplWzJdID0gaW1nLndpZHRoO1xyXG4gICAgICAgICAgICBzZWxmLmltYWdlU2l6ZVszXSA9IGltZy5oZWlnaHQ7XHJcbiAgICAgICAgICAgIHNlbGYudG1wSW1hZ2VbbmFtZV0gPSBpbWc7XHJcbiAgICAgICAgICAgIHNlbGYubmV4dEltZygpO1xyXG5cclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy9cclxuXHJcbiAgICB0ZXN0Wm9uZSAoIGUgKSB7XHJcblxyXG4gICAgICAgIGxldCBsID0gdGhpcy5sb2NhbDtcclxuICAgICAgICBpZiggbC54ID09PSAtMSAmJiBsLnkgPT09IC0xICkgcmV0dXJuICcnO1xyXG5cclxuICAgICAgICBpZiggdGhpcy51cCAmJiB0aGlzLmlzT3BlbiApe1xyXG4gICAgICAgICAgICBpZiggbC55ID4gdGhpcy5oIC0gdGhpcy5iYXNlSCApIHJldHVybiAndGl0bGUnO1xyXG4gICAgICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICAgICAgaWYoIHRoaXMuc2Nyb2xsICYmICggbC54ID4gKHRoaXMuc2ErdGhpcy5zYi0yMCkpICkgcmV0dXJuICdzY3JvbGwnO1xyXG4gICAgICAgICAgICAgICAgaWYobC54ID4gdGhpcy5zYSkgcmV0dXJuIHRoaXMudGVzdEl0ZW1zKCBsLnktdGhpcy5iYXNlSCApO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmKCBsLnkgPCB0aGlzLmJhc2VIKzIgKSByZXR1cm4gJ3RpdGxlJztcclxuICAgICAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgICAgIGlmKCB0aGlzLmlzT3BlbiApe1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKCB0aGlzLnNjcm9sbCAmJiAoIGwueCA+ICh0aGlzLnNhK3RoaXMuc2ItMjApKSApIHJldHVybiAnc2Nyb2xsJztcclxuICAgICAgICAgICAgICAgICAgICBpZihsLnggPiB0aGlzLnNhKSByZXR1cm4gdGhpcy50ZXN0SXRlbXMoIGwueS10aGlzLmJhc2VIICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gJyc7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHRlc3RJdGVtcyAoIHkgKSB7XHJcblxyXG4gICAgICAgIGxldCBuYW1lID0gJyc7XHJcblxyXG4gICAgICAgIGxldCBpID0gdGhpcy5pdGVtcy5sZW5ndGgsIGl0ZW0sIGEsIGI7XHJcbiAgICAgICAgd2hpbGUoaS0tKXtcclxuICAgICAgICAgICAgaXRlbSA9IHRoaXMuaXRlbXNbaV07XHJcbiAgICAgICAgICAgIGEgPSBpdGVtLnBvc3kgKyB0aGlzLnRvcExpc3Q7XHJcbiAgICAgICAgICAgIGIgPSBpdGVtLnBvc3kgKyB0aGlzLml0ZW1IZWlnaHQgKyAxICsgdGhpcy50b3BMaXN0O1xyXG4gICAgICAgICAgICBpZiggeSA+PSBhICYmIHkgPD0gYiApeyBcclxuICAgICAgICAgICAgICAgIG5hbWUgPSAnaXRlbScgKyBpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy51blNlbGVjdGVkKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnQgPSBpdGVtO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZCgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5hbWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gbmFtZTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgdW5TZWxlY3RlZCAoKSB7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmN1cnJlbnQgKXtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50LnN0eWxlLmJhY2tncm91bmQgPSAncmdiYSgwLDAsMCwwLjIpJztcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50LnN0eWxlLmNvbG9yID0gdGhpcy5mb250Q29sb3I7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBzZWxlY3RlZCAoKSB7XHJcblxyXG4gICAgICAgIHRoaXMuY3VycmVudC5zdHlsZS5iYWNrZ3JvdW5kID0gdGhpcy5jb2xvcnMuc2VsZWN0O1xyXG4gICAgICAgIHRoaXMuY3VycmVudC5zdHlsZS5jb2xvciA9ICcjRkZGJztcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBFVkVOVFNcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBtb3VzZXVwICggZSApIHtcclxuXHJcbiAgICAgICAgdGhpcy5pc0Rvd24gPSBmYWxzZTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW91c2Vkb3duICggZSApIHtcclxuXHJcbiAgICAgICAgbGV0IG5hbWUgPSB0aGlzLnRlc3Rab25lKCBlICk7XHJcblxyXG4gICAgICAgIGlmKCAhbmFtZSApIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgICAgaWYoIG5hbWUgPT09ICdzY3JvbGwnICl7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmlzRG93biA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMubW91c2Vtb3ZlKCBlICk7XHJcblxyXG4gICAgICAgIH0gZWxzZSBpZiggbmFtZSA9PT0gJ3RpdGxlJyApe1xyXG5cclxuICAgICAgICAgICAgdGhpcy5tb2RlVGl0bGUoMik7XHJcbiAgICAgICAgICAgIGlmKCAhdGhpcy5saXN0T25seSApe1xyXG4gICAgICAgICAgICAgICAgaWYoICF0aGlzLmlzT3BlbiApIHRoaXMub3BlbigpO1xyXG4gICAgICAgICAgICAgICAgZWxzZSB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiggdGhpcy5jdXJyZW50ICl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy5saXN0W3RoaXMuY3VycmVudC5pZF1cclxuICAgICAgICAgICAgICAgIC8vdGhpcy52YWx1ZSA9IHRoaXMuY3VycmVudC50ZXh0Q29udGVudDtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VuZCgpO1xyXG4gICAgICAgICAgICAgICAgaWYoICF0aGlzLmxpc3RPbmx5ICkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFRvcEl0ZW0oKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb3VzZW1vdmUgKCBlICkge1xyXG5cclxuICAgICAgICBsZXQgbnVwID0gZmFsc2U7XHJcbiAgICAgICAgbGV0IG5hbWUgPSB0aGlzLnRlc3Rab25lKCBlICk7XHJcblxyXG4gICAgICAgIGlmKCAhbmFtZSApIHJldHVybiBudXA7XHJcblxyXG4gICAgICAgIGlmKCBuYW1lID09PSAndGl0bGUnICl7XHJcbiAgICAgICAgICAgIHRoaXMudW5TZWxlY3RlZCgpO1xyXG4gICAgICAgICAgICB0aGlzLm1vZGVUaXRsZSgxKTtcclxuICAgICAgICAgICAgdGhpcy5jdXJzb3IoJ3BvaW50ZXInKTtcclxuXHJcbiAgICAgICAgfSBlbHNlIGlmKCBuYW1lID09PSAnc2Nyb2xsJyApe1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jdXJzb3IoJ3MtcmVzaXplJyk7XHJcbiAgICAgICAgICAgIHRoaXMubW9kZVNjcm9sbCgxKTtcclxuICAgICAgICAgICAgaWYoIHRoaXMuaXNEb3duICl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGVTY3JvbGwoMik7XHJcbiAgICAgICAgICAgICAgICBsZXQgdG9wID0gdGhpcy56b25lLnkrdGhpcy5iYXNlSC0yO1xyXG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGUoICggZS5jbGllbnRZIC0gdG9wICApIC0gKCB0aGlzLnNoKjAuNSApICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy9pZih0aGlzLmlzRG93bikgdGhpcy5saXN0bW92ZShlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgLy8gaXMgaXRlbVxyXG4gICAgICAgICAgICB0aGlzLm1vZGVUaXRsZSgwKTtcclxuICAgICAgICAgICAgdGhpcy5tb2RlU2Nyb2xsKDApO1xyXG4gICAgICAgICAgICB0aGlzLmN1cnNvcigncG9pbnRlcicpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoIG5hbWUgIT09IHRoaXMucHJldk5hbWUgKSBudXAgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMucHJldk5hbWUgPSBuYW1lO1xyXG5cclxuICAgICAgICByZXR1cm4gbnVwO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB3aGVlbCAoIGUgKSB7XHJcblxyXG4gICAgICAgIGxldCBuYW1lID0gdGhpcy50ZXN0Wm9uZSggZSApO1xyXG4gICAgICAgIGlmKCBuYW1lID09PSAndGl0bGUnICkgcmV0dXJuIGZhbHNlOyBcclxuICAgICAgICB0aGlzLnB5ICs9IGUuZGVsdGEqMTA7XHJcbiAgICAgICAgdGhpcy51cGRhdGUodGhpcy5weSk7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcblxyXG4gICAgfVxyXG5cclxuXHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIHJlc2V0ICgpIHtcclxuXHJcbiAgICAgICAgdGhpcy5wcmV2TmFtZSA9ICcnO1xyXG4gICAgICAgIHRoaXMudW5TZWxlY3RlZCgpO1xyXG4gICAgICAgIHRoaXMubW9kZVRpdGxlKDApO1xyXG4gICAgICAgIHRoaXMubW9kZVNjcm9sbCgwKTtcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBtb2RlU2Nyb2xsICggbW9kZSApIHtcclxuXHJcbiAgICAgICAgaWYoIG1vZGUgPT09IHRoaXMuc01vZGUgKSByZXR1cm47XHJcblxyXG4gICAgICAgIHN3aXRjaChtb2RlKXtcclxuICAgICAgICAgICAgY2FzZSAwOiAvLyBiYXNlXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbGVyLnN0eWxlLmJhY2tncm91bmQgPSB0aGlzLmJ1dHRvbkNvbG9yO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAxOiAvLyBvdmVyXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbGVyLnN0eWxlLmJhY2tncm91bmQgPSB0aGlzLmNvbG9ycy5zZWxlY3Q7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDI6IC8vIGVkaXQgLyBkb3duXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbGVyLnN0eWxlLmJhY2tncm91bmQgPSB0aGlzLmNvbG9ycy5kb3duO1xyXG4gICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnNNb2RlID0gbW9kZTtcclxuICAgIH1cclxuXHJcbiAgICBtb2RlVGl0bGUgKCBtb2RlICkge1xyXG5cclxuICAgICAgICBpZiggbW9kZSA9PT0gdGhpcy50TW9kZSApIHJldHVybjtcclxuXHJcbiAgICAgICAgbGV0IHMgPSB0aGlzLnM7XHJcblxyXG4gICAgICAgIHN3aXRjaChtb2RlKXtcclxuICAgICAgICAgICAgY2FzZSAwOiAvLyBiYXNlXHJcbiAgICAgICAgICAgICAgICBzWzNdLmNvbG9yID0gdGhpcy5mb250Q29sb3I7XHJcbiAgICAgICAgICAgICAgICBzWzNdLmJhY2tncm91bmQgPSB0aGlzLmJ1dHRvbkNvbG9yO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAxOiAvLyBvdmVyXHJcbiAgICAgICAgICAgICAgICBzWzNdLmNvbG9yID0gJyNGRkYnO1xyXG4gICAgICAgICAgICAgICAgc1szXS5iYWNrZ3JvdW5kID0gdGhpcy5jb2xvcnMuc2VsZWN0O1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAyOiAvLyBlZGl0IC8gZG93blxyXG4gICAgICAgICAgICAgICAgc1szXS5jb2xvciA9IHRoaXMuZm9udENvbG9yO1xyXG4gICAgICAgICAgICAgICAgc1szXS5iYWNrZ3JvdW5kID0gdGhpcy5jb2xvcnMuZG93bjtcclxuICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy50TW9kZSA9IG1vZGU7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGNsZWFyTGlzdCAoKSB7XHJcblxyXG4gICAgICAgIHdoaWxlICggdGhpcy5saXN0SW4uY2hpbGRyZW4ubGVuZ3RoICkgdGhpcy5saXN0SW4ucmVtb3ZlQ2hpbGQoIHRoaXMubGlzdEluLmxhc3RDaGlsZCApO1xyXG4gICAgICAgIHRoaXMuaXRlbXMgPSBbXTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgc2V0TGlzdCAoIGxpc3QgKSB7XHJcblxyXG4gICAgICAgIHRoaXMuY2xlYXJMaXN0KCk7XHJcblxyXG4gICAgICAgIHRoaXMubGlzdCA9IGxpc3Q7XHJcbiAgICAgICAgdGhpcy5sZW5ndGggPSB0aGlzLmxpc3QubGVuZ3RoO1xyXG5cclxuICAgICAgICB0aGlzLm1heEl0ZW0gPSB0aGlzLmZ1bGwgPyB0aGlzLmxlbmd0aCA6IDU7XHJcbiAgICAgICAgdGhpcy5tYXhJdGVtID0gdGhpcy5sZW5ndGggPCB0aGlzLm1heEl0ZW0gPyB0aGlzLmxlbmd0aCA6IHRoaXMubWF4SXRlbTtcclxuXHJcbiAgICAgICAgdGhpcy5tYXhIZWlnaHQgPSB0aGlzLm1heEl0ZW0gKiAodGhpcy5pdGVtSGVpZ2h0KzEpICsgMjtcclxuXHJcbiAgICAgICAgdGhpcy5tYXggPSB0aGlzLmxlbmd0aCAqICh0aGlzLml0ZW1IZWlnaHQrMSkgKyAyO1xyXG4gICAgICAgIHRoaXMucmF0aW8gPSB0aGlzLm1heEhlaWdodCAvIHRoaXMubWF4O1xyXG4gICAgICAgIHRoaXMuc2ggPSB0aGlzLm1heEhlaWdodCAqIHRoaXMucmF0aW87XHJcbiAgICAgICAgdGhpcy5yYW5nZSA9IHRoaXMubWF4SGVpZ2h0IC0gdGhpcy5zaDtcclxuXHJcbiAgICAgICAgdGhpcy5jWzJdLnN0eWxlLmhlaWdodCA9IHRoaXMubWF4SGVpZ2h0ICsgJ3B4JztcclxuICAgICAgICB0aGlzLnNjcm9sbGVyLnN0eWxlLmhlaWdodCA9IHRoaXMuc2ggKyAncHgnO1xyXG5cclxuICAgICAgICBpZiggdGhpcy5tYXggPiB0aGlzLm1heEhlaWdodCApeyBcclxuICAgICAgICAgICAgdGhpcy53dyA9IHRoaXMuc2IgLSAyMDtcclxuICAgICAgICAgICAgdGhpcy5zY3JvbGwgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IGl0ZW0sIG47Ly8sIGwgPSB0aGlzLnNiO1xyXG4gICAgICAgIGZvciggbGV0IGk9MDsgaTx0aGlzLmxlbmd0aDsgaSsrICl7XHJcblxyXG4gICAgICAgICAgICBuID0gdGhpcy5saXN0W2ldO1xyXG4gICAgICAgICAgICBpdGVtID0gdGhpcy5kb20oICdkaXYnLCB0aGlzLmNzcy5pdGVtICsgJ3dpZHRoOicrdGhpcy53dysncHg7IGhlaWdodDonK3RoaXMuaXRlbUhlaWdodCsncHg7IGxpbmUtaGVpZ2h0OicrKHRoaXMuaXRlbUhlaWdodC01KSsncHg7IGNvbG9yOicrdGhpcy5mb250Q29sb3IrJzsnICk7XHJcbiAgICAgICAgICAgIGl0ZW0ubmFtZSA9ICdpdGVtJytpO1xyXG4gICAgICAgICAgICBpdGVtLmlkID0gaTtcclxuICAgICAgICAgICAgaXRlbS5wb3N5ID0gKHRoaXMuaXRlbUhlaWdodCsxKSppO1xyXG4gICAgICAgICAgICB0aGlzLmxpc3RJbi5hcHBlbmRDaGlsZCggaXRlbSApO1xyXG4gICAgICAgICAgICB0aGlzLml0ZW1zLnB1c2goIGl0ZW0gKTtcclxuXHJcbiAgICAgICAgICAgIC8vaWYoIHRoaXMuaXNXaXRoSW1hZ2UgKSBpdGVtLmFwcGVuZENoaWxkKCB0aGlzLnRtcEltYWdlW25dICk7XHJcbiAgICAgICAgICAgIGlmKCAhdGhpcy5pc1dpdGhJbWFnZSApIGl0ZW0udGV4dENvbnRlbnQgPSBuO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuc2V0VG9wSXRlbSgpO1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIGFkZEltYWdlcyAoKXtcclxuICAgICAgICBsZXQgbG5nID0gdGhpcy5saXN0Lmxlbmd0aDtcclxuICAgICAgICBmb3IoIGxldCBpPTA7IGk8bG5nOyBpKysgKXtcclxuICAgICAgICAgICAgdGhpcy5pdGVtc1tpXS5hcHBlbmRDaGlsZCggdGhpcy50bXBJbWFnZVt0aGlzLmxpc3RbaV1dICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2V0VG9wSXRlbSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHNldFRvcEl0ZW0gKCl7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmlzV2l0aEltYWdlICl7IFxyXG5cclxuICAgICAgICAgICAgaWYoICF0aGlzLnByZUxvYWRDb21wbGV0ZSApIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgIGlmKCF0aGlzLmNbM10uY2hpbGRyZW4ubGVuZ3RoKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhbnZhcy53aWR0aCA9IHRoaXMuaW1hZ2VTaXplWzBdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jYW52YXMuaGVpZ2h0ID0gdGhpcy5pbWFnZVNpemVbMV07XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhbnZhcy5zdHlsZS5jc3NUZXh0ID0gJ3Bvc2l0aW9uOmFic29sdXRlOyB0b3A6MHB4OyBsZWZ0OjBweDsnXHJcbiAgICAgICAgICAgICAgICB0aGlzLmN0eCA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY1szXS5hcHBlbmRDaGlsZCggdGhpcy5jYW52YXMgKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbGV0IGltZyA9IHRoaXMudG1wSW1hZ2VbIHRoaXMudmFsdWUgXTtcclxuICAgICAgICAgICAgdGhpcy5jdHguZHJhd0ltYWdlKCB0aGlzLnRtcEltYWdlWyB0aGlzLnZhbHVlIF0sIDAsIDAsIHRoaXMuaW1hZ2VTaXplWzJdLCB0aGlzLmltYWdlU2l6ZVszXSwgMCwwLCB0aGlzLmltYWdlU2l6ZVswXSwgdGhpcy5pbWFnZVNpemVbMV0gKTtcclxuXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgdGhpcy5jWzNdLnRleHRDb250ZW50ID0gdGhpcy52YWx1ZTtcclxuXHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8vIC0tLS0tIExJU1RcclxuXHJcbiAgICB1cGRhdGUgKCB5ICkge1xyXG5cclxuICAgICAgICBpZiggIXRoaXMuc2Nyb2xsICkgcmV0dXJuO1xyXG5cclxuICAgICAgICB5ID0geSA8IDAgPyAwIDogeTtcclxuICAgICAgICB5ID0geSA+IHRoaXMucmFuZ2UgPyB0aGlzLnJhbmdlIDogeTtcclxuXHJcbiAgICAgICAgdGhpcy50b3BMaXN0ID0gLU1hdGguZmxvb3IoIHkgLyB0aGlzLnJhdGlvICk7XHJcblxyXG4gICAgICAgIHRoaXMubGlzdEluLnN0eWxlLnRvcCA9IHRoaXMudG9wTGlzdCsncHgnO1xyXG4gICAgICAgIHRoaXMuc2Nyb2xsZXIuc3R5bGUudG9wID0gTWF0aC5mbG9vciggeSApICArICdweCc7XHJcblxyXG4gICAgICAgIHRoaXMucHkgPSB5O1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBwYXJlbnRIZWlnaHQgKCB0ICkge1xyXG5cclxuICAgICAgICBpZiAoIHRoaXMuZ3JvdXAgIT09IG51bGwgKSB0aGlzLmdyb3VwLmNhbGMoIHQgKTtcclxuICAgICAgICBlbHNlIGlmICggdGhpcy5pc1VJICkgdGhpcy5tYWluLmNhbGMoIHQgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgb3BlbiAoIGZpcnN0ICkge1xyXG5cclxuICAgICAgICBzdXBlci5vcGVuKCk7XHJcblxyXG4gICAgICAgIHRoaXMudXBkYXRlKCAwICk7XHJcbiAgICAgICAgdGhpcy5oID0gdGhpcy5tYXhIZWlnaHQgKyB0aGlzLmJhc2VIICsgNTtcclxuICAgICAgICBpZiggIXRoaXMuc2Nyb2xsICl7XHJcbiAgICAgICAgICAgIHRoaXMudG9wTGlzdCA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMuaCA9IHRoaXMuYmFzZUggKyA1ICsgdGhpcy5tYXg7XHJcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnNjcm9sbGVyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNbMF0uaGVpZ2h0ID0gdGhpcy5oICsgJ3B4JztcclxuICAgICAgICB0aGlzLnNbMl0uZGlzcGxheSA9ICdibG9jayc7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLnVwICl7IFxyXG4gICAgICAgICAgICB0aGlzLnpvbmUueSAtPSB0aGlzLmggLSAodGhpcy5iYXNlSC0xMCk7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbNF0sICdkJywgdGhpcy5zdmdzLmFycm93VXAgKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnNldFN2ZyggdGhpcy5jWzRdLCAnZCcsIHRoaXMuc3Zncy5hcnJvd0Rvd24gKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuclNpemVDb250ZW50KCk7XHJcblxyXG4gICAgICAgIGxldCB0ID0gdGhpcy5oIC0gdGhpcy5iYXNlSDtcclxuXHJcbiAgICAgICAgdGhpcy56b25lLmggPSB0aGlzLmg7XHJcblxyXG4gICAgICAgIGlmKCFmaXJzdCkgdGhpcy5wYXJlbnRIZWlnaHQoIHQgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UgKCkge1xyXG5cclxuICAgICAgICBzdXBlci5jbG9zZSgpO1xyXG5cclxuICAgICAgICBpZiggdGhpcy51cCApIHRoaXMuem9uZS55ICs9IHRoaXMuaCAtICh0aGlzLmJhc2VILTEwKTtcclxuXHJcbiAgICAgICAgbGV0IHQgPSB0aGlzLmggLSB0aGlzLmJhc2VIO1xyXG5cclxuICAgICAgICB0aGlzLmggPSB0aGlzLmJhc2VIO1xyXG4gICAgICAgIHRoaXMuc1swXS5oZWlnaHQgPSB0aGlzLmggKyAncHgnO1xyXG4gICAgICAgIHRoaXMuc1syXS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbNF0sICdkJywgdGhpcy5zdmdzLmFycm93ICk7XHJcblxyXG4gICAgICAgIHRoaXMuem9uZS5oID0gdGhpcy5oO1xyXG5cclxuICAgICAgICB0aGlzLnBhcmVudEhlaWdodCggLXQgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS1cclxuXHJcbiAgICB0ZXh0ICggdHh0ICkge1xyXG5cclxuICAgICAgICB0aGlzLmNbM10udGV4dENvbnRlbnQgPSB0eHQ7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHJTaXplQ29udGVudCAoKSB7XHJcblxyXG4gICAgICAgIGxldCBpID0gdGhpcy5sZW5ndGg7XHJcbiAgICAgICAgd2hpbGUoaS0tKSB0aGlzLmxpc3RJbi5jaGlsZHJlbltpXS5zdHlsZS53aWR0aCA9IHRoaXMud3cgKyAncHgnO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICByU2l6ZSAoKSB7XHJcblxyXG4gICAgICAgIFByb3RvLnByb3RvdHlwZS5yU2l6ZS5jYWxsKCB0aGlzICk7XHJcblxyXG4gICAgICAgIGxldCBzID0gdGhpcy5zO1xyXG4gICAgICAgIGxldCB3ID0gdGhpcy5zYjtcclxuICAgICAgICBsZXQgZCA9IHRoaXMuc2E7XHJcblxyXG4gICAgICAgIGlmKHNbMl09PT0gdW5kZWZpbmVkKSByZXR1cm47XHJcblxyXG4gICAgICAgIHNbMl0ud2lkdGggPSB3ICsgJ3B4JztcclxuICAgICAgICBzWzJdLmxlZnQgPSBkICsncHgnO1xyXG5cclxuICAgICAgICBzWzNdLndpZHRoID0gdyArICdweCc7XHJcbiAgICAgICAgc1szXS5sZWZ0ID0gZCArICdweCc7XHJcblxyXG4gICAgICAgIHNbNF0ubGVmdCA9IGQgKyB3IC0gMTcgKyAncHgnO1xyXG5cclxuICAgICAgICB0aGlzLnd3ID0gdztcclxuICAgICAgICBpZiggdGhpcy5tYXggPiB0aGlzLm1heEhlaWdodCApIHRoaXMud3cgPSB3LTIwO1xyXG4gICAgICAgIGlmKHRoaXMuaXNPcGVuKSB0aGlzLnJTaXplQ29udGVudCgpO1xyXG5cclxuICAgIH1cclxuXHJcbn0iLCJpbXBvcnQgeyBQcm90byB9IGZyb20gJy4uL2NvcmUvUHJvdG8nO1xyXG5pbXBvcnQgeyBUb29scyB9IGZyb20gJy4uL2NvcmUvVG9vbHMnO1xyXG5cclxuZXhwb3J0IGNsYXNzIE51bWVyaWMgZXh0ZW5kcyBQcm90byB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoIG8gPSB7fSApIHtcclxuXHJcbiAgICAgICAgc3VwZXIoIG8gKTtcclxuXHJcbiAgICAgICAgdGhpcy5zZXRUeXBlTnVtYmVyKCBvICk7XHJcblxyXG4gICAgICAgIHRoaXMuYWxsd2F5ID0gby5hbGx3YXkgfHwgZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMuaXNEb3duID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMudmFsdWUgPSBbMF07XHJcbiAgICAgICAgdGhpcy5tdWx0eSA9IDE7XHJcbiAgICAgICAgdGhpcy5pbnZtdWx0eSA9IDE7XHJcbiAgICAgICAgdGhpcy5pc1NpbmdsZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5pc0FuZ2xlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5pc1ZlY3RvciA9IGZhbHNlO1xyXG5cclxuICAgICAgICBpZiggby5pc0FuZ2xlICl7XHJcbiAgICAgICAgICAgIHRoaXMuaXNBbmdsZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMubXVsdHkgPSBUb29scy50b3JhZDtcclxuICAgICAgICAgICAgdGhpcy5pbnZtdWx0eSA9IFRvb2xzLnRvZGVnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5pc0RyYWcgPSBvLmRyYWcgfHwgZmFsc2U7XHJcblxyXG4gICAgICAgIGlmKCBvLnZhbHVlICE9PSB1bmRlZmluZWQgKXtcclxuICAgICAgICAgICAgaWYoIWlzTmFOKG8udmFsdWUpKXsgXHJcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gW28udmFsdWVdO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYoIG8udmFsdWUgaW5zdGFuY2VvZiBBcnJheSApeyBcclxuICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSBvLnZhbHVlOyBcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNTaW5nbGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmKCBvLnZhbHVlIGluc3RhbmNlb2YgT2JqZWN0ICl7IFxyXG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgaWYoIG8udmFsdWUueCAhPT0gdW5kZWZpbmVkICkgdGhpcy52YWx1ZVswXSA9IG8udmFsdWUueDtcclxuICAgICAgICAgICAgICAgIGlmKCBvLnZhbHVlLnkgIT09IHVuZGVmaW5lZCApIHRoaXMudmFsdWVbMV0gPSBvLnZhbHVlLnk7XHJcbiAgICAgICAgICAgICAgICBpZiggby52YWx1ZS56ICE9PSB1bmRlZmluZWQgKSB0aGlzLnZhbHVlWzJdID0gby52YWx1ZS56O1xyXG4gICAgICAgICAgICAgICAgaWYoIG8udmFsdWUudyAhPT0gdW5kZWZpbmVkICkgdGhpcy52YWx1ZVszXSA9IG8udmFsdWUudztcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNWZWN0b3IgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc1NpbmdsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmxuZyA9IHRoaXMudmFsdWUubGVuZ3RoO1xyXG4gICAgICAgIHRoaXMudG1wID0gW107XHJcblxyXG4gICAgICAgIFxyXG5cclxuICAgICAgICB0aGlzLmN1cnJlbnQgPSAtMTtcclxuICAgICAgICB0aGlzLnByZXYgPSB7IHg6MCwgeTowLCBkOjAsIHY6MCB9O1xyXG5cclxuICAgICAgICAvLyBiZ1xyXG4gICAgICAgIHRoaXMuY1syXSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MuYmFzaWMgKyAnIGJhY2tncm91bmQ6JyArIHRoaXMuY29sb3JzLnNlbGVjdCArICc7IHRvcDo0cHg7IHdpZHRoOjBweDsgaGVpZ2h0OicgKyAodGhpcy5oLTgpICsgJ3B4OycgKTtcclxuXHJcbiAgICAgICAgdGhpcy5jTW9kZSA9IFtdO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCBpID0gdGhpcy5sbmc7XHJcbiAgICAgICAgd2hpbGUoaS0tKXtcclxuXHJcbiAgICAgICAgICAgIGlmKHRoaXMuaXNBbmdsZSkgdGhpcy52YWx1ZVtpXSA9ICh0aGlzLnZhbHVlW2ldICogMTgwIC8gTWF0aC5QSSkudG9GaXhlZCggdGhpcy5wcmVjaXNpb24gKTtcclxuICAgICAgICAgICAgdGhpcy5jWzMraV0gPSB0aGlzLmRvbSggJ2RpdicsIHRoaXMuY3NzLnR4dHNlbGVjdCArICcgaGVpZ2h0OicrKHRoaXMuaC00KSsncHg7IGJhY2tncm91bmQ6JyArIHRoaXMuY29sb3JzLmlucHV0QmcgKyAnOyBib3JkZXJDb2xvcjonICsgdGhpcy5jb2xvcnMuaW5wdXRCb3JkZXIrJzsgYm9yZGVyLXJhZGl1czonK3RoaXMucmFkaXVzKydweDsnKTtcclxuICAgICAgICAgICAgaWYoby5jZW50ZXIpIHRoaXMuY1syK2ldLnN0eWxlLnRleHRBbGlnbiA9ICdjZW50ZXInO1xyXG4gICAgICAgICAgICB0aGlzLmNbMytpXS50ZXh0Q29udGVudCA9IHRoaXMudmFsdWVbaV07XHJcbiAgICAgICAgICAgIHRoaXMuY1szK2ldLnN0eWxlLmNvbG9yID0gdGhpcy5mb250Q29sb3I7XHJcbiAgICAgICAgICAgIHRoaXMuY1szK2ldLmlzTnVtID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuY01vZGVbaV0gPSAwO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIGN1cnNvclxyXG4gICAgICAgIHRoaXMuY3Vyc29ySWQgPSAzICsgdGhpcy5sbmc7XHJcbiAgICAgICAgdGhpcy5jWyB0aGlzLmN1cnNvcklkIF0gPSB0aGlzLmRvbSggJ2RpdicsIHRoaXMuY3NzLmJhc2ljICsgJ3RvcDo0cHg7IGhlaWdodDonICsgKHRoaXMuaC04KSArICdweDsgd2lkdGg6MHB4OyBiYWNrZ3JvdW5kOicrdGhpcy5mb250Q29sb3IrJzsnICk7XHJcblxyXG4gICAgICAgIHRoaXMuaW5pdCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHRlc3Rab25lICggZSApIHtcclxuXHJcbiAgICAgICAgbGV0IGwgPSB0aGlzLmxvY2FsO1xyXG4gICAgICAgIGlmKCBsLnggPT09IC0xICYmIGwueSA9PT0gLTEgKSByZXR1cm4gJyc7XHJcblxyXG4gICAgICAgIGxldCBpID0gdGhpcy5sbmc7XHJcbiAgICAgICAgbGV0IHQgPSB0aGlzLnRtcDtcclxuICAgICAgICBcclxuXHJcbiAgICAgICAgd2hpbGUoIGktLSApe1xyXG4gICAgICAgICAgICBpZiggbC54PnRbaV1bMF0gJiYgbC54PHRbaV1bMl0gKSByZXR1cm4gaTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiAnJztcclxuXHJcbiAgICB9XHJcblxyXG4gICAvKiBtb2RlOiBmdW5jdGlvbiAoIG4sIG5hbWUgKSB7XHJcblxyXG4gICAgICAgIGlmKCBuID09PSB0aGlzLmNNb2RlW25hbWVdICkgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICAvL2xldCBtO1xyXG5cclxuICAgICAgICAvKnN3aXRjaChuKXtcclxuXHJcbiAgICAgICAgICAgIGNhc2UgMDogbSA9IHRoaXMuY29sb3JzLmJvcmRlcjsgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMTogbSA9IHRoaXMuY29sb3JzLmJvcmRlck92ZXI7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDI6IG0gPSB0aGlzLmNvbG9ycy5ib3JkZXJTZWxlY3Q7ICBicmVhaztcclxuXHJcbiAgICAgICAgfSovXHJcblxyXG4gICAvKiAgICAgdGhpcy5yZXNldCgpO1xyXG4gICAgICAgIC8vdGhpcy5jW25hbWUrMl0uc3R5bGUuYm9yZGVyQ29sb3IgPSBtO1xyXG4gICAgICAgIHRoaXMuY01vZGVbbmFtZV0gPSBuO1xyXG5cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuXHJcbiAgICB9LCovXHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBFVkVOVFNcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBtb3VzZWRvd24gKCBlICkge1xyXG5cclxuICAgICAgICBsZXQgbmFtZSA9IHRoaXMudGVzdFpvbmUoIGUgKTtcclxuXHJcbiAgICAgICAgaWYoICF0aGlzLmlzRG93biApe1xyXG4gICAgICAgICAgICB0aGlzLmlzRG93biA9IHRydWU7XHJcbiAgICAgICAgICAgIGlmKCBuYW1lICE9PSAnJyApeyBcclxuICAgICAgICAgICAgXHR0aGlzLmN1cnJlbnQgPSBuYW1lO1xyXG4gICAgICAgICAgICBcdHRoaXMucHJldiA9IHsgeDplLmNsaWVudFgsIHk6ZS5jbGllbnRZLCBkOjAsIHY6IHRoaXMuaXNTaW5nbGUgPyBwYXJzZUZsb2F0KHRoaXMudmFsdWUpIDogcGFyc2VGbG9hdCggdGhpcy52YWx1ZVsgdGhpcy5jdXJyZW50IF0gKSAgfTtcclxuICAgICAgICAgICAgXHR0aGlzLnNldElucHV0KCB0aGlzLmNbIDMgKyB0aGlzLmN1cnJlbnQgXSApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1vdXNlbW92ZSggZSApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIC8qXHJcblxyXG4gICAgICAgIGlmKCBuYW1lID09PSAnJyApIHJldHVybiBmYWxzZTtcclxuXHJcblxyXG4gICAgICAgIHRoaXMuY3VycmVudCA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5pc0Rvd24gPSB0cnVlO1xyXG5cclxuICAgICAgICB0aGlzLnByZXYgPSB7IHg6ZS5jbGllbnRYLCB5OmUuY2xpZW50WSwgZDowLCB2OiB0aGlzLmlzU2luZ2xlID8gcGFyc2VGbG9hdCh0aGlzLnZhbHVlKSA6IHBhcnNlRmxvYXQoIHRoaXMudmFsdWVbIHRoaXMuY3VycmVudCBdICkgIH07XHJcblxyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5tb2RlKCAyLCBuYW1lICk7Ki9cclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW91c2V1cCAoIGUgKSB7XHJcblxyXG4gICAgXHRpZiggdGhpcy5pc0Rvd24gKXtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuaXNEb3duID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vdGhpcy5jdXJyZW50ID0gLTE7XHJcbiAgICAgICAgICAgIHRoaXMucHJldiA9IHsgeDowLCB5OjAsIGQ6MCwgdjowIH07XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tb3VzZW1vdmUoIGUgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgICAgLypsZXQgbmFtZSA9IHRoaXMudGVzdFpvbmUoIGUgKTtcclxuICAgICAgICB0aGlzLmlzRG93biA9IGZhbHNlO1xyXG5cclxuICAgICAgICBpZiggdGhpcy5jdXJyZW50ICE9PSAtMSApeyBcclxuXHJcbiAgICAgICAgICAgIC8vbGV0IHRtID0gdGhpcy5jdXJyZW50O1xyXG4gICAgICAgICAgICBsZXQgdGQgPSB0aGlzLnByZXYuZDtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudCA9IC0xO1xyXG4gICAgICAgICAgICB0aGlzLnByZXYgPSB7IHg6MCwgeTowLCBkOjAsIHY6MCB9O1xyXG5cclxuICAgICAgICAgICAgaWYoICF0ZCApe1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0SW5wdXQoIHRoaXMuY1sgMyArIG5hbWUgXSApO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7Ly90aGlzLm1vZGUoIDIsIG5hbWUgKTtcclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZXNldCgpOy8vdGhpcy5tb2RlKCAwLCB0bSApO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0qL1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb3VzZW1vdmUgKCBlICkge1xyXG5cclxuICAgICAgICBsZXQgbnVwID0gZmFsc2U7XHJcbiAgICAgICAgbGV0IHggPSAwO1xyXG5cclxuICAgICAgICBsZXQgbmFtZSA9IHRoaXMudGVzdFpvbmUoIGUgKTtcclxuXHJcbiAgICAgICAgaWYoIG5hbWUgPT09ICcnICkgdGhpcy5jdXJzb3IoKTtcclxuICAgICAgICBlbHNleyBcclxuICAgICAgICBcdGlmKCF0aGlzLmlzRHJhZykgdGhpcy5jdXJzb3IoJ3RleHQnKTtcclxuICAgICAgICBcdGVsc2UgdGhpcy5jdXJzb3IoIHRoaXMuY3VycmVudCAhPT0gLTEgPyAnbW92ZScgOiAncG9pbnRlcicgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIFxyXG5cclxuICAgICAgICBpZiggdGhpcy5pc0RyYWcgKXtcclxuXHJcbiAgICAgICAgXHRpZiggdGhpcy5jdXJyZW50ICE9PSAtMSApe1xyXG5cclxuICAgICAgICAgICAgXHR0aGlzLnByZXYuZCArPSAoIGUuY2xpZW50WCAtIHRoaXMucHJldi54ICkgLSAoIGUuY2xpZW50WSAtIHRoaXMucHJldi55ICk7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IG4gPSB0aGlzLnByZXYudiArICggdGhpcy5wcmV2LmQgKiB0aGlzLnN0ZXApO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMudmFsdWVbIHRoaXMuY3VycmVudCBdID0gdGhpcy5udW1WYWx1ZShuKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY1sgMyArIHRoaXMuY3VycmVudCBdLnRleHRDb250ZW50ID0gdGhpcy52YWx1ZVt0aGlzLmN1cnJlbnRdO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMudmFsaWRhdGUoKTtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnByZXYueCA9IGUuY2xpZW50WDtcclxuICAgICAgICAgICAgICAgIHRoaXMucHJldi55ID0gZS5jbGllbnRZO1xyXG5cclxuICAgICAgICAgICAgICAgIG51cCA9IHRydWU7XHJcbiAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgIFx0aWYoIHRoaXMuaXNEb3duICkgeCA9IGUuY2xpZW50WCAtIHRoaXMuem9uZS54IC0zO1xyXG4gICAgICAgIFx0aWYoIHRoaXMuY3VycmVudCAhPT0gLTEgKSB4IC09IHRoaXMudG1wW3RoaXMuY3VycmVudF1bMF1cclxuICAgICAgICBcdHJldHVybiB0aGlzLnVwSW5wdXQoIHgsIHRoaXMuaXNEb3duICk7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgXHJcblxyXG5cclxuICAgICAgICByZXR1cm4gbnVwO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvL2tleWRvd246IGZ1bmN0aW9uICggZSApIHsgcmV0dXJuIHRydWU7IH0sXHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIHJlc2V0ICgpIHtcclxuXHJcbiAgICAgICAgbGV0IG51cCA9IGZhbHNlO1xyXG4gICAgICAgIC8vdGhpcy5pc0Rvd24gPSBmYWxzZTtcclxuXHJcbiAgICAgICAgLy90aGlzLmN1cnJlbnQgPSAwO1xyXG5cclxuICAgICAgIC8qIGxldCBpID0gdGhpcy5sbmc7XHJcbiAgICAgICAgd2hpbGUoaS0tKXsgXHJcbiAgICAgICAgICAgIGlmKHRoaXMuY01vZGVbaV0hPT0wKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuY01vZGVbaV0gPSAwO1xyXG4gICAgICAgICAgICAgICAgLy90aGlzLmNbMitpXS5zdHlsZS5ib3JkZXJDb2xvciA9IHRoaXMuY29sb3JzLmJvcmRlcjtcclxuICAgICAgICAgICAgICAgIG51cCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9Ki9cclxuXHJcbiAgICAgICAgcmV0dXJuIG51cDtcclxuXHJcbiAgICB9XHJcblxyXG5cclxuICAgIHNldFZhbHVlICggdiApIHtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuaXNWZWN0b3IgKXtcclxuXHJcbiAgICAgICAgICAgIGlmKCB2LnggIT09IHVuZGVmaW5lZCApIHRoaXMudmFsdWVbMF0gPSB2Lng7XHJcbiAgICAgICAgICAgIGlmKCB2LnkgIT09IHVuZGVmaW5lZCApIHRoaXMudmFsdWVbMV0gPSB2Lnk7XHJcbiAgICAgICAgICAgIGlmKCB2LnogIT09IHVuZGVmaW5lZCApIHRoaXMudmFsdWVbMl0gPSB2Lno7XHJcbiAgICAgICAgICAgIGlmKCB2LncgIT09IHVuZGVmaW5lZCApIHRoaXMudmFsdWVbM10gPSB2Lnc7XHJcblxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB2O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgXHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy51cGRhdGUoKTtcclxuXHJcbiAgICAgICAgLy9sZXQgaSA9IHRoaXMudmFsdWUubGVuZ3RoO1xyXG5cclxuICAgICAgICAvKm4gPSBuIHx8IDA7XHJcbiAgICAgICAgdGhpcy52YWx1ZVtuXSA9IHRoaXMubnVtVmFsdWUoIHYgKTtcclxuICAgICAgICB0aGlzLmNbIDMgKyBuIF0udGV4dENvbnRlbnQgPSB0aGlzLnZhbHVlW25dOyovXHJcblxyXG4gICAgfVxyXG5cclxuICAgIHNhbWVTdHIgKCBzdHIgKXtcclxuXHJcbiAgICAgICAgbGV0IGkgPSB0aGlzLnZhbHVlLmxlbmd0aDtcclxuICAgICAgICB3aGlsZShpLS0pIHRoaXMuY1sgMyArIGkgXS50ZXh0Q29udGVudCA9IHN0cjtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlICggdXAgKSB7XHJcblxyXG4gICAgICAgIGxldCBpID0gdGhpcy52YWx1ZS5sZW5ndGg7XHJcblxyXG4gICAgICAgIHdoaWxlKGktLSl7XHJcbiAgICAgICAgICAgICB0aGlzLnZhbHVlW2ldID0gdGhpcy5udW1WYWx1ZSggdGhpcy52YWx1ZVtpXSAqIHRoaXMuaW52bXVsdHkgKTtcclxuICAgICAgICAgICAgIHRoaXMuY1sgMyArIGkgXS50ZXh0Q29udGVudCA9IHRoaXMudmFsdWVbaV07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiggdXAgKSB0aGlzLnNlbmQoKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgc2VuZCAoIHYgKSB7XHJcblxyXG4gICAgICAgIHYgPSB2IHx8IHRoaXMudmFsdWU7XHJcblxyXG4gICAgICAgIHRoaXMuaXNTZW5kID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMub2JqZWN0TGluayAhPT0gbnVsbCApeyBcclxuXHJcbiAgICAgICAgICAgIGlmKCB0aGlzLmlzVmVjdG9yICl7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5vYmplY3RMaW5rWyB0aGlzLnZhbCBdLmZyb21BcnJheSggdiApO1xyXG5cclxuICAgICAgICAgICAgICAgIC8qdGhpcy5vYmplY3RMaW5rWyB0aGlzLnZhbCBdLnggPSB2WzBdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vYmplY3RMaW5rWyB0aGlzLnZhbCBdLnkgPSB2WzFdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vYmplY3RMaW5rWyB0aGlzLnZhbCBdLnogPSB2WzJdO1xyXG4gICAgICAgICAgICAgICAgaWYoIHZbM10gKSB0aGlzLm9iamVjdExpbmtbIHRoaXMudmFsIF0udyA9IHZbM107Ki9cclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9iamVjdExpbmtbIHRoaXMudmFsIF0gPSB2O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoIHRoaXMuY2FsbGJhY2sgKSB0aGlzLmNhbGxiYWNrKCB2LCB0aGlzLnZhbCApO1xyXG5cclxuICAgICAgICB0aGlzLmlzU2VuZCA9IGZhbHNlO1xyXG5cclxuICAgIH1cclxuXHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBJTlBVVFxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIHNlbGVjdCAoIGMsIGUsIHcgKSB7XHJcblxyXG4gICAgICAgIGxldCBzID0gdGhpcy5zO1xyXG4gICAgICAgIGxldCBkID0gdGhpcy5jdXJyZW50ICE9PSAtMSA/IHRoaXMudG1wW3RoaXMuY3VycmVudF1bMF0gKyA1IDogMDtcclxuICAgICAgICBzW3RoaXMuY3Vyc29ySWRdLndpZHRoID0gJzFweCc7XHJcbiAgICAgICAgc1t0aGlzLmN1cnNvcklkXS5sZWZ0ID0gKCBkICsgYyApICsgJ3B4JztcclxuICAgICAgICBzWzJdLmxlZnQgPSAoIGQgKyBlICkgKyAncHgnO1xyXG4gICAgICAgIHNbMl0ud2lkdGggPSB3ICsgJ3B4JztcclxuICAgIFxyXG4gICAgfVxyXG5cclxuICAgIHVuc2VsZWN0ICgpIHtcclxuXHJcbiAgICAgICAgbGV0IHMgPSB0aGlzLnM7XHJcbiAgICAgICAgaWYoIXMpIHJldHVybjtcclxuICAgICAgICBzWzJdLndpZHRoID0gMCArICdweCc7XHJcbiAgICAgICAgc1t0aGlzLmN1cnNvcklkXS53aWR0aCA9IDAgKyAncHgnO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB2YWxpZGF0ZSAoIGZvcmNlICkge1xyXG5cclxuICAgICAgICBsZXQgYXIgPSBbXTtcclxuICAgICAgICBsZXQgaSA9IHRoaXMubG5nO1xyXG5cclxuICAgICAgICBpZiggdGhpcy5hbGx3YXkgKSBmb3JjZSA9IHRydWU7XHJcblxyXG4gICAgICAgIHdoaWxlKGktLSl7XHJcbiAgICAgICAgXHRpZighaXNOYU4oIHRoaXMuY1sgMyArIGkgXS50ZXh0Q29udGVudCApKXsgXHJcbiAgICAgICAgICAgICAgICBsZXQgbnggPSB0aGlzLm51bVZhbHVlKCB0aGlzLmNbIDMgKyBpIF0udGV4dENvbnRlbnQgKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY1sgMyArIGkgXS50ZXh0Q29udGVudCA9IG54O1xyXG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZVtpXSA9IG54O1xyXG4gICAgICAgICAgICB9IGVsc2UgeyAvLyBub3QgbnVtYmVyXHJcbiAgICAgICAgICAgICAgICB0aGlzLmNbIDMgKyBpIF0udGV4dENvbnRlbnQgPSB0aGlzLnZhbHVlW2ldO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIFx0YXJbaV0gPSB0aGlzLnZhbHVlW2ldICogdGhpcy5tdWx0eTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKCAhZm9yY2UgKSByZXR1cm47XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmlzU2luZ2xlICkgdGhpcy5zZW5kKCBhclswXSApO1xyXG4gICAgICAgIGVsc2UgdGhpcy5zZW5kKCBhciApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyAgIFJFWklTRVxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIHJTaXplICgpIHtcclxuXHJcbiAgICAgICAgc3VwZXIuclNpemUoKTtcclxuXHJcbiAgICAgICAgbGV0IHcgPSBNYXRoLmZsb29yKCAoIHRoaXMuc2IgKyA1ICkgLyB0aGlzLmxuZyApLTU7XHJcbiAgICAgICAgbGV0IHMgPSB0aGlzLnM7XHJcbiAgICAgICAgbGV0IGkgPSB0aGlzLmxuZztcclxuICAgICAgICB3aGlsZShpLS0pe1xyXG4gICAgICAgICAgICB0aGlzLnRtcFtpXSA9IFsgTWF0aC5mbG9vciggdGhpcy5zYSArICggdyAqIGkgKSsoIDUgKiBpICkpLCB3IF07XHJcbiAgICAgICAgICAgIHRoaXMudG1wW2ldWzJdID0gdGhpcy50bXBbaV1bMF0gKyB0aGlzLnRtcFtpXVsxXTtcclxuICAgICAgICAgICAgc1sgMyArIGkgXS5sZWZ0ID0gdGhpcy50bXBbaV1bMF0gKyAncHgnO1xyXG4gICAgICAgICAgICBzWyAzICsgaSBdLndpZHRoID0gdGhpcy50bXBbaV1bMV0gKyAncHgnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG59IiwiaW1wb3J0IHsgUHJvdG8gfSBmcm9tICcuLi9jb3JlL1Byb3RvJztcclxuXHJcblxyXG5leHBvcnQgY2xhc3MgU2xpZGUgZXh0ZW5kcyBQcm90byB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoIG8gPSB7fSApIHtcclxuXHJcbiAgICAgICAgc3VwZXIoIG8gKTtcclxuXHJcbiAgICAgICAgdGhpcy5zZXRUeXBlTnVtYmVyKCBvICk7XHJcblxyXG5cclxuICAgICAgICB0aGlzLm1vZGVsID0gby5zdHlwZSB8fCAwO1xyXG4gICAgICAgIGlmKCBvLm1vZGUgIT09IHVuZGVmaW5lZCApIHRoaXMubW9kZWwgPSBvLm1vZGU7XHJcbiAgICAgICAgdGhpcy5idXR0b25Db2xvciA9IG8uYkNvbG9yIHx8IHRoaXMuY29sb3JzLmJ1dHRvbjtcclxuXHJcbiAgICAgICAgdGhpcy5kZWZhdWx0Qm9yZGVyQ29sb3IgPSB0aGlzLmNvbG9ycy5oaWRlO1xyXG5cclxuICAgICAgICB0aGlzLmlzRG93biA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuaXNPdmVyID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5hbGx3YXkgPSBvLmFsbHdheSB8fCBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy5pc0RlZyA9IG8uaXNEZWcgfHwgZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMuZmlyc3RJbXB1dCA9IGZhbHNlO1xyXG5cclxuICAgICAgICAvL3RoaXMuY1syXSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MudHh0c2VsZWN0ICsgJ2xldHRlci1zcGFjaW5nOi0xcHg7IHRleHQtYWxpZ246cmlnaHQ7IHdpZHRoOjQ3cHg7IGJvcmRlcjoxcHggZGFzaGVkICcrdGhpcy5kZWZhdWx0Qm9yZGVyQ29sb3IrJzsgY29sb3I6JysgdGhpcy5mb250Q29sb3IgKTtcclxuICAgICAgICAvL3RoaXMuY1syXSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MudHh0c2VsZWN0ICsgJ3RleHQtYWxpZ246cmlnaHQ7IHdpZHRoOjQ3cHg7IGJvcmRlcjoxcHggZGFzaGVkICcrdGhpcy5kZWZhdWx0Qm9yZGVyQ29sb3IrJzsgY29sb3I6JysgdGhpcy5mb250Q29sb3IgKTtcclxuICAgICAgICB0aGlzLmNbMl0gPSB0aGlzLmRvbSggJ2RpdicsIHRoaXMuY3NzLnR4dHNlbGVjdCArICdib3JkZXI6bm9uZTsgd2lkdGg6NDdweDsgY29sb3I6JysgdGhpcy5mb250Q29sb3IgKTtcclxuICAgICAgICAvL3RoaXMuY1syXSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MudHh0c2VsZWN0ICsgJ2xldHRlci1zcGFjaW5nOi0xcHg7IHRleHQtYWxpZ246cmlnaHQ7IHdpZHRoOjQ3cHg7IGNvbG9yOicrIHRoaXMuZm9udENvbG9yICk7XHJcbiAgICAgICAgdGhpcy5jWzNdID0gdGhpcy5kb20oICdkaXYnLCB0aGlzLmNzcy5iYXNpYyArICcgdG9wOjA7IGhlaWdodDonK3RoaXMuaCsncHg7JyApO1xyXG4gICAgICAgIHRoaXMuY1s0XSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MuYmFzaWMgKyAnYmFja2dyb3VuZDonK3RoaXMuY29sb3JzLnNjcm9sbGJhY2srJzsgdG9wOjJweDsgaGVpZ2h0OicrKHRoaXMuaC00KSsncHg7JyApO1xyXG4gICAgICAgIHRoaXMuY1s1XSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MuYmFzaWMgKyAnbGVmdDo0cHg7IHRvcDo1cHg7IGhlaWdodDonKyh0aGlzLmgtMTApKydweDsgYmFja2dyb3VuZDonICsgdGhpcy5mb250Q29sb3IgKyc7JyApO1xyXG5cclxuICAgICAgICB0aGlzLmNbMl0uaXNOdW0gPSB0cnVlO1xyXG4gICAgICAgIC8vdGhpcy5jWzJdLnN0eWxlLmhlaWdodCA9ICh0aGlzLmgtNCkgKyAncHgnO1xyXG4gICAgICAgIC8vdGhpcy5jWzJdLnN0eWxlLmxpbmVIZWlnaHQgPSAodGhpcy5oLTgpICsgJ3B4JztcclxuICAgICAgICB0aGlzLmNbMl0uc3R5bGUuaGVpZ2h0ID0gKHRoaXMuaC0yKSArICdweCc7XHJcbiAgICAgICAgdGhpcy5jWzJdLnN0eWxlLmxpbmVIZWlnaHQgPSAodGhpcy5oLTEwKSArICdweCc7XHJcblxyXG4gICAgICAgIGlmKHRoaXMubW9kZWwgIT09IDApe1xyXG5cclxuICAgICAgICAgICAgbGV0IGgxID0gNCwgaDIgPSA4LCB3dyA9IHRoaXMuaC00LCByYSA9IDIwO1xyXG5cclxuICAgICAgICAgICAgaWYoIHRoaXMubW9kZWwgPT09IDIgKXtcclxuICAgICAgICAgICAgICAgIGgxID0gNDsvLzJcclxuICAgICAgICAgICAgICAgIGgyID0gODtcclxuICAgICAgICAgICAgICAgIHJhID0gMjtcclxuICAgICAgICAgICAgICAgIHd3ID0gKHRoaXMuaC00KSowLjVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYodGhpcy5tb2RlbCA9PT0gMykgdGhpcy5jWzVdLnN0eWxlLnZpc2libGUgPSAnbm9uZSc7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmNbNF0uc3R5bGUuYm9yZGVyUmFkaXVzID0gaDEgKyAncHgnO1xyXG4gICAgICAgICAgICB0aGlzLmNbNF0uc3R5bGUuaGVpZ2h0ID0gaDIgKyAncHgnO1xyXG4gICAgICAgICAgICB0aGlzLmNbNF0uc3R5bGUudG9wID0gKHRoaXMuaCowLjUpIC0gaDEgKyAncHgnO1xyXG4gICAgICAgICAgICB0aGlzLmNbNV0uc3R5bGUuYm9yZGVyUmFkaXVzID0gKGgxKjAuNSkgKyAncHgnO1xyXG4gICAgICAgICAgICB0aGlzLmNbNV0uc3R5bGUuaGVpZ2h0ID0gaDEgKyAncHgnO1xyXG4gICAgICAgICAgICB0aGlzLmNbNV0uc3R5bGUudG9wID0gKHRoaXMuaCowLjUpLShoMSowLjUpICsgJ3B4JztcclxuXHJcbiAgICAgICAgICAgIHRoaXMuY1s2XSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MuYmFzaWMgKyAnYm9yZGVyLXJhZGl1czonK3JhKydweDsgbWFyZ2luLWxlZnQ6JysoLXd3KjAuNSkrJ3B4OyBib3JkZXI6MXB4IHNvbGlkICcrdGhpcy5jb2xvcnMuYm9yZGVyKyc7IGJhY2tncm91bmQ6Jyt0aGlzLmJ1dHRvbkNvbG9yKyc7IGxlZnQ6NHB4OyB0b3A6MnB4OyBoZWlnaHQ6JysodGhpcy5oLTQpKydweDsgd2lkdGg6Jyt3dysncHg7JyApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5pbml0KCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHRlc3Rab25lICggZSApIHtcclxuXHJcbiAgICAgICAgbGV0IGwgPSB0aGlzLmxvY2FsO1xyXG4gICAgICAgIGlmKCBsLnggPT09IC0xICYmIGwueSA9PT0gLTEgKSByZXR1cm4gJyc7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYoIGwueCA+PSB0aGlzLnR4bCApIHJldHVybiAndGV4dCc7XHJcbiAgICAgICAgZWxzZSBpZiggbC54ID49IHRoaXMuc2EgKSByZXR1cm4gJ3Njcm9sbCc7XHJcbiAgICAgICAgZWxzZSByZXR1cm4gJyc7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vICAgRVZFTlRTXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgbW91c2V1cCAoIGUgKSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYoIHRoaXMuaXNEb3duICkgdGhpcy5pc0Rvd24gPSBmYWxzZTtcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBtb3VzZWRvd24gKCBlICkge1xyXG5cclxuICAgICAgICBsZXQgbmFtZSA9IHRoaXMudGVzdFpvbmUoIGUgKTtcclxuXHJcbiAgICAgICAgaWYoICFuYW1lICkgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICBpZiggbmFtZSA9PT0gJ3Njcm9sbCcgKXsgXHJcbiAgICAgICAgICAgIHRoaXMuaXNEb3duID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5vbGQgPSB0aGlzLnZhbHVlO1xyXG4gICAgICAgICAgICB0aGlzLm1vdXNlbW92ZSggZSApO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qaWYoIG5hbWUgPT09ICd0ZXh0JyApe1xyXG4gICAgICAgICAgICB0aGlzLnNldElucHV0KCB0aGlzLmNbMl0sIGZ1bmN0aW9uKCl7IHRoaXMudmFsaWRhdGUoKSB9LmJpbmQodGhpcykgKTtcclxuICAgICAgICB9Ki9cclxuXHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vdXNlbW92ZSAoIGUgKSB7XHJcblxyXG4gICAgICAgIGxldCBudXAgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgbGV0IG5hbWUgPSB0aGlzLnRlc3Rab25lKCBlICk7XHJcblxyXG4gICAgICAgIGlmKCBuYW1lID09PSAnc2Nyb2xsJyApIHtcclxuICAgICAgICAgICAgdGhpcy5tb2RlKDEpO1xyXG4gICAgICAgICAgICB0aGlzLmN1cnNvcigndy1yZXNpemUnKTtcclxuICAgICAgICAvL30gZWxzZSBpZihuYW1lID09PSAndGV4dCcpeyBcclxuICAgICAgICAgICAgLy90aGlzLmN1cnNvcigncG9pbnRlcicpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3Vyc29yKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiggdGhpcy5pc0Rvd24gKXtcclxuXHJcbiAgICAgICAgICAgIGxldCBuID0gKCgoIGUuY2xpZW50WCAtICh0aGlzLnpvbmUueCt0aGlzLnNhKSAtIDMgKSAvIHRoaXMud3cgKSAqIHRoaXMucmFuZ2UgKyB0aGlzLm1pbiApIC0gdGhpcy5vbGQ7XHJcbiAgICAgICAgICAgIGlmKG4gPj0gdGhpcy5zdGVwIHx8IG4gPD0gdGhpcy5zdGVwKXsgXHJcbiAgICAgICAgICAgICAgICBuID0gTWF0aC5mbG9vciggbiAvIHRoaXMuc3RlcCApO1xyXG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHRoaXMubnVtVmFsdWUoIHRoaXMub2xkICsgKCBuICogdGhpcy5zdGVwICkgKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlKCB0cnVlICk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9sZCA9IHRoaXMudmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbnVwID0gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBudXA7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8va2V5ZG93bjogZnVuY3Rpb24gKCBlICkgeyByZXR1cm4gdHJ1ZTsgfSxcclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgdmFsaWRhdGUgKCkge1xyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCBuID0gdGhpcy5jWzJdLnRleHRDb250ZW50O1xyXG5cclxuICAgICAgICBpZighaXNOYU4oIG4gKSl7IFxyXG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy5udW1WYWx1ZSggbiApOyBcclxuICAgICAgICAgICAgdGhpcy51cGRhdGUodHJ1ZSk7IFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZWxzZSB0aGlzLmNbMl0udGV4dENvbnRlbnQgPSB0aGlzLnZhbHVlICsgKHRoaXMuaXNEZWcgPyAnwrAnOicnKTtcclxuXHJcbiAgICB9XHJcblxyXG5cclxuICAgIHJlc2V0ICgpIHtcclxuXHJcbiAgICAgICAgLy90aGlzLmNsZWFySW5wdXQoKTtcclxuICAgICAgICB0aGlzLmlzRG93biA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMubW9kZSgwKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW9kZSAoIG1vZGUgKSB7XHJcblxyXG4gICAgICAgIGxldCBzID0gdGhpcy5zO1xyXG5cclxuICAgICAgICBzd2l0Y2gobW9kZSl7XHJcbiAgICAgICAgICAgIGNhc2UgMDogLy8gYmFzZVxyXG4gICAgICAgICAgICAgICAvLyBzWzJdLmJvcmRlciA9ICcxcHggc29saWQgJyArIHRoaXMuY29sb3JzLmhpZGU7XHJcbiAgICAgICAgICAgICAgICBzWzJdLmNvbG9yID0gdGhpcy5mb250Q29sb3I7XHJcbiAgICAgICAgICAgICAgICBzWzRdLmJhY2tncm91bmQgPSB0aGlzLmNvbG9ycy5zY3JvbGxiYWNrO1xyXG4gICAgICAgICAgICAgICAgc1s1XS5iYWNrZ3JvdW5kID0gdGhpcy5mb250Q29sb3I7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDE6IC8vIHNjcm9sbCBvdmVyXHJcbiAgICAgICAgICAgICAgICAvL3NbMl0uYm9yZGVyID0gJzFweCBkYXNoZWQgJyArIHRoaXMuY29sb3JzLmhpZGU7XHJcbiAgICAgICAgICAgICAgICBzWzJdLmNvbG9yID0gdGhpcy5jb2xvclBsdXM7XHJcbiAgICAgICAgICAgICAgICBzWzRdLmJhY2tncm91bmQgPSB0aGlzLmNvbG9ycy5zY3JvbGxiYWNrb3ZlcjtcclxuICAgICAgICAgICAgICAgIHNbNV0uYmFja2dyb3VuZCA9IHRoaXMuY29sb3JQbHVzO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAvKiBjYXNlIDI6IFxyXG4gICAgICAgICAgICAgICAgc1syXS5ib3JkZXIgPSAnMXB4IHNvbGlkICcgKyB0aGlzLmNvbG9ycy5ib3JkZXJTZWxlY3Q7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDM6IFxyXG4gICAgICAgICAgICAgICAgc1syXS5ib3JkZXIgPSAnMXB4IGRhc2hlZCAnICsgdGhpcy5mb250Q29sb3I7Ly90aGlzLmNvbG9ycy5ib3JkZXJTZWxlY3Q7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDQ6IFxyXG4gICAgICAgICAgICAgICAgc1syXS5ib3JkZXIgPSAnMXB4IGRhc2hlZCAnICsgdGhpcy5jb2xvcnMuaGlkZTtcclxuICAgICAgICAgICAgYnJlYWs7Ki9cclxuXHJcblxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGUgKCB1cCApIHtcclxuXHJcbiAgICAgICAgbGV0IHd3ID0gTWF0aC5mbG9vciggdGhpcy53dyAqICgoIHRoaXMudmFsdWUgLSB0aGlzLm1pbiApIC8gdGhpcy5yYW5nZSApKTtcclxuICAgICAgIFxyXG4gICAgICAgIGlmKHRoaXMubW9kZWwgIT09IDMpIHRoaXMuc1s1XS53aWR0aCA9IHd3ICsgJ3B4JztcclxuICAgICAgICBpZih0aGlzLnNbNl0pIHRoaXMuc1s2XS5sZWZ0ID0gKCB0aGlzLnNhICsgd3cgKyAzICkgKyAncHgnO1xyXG4gICAgICAgIHRoaXMuY1syXS50ZXh0Q29udGVudCA9IHRoaXMudmFsdWUgKyAodGhpcy5pc0RlZyA/ICfCsCc6JycpO1xyXG5cclxuICAgICAgICBpZiggdXAgKSB0aGlzLnNlbmQoKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgclNpemUgKCkge1xyXG5cclxuICAgICAgICBzdXBlci5yU2l6ZSgpO1xyXG5cclxuICAgICAgICBsZXQgdyA9IHRoaXMuc2IgLSB0aGlzLnNjO1xyXG4gICAgICAgIHRoaXMud3cgPSB3IC0gNjtcclxuXHJcbiAgICAgICAgbGV0IHR4ID0gdGhpcy5zYztcclxuICAgICAgICBpZih0aGlzLmlzVUkgfHwgIXRoaXMuc2ltcGxlKSB0eCA9IHRoaXMuc2MrMTA7XHJcbiAgICAgICAgdGhpcy50eGwgPSB0aGlzLncgLSB0eCArIDI7XHJcblxyXG4gICAgICAgIC8vbGV0IHR5ID0gTWF0aC5mbG9vcih0aGlzLmggKiAwLjUpIC0gODtcclxuXHJcbiAgICAgICAgbGV0IHMgPSB0aGlzLnM7XHJcblxyXG4gICAgICAgIHNbMl0ud2lkdGggPSAodGhpcy5zYyAtNiApKyAncHgnO1xyXG4gICAgICAgIHNbMl0ubGVmdCA9ICh0aGlzLnR4bCArNCkgKyAncHgnO1xyXG4gICAgICAgIC8vc1syXS50b3AgPSB0eSArICdweCc7XHJcbiAgICAgICAgc1szXS5sZWZ0ID0gdGhpcy5zYSArICdweCc7XHJcbiAgICAgICAgc1szXS53aWR0aCA9IHcgKyAncHgnO1xyXG4gICAgICAgIHNbNF0ubGVmdCA9IHRoaXMuc2EgKyAncHgnO1xyXG4gICAgICAgIHNbNF0ud2lkdGggPSB3ICsgJ3B4JztcclxuICAgICAgICBzWzVdLmxlZnQgPSAodGhpcy5zYSArIDMpICsgJ3B4JztcclxuXHJcbiAgICAgICAgdGhpcy51cGRhdGUoKTtcclxuXHJcbiAgICB9XHJcblxyXG59IiwiaW1wb3J0IHsgUHJvdG8gfSBmcm9tICcuLi9jb3JlL1Byb3RvJztcclxuXHJcbmV4cG9ydCBjbGFzcyBUZXh0SW5wdXQgZXh0ZW5kcyBQcm90byB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoIG8gPSB7fSApIHtcclxuXHJcbiAgICAgICAgc3VwZXIoIG8gKTtcclxuXHJcbiAgICAgICAgdGhpcy5jbW9kZSA9IDA7XHJcblxyXG4gICAgICAgIHRoaXMudmFsdWUgPSBvLnZhbHVlIHx8ICcnO1xyXG4gICAgICAgIHRoaXMucGxhY2VIb2xkZXIgPSBvLnBsYWNlSG9sZGVyIHx8ICcnO1xyXG5cclxuICAgICAgICB0aGlzLmFsbHdheSA9IG8uYWxsd2F5IHx8IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuZWRpdGFibGUgPSBvLmVkaXQgIT09IHVuZGVmaW5lZCA/IG8uZWRpdCA6IHRydWU7XHJcblxyXG5cclxuICAgICAgICB0aGlzLmlzRG93biA9IGZhbHNlO1xyXG5cclxuICAgICAgICAvLyBiZ1xyXG4gICAgICAgIHRoaXMuY1syXSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MuYmFzaWMgKyAnIGJhY2tncm91bmQ6JyArIHRoaXMuY29sb3JzLnNlbGVjdCArICc7IHRvcDo0cHg7IHdpZHRoOjBweDsgaGVpZ2h0OicgKyAodGhpcy5oLTgpICsgJ3B4OycgKTtcclxuXHJcbiAgICAgICAgdGhpcy5jWzNdID0gdGhpcy5kb20oICdkaXYnLCB0aGlzLmNzcy50eHRzZWxlY3QgKyAnaGVpZ2h0OicgKyAodGhpcy5oLTQpICsgJ3B4OyBiYWNrZ3JvdW5kOicgKyB0aGlzLmNvbG9ycy5pbnB1dEJnICsgJzsgYm9yZGVyQ29sb3I6JyArIHRoaXMuY29sb3JzLmlucHV0Qm9yZGVyKyc7IGJvcmRlci1yYWRpdXM6Jyt0aGlzLnJhZGl1cysncHg7JyApO1xyXG4gICAgICAgIHRoaXMuY1szXS50ZXh0Q29udGVudCA9IHRoaXMudmFsdWU7XHJcblxyXG4gICAgICAgIC8vIGN1cnNvclxyXG4gICAgICAgIHRoaXMuY1s0XSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MuYmFzaWMgKyAndG9wOjRweDsgaGVpZ2h0OicgKyAodGhpcy5oLTgpICsgJ3B4OyB3aWR0aDowcHg7IGJhY2tncm91bmQ6Jyt0aGlzLmZvbnRDb2xvcisnOycgKTtcclxuXHJcbiAgICAgICAgLy8gZmFrZVxyXG4gICAgICAgIHRoaXMuY1s1XSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MudHh0c2VsZWN0ICsgJ2hlaWdodDonICsgKHRoaXMuaC00KSArICdweDsganVzdGlmeS1jb250ZW50OiBjZW50ZXI7IGZvbnQtc3R5bGU6IGl0YWxpYzsgY29sb3I6Jyt0aGlzLmNvbG9ycy5pbnB1dEhvbGRlcisnOycgKTtcclxuICAgICAgICBpZiggdGhpcy52YWx1ZSA9PT0gJycgKSB0aGlzLmNbNV0udGV4dENvbnRlbnQgPSB0aGlzLnBsYWNlSG9sZGVyO1xyXG5cclxuXHJcbiAgICAgICAgdGhpcy5pbml0KCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHRlc3Rab25lICggZSApIHtcclxuXHJcbiAgICAgICAgbGV0IGwgPSB0aGlzLmxvY2FsO1xyXG4gICAgICAgIGlmKCBsLnggPT09IC0xICYmIGwueSA9PT0gLTEgKSByZXR1cm4gJyc7XHJcbiAgICAgICAgaWYoIGwueCA+PSB0aGlzLnNhICkgcmV0dXJuICd0ZXh0JztcclxuICAgICAgICByZXR1cm4gJyc7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vICAgRVZFTlRTXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgbW91c2V1cCAoIGUgKSB7XHJcblxyXG4gICAgICAgIGlmKCF0aGlzLmVkaXRhYmxlKSByZXR1cm47XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmlzRG93biApe1xyXG4gICAgICAgICAgICB0aGlzLmlzRG93biA9IGZhbHNlO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tb3VzZW1vdmUoIGUgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW91c2Vkb3duICggZSApIHtcclxuXHJcbiAgICAgICAgaWYoIXRoaXMuZWRpdGFibGUpIHJldHVybjtcclxuXHJcbiAgICAgICAgbGV0IG5hbWUgPSB0aGlzLnRlc3Rab25lKCBlICk7XHJcblxyXG4gICAgICAgIGlmKCAhdGhpcy5pc0Rvd24gKXtcclxuICAgICAgICAgICAgdGhpcy5pc0Rvd24gPSB0cnVlO1xyXG4gICAgICAgICAgICBpZiggbmFtZSA9PT0gJ3RleHQnICkgdGhpcy5zZXRJbnB1dCggdGhpcy5jWzNdICk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1vdXNlbW92ZSggZSApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb3VzZW1vdmUgKCBlICkge1xyXG5cclxuICAgICAgICBpZighdGhpcy5lZGl0YWJsZSkgcmV0dXJuO1xyXG5cclxuICAgICAgICBsZXQgbmFtZSA9IHRoaXMudGVzdFpvbmUoIGUgKTtcclxuXHJcbiAgICAgICAgLy9sZXQgbCA9IHRoaXMubG9jYWw7XHJcbiAgICAgICAgLy9pZiggbC54ID09PSAtMSAmJiBsLnkgPT09IC0xICl7IHJldHVybjt9XHJcblxyXG4gICAgICAgIC8vaWYoIGwueCA+PSB0aGlzLnNhICkgdGhpcy5jdXJzb3IoJ3RleHQnKTtcclxuICAgICAgICAvL2Vsc2UgdGhpcy5jdXJzb3IoKTtcclxuXHJcbiAgICAgICAgbGV0IHggPSAwO1xyXG5cclxuICAgICAgICBpZiggbmFtZSA9PT0gJ3RleHQnICkgdGhpcy5jdXJzb3IoJ3RleHQnKTtcclxuICAgICAgICBlbHNlIHRoaXMuY3Vyc29yKCk7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmlzRG93biApIHggPSBlLmNsaWVudFggLSB0aGlzLnpvbmUueDtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMudXBJbnB1dCggeCAtIHRoaXMuc2EgLTMsIHRoaXMuaXNEb3duICk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZSAoICkge1xyXG5cclxuICAgICAgICB0aGlzLmNbM10udGV4dENvbnRlbnQgPSB0aGlzLnZhbHVlO1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICByZW5kZXIgKCBjLCBlLCBzICkge1xyXG5cclxuICAgICAgICB0aGlzLnNbNF0ud2lkdGggPSAnMXB4JztcclxuICAgICAgICB0aGlzLnNbNF0ubGVmdCA9ICh0aGlzLnNhICsgYys1KSArICdweCc7XHJcblxyXG4gICAgICAgIHRoaXMuc1syXS5sZWZ0ID0gKHRoaXMuc2EgKyBlKzUpICsgJ3B4JztcclxuICAgICAgICB0aGlzLnNbMl0ud2lkdGggPSBzKydweCc7XHJcbiAgICBcclxuICAgIH1cclxuXHJcblxyXG4gICAgcmVzZXQgKCkge1xyXG5cclxuICAgICAgICB0aGlzLmN1cnNvcigpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyAgIElOUFVUXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgc2VsZWN0ICggYywgZSwgdyApIHtcclxuXHJcbiAgICAgICAgbGV0IHMgPSB0aGlzLnM7XHJcbiAgICAgICAgbGV0IGQgPSB0aGlzLnNhICsgNTtcclxuICAgICAgICBzWzRdLndpZHRoID0gJzFweCc7XHJcbiAgICAgICAgc1s0XS5sZWZ0ID0gKCBkICsgYyApICsgJ3B4JztcclxuICAgICAgICBzWzJdLmxlZnQgPSAoIGQgKyBlICkgKyAncHgnO1xyXG4gICAgICAgIHNbMl0ud2lkdGggPSB3ICsgJ3B4JztcclxuICAgIFxyXG4gICAgfVxyXG5cclxuICAgIHVuc2VsZWN0ICgpIHtcclxuXHJcbiAgICAgICAgbGV0IHMgPSB0aGlzLnM7XHJcbiAgICAgICAgaWYoIXMpIHJldHVybjtcclxuICAgICAgICBzWzJdLndpZHRoID0gMCArICdweCc7XHJcbiAgICAgICAgc1s0XS53aWR0aCA9IDAgKyAncHgnO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB2YWxpZGF0ZSAoIGZvcmNlICkge1xyXG5cclxuICAgICAgICBpZiggdGhpcy5hbGx3YXkgKSBmb3JjZSA9IHRydWU7IFxyXG5cclxuICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy5jWzNdLnRleHRDb250ZW50O1xyXG5cclxuICAgICAgICBpZih0aGlzLnZhbHVlICE9PSAnJykgdGhpcy5jWzVdLnRleHRDb250ZW50ID0gJyc7XHJcbiAgICAgICAgZWxzZSB0aGlzLmNbNV0udGV4dENvbnRlbnQgPSB0aGlzLnBsYWNlSG9sZGVyO1xyXG5cclxuICAgICAgICBpZiggIWZvcmNlICkgcmV0dXJuO1xyXG5cclxuICAgICAgICB0aGlzLnNlbmQoKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBSRVpJU0VcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICByU2l6ZSAoKSB7XHJcblxyXG4gICAgICAgIHN1cGVyLnJTaXplKCk7XHJcblxyXG4gICAgICAgIGxldCBzID0gdGhpcy5zO1xyXG4gICAgICAgIHNbM10ubGVmdCA9IHRoaXMuc2EgKyAncHgnO1xyXG4gICAgICAgIHNbM10ud2lkdGggPSB0aGlzLnNiICsgJ3B4JztcclxuXHJcbiAgICAgICAgc1s1XS5sZWZ0ID0gdGhpcy5zYSArICdweCc7XHJcbiAgICAgICAgc1s1XS53aWR0aCA9IHRoaXMuc2IgKyAncHgnO1xyXG4gICAgIFxyXG4gICAgfVxyXG5cclxuXHJcbn0iLCJpbXBvcnQgeyBQcm90byB9IGZyb20gJy4uL2NvcmUvUHJvdG8nO1xyXG5cclxuXHJcbmV4cG9ydCBjbGFzcyBUaXRsZSBleHRlbmRzIFByb3RvIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvciggbyA9IHt9ICkge1xyXG5cclxuICAgICAgICBzdXBlciggbyApO1xyXG5cclxuICAgICAgICBsZXQgcHJlZml4ID0gby5wcmVmaXggfHwgJyc7XHJcblxyXG4gICAgICAgIHRoaXMuY1syXSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MudHh0ICsgJ3RleHQtYWxpZ246cmlnaHQ7IHdpZHRoOjYwcHg7IGxpbmUtaGVpZ2h0OicrICh0aGlzLmgtOCkgKyAncHg7IGNvbG9yOicgKyB0aGlzLmZvbnRDb2xvciApO1xyXG5cclxuICAgICAgICBpZiggdGhpcy5oID09PSAzMSApe1xyXG5cclxuICAgICAgICAgICAgdGhpcy5zWzBdLmhlaWdodCA9IHRoaXMuaCArICdweCc7XHJcbiAgICAgICAgICAgIHRoaXMuc1sxXS50b3AgPSA4ICsgJ3B4JztcclxuICAgICAgICAgICAgdGhpcy5jWzJdLnN0eWxlLnRvcCA9IDggKyAncHgnO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBzID0gdGhpcy5zO1xyXG5cclxuICAgICAgICBzWzFdLnRleHRBbGlnbiA9IG8uYWxpZ24gfHwgJ2xlZnQnO1xyXG4gICAgICAgIHNbMV0uZm9udFdlaWdodCA9IG8uZm9udFdlaWdodCB8fCAnYm9sZCc7XHJcblxyXG5cclxuICAgICAgICB0aGlzLmNbMV0udGV4dENvbnRlbnQgPSB0aGlzLnR4dC5zdWJzdHJpbmcoMCwxKS50b1VwcGVyQ2FzZSgpICsgdGhpcy50eHQuc3Vic3RyaW5nKDEpLnJlcGxhY2UoXCItXCIsIFwiIFwiKTtcclxuICAgICAgICB0aGlzLmNbMl0udGV4dENvbnRlbnQgPSBwcmVmaXg7XHJcblxyXG4gICAgICAgIHRoaXMuaW5pdCgpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB0ZXh0ICggdHh0ICkge1xyXG5cclxuICAgICAgICB0aGlzLmNbMV0udGV4dENvbnRlbnQgPSB0eHQ7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHRleHQyICggdHh0ICkge1xyXG5cclxuICAgICAgICB0aGlzLmNbMl0udGV4dENvbnRlbnQgPSB0eHQ7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHJTaXplICgpIHtcclxuXHJcbiAgICAgICAgc3VwZXIuclNpemUoKTtcclxuICAgICAgICB0aGlzLnNbMV0ud2lkdGggPSB0aGlzLncgKyAncHgnOyAvLy0gNTAgKyAncHgnO1xyXG4gICAgICAgIHRoaXMuc1syXS5sZWZ0ID0gdGhpcy53ICsgJ3B4JzsvLy0gKCA1MCArIDI2ICkgKyAncHgnO1xyXG5cclxuICAgIH1cclxuXHJcbn0iLCJpbXBvcnQgeyBQcm90byB9IGZyb20gJy4uL2NvcmUvUHJvdG8nO1xyXG5cclxuZXhwb3J0IGNsYXNzIFNlbGVjdCBleHRlbmRzIFByb3RvIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvciggbyA9IHt9ICkge1xyXG5cclxuICAgICAgICBzdXBlciggbyApO1xyXG5cclxuICAgICAgICB0aGlzLnZhbHVlID0gby52YWx1ZSB8fCAnJztcclxuXHJcbiAgICAgICAgdGhpcy5pc0Rvd24gPSBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy5vbkFjdGlmID0gby5vbkFjdGlmIHx8IGZ1bmN0aW9uKCl7fTtcclxuXHJcbiAgICAgICAgdGhpcy5idXR0b25Db2xvciA9IG8uYkNvbG9yIHx8IHRoaXMuY29sb3JzLmJ1dHRvbjtcclxuICAgICAgICB0aGlzLmJ1dHRvbk92ZXIgPSBvLmJPdmVyIHx8IHRoaXMuY29sb3JzLm92ZXI7XHJcbiAgICAgICAgdGhpcy5idXR0b25Eb3duID0gby5iRG93biB8fCB0aGlzLmNvbG9ycy5zZWxlY3Q7XHJcbiAgICAgICAgdGhpcy5idXR0b25BY3Rpb24gPSBvLmJBY3Rpb24gfHwgdGhpcy5jb2xvcnMuYWN0aW9uO1xyXG5cclxuICAgICAgICBsZXQgcHJlZml4ID0gby5wcmVmaXggfHwgJyc7XHJcblxyXG4gICAgICAgIHRoaXMuY1syXSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MudHh0ICsgdGhpcy5jc3MuYnV0dG9uICsgJyB0b3A6MXB4OyBiYWNrZ3JvdW5kOicrdGhpcy5idXR0b25Db2xvcisnOyBoZWlnaHQ6JysodGhpcy5oLTIpKydweDsgYm9yZGVyOicrdGhpcy5jb2xvcnMuYnV0dG9uQm9yZGVyKyc7IGJvcmRlci1yYWRpdXM6MTVweDsgd2lkdGg6MzBweDsgbGVmdDoxMHB4OycgKTtcclxuICAgICAgICB0aGlzLmNbMl0uc3R5bGUuY29sb3IgPSB0aGlzLmZvbnRDb2xvcjtcclxuXHJcbiAgICAgICAgdGhpcy5jWzNdID0gdGhpcy5kb20oICdkaXYnLCB0aGlzLmNzcy50eHRzZWxlY3QgKyAnaGVpZ2h0OicgKyAodGhpcy5oLTQpICsgJ3B4OyBiYWNrZ3JvdW5kOicgKyB0aGlzLmNvbG9ycy5pbnB1dEJnICsgJzsgYm9yZGVyQ29sb3I6JyArIHRoaXMuY29sb3JzLmlucHV0Qm9yZGVyKyc7IGJvcmRlci1yYWRpdXM6Jyt0aGlzLnJhZGl1cysncHg7JyApO1xyXG4gICAgICAgIHRoaXMuY1szXS50ZXh0Q29udGVudCA9IHRoaXMudmFsdWU7XHJcblxyXG4gICAgICAgIGxldCBmbHRvcCA9IE1hdGguZmxvb3IodGhpcy5oKjAuNSktNztcclxuICAgICAgICB0aGlzLmNbNF0gPSB0aGlzLmRvbSggJ3BhdGgnLCB0aGlzLmNzcy5iYXNpYyArICdwb3NpdGlvbjphYnNvbHV0ZTsgd2lkdGg6MTRweDsgaGVpZ2h0OjE0cHg7IGxlZnQ6NXB4OyB0b3A6JytmbHRvcCsncHg7JywgeyBkOnRoaXMuc3Znc1sgJ2N1cnNvcicgXSwgZmlsbDp0aGlzLmZvbnRDb2xvciwgc3Ryb2tlOidub25lJ30pO1xyXG5cclxuICAgICAgICB0aGlzLnN0YXQgPSAxO1xyXG4gICAgICAgIHRoaXMuaXNBY3RpZiA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLmluaXQoKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgdGVzdFpvbmUgKCBlICkge1xyXG5cclxuICAgICAgICBsZXQgbCA9IHRoaXMubG9jYWw7XHJcbiAgICAgICAgaWYoIGwueCA9PT0gLTEgJiYgbC55ID09PSAtMSApIHJldHVybiAnJztcclxuICAgICAgICBpZiggbC54ID4gdGhpcy5zYSAmJiBsLnggPCB0aGlzLnNhKzMwICkgcmV0dXJuICdvdmVyJztcclxuICAgICAgICByZXR1cm4gJzAnXHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vICAgRVZFTlRTXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgbW91c2V1cCAoIGUgKSB7XHJcbiAgICBcclxuICAgICAgICBpZiggdGhpcy5pc0Rvd24gKXtcclxuICAgICAgICAgICAgLy90aGlzLnZhbHVlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuaXNEb3duID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vdGhpcy5zZW5kKCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1vdXNlbW92ZSggZSApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb3VzZWRvd24gKCBlICkge1xyXG5cclxuICAgICAgICBsZXQgbmFtZSA9IHRoaXMudGVzdFpvbmUoIGUgKTtcclxuXHJcbiAgICAgICAgaWYoICFuYW1lICkgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLmlzRG93biA9IHRydWU7XHJcbiAgICAgICAgLy90aGlzLnZhbHVlID0gdGhpcy52YWx1ZXNbIG5hbWUtMiBdO1xyXG4gICAgICAgIC8vdGhpcy5zZW5kKCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubW91c2Vtb3ZlKCBlICk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vdXNlbW92ZSAoIGUgKSB7XHJcblxyXG4gICAgICAgIGxldCB1cCA9IGZhbHNlO1xyXG5cclxuICAgICAgICBsZXQgbmFtZSA9IHRoaXMudGVzdFpvbmUoIGUgKTtcclxuICAgICAgICAvL2xldCBzZWwgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgXHJcblxyXG4gICAgICAgIC8vY29uc29sZS5sb2cobmFtZSlcclxuXHJcbiAgICAgICAgaWYoIG5hbWUgPT09ICdvdmVyJyApe1xyXG4gICAgICAgICAgICB0aGlzLmN1cnNvcigncG9pbnRlcicpO1xyXG4gICAgICAgICAgICB1cCA9IHRoaXMubW9kZSggdGhpcy5pc0Rvd24gPyAzIDogMiApO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHVwID0gdGhpcy5yZXNldCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHVwO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgYXBwbHkgKCB2ICkge1xyXG5cclxuICAgICAgICB2ID0gdiB8fCAnJztcclxuXHJcbiAgICAgICAgaWYoIHYgIT09IHRoaXMudmFsdWUgKSB7XHJcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB2O1xyXG4gICAgICAgICAgICB0aGlzLmNbM10udGV4dENvbnRlbnQgPSB0aGlzLnZhbHVlO1xyXG4gICAgICAgICAgICB0aGlzLnNlbmQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5tb2RlKDEpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGUgKCkge1xyXG5cclxuICAgICAgICB0aGlzLm1vZGUoIDMgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW9kZSAoIG4gKSB7XHJcblxyXG4gICAgICAgIGxldCBjaGFuZ2UgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuc3RhdCAhPT0gbiApe1xyXG5cclxuICAgICAgICAgICAgaWYoIG49PT0xICkgdGhpcy5pc0FjdGlmID0gZmFsc2U7O1xyXG5cclxuICAgICAgICAgICAgaWYoIG49PT0zICl7IFxyXG4gICAgICAgICAgICAgICAgaWYoICF0aGlzLmlzQWN0aWYgKXsgdGhpcy5pc0FjdGlmID0gdHJ1ZTsgbj00OyB0aGlzLm9uQWN0aWYoIHRoaXMgKTsgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7IHRoaXMuaXNBY3RpZiA9IGZhbHNlOyB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmKCBuPT09MiAmJiB0aGlzLmlzQWN0aWYgKSBuID0gNDtcclxuXHJcbiAgICAgICAgICAgIHN3aXRjaCggbiApe1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgMTogdGhpcy5zdGF0ID0gMTsgdGhpcy5zWyAyIF0uY29sb3IgPSB0aGlzLmZvbnRDb2xvcjsgIHRoaXMuc1sgMiBdLmJhY2tncm91bmQgPSB0aGlzLmJ1dHRvbkNvbG9yOyBicmVhazsgLy8gYmFzZVxyXG4gICAgICAgICAgICAgICAgY2FzZSAyOiB0aGlzLnN0YXQgPSAyOyB0aGlzLnNbIDIgXS5jb2xvciA9IHRoaXMuZm9udFNlbGVjdDsgdGhpcy5zWyAyIF0uYmFja2dyb3VuZCA9IHRoaXMuYnV0dG9uT3ZlcjsgYnJlYWs7IC8vIG92ZXJcclxuICAgICAgICAgICAgICAgIGNhc2UgMzogdGhpcy5zdGF0ID0gMzsgdGhpcy5zWyAyIF0uY29sb3IgPSB0aGlzLmZvbnRTZWxlY3Q7IHRoaXMuc1sgMiBdLmJhY2tncm91bmQgPSB0aGlzLmJ1dHRvbkRvd247IGJyZWFrOyAvLyBkb3duXHJcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IHRoaXMuc3RhdCA9IDQ7IHRoaXMuc1sgMiBdLmNvbG9yID0gdGhpcy5mb250U2VsZWN0OyB0aGlzLnNbIDIgXS5iYWNrZ3JvdW5kID0gdGhpcy5idXR0b25BY3Rpb247IGJyZWFrOyAvLyBhY3RpZlxyXG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY2hhbmdlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gY2hhbmdlO1xyXG5cclxuXHJcblxyXG4gICAgfVxyXG5cclxuICAgIHJlc2V0ICgpIHtcclxuXHJcbiAgICAgICAgdGhpcy5jdXJzb3IoKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5tb2RlKCB0aGlzLmlzQWN0aWYgPyA0IDogMSApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB0ZXh0ICggdHh0ICkge1xyXG5cclxuICAgICAgICB0aGlzLmNbM10udGV4dENvbnRlbnQgPSB0eHQ7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHJTaXplICgpIHtcclxuXHJcbiAgICAgICAgc3VwZXIuclNpemUoKTtcclxuXHJcbiAgICAgICAgbGV0IHMgPSB0aGlzLnM7XHJcbiAgICAgICAgc1syXS5sZWZ0ID0gdGhpcy5zYSArICdweCc7XHJcbiAgICAgICAgc1szXS5sZWZ0ID0gKHRoaXMuc2EgKyA0MCkgKyAncHgnO1xyXG4gICAgICAgIHNbM10ud2lkdGggPSAodGhpcy5zYiAtIDQwKSArICdweCc7XHJcbiAgICAgICAgc1s0XS5sZWZ0ID0gKHRoaXMuc2ErOCkgKyAncHgnO1xyXG5cclxuICAgIH1cclxuXHJcbn0iLCJpbXBvcnQgeyBQcm90byB9IGZyb20gJy4uL2NvcmUvUHJvdG8nO1xyXG5cclxuZXhwb3J0IGNsYXNzIFNlbGVjdG9yIGV4dGVuZHMgUHJvdG8ge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCBvID0ge30gKSB7XHJcblxyXG4gICAgICAgIHN1cGVyKCBvICk7XHJcblxyXG4gICAgICAgIHRoaXMudmFsdWVzID0gby52YWx1ZXM7XHJcbiAgICAgICAgaWYodHlwZW9mIHRoaXMudmFsdWVzID09PSAnc3RyaW5nJyApIHRoaXMudmFsdWVzID0gWyB0aGlzLnZhbHVlcyBdO1xyXG5cclxuICAgICAgICB0aGlzLnZhbHVlID0gby52YWx1ZSB8fCB0aGlzLnZhbHVlc1swXTtcclxuXHJcblxyXG5cclxuICAgICAgICAvL3RoaXMuc2VsZWN0ZWQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuaXNEb3duID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMuYnV0dG9uQ29sb3IgPSBvLmJDb2xvciB8fCB0aGlzLmNvbG9ycy5idXR0b247XHJcbiAgICAgICAgdGhpcy5idXR0b25PdmVyID0gby5iT3ZlciB8fCB0aGlzLmNvbG9ycy5vdmVyO1xyXG4gICAgICAgIHRoaXMuYnV0dG9uRG93biA9IG8uYkRvd24gfHwgdGhpcy5jb2xvcnMuc2VsZWN0O1xyXG5cclxuICAgICAgICB0aGlzLmxuZyA9IHRoaXMudmFsdWVzLmxlbmd0aDtcclxuICAgICAgICB0aGlzLnRtcCA9IFtdO1xyXG4gICAgICAgIHRoaXMuc3RhdCA9IFtdO1xyXG5cclxuICAgICAgICBsZXQgc2VsO1xyXG5cclxuICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgdGhpcy5sbmc7IGkrKyl7XHJcblxyXG4gICAgICAgICAgICBzZWwgPSBmYWxzZTtcclxuICAgICAgICAgICAgaWYoIHRoaXMudmFsdWVzW2ldID09PSB0aGlzLnZhbHVlICkgc2VsID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuY1tpKzJdID0gdGhpcy5kb20oICdkaXYnLCB0aGlzLmNzcy50eHQgKyB0aGlzLmNzcy5idXR0b24gKyAnIHRvcDoxcHg7IGJhY2tncm91bmQ6Jysoc2VsPyB0aGlzLmJ1dHRvbkRvd24gOiB0aGlzLmJ1dHRvbkNvbG9yKSsnOyBoZWlnaHQ6JysodGhpcy5oLTIpKydweDsgYm9yZGVyOicrdGhpcy5jb2xvcnMuYnV0dG9uQm9yZGVyKyc7IGJvcmRlci1yYWRpdXM6Jyt0aGlzLnJhZGl1cysncHg7JyApO1xyXG4gICAgICAgICAgICB0aGlzLmNbaSsyXS5zdHlsZS5jb2xvciA9IHNlbCA/IHRoaXMuZm9udFNlbGVjdCA6IHRoaXMuZm9udENvbG9yO1xyXG4gICAgICAgICAgICB0aGlzLmNbaSsyXS5pbm5lckhUTUwgPSB0aGlzLnZhbHVlc1tpXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuc3RhdFtpXSA9IHNlbCA/IDM6MTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuaW5pdCgpO1xyXG4gICAgIFxyXG4gICAgfVxyXG5cclxuICAgIHRlc3Rab25lICggZSApIHtcclxuXHJcbiAgICAgICAgbGV0IGwgPSB0aGlzLmxvY2FsO1xyXG4gICAgICAgIGlmKCBsLnggPT09IC0xICYmIGwueSA9PT0gLTEgKSByZXR1cm4gJyc7XHJcblxyXG4gICAgICAgIGxldCBpID0gdGhpcy5sbmc7XHJcbiAgICAgICAgbGV0IHQgPSB0aGlzLnRtcDtcclxuICAgICAgICBcclxuICAgICAgICB3aGlsZSggaS0tICl7XHJcbiAgICAgICAgXHRpZiggbC54PnRbaV1bMF0gJiYgbC54PHRbaV1bMl0gKSByZXR1cm4gaSsyO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuICcnXHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vICAgRVZFTlRTXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgbW91c2V1cCAoIGUgKSB7XHJcbiAgICBcclxuICAgICAgICBpZiggdGhpcy5pc0Rvd24gKXtcclxuICAgICAgICAgICAgLy90aGlzLnZhbHVlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuaXNEb3duID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vdGhpcy5zZW5kKCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1vdXNlbW92ZSggZSApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb3VzZWRvd24gKCBlICkge1xyXG5cclxuICAgIFx0bGV0IG5hbWUgPSB0aGlzLnRlc3Rab25lKCBlICk7XHJcblxyXG4gICAgICAgIGlmKCAhbmFtZSApIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICBcdHRoaXMuaXNEb3duID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy52YWx1ZXNbIG5hbWUtMiBdO1xyXG4gICAgICAgIHRoaXMuc2VuZCgpO1xyXG4gICAgXHRyZXR1cm4gdGhpcy5tb3VzZW1vdmUoIGUgKTtcclxuIFxyXG4gICAgICAgIC8vIHRydWU7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vdXNlbW92ZSAoIGUgKSB7XHJcblxyXG4gICAgICAgIGxldCB1cCA9IGZhbHNlO1xyXG5cclxuICAgICAgICBsZXQgbmFtZSA9IHRoaXMudGVzdFpvbmUoIGUgKTtcclxuICAgICAgICAvL2xldCBzZWwgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgXHJcblxyXG4gICAgICAgIC8vY29uc29sZS5sb2cobmFtZSlcclxuXHJcbiAgICAgICAgaWYoIG5hbWUgIT09ICcnICl7XHJcbiAgICAgICAgICAgIHRoaXMuY3Vyc29yKCdwb2ludGVyJyk7XHJcbiAgICAgICAgICAgIHVwID0gdGhpcy5tb2RlcyggdGhpcy5pc0Rvd24gPyAzIDogMiwgbmFtZSApO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgXHR1cCA9IHRoaXMucmVzZXQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB1cDtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIG1vZGVzICggbiwgbmFtZSApIHtcclxuXHJcbiAgICAgICAgbGV0IHYsIHIgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgZm9yKCBsZXQgaSA9IDA7IGkgPCB0aGlzLmxuZzsgaSsrICl7XHJcblxyXG4gICAgICAgICAgICBpZiggaSA9PT0gbmFtZS0yICYmIHRoaXMudmFsdWVzWyBpIF0gIT09IHRoaXMudmFsdWUgKSB2ID0gdGhpcy5tb2RlKCBuLCBpKzIgKTtcclxuICAgICAgICAgICAgZWxzZXsgXHJcblxyXG4gICAgICAgICAgICAgICAgaWYoIHRoaXMudmFsdWVzWyBpIF0gPT09IHRoaXMudmFsdWUgKSB2ID0gdGhpcy5tb2RlKCAzLCBpKzIgKTtcclxuICAgICAgICAgICAgICAgIGVsc2UgdiA9IHRoaXMubW9kZSggMSwgaSsyICk7XHJcblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZih2KSByID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcjtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW9kZSAoIG4sIG5hbWUgKSB7XHJcblxyXG4gICAgICAgIGxldCBjaGFuZ2UgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgbGV0IGkgPSBuYW1lIC0gMjtcclxuXHJcblxyXG4gICAgICAgIGlmKCB0aGlzLnN0YXRbaV0gIT09IG4gKXtcclxuXHJcbiAgICAgICAgICAgXHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgIHN3aXRjaCggbiApe1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgMTogdGhpcy5zdGF0W2ldID0gMTsgdGhpcy5zWyBpKzIgXS5jb2xvciA9IHRoaXMuZm9udENvbG9yOyAgdGhpcy5zWyBpKzIgXS5iYWNrZ3JvdW5kID0gdGhpcy5idXR0b25Db2xvcjsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDI6IHRoaXMuc3RhdFtpXSA9IDI7IHRoaXMuc1sgaSsyIF0uY29sb3IgPSB0aGlzLmZvbnRTZWxlY3Q7IHRoaXMuc1sgaSsyIF0uYmFja2dyb3VuZCA9IHRoaXMuYnV0dG9uT3ZlcjsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDM6IHRoaXMuc3RhdFtpXSA9IDM7IHRoaXMuc1sgaSsyIF0uY29sb3IgPSB0aGlzLmZvbnRTZWxlY3Q7IHRoaXMuc1sgaSsyIF0uYmFja2dyb3VuZCA9IHRoaXMuYnV0dG9uRG93bjsgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjaGFuZ2UgPSB0cnVlO1xyXG5cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcblxyXG4gICAgICAgIHJldHVybiBjaGFuZ2U7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICByZXNldCAoKSB7XHJcblxyXG4gICAgICAgIHRoaXMuY3Vyc29yKCk7XHJcblxyXG4gICAgICAgIGxldCB2LCByID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGZvciggbGV0IGkgPSAwOyBpIDwgdGhpcy5sbmc7IGkrKyApe1xyXG5cclxuICAgICAgICAgICAgaWYoIHRoaXMudmFsdWVzWyBpIF0gPT09IHRoaXMudmFsdWUgKSB2ID0gdGhpcy5tb2RlKCAzLCBpKzIgKTtcclxuICAgICAgICAgICAgZWxzZSB2ID0gdGhpcy5tb2RlKCAxLCBpKzIgKTtcclxuICAgICAgICAgICAgaWYodikgciA9IHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcjsvL3RoaXMubW9kZXMoIDEgLCAyICk7XHJcblxyXG4gICAgXHQvKmlmKCB0aGlzLnNlbGVjdGVkICl7XHJcbiAgICBcdFx0dGhpcy5zWyB0aGlzLnNlbGVjdGVkIF0uY29sb3IgPSB0aGlzLmZvbnRDb2xvcjtcclxuICAgICAgICAgICAgdGhpcy5zWyB0aGlzLnNlbGVjdGVkIF0uYmFja2dyb3VuZCA9IHRoaXMuYnV0dG9uQ29sb3I7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWQgPSBudWxsO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICBcdH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7Ki9cclxuXHJcbiAgICB9XHJcblxyXG4gICAgbGFiZWwgKCBzdHJpbmcsIG4gKSB7XHJcblxyXG4gICAgICAgIG4gPSBuIHx8IDI7XHJcbiAgICAgICAgdGhpcy5jW25dLnRleHRDb250ZW50ID0gc3RyaW5nO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBpY29uICggc3RyaW5nLCB5LCBuICkge1xyXG5cclxuICAgICAgICBuID0gbiB8fCAyO1xyXG4gICAgICAgIHRoaXMuc1tuXS5wYWRkaW5nID0gKCB5IHx8IDAgKSArJ3B4IDBweCc7XHJcbiAgICAgICAgdGhpcy5jW25dLmlubmVySFRNTCA9IHN0cmluZztcclxuXHJcbiAgICB9XHJcblxyXG4gICAgclNpemUgKCkge1xyXG5cclxuICAgICAgICBzdXBlci5yU2l6ZSgpOztcclxuXHJcbiAgICAgICAgbGV0IHMgPSB0aGlzLnM7XHJcbiAgICAgICAgbGV0IHcgPSB0aGlzLnNiO1xyXG4gICAgICAgIGxldCBkID0gdGhpcy5zYTtcclxuXHJcbiAgICAgICAgbGV0IGkgPSB0aGlzLmxuZztcclxuICAgICAgICBsZXQgZGMgPSAgMztcclxuICAgICAgICBsZXQgc2l6ZSA9IE1hdGguZmxvb3IoICggdy0oZGMqKGktMSkpICkgLyBpICk7XHJcblxyXG4gICAgICAgIHdoaWxlKGktLSl7XHJcblxyXG4gICAgICAgIFx0dGhpcy50bXBbaV0gPSBbIE1hdGguZmxvb3IoIGQgKyAoIHNpemUgKiBpICkgKyAoIGRjICogaSApKSwgc2l6ZSBdO1xyXG4gICAgICAgIFx0dGhpcy50bXBbaV1bMl0gPSB0aGlzLnRtcFtpXVswXSArIHRoaXMudG1wW2ldWzFdO1xyXG4gICAgICAgICAgICBzW2krMl0ubGVmdCA9IHRoaXMudG1wW2ldWzBdICsgJ3B4JztcclxuICAgICAgICAgICAgc1tpKzJdLndpZHRoID0gdGhpcy50bXBbaV1bMV0gKyAncHgnO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxufSIsImltcG9ydCB7IFByb3RvIH0gZnJvbSAnLi4vY29yZS9Qcm90byc7XHJcblxyXG5leHBvcnQgY2xhc3MgRW1wdHkgZXh0ZW5kcyBQcm90byB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoIG8gPSB7fSApIHtcclxuXHJcblx0ICAgIG8uc2ltcGxlID0gdHJ1ZTtcclxuXHQgICAgby5pc1NwYWNlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgc3VwZXIoIG8gKTtcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLmluaXQoKTtcclxuXHJcbiAgICB9XHJcbiAgICBcclxufVxyXG4iLCJpbXBvcnQgeyBQcm90byB9IGZyb20gJy4uL2NvcmUvUHJvdG8nO1xyXG5cclxuZXhwb3J0IGNsYXNzIEl0ZW0gZXh0ZW5kcyBQcm90byB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoIG8gPSB7fSApIHtcclxuXHJcbiAgICAgICAgc3VwZXIoIG8gKTtcclxuXHJcbiAgICAgICAgdGhpcy5wID0gMTAwO1xyXG4gICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnR4dDtcclxuICAgICAgICB0aGlzLnN0YXR1cyA9IDE7XHJcblxyXG4gICAgICAgIHRoaXMuaXR5cGUgPSBvLml0eXBlIHx8ICdub25lJztcclxuICAgICAgICB0aGlzLnZhbCA9IHRoaXMuaXR5cGU7XHJcblxyXG4gICAgICAgIHRoaXMuZ3JhcGggPSB0aGlzLnN2Z3NbIHRoaXMuaXR5cGUgXTtcclxuXHJcbiAgICAgICAgbGV0IGZsdG9wID0gTWF0aC5mbG9vcih0aGlzLmgqMC41KS03O1xyXG5cclxuICAgICAgICB0aGlzLmNbMl0gPSB0aGlzLmRvbSggJ3BhdGgnLCB0aGlzLmNzcy5iYXNpYyArICdwb3NpdGlvbjphYnNvbHV0ZTsgd2lkdGg6MTRweDsgaGVpZ2h0OjE0cHg7IGxlZnQ6NXB4OyB0b3A6JytmbHRvcCsncHg7JywgeyBkOnRoaXMuZ3JhcGgsIGZpbGw6dGhpcy5mb250Q29sb3IsIHN0cm9rZTonbm9uZSd9KTtcclxuXHJcbiAgICAgICAgdGhpcy5zWzFdLm1hcmdpbkxlZnQgPSAyMCArICdweCc7XHJcblxyXG4gICAgICAgIHRoaXMuaW5pdCgpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyAgIEVWRU5UU1xyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIG1vdXNlbW92ZSAoIGUgKSB7XHJcblxyXG4gICAgICAgIHRoaXMuY3Vyc29yKCdwb2ludGVyJyk7XHJcblxyXG4gICAgICAgIC8vdXAgPSB0aGlzLm1vZGVzKCB0aGlzLmlzRG93biA/IDMgOiAyLCBuYW1lICk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vdXNlZG93biAoIGUgKSB7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmlzVUkgKSB0aGlzLm1haW4ucmVzZXRJdGVtKCk7XHJcblxyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWQoIHRydWUgKTtcclxuXHJcbiAgICAgICAgdGhpcy5zZW5kKCk7XHJcblxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB1aW91dCAoKSB7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmlzU2VsZWN0ICkgdGhpcy5tb2RlKDMpO1xyXG4gICAgICAgIGVsc2UgdGhpcy5tb2RlKDEpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB1aW92ZXIgKCkge1xyXG5cclxuICAgICAgICBpZiggdGhpcy5pc1NlbGVjdCApIHRoaXMubW9kZSg0KTtcclxuICAgICAgICBlbHNlIHRoaXMubW9kZSgyKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlICgpIHtcclxuICAgICAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgLypyU2l6ZSAoKSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgc3VwZXIuclNpemUoKTtcclxuXHJcbiAgICB9Ki9cclxuXHJcbiAgICBtb2RlICggbiApIHtcclxuXHJcbiAgICAgICAgbGV0IGNoYW5nZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICBpZiggdGhpcy5zdGF0dXMgIT09IG4gKXtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuc3RhdHVzID0gbjtcclxuICAgICAgICBcclxuICAgICAgICAgICAgc3dpdGNoKCBuICl7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSAxOiB0aGlzLnN0YXR1cyA9IDE7IHRoaXMuc1sxXS5jb2xvciA9IHRoaXMuZm9udENvbG9yOyB0aGlzLnNbMF0uYmFja2dyb3VuZCA9ICdub25lJzsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDI6IHRoaXMuc3RhdHVzID0gMjsgdGhpcy5zWzFdLmNvbG9yID0gdGhpcy5mb250Q29sb3I7IHRoaXMuc1swXS5iYWNrZ3JvdW5kID0gdGhpcy5iZ092ZXI7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAzOiB0aGlzLnN0YXR1cyA9IDM7IHRoaXMuc1sxXS5jb2xvciA9ICcjRkZGJzsgICAgICAgICB0aGlzLnNbMF0uYmFja2dyb3VuZCA9IHRoaXMuY29sb3JzLnNlbGVjdDsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IHRoaXMuc3RhdHVzID0gNDsgdGhpcy5zWzFdLmNvbG9yID0gJyNGRkYnOyAgICAgICAgIHRoaXMuc1swXS5iYWNrZ3JvdW5kID0gdGhpcy5jb2xvcnMuZG93bjsgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjaGFuZ2UgPSB0cnVlO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBjaGFuZ2U7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHJlc2V0ICgpIHtcclxuXHJcbiAgICAgICAgdGhpcy5jdXJzb3IoKTtcclxuICAgICAgIC8vIHJldHVybiB0aGlzLm1vZGUoIDEgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgc2VsZWN0ZWQgKCBiICl7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmlzU2VsZWN0ICkgdGhpcy5tb2RlKDEpO1xyXG5cclxuICAgICAgICB0aGlzLmlzU2VsZWN0ID0gYiB8fCBmYWxzZTtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuaXNTZWxlY3QgKSB0aGlzLm1vZGUoMyk7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG5cclxufSIsImltcG9ydCB7IFByb3RvIH0gZnJvbSAnLi4vY29yZS9Qcm90byc7XHJcblxyXG5leHBvcnQgY2xhc3MgR3JpZCBleHRlbmRzIFByb3RvIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvciggbyA9IHt9ICkge1xyXG5cclxuICAgICAgICBzdXBlciggbyApO1xyXG5cclxuICAgICAgICB0aGlzLnZhbHVlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy52YWx1ZXMgPSBvLnZhbHVlcyB8fCBbXTtcclxuXHJcbiAgICAgICAgaWYoIHR5cGVvZiB0aGlzLnZhbHVlcyA9PT0gJ3N0cmluZycgKSB0aGlzLnZhbHVlcyA9IFsgdGhpcy52YWx1ZXMgXTtcclxuXHJcbiAgICAgICAgLy90aGlzLnNlbGVjdGVkID0gbnVsbDtcclxuICAgICAgICB0aGlzLmlzRG93biA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLmJ1dHRvbkNvbG9yID0gby5iQ29sb3IgfHwgdGhpcy5jb2xvcnMuYnV0dG9uO1xyXG4gICAgICAgIHRoaXMuYnV0dG9uT3ZlciA9IG8uYk92ZXIgfHwgdGhpcy5jb2xvcnMub3ZlcjtcclxuICAgICAgICB0aGlzLmJ1dHRvbkRvd24gPSBvLmJEb3duIHx8IHRoaXMuY29sb3JzLnNlbGVjdDtcclxuXHJcbiAgICAgICAgdGhpcy5zcGFjZXMgPSBvLnNwYWNlcyB8fCBbMTAsM107XHJcbiAgICAgICAgdGhpcy5ic2l6ZSA9IG8uYnNpemUgfHwgWzEwMCwyMF07XHJcblxyXG4gICAgICAgIHRoaXMuYnNpemVNYXggPSB0aGlzLmJzaXplWzBdO1xyXG5cclxuICAgICAgICB0aGlzLmxuZyA9IHRoaXMudmFsdWVzLmxlbmd0aDtcclxuICAgICAgICB0aGlzLnRtcCA9IFtdO1xyXG4gICAgICAgIHRoaXMuc3RhdCA9IFtdO1xyXG4gICAgICAgIHRoaXMuZ3JpZCA9IFsgMiwgTWF0aC5yb3VuZCggdGhpcy5sbmcgKiAwLjUgKSBdO1xyXG4gICAgICAgIHRoaXMuaCA9IHRoaXMuZ3JpZFsxXSAqICggdGhpcy5ic2l6ZVsxXSArIHRoaXMuc3BhY2VzWzFdICkgKyB0aGlzLnNwYWNlc1sxXTtcclxuXHJcbiAgICAgICAgdGhpcy5jWzFdLnRleHRDb250ZW50ID0gJyc7XHJcblxyXG4gICAgICAgIHRoaXMuY1syXSA9IHRoaXMuZG9tKCAndGFibGUnLCB0aGlzLmNzcy5iYXNpYyArICd3aWR0aDoxMDAlOyB0b3A6JysodGhpcy5zcGFjZXNbMV0tMikrJ3B4OyBoZWlnaHQ6YXV0bzsgYm9yZGVyLWNvbGxhcHNlOnNlcGFyYXRlOyBib3JkZXI6bm9uZTsgYm9yZGVyLXNwYWNpbmc6ICcrKHRoaXMuc3BhY2VzWzBdLTIpKydweCAnKyh0aGlzLnNwYWNlc1sxXS0yKSsncHg7JyApO1xyXG5cclxuICAgICAgICBsZXQgbiA9IDAsIGIsIG1pZCwgdGQsIHRyO1xyXG5cclxuICAgICAgICB0aGlzLmJ1dHRvbnMgPSBbXTtcclxuICAgICAgICB0aGlzLnN0YXQgPSBbXTtcclxuICAgICAgICB0aGlzLnRtcFggPSBbXTtcclxuICAgICAgICB0aGlzLnRtcFkgPSBbXTtcclxuXHJcbiAgICAgICAgZm9yKCBsZXQgaSA9IDA7IGkgPCB0aGlzLmdyaWRbMV07IGkrKyApe1xyXG4gICAgICAgICAgICB0ciA9IHRoaXMuY1syXS5pbnNlcnRSb3coKTtcclxuICAgICAgICAgICAgdHIuc3R5bGUuY3NzVGV4dCA9ICdwb2ludGVyLWV2ZW50czpub25lOyc7XHJcbiAgICAgICAgICAgIGZvciggbGV0IGogPSAwOyBqIDwgdGhpcy5ncmlkWzBdOyBqKysgKXtcclxuXHJcbiAgICAgICAgICAgICAgICB0ZCA9IHRyLmluc2VydENlbGwoKTtcclxuICAgICAgICAgICAgICAgIHRkLnN0eWxlLmNzc1RleHQgPSAncG9pbnRlci1ldmVudHM6bm9uZTsnO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKCB0aGlzLnZhbHVlc1tuXSApe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBiID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2RpdicgKTtcclxuICAgICAgICAgICAgICAgICAgICBiLnN0eWxlLmNzc1RleHQgPSB0aGlzLmNzcy50eHQgKyB0aGlzLmNzcy5idXR0b24gKyAncG9zaXRpb246c3RhdGljOyB3aWR0aDonK3RoaXMuYnNpemVbMF0rJ3B4OyBoZWlnaHQ6Jyt0aGlzLmJzaXplWzFdKydweDsgYm9yZGVyOicrdGhpcy5jb2xvcnMuYnV0dG9uQm9yZGVyKyc7IGxlZnQ6YXV0bzsgcmlnaHQ6YXV0bzsgYmFja2dyb3VuZDonK3RoaXMuYnV0dG9uQ29sb3IrJzsgIGJvcmRlci1yYWRpdXM6Jyt0aGlzLnJhZGl1cysncHg7JztcclxuICAgICAgICAgICAgICAgICAgICBiLmlubmVySFRNTCA9IHRoaXMudmFsdWVzW25dO1xyXG4gICAgICAgICAgICAgICAgICAgIHRkLmFwcGVuZENoaWxkKCBiICk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYnV0dG9ucy5wdXNoKGIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdC5wdXNoKDEpO1xyXG5cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnZGl2JyApO1xyXG4gICAgICAgICAgICAgICAgICAgIGIuc3R5bGUuY3NzVGV4dCA9IHRoaXMuY3NzLnR4dCArICdwb3NpdGlvbjpzdGF0aWM7IHdpZHRoOicrdGhpcy5ic2l6ZVswXSsncHg7IGhlaWdodDonK3RoaXMuYnNpemVbMV0rJ3B4OyB0ZXh0LWFsaWduOmNlbnRlcjsgIGxlZnQ6YXV0bzsgcmlnaHQ6YXV0bzsgYmFja2dyb3VuZDpub25lOyc7XHJcbiAgICAgICAgICAgICAgICAgICAgdGQuYXBwZW5kQ2hpbGQoIGIgKTtcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoaj09PTApIGIuc3R5bGUuY3NzVGV4dCArPSAnZmxvYXQ6cmlnaHQ7JztcclxuICAgICAgICAgICAgICAgIGVsc2UgYi5zdHlsZS5jc3NUZXh0ICs9ICdmbG9hdDpsZWZ0Oyc7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgbisrO1xyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5pbml0KCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHRlc3Rab25lICggZSApIHtcclxuXHJcbiAgICAgICAgbGV0IGwgPSB0aGlzLmxvY2FsO1xyXG4gICAgICAgIGlmKCBsLnggPT09IC0xICYmIGwueSA9PT0gLTEgKSByZXR1cm4gLTE7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IHR4ID0gdGhpcy50bXBYO1xyXG4gICAgICAgIGxldCB0eSA9IHRoaXMudG1wWTtcclxuXHJcbiAgICAgICAgbGV0IGlkID0gLTE7XHJcbiAgICAgICAgbGV0IGMgPSAtMTtcclxuICAgICAgICBsZXQgbGluZSA9IC0xO1xyXG4gICAgICAgIGxldCBpID0gdGhpcy5ncmlkWzBdO1xyXG4gICAgICAgIHdoaWxlKCBpLS0gKXtcclxuICAgICAgICBcdGlmKCBsLnggPiB0eFtpXVswXSAmJiBsLnggPCB0eFtpXVsxXSApIGMgPSBpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaSA9IHRoaXMuZ3JpZFsxXTtcclxuICAgICAgICB3aGlsZSggaS0tICl7XHJcbiAgICAgICAgICAgIGlmKCBsLnkgPiB0eVtpXVswXSAmJiBsLnkgPCB0eVtpXVsxXSApIGxpbmUgPSBpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoYyE9PS0xICYmIGxpbmUhPT0tMSl7XHJcbiAgICAgICAgICAgIGlkID0gYyArIChsaW5lKjIpO1xyXG4gICAgICAgICAgICBpZihpZD50aGlzLmxuZy0xKSBpZCA9IC0xO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGlkO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyAgIEVWRU5UU1xyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIG1vdXNldXAgKCBlICkge1xyXG4gICAgXHJcbiAgICAgICAgaWYoIHRoaXMuaXNEb3duICl7XHJcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5pc0Rvd24gPSBmYWxzZTtcclxuICAgICAgICAgICAgLy90aGlzLnNlbmQoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubW91c2Vtb3ZlKCBlICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vdXNlZG93biAoIGUgKSB7XHJcblxyXG4gICAgXHRsZXQgaWQgPSB0aGlzLnRlc3Rab25lKCBlICk7XHJcblxyXG4gICAgICAgIGlmKCBpZCA8IDAgKSByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgXHR0aGlzLmlzRG93biA9IHRydWU7XHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IHRoaXMudmFsdWVzW2lkXTtcclxuICAgICAgICB0aGlzLnNlbmQoKTtcclxuICAgIFx0cmV0dXJuIHRoaXMubW91c2Vtb3ZlKCBlICk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vdXNlbW92ZSAoIGUgKSB7XHJcblxyXG4gICAgICAgIGxldCB1cCA9IGZhbHNlO1xyXG5cclxuICAgICAgICBsZXQgaWQgPSB0aGlzLnRlc3Rab25lKCBlICk7XHJcblxyXG4gICAgICAgIGlmKCBpZCAhPT0gLTEgKXtcclxuICAgICAgICAgICAgdGhpcy5jdXJzb3IoJ3BvaW50ZXInKTtcclxuICAgICAgICAgICAgdXAgPSB0aGlzLm1vZGVzKCB0aGlzLmlzRG93biA/IDMgOiAyLCBpZCApO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgXHR1cCA9IHRoaXMucmVzZXQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB1cDtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIG1vZGVzICggbiwgaWQgKSB7XHJcblxyXG4gICAgICAgIGxldCB2LCByID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGZvciggbGV0IGkgPSAwOyBpIDwgdGhpcy5sbmc7IGkrKyApe1xyXG5cclxuICAgICAgICAgICAgaWYoIGkgPT09IGlkICkgdiA9IHRoaXMubW9kZSggbiwgaSApO1xyXG4gICAgICAgICAgICBlbHNlIHYgPSB0aGlzLm1vZGUoIDEsIGkgKTtcclxuXHJcbiAgICAgICAgICAgIGlmKHYpIHIgPSB0cnVlO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiByO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb2RlICggbiwgaWQgKSB7XHJcblxyXG4gICAgICAgIGxldCBjaGFuZ2UgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgbGV0IGkgPSBpZDtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuc3RhdFtpXSAhPT0gbiApe1xyXG4gICAgICAgIFxyXG4gICAgICAgICAgICBzd2l0Y2goIG4gKXtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlIDE6IHRoaXMuc3RhdFtpXSA9IDE7IHRoaXMuYnV0dG9uc1sgaSBdLnN0eWxlLmNvbG9yID0gdGhpcy5mb250Q29sb3I7ICB0aGlzLmJ1dHRvbnNbIGkgXS5zdHlsZS5iYWNrZ3JvdW5kID0gdGhpcy5idXR0b25Db2xvcjsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDI6IHRoaXMuc3RhdFtpXSA9IDI7IHRoaXMuYnV0dG9uc1sgaSBdLnN0eWxlLmNvbG9yID0gdGhpcy5mb250U2VsZWN0OyB0aGlzLmJ1dHRvbnNbIGkgXS5zdHlsZS5iYWNrZ3JvdW5kID0gdGhpcy5idXR0b25PdmVyOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgMzogdGhpcy5zdGF0W2ldID0gMzsgdGhpcy5idXR0b25zWyBpIF0uc3R5bGUuY29sb3IgPSB0aGlzLmZvbnRTZWxlY3Q7IHRoaXMuYnV0dG9uc1sgaSBdLnN0eWxlLmJhY2tncm91bmQgPSB0aGlzLmJ1dHRvbkRvd247IGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY2hhbmdlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG5cclxuICAgICAgICByZXR1cm4gY2hhbmdlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgcmVzZXQgKCkge1xyXG5cclxuICAgICAgICB0aGlzLmN1cnNvcigpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLm1vZGVzKCAxICwgMCApO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBsYWJlbCAoIHN0cmluZywgbiApIHtcclxuXHJcbiAgICAgICAgdGhpcy5idXR0b25zW25dLnRleHRDb250ZW50ID0gc3RyaW5nO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBpY29uICggc3RyaW5nLCB5LCBuICkge1xyXG5cclxuICAgICAgICB0aGlzLmJ1dHRvbnNbbl0uc3R5bGUucGFkZGluZyA9ICggeSB8fCAwICkgKydweCAwcHgnO1xyXG4gICAgICAgIHRoaXMuYnV0dG9uc1tuXS5pbm5lckhUTUwgPSBzdHJpbmc7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHRlc3RXICgpIHtcclxuXHJcbiAgICAgICAgbGV0IHZ3ID0gdGhpcy5zcGFjZXNbMF0qMyArIHRoaXMuYnNpemVNYXgqMiwgcnogPSBmYWxzZTtcclxuICAgICAgICBpZiggdncgPiB0aGlzLncgKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYnNpemVbMF0gPSAoIHRoaXMudy0odGhpcy5zcGFjZXNbMF0qMykgKSAqIDAuNTtcclxuICAgICAgICAgICAgcnogPSB0cnVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmKCB0aGlzLmJzaXplWzBdICE9PSB0aGlzLmJzaXplTWF4ICkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ic2l6ZVswXSA9IHRoaXMuYnNpemVNYXg7XHJcbiAgICAgICAgICAgICAgICByeiA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKCAhcnogKSByZXR1cm47XHJcblxyXG4gICAgICAgIGxldCBpID0gdGhpcy5idXR0b25zLmxlbmd0aDtcclxuICAgICAgICB3aGlsZShpLS0pIHRoaXMuYnV0dG9uc1tpXS5zdHlsZS53aWR0aCA9IHRoaXMuYnNpemVbMF0gKyAncHgnO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICByU2l6ZSAoKSB7XHJcblxyXG4gICAgICAgIHN1cGVyLnJTaXplKCk7XHJcblxyXG4gICAgICAgIHRoaXMudGVzdFcoKTtcclxuXHJcbiAgICAgICAgbGV0IG4gPSAwLCBiLCBtaWQ7XHJcblxyXG4gICAgICAgIHRoaXMudG1wWCA9IFtdO1xyXG4gICAgICAgIHRoaXMudG1wWSA9IFtdO1xyXG5cclxuICAgICAgICBmb3IoIGxldCBqID0gMDsgaiA8IHRoaXMuZ3JpZFswXTsgaisrICl7XHJcblxyXG4gICAgICAgICAgICBpZihqPT09MCl7XHJcbiAgICAgICAgICAgICAgICBtaWQgPSAoIHRoaXMudyowLjUgKSAtICggdGhpcy5zcGFjZXNbMF0qMC41ICk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRtcFgucHVzaCggWyBtaWQtdGhpcy5ic2l6ZVswXSwgbWlkIF0gKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIG1pZCA9ICggdGhpcy53KjAuNSApICsgKCB0aGlzLnNwYWNlc1swXSowLjUgKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudG1wWC5wdXNoKCBbIG1pZCwgbWlkK3RoaXMuYnNpemVbMF0gXSApO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbWlkID0gdGhpcy5zcGFjZXNbMV07XHJcblxyXG4gICAgICAgIGZvciggbGV0IGkgPSAwOyBpIDwgdGhpcy5ncmlkWzFdOyBpKysgKXtcclxuXHJcbiAgICAgICAgICAgIHRoaXMudG1wWS5wdXNoKCBbIG1pZCwgbWlkICsgdGhpcy5ic2l6ZVsxXSBdICk7XHJcbiAgICAgICAgICAgIG1pZCArPSB0aGlzLmJzaXplWzFdICsgdGhpcy5zcGFjZXNbMV07XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG59IiwiXHJcbmltcG9ydCB7IEJvb2wgfSBmcm9tICcuLi9wcm90by9Cb29sLmpzJztcclxuaW1wb3J0IHsgQnV0dG9uIH0gZnJvbSAnLi4vcHJvdG8vQnV0dG9uLmpzJztcclxuaW1wb3J0IHsgQ2lyY3VsYXIgfSBmcm9tICcuLi9wcm90by9DaXJjdWxhci5qcyc7XHJcbmltcG9ydCB7IENvbG9yIH0gZnJvbSAnLi4vcHJvdG8vQ29sb3IuanMnO1xyXG5pbXBvcnQgeyBGcHMgfSBmcm9tICcuLi9wcm90by9GcHMuanMnO1xyXG5pbXBvcnQgeyBHcmFwaCB9IGZyb20gJy4uL3Byb3RvL0dyYXBoLmpzJztcclxuaW1wb3J0IHsgR3JvdXAgIH0gZnJvbSAnLi4vcHJvdG8vR3JvdXAuanMnO1xyXG5pbXBvcnQgeyBKb3lzdGljayB9IGZyb20gJy4uL3Byb3RvL0pveXN0aWNrLmpzJztcclxuaW1wb3J0IHsgS25vYiB9IGZyb20gJy4uL3Byb3RvL0tub2IuanMnO1xyXG5pbXBvcnQgeyBMaXN0IH0gZnJvbSAnLi4vcHJvdG8vTGlzdC5qcyc7XHJcbmltcG9ydCB7IE51bWVyaWMgfSBmcm9tICcuLi9wcm90by9OdW1lcmljLmpzJztcclxuaW1wb3J0IHsgU2xpZGUgfSBmcm9tICcuLi9wcm90by9TbGlkZS5qcyc7XHJcbmltcG9ydCB7IFRleHRJbnB1dCB9IGZyb20gJy4uL3Byb3RvL1RleHRJbnB1dC5qcyc7XHJcbmltcG9ydCB7IFRpdGxlIH0gZnJvbSAnLi4vcHJvdG8vVGl0bGUuanMnO1xyXG5pbXBvcnQgeyBTZWxlY3QgfSBmcm9tICcuLi9wcm90by9TZWxlY3QuanMnO1xyXG5pbXBvcnQgeyBTZWxlY3RvciB9IGZyb20gJy4uL3Byb3RvL1NlbGVjdG9yLmpzJztcclxuaW1wb3J0IHsgRW1wdHkgfSBmcm9tICcuLi9wcm90by9FbXB0eS5qcyc7XHJcbmltcG9ydCB7IEl0ZW0gfSBmcm9tICcuLi9wcm90by9JdGVtLmpzJztcclxuaW1wb3J0IHsgR3JpZCB9IGZyb20gJy4uL3Byb3RvL0dyaWQuanMnO1xyXG5cclxuXHJcbmV4cG9ydCBjb25zdCBhZGQgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIGxldCBhID0gYXJndW1lbnRzOyBcclxuXHJcbiAgICAgICAgbGV0IHR5cGUsIG8sIHJlZiA9IGZhbHNlLCBuID0gbnVsbDtcclxuXHJcbiAgICAgICAgaWYoIHR5cGVvZiBhWzBdID09PSAnc3RyaW5nJyApeyBcclxuXHJcbiAgICAgICAgICAgIHR5cGUgPSBhWzBdO1xyXG4gICAgICAgICAgICBvID0gYVsxXSB8fCB7fTtcclxuXHJcbiAgICAgICAgfSBlbHNlIGlmICggdHlwZW9mIGFbMF0gPT09ICdvYmplY3QnICl7IC8vIGxpa2UgZGF0IGd1aVxyXG5cclxuICAgICAgICAgICAgcmVmID0gdHJ1ZTtcclxuICAgICAgICAgICAgaWYoIGFbMl0gPT09IHVuZGVmaW5lZCApIFtdLnB1c2guY2FsbChhLCB7fSk7XHJcblxyXG4gICAgICAgICAgICB0eXBlID0gYVsyXS50eXBlID8gYVsyXS50eXBlIDogJ3NsaWRlJzsvL2F1dG9UeXBlLmFwcGx5KCB0aGlzLCBhICk7XHJcblxyXG4gICAgICAgICAgICBvID0gYVsyXTtcclxuICAgICAgICAgICAgby5uYW1lID0gYVsxXTtcclxuICAgICAgICAgICAgby52YWx1ZSA9IGFbMF1bYVsxXV07XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IG5hbWUgPSB0eXBlLnRvTG93ZXJDYXNlKCk7XHJcblxyXG4gICAgICAgIGlmKCBuYW1lID09PSAnZ3JvdXAnICkgby5hZGQgPSBhZGQ7XHJcblxyXG4gICAgICAgIHN3aXRjaCggbmFtZSApe1xyXG5cclxuICAgICAgICAgICAgY2FzZSAnYm9vbCc6IG4gPSBuZXcgQm9vbChvKTsgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2J1dHRvbic6IG4gPSBuZXcgQnV0dG9uKG8pOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnY2lyY3VsYXInOiBuID0gbmV3IENpcmN1bGFyKG8pOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnY29sb3InOiBuID0gbmV3IENvbG9yKG8pOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnZnBzJzogbiA9IG5ldyBGcHMobyk7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdncmFwaCc6IG4gPSBuZXcgR3JhcGgobyk7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdncm91cCc6IG4gPSBuZXcgR3JvdXAobyk7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdqb3lzdGljayc6IG4gPSBuZXcgSm95c3RpY2sobyk7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdrbm9iJzogbiA9IG5ldyBLbm9iKG8pOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnbGlzdCc6IG4gPSBuZXcgTGlzdChvKTsgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ251bWVyaWMnOiBjYXNlICdudW1iZXInOiBuID0gbmV3IE51bWVyaWMobyk7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdzbGlkZSc6IG4gPSBuZXcgU2xpZGUobyk7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICd0ZXh0SW5wdXQnOiBjYXNlICdzdHJpbmcnOiBuID0gbmV3IFRleHRJbnB1dChvKTsgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3RpdGxlJzogbiA9IG5ldyBUaXRsZShvKTsgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdCc6IG4gPSBuZXcgU2VsZWN0KG8pOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnc2VsZWN0b3InOiBuID0gbmV3IFNlbGVjdG9yKG8pOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnZW1wdHknOiBjYXNlICdzcGFjZSc6IG4gPSBuZXcgRW1wdHkobyk7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdpdGVtJzogbiA9IG5ldyBJdGVtKG8pOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnZ3JpZCc6IG4gPSBuZXcgR3JpZChvKTsgYnJlYWs7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoIG4gIT09IG51bGwgKXtcclxuXHJcbiAgICAgICAgICAgIGlmKCByZWYgKSBuLnNldFJlZmVyZW5jeSggYVswXSwgYVsxXSApO1xyXG4gICAgICAgICAgICByZXR1cm4gbjtcclxuXHJcbiAgICAgICAgfVxyXG5cclxufSIsIlxyXG5pbXBvcnQgeyBSb290cyB9IGZyb20gJy4vUm9vdHMnO1xyXG5pbXBvcnQgeyBUb29scyB9IGZyb20gJy4vVG9vbHMnO1xyXG5pbXBvcnQgeyBhZGQgfSBmcm9tICcuL2FkZCc7XHJcbmltcG9ydCB7IFYyIH0gZnJvbSAnLi9WMic7XHJcblxyXG4vKipcclxuICogQGF1dGhvciBsdGggLyBodHRwczovL2dpdGh1Yi5jb20vbG8tdGhcclxuICovXHJcblxyXG5leHBvcnQgY2xhc3MgR3VpIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvciggbyA9IHt9ICkge1xyXG5cclxuICAgICAgICB0aGlzLmNhbnZhcyA9IG51bGw7XHJcblxyXG4gICAgICAgIHRoaXMuaXNFbXB0eSA9IHRydWU7XHJcblxyXG4gICAgICAgIC8vIGNvbG9yXHJcbiAgICAgICAgdGhpcy5jb2xvcnMgPSBUb29scy5jbG9uZUNvbG9yKCk7XHJcbiAgICAgICAgdGhpcy5jc3MgPSBUb29scy5jbG9uZUNzcygpO1xyXG5cclxuXHJcbiAgICAgICAgaWYoIG8uY29uZmlnICkgdGhpcy5zZXRDb25maWcoIG8uY29uZmlnICk7XHJcblxyXG5cclxuICAgICAgICB0aGlzLmJnID0gby5iZyB8fCB0aGlzLmNvbG9ycy5iYWNrZ3JvdW5kO1xyXG5cclxuICAgICAgICBpZiggby50cmFuc3BhcmVudCAhPT0gdW5kZWZpbmVkICl7XHJcbiAgICAgICAgICAgIHRoaXMuY29sb3JzLmJhY2tncm91bmQgPSAnbm9uZSc7XHJcbiAgICAgICAgICAgIHRoaXMuY29sb3JzLmJhY2tncm91bmRPdmVyID0gJ25vbmUnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy9pZiggby5jYWxsYmFjayApIHRoaXMuY2FsbGJhY2sgPSAgby5jYWxsYmFjaztcclxuXHJcbiAgICAgICAgdGhpcy5pc1Jlc2V0ID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgdGhpcy50bXBBZGQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMudG1wSCA9IDA7XHJcblxyXG4gICAgICAgIHRoaXMuaXNDYW52YXMgPSBvLmlzQ2FudmFzIHx8IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuaXNDYW52YXNPbmx5ID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5jc3NHdWkgPSBvLmNzcyAhPT0gdW5kZWZpbmVkID8gby5jc3MgOiAnJztcclxuICAgICAgICB0aGlzLmNhbGxiYWNrID0gby5jYWxsYmFjayAgPT09IHVuZGVmaW5lZCA/IG51bGwgOiBvLmNhbGxiYWNrO1xyXG5cclxuICAgICAgICB0aGlzLmZvcmNlSGVpZ2h0ID0gby5tYXhIZWlnaHQgfHwgMDtcclxuICAgICAgICB0aGlzLmxvY2tIZWlnaHQgPSBvLmxvY2tIZWlnaHQgfHwgZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMuaXNJdGVtTW9kZSA9IG8uaXRlbU1vZGUgIT09IHVuZGVmaW5lZCA/IG8uaXRlbU1vZGUgOiBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy5jbiA9ICcnO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIHNpemUgZGVmaW5lXHJcbiAgICAgICAgdGhpcy5zaXplID0gVG9vbHMuc2l6ZTtcclxuICAgICAgICBpZiggby5wICE9PSB1bmRlZmluZWQgKSB0aGlzLnNpemUucCA9IG8ucDtcclxuICAgICAgICBpZiggby53ICE9PSB1bmRlZmluZWQgKSB0aGlzLnNpemUudyA9IG8udztcclxuICAgICAgICBpZiggby5oICE9PSB1bmRlZmluZWQgKSB0aGlzLnNpemUuaCA9IG8uaDtcclxuICAgICAgICBpZiggby5zICE9PSB1bmRlZmluZWQgKSB0aGlzLnNpemUucyA9IG8ucztcclxuXHJcbiAgICAgICAgdGhpcy5zaXplLmggPSB0aGlzLnNpemUuaCA8IDExID8gMTEgOiB0aGlzLnNpemUuaDtcclxuXHJcbiAgICAgICAgLy8gbG9jYWwgbW91c2UgYW5kIHpvbmVcclxuICAgICAgICB0aGlzLmxvY2FsID0gbmV3IFYyKCkubmVnKCk7XHJcbiAgICAgICAgdGhpcy56b25lID0geyB4OjAsIHk6MCwgdzp0aGlzLnNpemUudywgaDowIH07XHJcblxyXG4gICAgICAgIC8vIHZpcnR1YWwgbW91c2VcclxuICAgICAgICB0aGlzLm1vdXNlID0gbmV3IFYyKCkubmVnKCk7XHJcblxyXG4gICAgICAgIHRoaXMuaCA9IDA7XHJcbiAgICAgICAgdGhpcy5wcmV2WSA9IC0xO1xyXG4gICAgICAgIHRoaXMuc3cgPSAwO1xyXG5cclxuICAgICAgICBcclxuXHJcbiAgICAgICAgLy8gYm90dG9tIGFuZCBjbG9zZSBoZWlnaHRcclxuICAgICAgICB0aGlzLmlzV2l0aENsb3NlID0gby5jbG9zZSAhPT0gdW5kZWZpbmVkID8gby5jbG9zZSA6IHRydWU7XHJcbiAgICAgICAgdGhpcy5iaCA9ICF0aGlzLmlzV2l0aENsb3NlID8gMCA6IHRoaXMuc2l6ZS5oO1xyXG5cclxuICAgICAgICB0aGlzLmF1dG9SZXNpemUgPSBvLmF1dG9SZXNpemUgPT09IHVuZGVmaW5lZCA/IHRydWUgOiBvLmF1dG9SZXNpemU7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5pc0NlbnRlciA9IG8uY2VudGVyIHx8IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuaXNPcGVuID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmlzRG93biA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuaXNTY3JvbGwgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy51aXMgPSBbXTtcclxuXHJcbiAgICAgICAgdGhpcy5jdXJyZW50ID0gLTE7XHJcbiAgICAgICAgdGhpcy50YXJnZXQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuZGVjYWwgPSAwO1xyXG4gICAgICAgIHRoaXMucmF0aW8gPSAxO1xyXG4gICAgICAgIHRoaXMub3kgPSAwO1xyXG5cclxuXHJcblxyXG4gICAgICAgIHRoaXMuaXNOZXdUYXJnZXQgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy5jb250ZW50ID0gVG9vbHMuZG9tKCAnZGl2JywgdGhpcy5jc3MuYmFzaWMgKyAnIHdpZHRoOjBweDsgaGVpZ2h0OmF1dG87IHRvcDowcHg7ICcgKyB0aGlzLmNzc0d1aSApO1xyXG5cclxuICAgICAgICB0aGlzLmlubmVyQ29udGVudCA9IFRvb2xzLmRvbSggJ2RpdicsIHRoaXMuY3NzLmJhc2ljICsgJ3dpZHRoOjEwMCU7IHRvcDowOyBsZWZ0OjA7IGhlaWdodDphdXRvOyBvdmVyZmxvdzpoaWRkZW47Jyk7XHJcbiAgICAgICAgdGhpcy5jb250ZW50LmFwcGVuZENoaWxkKCB0aGlzLmlubmVyQ29udGVudCApO1xyXG5cclxuICAgICAgICB0aGlzLmlubmVyID0gVG9vbHMuZG9tKCAnZGl2JywgdGhpcy5jc3MuYmFzaWMgKyAnd2lkdGg6MTAwJTsgbGVmdDowOyAnKTtcclxuICAgICAgICB0aGlzLmlubmVyQ29udGVudC5hcHBlbmRDaGlsZCh0aGlzLmlubmVyKTtcclxuXHJcbiAgICAgICAgLy8gc2Nyb2xsXHJcbiAgICAgICAgdGhpcy5zY3JvbGxCRyA9IFRvb2xzLmRvbSggJ2RpdicsIHRoaXMuY3NzLmJhc2ljICsgJ3JpZ2h0OjA7IHRvcDowOyB3aWR0aDonKyAodGhpcy5zaXplLnMgLSAxKSArJ3B4OyBoZWlnaHQ6MTBweDsgZGlzcGxheTpub25lOyBiYWNrZ3JvdW5kOicrdGhpcy5iZysnOycpO1xyXG4gICAgICAgIHRoaXMuY29udGVudC5hcHBlbmRDaGlsZCggdGhpcy5zY3JvbGxCRyApO1xyXG5cclxuICAgICAgICB0aGlzLnNjcm9sbCA9IFRvb2xzLmRvbSggJ2RpdicsIHRoaXMuY3NzLmJhc2ljICsgJ2JhY2tncm91bmQ6Jyt0aGlzLmNvbG9ycy5zY3JvbGwrJzsgcmlnaHQ6MnB4OyB0b3A6MDsgd2lkdGg6JysodGhpcy5zaXplLnMtNCkrJ3B4OyBoZWlnaHQ6MTBweDsnKTtcclxuICAgICAgICB0aGlzLnNjcm9sbEJHLmFwcGVuZENoaWxkKCB0aGlzLnNjcm9sbCApO1xyXG5cclxuICAgICAgICAvLyBib3R0b20gYnV0dG9uXHJcblxyXG4gICAgICAgIGxldCByID0gby5yYWRpdXMgfHwgdGhpcy5jb2xvcnMucmFkaXVzO1xyXG4gICAgICAgIHRoaXMuYm90dG9tID0gVG9vbHMuZG9tKCAnZGl2JywgIHRoaXMuY3NzLnR4dCArICd3aWR0aDoxMDAlOyB0b3A6YXV0bzsgYm90dG9tOjA7IGxlZnQ6MDsgYm9yZGVyLWJvdHRvbS1yaWdodC1yYWRpdXM6JytyKydweDsgIGJvcmRlci1ib3R0b20tbGVmdC1yYWRpdXM6JytyKydweDsgdGV4dC1hbGlnbjpjZW50ZXI7IGhlaWdodDonK3RoaXMuYmgrJ3B4OyBsaW5lLWhlaWdodDonKyh0aGlzLmJoLTUpKydweDsnKTsvLyBib3JkZXItdG9wOjFweCBzb2xpZCAnK1Rvb2xzLmNvbG9ycy5zdHJva2UrJzsnKTtcclxuICAgICAgICB0aGlzLmNvbnRlbnQuYXBwZW5kQ2hpbGQoIHRoaXMuYm90dG9tICk7XHJcbiAgICAgICAgdGhpcy5ib3R0b20udGV4dENvbnRlbnQgPSAnQ2xvc2UnO1xyXG4gICAgICAgIHRoaXMuYm90dG9tLnN0eWxlLmJhY2tncm91bmQgPSB0aGlzLmJnO1xyXG5cclxuICAgICAgICAvL1xyXG5cclxuICAgICAgICB0aGlzLnBhcmVudCA9IG8ucGFyZW50ICE9PSB1bmRlZmluZWQgPyBvLnBhcmVudCA6IG51bGw7XHJcbiAgICAgICAgdGhpcy5wYXJlbnQgPSBvLnRhcmdldCAhPT0gdW5kZWZpbmVkID8gby50YXJnZXQgOiB0aGlzLnBhcmVudDtcclxuICAgICAgICBcclxuICAgICAgICBpZiggdGhpcy5wYXJlbnQgPT09IG51bGwgJiYgIXRoaXMuaXNDYW52YXMgKXsgXHJcbiAgICAgICAgXHR0aGlzLnBhcmVudCA9IGRvY3VtZW50LmJvZHk7XHJcbiAgICAgICAgICAgIC8vIGRlZmF1bHQgcG9zaXRpb25cclxuICAgICAgICBcdGlmKCAhdGhpcy5pc0NlbnRlciApIHRoaXMuY29udGVudC5zdHlsZS5yaWdodCA9ICcxMHB4JzsgXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiggdGhpcy5wYXJlbnQgIT09IG51bGwgKSB0aGlzLnBhcmVudC5hcHBlbmRDaGlsZCggdGhpcy5jb250ZW50ICk7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmlzQ2FudmFzICYmIHRoaXMucGFyZW50ID09PSBudWxsICkgdGhpcy5pc0NhbnZhc09ubHkgPSB0cnVlO1xyXG5cclxuICAgICAgICBpZiggIXRoaXMuaXNDYW52YXNPbmx5ICkgdGhpcy5jb250ZW50LnN0eWxlLnBvaW50ZXJFdmVudHMgPSAnYXV0byc7XHJcblxyXG5cclxuICAgICAgICB0aGlzLnNldFdpZHRoKCk7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmlzQ2FudmFzICkgdGhpcy5tYWtlQ2FudmFzKCk7XHJcblxyXG4gICAgICAgIFJvb3RzLmFkZCggdGhpcyApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBzZXRUb3AgKCB0LCBoICkge1xyXG5cclxuICAgICAgICB0aGlzLmNvbnRlbnQuc3R5bGUudG9wID0gdCArICdweCc7XHJcbiAgICAgICAgaWYoIGggIT09IHVuZGVmaW5lZCApIHRoaXMuZm9yY2VIZWlnaHQgPSBoO1xyXG4gICAgICAgIHRoaXMuc2V0SGVpZ2h0KCk7XHJcblxyXG4gICAgICAgIFJvb3RzLm5lZWRSZVpvbmUgPSB0cnVlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvL2NhbGxiYWNrOiBmdW5jdGlvbiAoKSB7fSxcclxuXHJcbiAgICBkaXNwb3NlICgpIHtcclxuXHJcbiAgICAgICAgdGhpcy5jbGVhcigpO1xyXG4gICAgICAgIGlmKCB0aGlzLnBhcmVudCAhPT0gbnVsbCApIHRoaXMucGFyZW50LnJlbW92ZUNoaWxkKCB0aGlzLmNvbnRlbnQgKTtcclxuICAgICAgICBSb290cy5yZW1vdmUoIHRoaXMgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBDQU5WQVNcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBvbkRyYXcgKCkge31cclxuXHJcbiAgICBtYWtlQ2FudmFzICgpIHtcclxuXHJcbiAgICBcdHRoaXMuY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCAnaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCcsIFwiY2FudmFzXCIgKTtcclxuICAgIFx0dGhpcy5jYW52YXMud2lkdGggPSB0aGlzLnpvbmUudztcclxuICAgIFx0dGhpcy5jYW52YXMuaGVpZ2h0ID0gdGhpcy5mb3JjZUhlaWdodCA/IHRoaXMuZm9yY2VIZWlnaHQgOiB0aGlzLnpvbmUuaDtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgZHJhdyAoIGZvcmNlICkge1xyXG5cclxuICAgIFx0aWYoIHRoaXMuY2FudmFzID09PSBudWxsICkgcmV0dXJuO1xyXG5cclxuICAgIFx0bGV0IHcgPSB0aGlzLnpvbmUudztcclxuICAgIFx0bGV0IGggPSB0aGlzLmZvcmNlSGVpZ2h0ID8gdGhpcy5mb3JjZUhlaWdodCA6IHRoaXMuem9uZS5oO1xyXG4gICAgXHRSb290cy50b0NhbnZhcyggdGhpcywgdywgaCwgZm9yY2UgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8vLy8vXHJcblxyXG4gICAgZ2V0RG9tICgpIHtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGVudDtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgc2V0TW91c2UgKCBtICkge1xyXG5cclxuICAgICAgICB0aGlzLm1vdXNlLnNldCggbS54LCBtLnkgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgc2V0Q29uZmlnICggbyApIHtcclxuXHJcbiAgICAgICAgdGhpcy5zZXRDb2xvcnMoIG8gKTtcclxuICAgICAgICB0aGlzLnNldFRleHQoIG8uZm9udFNpemUsIG8udGV4dCwgby5mb250LCBvLnNoYWRvdyApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBzZXRDb2xvcnMgKCBvICkge1xyXG5cclxuICAgICAgICBmb3IoIGxldCBjIGluIG8gKXtcclxuICAgICAgICAgICAgaWYoIHRoaXMuY29sb3JzW2NdICkgdGhpcy5jb2xvcnNbY10gPSBvW2NdO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgc2V0VGV4dCAoIHNpemUsIGNvbG9yLCBmb250LCBzaGFkb3cgKSB7XHJcblxyXG4gICAgICAgIFRvb2xzLnNldFRleHQoIHNpemUsIGNvbG9yLCBmb250LCBzaGFkb3csIHRoaXMuY29sb3JzLCB0aGlzLmNzcyApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBoaWRlICggYiApIHtcclxuXHJcbiAgICAgICAgdGhpcy5jb250ZW50LnN0eWxlLmRpc3BsYXkgPSBiID8gJ25vbmUnIDogJ2Jsb2NrJztcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBvbkNoYW5nZSAoIGYgKSB7XHJcblxyXG4gICAgICAgIHRoaXMuY2FsbGJhY2sgPSBmIHx8IG51bGw7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vICAgU1RZTEVTXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgbW9kZSAoIG4gKSB7XHJcblxyXG4gICAgXHRsZXQgbmVlZENoYW5nZSA9IGZhbHNlO1xyXG5cclxuICAgIFx0aWYoIG4gIT09IHRoaXMuY24gKXtcclxuXHJcblx0ICAgIFx0dGhpcy5jbiA9IG47XHJcblxyXG5cdCAgICBcdHN3aXRjaCggbiApe1xyXG5cclxuXHQgICAgXHRcdGNhc2UgJ2RlZic6IFxyXG5cdCAgICBcdFx0ICAgdGhpcy5zY3JvbGwuc3R5bGUuYmFja2dyb3VuZCA9IHRoaXMuY29sb3JzLnNjcm9sbDsgXHJcblx0ICAgIFx0XHQgICB0aGlzLmJvdHRvbS5zdHlsZS5iYWNrZ3JvdW5kID0gdGhpcy5jb2xvcnMuYmFja2dyb3VuZDtcclxuXHQgICAgXHRcdCAgIHRoaXMuYm90dG9tLnN0eWxlLmNvbG9yID0gdGhpcy5jb2xvcnMudGV4dDtcclxuXHQgICAgXHRcdGJyZWFrO1xyXG5cclxuXHQgICAgXHRcdC8vY2FzZSAnc2Nyb2xsRGVmJzogdGhpcy5zY3JvbGwuc3R5bGUuYmFja2dyb3VuZCA9IHRoaXMuY29sb3JzLnNjcm9sbDsgYnJlYWs7XHJcblx0ICAgIFx0XHRjYXNlICdzY3JvbGxPdmVyJzogdGhpcy5zY3JvbGwuc3R5bGUuYmFja2dyb3VuZCA9IHRoaXMuY29sb3JzLnNlbGVjdDsgYnJlYWs7XHJcblx0ICAgIFx0XHRjYXNlICdzY3JvbGxEb3duJzogdGhpcy5zY3JvbGwuc3R5bGUuYmFja2dyb3VuZCA9IHRoaXMuY29sb3JzLmRvd247IGJyZWFrO1xyXG5cclxuXHQgICAgXHRcdC8vY2FzZSAnYm90dG9tRGVmJzogdGhpcy5ib3R0b20uc3R5bGUuYmFja2dyb3VuZCA9IHRoaXMuY29sb3JzLmJhY2tncm91bmQ7IGJyZWFrO1xyXG5cdCAgICBcdFx0Y2FzZSAnYm90dG9tT3Zlcic6IHRoaXMuYm90dG9tLnN0eWxlLmJhY2tncm91bmQgPSB0aGlzLmNvbG9ycy5iYWNrZ3JvdW5kT3ZlcjsgdGhpcy5ib3R0b20uc3R5bGUuY29sb3IgPSAnI0ZGRic7IGJyZWFrO1xyXG5cdCAgICBcdFx0Ly9jYXNlICdib3R0b21Eb3duJzogdGhpcy5ib3R0b20uc3R5bGUuYmFja2dyb3VuZCA9IHRoaXMuY29sb3JzLnNlbGVjdDsgdGhpcy5ib3R0b20uc3R5bGUuY29sb3IgPSAnIzAwMCc7IGJyZWFrO1xyXG5cclxuXHQgICAgXHR9XHJcblxyXG5cdCAgICBcdG5lZWRDaGFuZ2UgPSB0cnVlO1xyXG5cclxuXHQgICAgfVxyXG5cclxuICAgIFx0cmV0dXJuIG5lZWRDaGFuZ2U7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vICAgVEFSR0VUXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgY2xlYXJUYXJnZXQgKCkge1xyXG5cclxuICAgIFx0aWYoIHRoaXMuY3VycmVudCA9PT0gLTEgKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgLy9pZighdGhpcy50YXJnZXQpIHJldHVybjtcclxuICAgICAgICB0aGlzLnRhcmdldC51aW91dCgpO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0LnJlc2V0KCk7XHJcbiAgICAgICAgdGhpcy50YXJnZXQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuY3VycmVudCA9IC0xO1xyXG5cclxuICAgICAgICAvLy9jb25zb2xlLmxvZyh0aGlzLmlzRG93bikvL2lmKHRoaXMuaXNEb3duKVJvb3RzLmNsZWFySW5wdXQoKTtcclxuXHJcbiAgICAgICAgXHJcblxyXG4gICAgICAgIFJvb3RzLmN1cnNvcigpO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyAgIFpPTkUgVEVTVFxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIHRlc3Rab25lICggZSApIHtcclxuXHJcbiAgICAgICAgbGV0IGwgPSB0aGlzLmxvY2FsO1xyXG4gICAgICAgIGlmKCBsLnggPT09IC0xICYmIGwueSA9PT0gLTEgKSByZXR1cm4gJyc7XHJcblxyXG4gICAgICAgIHRoaXMuaXNSZXNldCA9IGZhbHNlO1xyXG5cclxuICAgICAgICBsZXQgbmFtZSA9ICcnO1xyXG5cclxuICAgICAgICBsZXQgcyA9IHRoaXMuaXNTY3JvbGwgPyAgdGhpcy56b25lLncgIC0gdGhpcy5zaXplLnMgOiB0aGlzLnpvbmUudztcclxuICAgICAgICBcclxuICAgICAgICBpZiggbC55ID4gdGhpcy56b25lLmggLSB0aGlzLmJoICYmICBsLnkgPCB0aGlzLnpvbmUuaCApIG5hbWUgPSAnYm90dG9tJztcclxuICAgICAgICBlbHNlIG5hbWUgPSBsLnggPiBzID8gJ3Njcm9sbCcgOiAnY29udGVudCc7XHJcblxyXG4gICAgICAgIHJldHVybiBuYW1lO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyAgIEVWRU5UU1xyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIGhhbmRsZUV2ZW50ICggZSApIHtcclxuXHJcbiAgICBcdGxldCB0eXBlID0gZS50eXBlO1xyXG5cclxuICAgIFx0bGV0IGNoYW5nZSA9IGZhbHNlO1xyXG4gICAgXHRsZXQgdGFyZ2V0Q2hhbmdlID0gZmFsc2U7XHJcblxyXG4gICAgXHRsZXQgbmFtZSA9IHRoaXMudGVzdFpvbmUoIGUgKTtcclxuXHJcbiAgICAgICAgXHJcblxyXG4gICAgXHRpZiggdHlwZSA9PT0gJ21vdXNldXAnICYmIHRoaXMuaXNEb3duICkgdGhpcy5pc0Rvd24gPSBmYWxzZTtcclxuICAgIFx0aWYoIHR5cGUgPT09ICdtb3VzZWRvd24nICYmICF0aGlzLmlzRG93biApIHRoaXMuaXNEb3duID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuaXNEb3duICYmIHRoaXMuaXNOZXdUYXJnZXQgKXsgUm9vdHMuY2xlYXJJbnB1dCgpOyB0aGlzLmlzTmV3VGFyZ2V0PWZhbHNlOyB9XHJcblxyXG4gICAgXHRpZiggIW5hbWUgKSByZXR1cm47XHJcblxyXG4gICAgXHRzd2l0Y2goIG5hbWUgKXtcclxuXHJcbiAgICBcdFx0Y2FzZSAnY29udGVudCc6XHJcblxyXG4gICAgICAgICAgICAgICAgZS5jbGllbnRZID0gdGhpcy5pc1Njcm9sbCA/ICBlLmNsaWVudFkgKyB0aGlzLmRlY2FsIDogZS5jbGllbnRZO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKCBSb290cy5pc01vYmlsZSAmJiB0eXBlID09PSAnbW91c2Vkb3duJyApIHRoaXMuZ2V0TmV4dCggZSwgY2hhbmdlICk7XHJcblxyXG5cdCAgICBcdFx0aWYoIHRoaXMudGFyZ2V0ICkgdGFyZ2V0Q2hhbmdlID0gdGhpcy50YXJnZXQuaGFuZGxlRXZlbnQoIGUgKTtcclxuXHJcblx0ICAgIFx0XHRpZiggdHlwZSA9PT0gJ21vdXNlbW92ZScgKSBjaGFuZ2UgPSB0aGlzLm1vZGUoJ2RlZicpO1xyXG4gICAgICAgICAgICAgICAgaWYoIHR5cGUgPT09ICd3aGVlbCcgJiYgIXRhcmdldENoYW5nZSAmJiB0aGlzLmlzU2Nyb2xsICkgY2hhbmdlID0gdGhpcy5vbldoZWVsKCBlICk7XHJcbiAgICAgICAgICAgICAgIFxyXG5cdCAgICBcdFx0aWYoICFSb290cy5sb2NrICkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0TmV4dCggZSwgY2hhbmdlICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgXHRcdGJyZWFrO1xyXG4gICAgXHRcdGNhc2UgJ2JvdHRvbSc6XHJcblxyXG5cdCAgICBcdFx0dGhpcy5jbGVhclRhcmdldCgpO1xyXG5cdCAgICBcdFx0aWYoIHR5cGUgPT09ICdtb3VzZW1vdmUnICkgY2hhbmdlID0gdGhpcy5tb2RlKCdib3R0b21PdmVyJyk7XHJcblx0ICAgIFx0XHRpZiggdHlwZSA9PT0gJ21vdXNlZG93bicgKSB7XHJcblx0ICAgIFx0XHRcdHRoaXMuaXNPcGVuID0gdGhpcy5pc09wZW4gPyBmYWxzZSA6IHRydWU7XHJcblx0XHQgICAgICAgICAgICB0aGlzLmJvdHRvbS50ZXh0Q29udGVudCA9IHRoaXMuaXNPcGVuID8gJ0Nsb3NlJyA6ICdPcGVuJztcclxuXHRcdCAgICAgICAgICAgIHRoaXMuc2V0SGVpZ2h0KCk7XHJcblx0XHQgICAgICAgICAgICB0aGlzLm1vZGUoJ2RlZicpO1xyXG5cdFx0ICAgICAgICAgICAgY2hhbmdlID0gdHJ1ZTtcclxuXHQgICAgXHRcdH1cclxuXHJcbiAgICBcdFx0YnJlYWs7XHJcbiAgICBcdFx0Y2FzZSAnc2Nyb2xsJzpcclxuXHJcblx0ICAgIFx0XHR0aGlzLmNsZWFyVGFyZ2V0KCk7XHJcblx0ICAgIFx0XHRpZiggdHlwZSA9PT0gJ21vdXNlbW92ZScgKSBjaGFuZ2UgPSB0aGlzLm1vZGUoJ3Njcm9sbE92ZXInKTtcclxuXHQgICAgXHRcdGlmKCB0eXBlID09PSAnbW91c2Vkb3duJyApIGNoYW5nZSA9IHRoaXMubW9kZSgnc2Nyb2xsRG93bicpOyBcclxuICAgICAgICAgICAgICAgIGlmKCB0eXBlID09PSAnd2hlZWwnICkgY2hhbmdlID0gdGhpcy5vbldoZWVsKCBlICk7IFxyXG5cdCAgICBcdFx0aWYoIHRoaXMuaXNEb3duICkgdGhpcy51cGRhdGUoIChlLmNsaWVudFktdGhpcy56b25lLnkpLSh0aGlzLnNoKjAuNSkgKTtcclxuXHJcbiAgICBcdFx0YnJlYWs7XHJcblxyXG5cclxuICAgIFx0fVxyXG5cclxuICAgIFx0aWYoIHRoaXMuaXNEb3duICkgY2hhbmdlID0gdHJ1ZTtcclxuICAgIFx0aWYoIHRhcmdldENoYW5nZSApIGNoYW5nZSA9IHRydWU7XHJcblxyXG4gICAgICAgIGlmKCB0eXBlID09PSAna2V5dXAnICkgY2hhbmdlID0gdHJ1ZTtcclxuICAgICAgICBpZiggdHlwZSA9PT0gJ2tleWRvd24nICkgY2hhbmdlID0gdHJ1ZTtcclxuXHJcbiAgICBcdGlmKCBjaGFuZ2UgKSB0aGlzLmRyYXcoKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0TmV4dCAoIGUsIGNoYW5nZSApIHtcclxuXHJcblxyXG5cclxuICAgICAgICBsZXQgbmV4dCA9IFJvb3RzLmZpbmRUYXJnZXQoIHRoaXMudWlzLCBlICk7XHJcblxyXG4gICAgICAgIGlmKCBuZXh0ICE9PSB0aGlzLmN1cnJlbnQgKXtcclxuICAgICAgICAgICAgdGhpcy5jbGVhclRhcmdldCgpO1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnQgPSBuZXh0O1xyXG4gICAgICAgICAgICBjaGFuZ2UgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5pc05ld1RhcmdldCA9IHRydWU7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoIG5leHQgIT09IC0xICl7IFxyXG4gICAgICAgICAgICB0aGlzLnRhcmdldCA9IHRoaXMudWlzWyB0aGlzLmN1cnJlbnQgXTtcclxuICAgICAgICAgICAgdGhpcy50YXJnZXQudWlvdmVyKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBvbldoZWVsICggZSApIHtcclxuXHJcbiAgICAgICAgdGhpcy5veSArPSAyMCplLmRlbHRhO1xyXG4gICAgICAgIHRoaXMudXBkYXRlKCB0aGlzLm95ICk7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vICAgUkVTRVRcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICByZXNldCAoIGZvcmNlICkge1xyXG5cclxuICAgICAgICBpZiggdGhpcy5pc1Jlc2V0ICkgcmV0dXJuO1xyXG5cclxuICAgICAgICAvL3RoaXMucmVzZXRJdGVtKCk7XHJcblxyXG4gICAgICAgIHRoaXMubW91c2UubmVnKCk7XHJcbiAgICAgICAgdGhpcy5pc0Rvd24gPSBmYWxzZTtcclxuXHJcbiAgICAgICAgLy9Sb290cy5jbGVhcklucHV0KCk7XHJcbiAgICAgICAgbGV0IHIgPSB0aGlzLm1vZGUoJ2RlZicpO1xyXG4gICAgICAgIGxldCByMiA9IHRoaXMuY2xlYXJUYXJnZXQoKTtcclxuXHJcbiAgICAgICAgaWYoIHIgfHwgcjIgKSB0aGlzLmRyYXcoIHRydWUgKTtcclxuXHJcbiAgICAgICAgdGhpcy5pc1Jlc2V0ID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgLy9Sb290cy5sb2NrID0gZmFsc2U7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vICAgQUREIE5PREVcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBhZGQgKCkge1xyXG5cclxuICAgICAgICBsZXQgYSA9IGFyZ3VtZW50cztcclxuXHJcbiAgICAgICAgbGV0IG9udG9wID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGlmKCB0eXBlb2YgYVsxXSA9PT0gJ29iamVjdCcgKXsgXHJcblxyXG4gICAgICAgICAgICBhWzFdLmlzVUkgPSB0cnVlO1xyXG4gICAgICAgICAgICBhWzFdLm1haW4gPSB0aGlzO1xyXG5cclxuICAgICAgICAgICAgb250b3AgPSBhWzFdLm9udG9wID8gYVsxXS5vbnRvcCA6IGZhbHNlO1xyXG5cclxuICAgICAgICB9IGVsc2UgaWYoIHR5cGVvZiBhWzFdID09PSAnc3RyaW5nJyApe1xyXG5cclxuICAgICAgICAgICAgaWYoIGFbMl0gPT09IHVuZGVmaW5lZCApIFtdLnB1c2guY2FsbChhLCB7IGlzVUk6dHJ1ZSwgbWFpbjp0aGlzIH0pO1xyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGFbMl0uaXNVSSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBhWzJdLm1haW4gPSB0aGlzO1xyXG5cclxuICAgICAgICAgICAgICAgIG9udG9wID0gYVsxXS5vbnRvcCA/IGFbMV0ub250b3AgOiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICB9IFxyXG5cclxuICAgICAgICBsZXQgdSA9IGFkZC5hcHBseSggdGhpcywgYSApO1xyXG5cclxuICAgICAgICBpZiggdSA9PT0gbnVsbCApIHJldHVybjtcclxuXHJcbiAgICAgICAgaWYob250b3ApIHRoaXMudWlzLnVuc2hpZnQoIHUgKTtcclxuICAgICAgICBlbHNlIHRoaXMudWlzLnB1c2goIHUgKTtcclxuXHJcbiAgICAgICAgaWYoICF1LmF1dG9XaWR0aCApe1xyXG4gICAgICAgICAgICBsZXQgeSA9IHUuY1swXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3A7XHJcbiAgICAgICAgICAgIGlmKCB0aGlzLnByZXZZICE9PSB5ICl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhbGMoIHUuaCArIDEgKTtcclxuICAgICAgICAgICAgICAgIHRoaXMucHJldlkgPSB5O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMucHJldlkgPSAwOy8vLTE7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsYyggdS5oICsgMSApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5pc0VtcHR5ID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHJldHVybiB1O1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBhcHBseUNhbGMgKCkge1xyXG5cclxuICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMudWlzLmxlbmd0aCwgdGhpcy50bXBIIClcclxuXHJcbiAgICAgICAgdGhpcy5jYWxjKCB0aGlzLnRtcEggKTtcclxuICAgICAgICAvL3RoaXMudG1wSCA9IDA7XHJcbiAgICAgICAgdGhpcy50bXBBZGQgPSBudWxsO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBjYWxjVWlzICgpIHtcclxuXHJcbiAgICAgICAgUm9vdHMuY2FsY1VpcyggdGhpcy51aXMsIHRoaXMuem9uZSwgdGhpcy56b25lLnkgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gcmVtb3ZlIG9uZSBub2RlXHJcblxyXG4gICAgcmVtb3ZlICggbiApIHtcclxuXHJcbiAgICAgICAgaWYoIG4uY2xlYXIgKSBuLmNsZWFyKCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIGNhbGwgYWZ0ZXIgdWlzIGNsZWFyXHJcblxyXG4gICAgY2xlYXJPbmUgKCBuICkgeyBcclxuXHJcbiAgICAgICAgbGV0IGlkID0gdGhpcy51aXMuaW5kZXhPZiggbiApOyBcclxuICAgICAgICBpZiAoIGlkICE9PSAtMSApIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxjKCAtICh0aGlzLnVpc1sgaWQgXS5oICsgMSApICk7XHJcbiAgICAgICAgICAgIHRoaXMuaW5uZXIucmVtb3ZlQ2hpbGQoIHRoaXMudWlzWyBpZCBdLmNbMF0gKTtcclxuICAgICAgICAgICAgdGhpcy51aXMuc3BsaWNlKCBpZCwgMSApOyBcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIGNsZWFyIGFsbCBndWlcclxuXHJcbiAgICBlbXB0eSAoKSB7XHJcblxyXG4gICAgICAgIC8vdGhpcy5jbG9zZSgpO1xyXG5cclxuICAgICAgICBsZXQgaSA9IHRoaXMudWlzLmxlbmd0aCwgaXRlbTtcclxuXHJcbiAgICAgICAgd2hpbGUoIGktLSApe1xyXG4gICAgICAgICAgICBpdGVtID0gdGhpcy51aXMucG9wKCk7XHJcbiAgICAgICAgICAgIHRoaXMuaW5uZXIucmVtb3ZlQ2hpbGQoIGl0ZW0uY1swXSApO1xyXG4gICAgICAgICAgICBpdGVtLmNsZWFyKCB0cnVlICk7XHJcblxyXG4gICAgICAgICAgICAvL3RoaXMudWlzW2ldLmNsZWFyKClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuaXNFbXB0eSA9IHRydWU7XHJcbiAgICAgICAgLy9Sb290cy5saXN0ZW5zID0gW107XHJcbiAgICAgICAgdGhpcy5jYWxjKCAtdGhpcy5oICk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGNsZWFyICgpIHtcclxuXHJcbiAgICAgICAgdGhpcy5lbXB0eSgpO1xyXG5cclxuICAgICAgICAvL3RoaXMuY2FsbGJhY2sgPSBudWxsO1xyXG5cclxuICAgICAgICAvKmxldCBpID0gdGhpcy51aXMubGVuZ3RoO1xyXG4gICAgICAgIHdoaWxlKCBpLS0gKSB0aGlzLnVpc1tpXS5jbGVhcigpO1xyXG5cclxuICAgICAgICB0aGlzLnVpcyA9IFtdO1xyXG4gICAgICAgIFJvb3RzLmxpc3RlbnMgPSBbXTtcclxuXHJcbiAgICAgICAgdGhpcy5jYWxjKCAtdGhpcy5oICk7Ki9cclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBJVEVNUyBTUEVDSUFMXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG5cclxuICAgIHJlc2V0SXRlbSAoKSB7XHJcblxyXG4gICAgICAgIGlmKCAhdGhpcy5pc0l0ZW1Nb2RlICkgcmV0dXJuO1xyXG5cclxuICAgICAgICBsZXQgaSA9IHRoaXMudWlzLmxlbmd0aDtcclxuICAgICAgICB3aGlsZShpLS0pIHRoaXMudWlzW2ldLnNlbGVjdGVkKCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHNldEl0ZW0gKCBuYW1lICkge1xyXG5cclxuICAgICAgICBpZiggIXRoaXMuaXNJdGVtTW9kZSApIHJldHVybjtcclxuXHJcbiAgICAgICAgbmFtZSA9IG5hbWUgfHwgJyc7XHJcblxyXG4gICAgICAgIHRoaXMucmVzZXRJdGVtKCk7XHJcblxyXG4gICAgICAgIGlmKCAhbmFtZSApe1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZSgwKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH0gXHJcblxyXG4gICAgICAgIGxldCBpID0gdGhpcy51aXMubGVuZ3RoO1xyXG4gICAgICAgIHdoaWxlKGktLSl7IFxyXG4gICAgICAgICAgICBpZiggdGhpcy51aXNbaV0udmFsdWUgPT09IG5hbWUgKXsgXHJcbiAgICAgICAgICAgICAgICB0aGlzLnVpc1tpXS5zZWxlY3RlZCggdHJ1ZSApO1xyXG4gICAgICAgICAgICAgICAgaWYoIHRoaXMuaXNTY3JvbGwgKSB0aGlzLnVwZGF0ZSggKCBpKih0aGlzLnVpc1tpXS5oKzEpICkqdGhpcy5yYXRpbyApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcblxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vICAgU0NST0xMXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgdXBTY3JvbGwgKCBiICkge1xyXG5cclxuICAgICAgICB0aGlzLnN3ID0gYiA/IHRoaXMuc2l6ZS5zIDogMDtcclxuICAgICAgICB0aGlzLm95ID0gYiA/IHRoaXMub3kgOiAwO1xyXG4gICAgICAgIHRoaXMuc2Nyb2xsQkcuc3R5bGUuZGlzcGxheSA9IGIgPyAnYmxvY2snIDogJ25vbmUnO1xyXG5cclxuICAgICAgICBpZiggYiApe1xyXG5cclxuICAgICAgICAgICAgdGhpcy50b3RhbCA9IHRoaXMuaDtcclxuXHJcbiAgICAgICAgICAgIHRoaXMubWF4VmlldyA9IHRoaXMubWF4SGVpZ2h0O1xyXG5cclxuICAgICAgICAgICAgdGhpcy5yYXRpbyA9IHRoaXMubWF4VmlldyAvIHRoaXMudG90YWw7XHJcbiAgICAgICAgICAgIHRoaXMuc2ggPSB0aGlzLm1heFZpZXcgKiB0aGlzLnJhdGlvO1xyXG5cclxuICAgICAgICAgICAgLy9pZiggdGhpcy5zaCA8IDIwICkgdGhpcy5zaCA9IDIwO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5yYW5nZSA9IHRoaXMubWF4VmlldyAtIHRoaXMuc2g7XHJcblxyXG4gICAgICAgICAgICB0aGlzLm95ID0gVG9vbHMuY2xhbXAoIHRoaXMub3ksIDAsIHRoaXMucmFuZ2UgKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsQkcuc3R5bGUuaGVpZ2h0ID0gdGhpcy5tYXhWaWV3ICsgJ3B4JztcclxuICAgICAgICAgICAgdGhpcy5zY3JvbGwuc3R5bGUuaGVpZ2h0ID0gdGhpcy5zaCArICdweCc7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5zZXRJdGVtV2lkdGgoIHRoaXMuem9uZS53IC0gdGhpcy5zdyApO1xyXG4gICAgICAgIHRoaXMudXBkYXRlKCB0aGlzLm95ICk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZSAoIHkgKSB7XHJcblxyXG4gICAgICAgIHkgPSBUb29scy5jbGFtcCggeSwgMCwgdGhpcy5yYW5nZSApO1xyXG5cclxuICAgICAgICB0aGlzLmRlY2FsID0gTWF0aC5mbG9vciggeSAvIHRoaXMucmF0aW8gKTtcclxuICAgICAgICB0aGlzLmlubmVyLnN0eWxlLnRvcCA9IC0gdGhpcy5kZWNhbCArICdweCc7XHJcbiAgICAgICAgdGhpcy5zY3JvbGwuc3R5bGUudG9wID0gTWF0aC5mbG9vciggeSApICsgJ3B4JztcclxuICAgICAgICB0aGlzLm95ID0geTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBSRVNJWkUgRlVOQ1RJT05cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBjYWxjICggeSApIHtcclxuXHJcbiAgICAgICAgdGhpcy5oICs9IHk7XHJcbiAgICAgICAgY2xlYXJUaW1lb3V0KCB0aGlzLnRtcCApO1xyXG4gICAgICAgIHRoaXMudG1wID0gc2V0VGltZW91dCggdGhpcy5zZXRIZWlnaHQuYmluZCh0aGlzKSwgMTAgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgc2V0SGVpZ2h0ICgpIHtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMudG1wICkgY2xlYXJUaW1lb3V0KCB0aGlzLnRtcCApO1xyXG5cclxuICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMuaCApXHJcblxyXG4gICAgICAgIHRoaXMuem9uZS5oID0gdGhpcy5iaDtcclxuICAgICAgICB0aGlzLmlzU2Nyb2xsID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmlzT3BlbiApe1xyXG5cclxuICAgICAgICAgICAgbGV0IGhoaCA9IHRoaXMuZm9yY2VIZWlnaHQgPyB0aGlzLmZvcmNlSGVpZ2h0ICsgdGhpcy56b25lLnkgOiB3aW5kb3cuaW5uZXJIZWlnaHQ7XHJcblxyXG4gICAgICAgICAgICB0aGlzLm1heEhlaWdodCA9IGhoaCAtIHRoaXMuem9uZS55IC0gdGhpcy5iaDtcclxuXHJcbiAgICAgICAgICAgIGxldCBkaWZmID0gdGhpcy5oIC0gdGhpcy5tYXhIZWlnaHQ7XHJcblxyXG4gICAgICAgICAgICBpZiggZGlmZiA+IDEgKXsgLy90aGlzLmggPiB0aGlzLm1heEhlaWdodCApe1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuaXNTY3JvbGwgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy56b25lLmggPSB0aGlzLm1heEhlaWdodCArIHRoaXMuYmg7XHJcblxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuem9uZS5oID0gdGhpcy5oICsgdGhpcy5iaDtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy51cFNjcm9sbCggdGhpcy5pc1Njcm9sbCApO1xyXG5cclxuICAgICAgICB0aGlzLmlubmVyQ29udGVudC5zdHlsZS5oZWlnaHQgPSB0aGlzLnpvbmUuaCAtIHRoaXMuYmggKyAncHgnO1xyXG4gICAgICAgIHRoaXMuY29udGVudC5zdHlsZS5oZWlnaHQgPSB0aGlzLnpvbmUuaCArICdweCc7XHJcbiAgICAgICAgdGhpcy5ib3R0b20uc3R5bGUudG9wID0gdGhpcy56b25lLmggLSB0aGlzLmJoICsgJ3B4JztcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuZm9yY2VIZWlnaHQgJiYgdGhpcy5sb2NrSGVpZ2h0ICkgdGhpcy5jb250ZW50LnN0eWxlLmhlaWdodCA9IHRoaXMuZm9yY2VIZWlnaHQgKyAncHgnO1xyXG5cclxuICAgICAgICBpZiggdGhpcy5pc09wZW4gKSB0aGlzLmNhbGNVaXMoKTtcclxuICAgICAgICBpZiggdGhpcy5pc0NhbnZhcyApIHRoaXMuZHJhdyggdHJ1ZSApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICByZXpvbmUgKCkge1xyXG4gICAgICAgIFJvb3RzLm5lZWRSZVpvbmUgPSB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIHNldFdpZHRoICggdyApIHtcclxuXHJcbiAgICAgICAgaWYoIHcgKSB0aGlzLnpvbmUudyA9IHc7XHJcblxyXG4gICAgICAgIHRoaXMuY29udGVudC5zdHlsZS53aWR0aCA9IHRoaXMuem9uZS53ICsgJ3B4JztcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuaXNDZW50ZXIgKSB0aGlzLmNvbnRlbnQuc3R5bGUubWFyZ2luTGVmdCA9IC0oTWF0aC5mbG9vcih0aGlzLnpvbmUudyowLjUpKSArICdweCc7XHJcblxyXG4gICAgICAgIHRoaXMuc2V0SXRlbVdpZHRoKCB0aGlzLnpvbmUudyAtIHRoaXMuc3cgKTtcclxuXHJcbiAgICAgICAgdGhpcy5zZXRIZWlnaHQoKTtcclxuXHJcbiAgICAgICAgaWYoICF0aGlzLmlzQ2FudmFzT25seSApIFJvb3RzLm5lZWRSZVpvbmUgPSB0cnVlO1xyXG4gICAgICAgIC8vdGhpcy5yZXNpemUoKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgc2V0SXRlbVdpZHRoICggdyApIHtcclxuXHJcbiAgICAgICAgbGV0IGkgPSB0aGlzLnVpcy5sZW5ndGg7XHJcbiAgICAgICAgd2hpbGUoaS0tKXtcclxuICAgICAgICAgICAgdGhpcy51aXNbaV0uc2V0U2l6ZSggdyApO1xyXG4gICAgICAgICAgICB0aGlzLnVpc1tpXS5yU2l6ZSgpXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbn1cclxuXHJcbkd1aS5wcm90b3R5cGUuaXNHdWkgPSB0cnVlOyIsIi8vaW1wb3J0ICcuL3BvbHlmaWxscy5qcyc7XHJcblxyXG5leHBvcnQgY29uc3QgUkVWSVNJT04gPSAnMy4wJztcclxuXHJcbmV4cG9ydCB7IFRvb2xzIH0gZnJvbSAnLi9jb3JlL1Rvb2xzLmpzJztcclxuZXhwb3J0IHsgR3VpIH0gZnJvbSAnLi9jb3JlL0d1aS5qcyc7XHJcbmV4cG9ydCB7IFByb3RvIH0gZnJvbSAnLi9jb3JlL1Byb3RvLmpzJztcclxuZXhwb3J0IHsgYWRkIH0gZnJvbSAnLi9jb3JlL2FkZC5qcyc7XHJcbi8vXHJcbmV4cG9ydCB7IEJvb2wgfSBmcm9tICcuL3Byb3RvL0Jvb2wuanMnO1xyXG5leHBvcnQgeyBCdXR0b24gfSBmcm9tICcuL3Byb3RvL0J1dHRvbi5qcyc7XHJcbmV4cG9ydCB7IENpcmN1bGFyIH0gZnJvbSAnLi9wcm90by9DaXJjdWxhci5qcyc7XHJcbmV4cG9ydCB7IENvbG9yIH0gZnJvbSAnLi9wcm90by9Db2xvci5qcyc7XHJcbmV4cG9ydCB7IEZwcyB9IGZyb20gJy4vcHJvdG8vRnBzLmpzJztcclxuZXhwb3J0IHsgR3JvdXAgfSBmcm9tICcuL3Byb3RvL0dyb3VwLmpzJztcclxuZXhwb3J0IHsgSm95c3RpY2sgfSBmcm9tICcuL3Byb3RvL0pveXN0aWNrLmpzJztcclxuZXhwb3J0IHsgS25vYiB9IGZyb20gJy4vcHJvdG8vS25vYi5qcyc7XHJcbmV4cG9ydCB7IExpc3QgfSBmcm9tICcuL3Byb3RvL0xpc3QuanMnO1xyXG5leHBvcnQgeyBOdW1lcmljIH0gZnJvbSAnLi9wcm90by9OdW1lcmljLmpzJztcclxuZXhwb3J0IHsgU2xpZGUgfSBmcm9tICcuL3Byb3RvL1NsaWRlLmpzJztcclxuZXhwb3J0IHsgVGV4dElucHV0IH0gZnJvbSAnLi9wcm90by9UZXh0SW5wdXQuanMnO1xyXG5leHBvcnQgeyBUaXRsZSB9IGZyb20gJy4vcHJvdG8vVGl0bGUuanMnOyJdLCJuYW1lcyI6WyJydW50aW1lIiwiZXhwb3J0cyIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiaXRlcmF0b3IiLCJhc3luY0l0ZXJhdG9yIiwidG9TdHJpbmdUYWciLCJvYmoiLCJrZXkiLCJ2YWx1ZSIsImlubmVyRm4iLCJhcmciLCJFcnJvciIsIm1ldGhvZCIsImNvbnRleHQiLCJHZW5TdGF0ZVN1c3BlbmRlZFN0YXJ0IiwiQ29udGludWVTZW50aW5lbCIsImRvbmUiLCJyZWNvcmQiLCJzZWxmIiwiZm4iLCJ3cmFwIiwiaXRlcmF0b3JTeW1ib2wiLCJnZXRQcm90b3R5cGVPZiIsImdldFByb3RvIiwidmFsdWVzIiwiY2FsbCIsIk5hdGl2ZUl0ZXJhdG9yUHJvdG90eXBlIiwiY3JlYXRlIiwiSXRlcmF0b3JQcm90b3R5cGUiLCJmb3JFYWNoIiwiZ2VuZXJhdG9yIiwicmVzb2x2ZSIsInJlamVjdCIsInRyeUNhdGNoIiwiaGFzT3duIiwidGhlbiIsIlByb21pc2VJbXBsIiwicHJldmlvdXNQcm9taXNlIiwiY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmciLCJkZWxlZ2F0ZSIsIlR5cGVFcnJvciIsImluZm8iLCJsb2NzIiwiZW50cnkiLCJ0cnlMb2NzTGlzdCIsInRoaXMiLCJpdGVyYWJsZSIsIm5leHQiLCJjb25zdHJ1Y3RvciIsImRpc3BsYXlOYW1lIiwiR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUiLCJpc0dlbmVyYXRvckZ1bmN0aW9uIiwibWFyayIsImF3cmFwIiwiQXN5bmNJdGVyYXRvciIsImFzeW5jSXRlcmF0b3JTeW1ib2wiLCJhc3luYyIsIm91dGVyRm4iLCJyZXN1bHQiLCJpdGVyIiwiR3AiLCJ0b1N0cmluZyIsImtleXMiLCJvYmplY3QiLCJDb250ZXh0IiwidW5kZWZpbmVkIiwibmFtZSIsImlzTmFOIiwiaSIsImhhbmRsZSIsImNhdGNoTG9jIiwiZmluYWxseUxvYyIsImZpbmFsbHlFbnRyeSIsInR5cGUiLCJhZnRlckxvYyIsInJlc3VsdE5hbWUiLCJuZXh0TG9jIiwibW9kdWxlIiwiYWNjaWRlbnRhbFN0cmljdE1vZGUiLCJUIiwiY3JlYXRlRG9jdW1lbnRGcmFnbWVudCIsIlBJIiwiYyIsIm8iLCJkb20iLCJjaGlsZE5vZGVzIiwic2V0QXR0cmlidXRlTlMiLCJsaW5rcyIsInNldCIsImRvY3VtZW50IiwiaHRtbHMiLCJfZG9tIiwiaWQiLCJhcHBlbmRDaGlsZCIsImciLCJhIiwibiIsImhleCIsInJlcGxhY2UiLCJwYXJzZUludCIsIk1hdGgiLCJsIiwibGVuZ3RoIiwidiIsInN1YnN0ciIsInQiLCJiIiwibWluIiwibWF4IiwiaCIsInMiLCJyIiwiaHVlVG9SZ2IiLCJwIiwicSIsInNldHRpbmdzIiwicGFyZW50IiwiY29sb3JzIiwidyIsInN2ZyIsImQiLCJjeCIsImN5IiwiZngiLCJmeSIsInRhbiIsImQyIiwiYTIiLCJhciIsImoiLCJwYXRoIiwiY2NjIiwiYTEiLCJoc2xUb1JnYiIsIm1pZCIsImNvbG9yIiwibnVkZ2UiLCJzZXRUZXh0IiwiVG9vbHMiLCJSIiwiTmFOIiwidWkiLCJpc0NhbnZhc09ubHkiLCJldmVudCIsImUiLCJjbGllbnRYIiwiY2xpZW50WSIsIklEIiwibW91c2UiLCJ4IiwieSIsInUiLCJ1aXMiLCJhdXRvV2lkdGgiLCJweSIsInB4IiwieiIsIm15IiwidG1wVGltZSIsImlzTmV3U2l6ZSIsImN0eCIsImNzcyIsImhpZGRlbkltcHV0IiwiaGlkZGVuU2l6ZXIiLCJzdHIiLCJzdGFydFgiLCJtb3ZlWCIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsIlJvb3RzIiwiVjIiLCJhbmdsZSIsImFscGhhIiwiUHJvdG8iLCJzdHlsZSIsIm1hcmdpbkJvdHRvbSIsInRleHRDb250ZW50IiwicG9zaXRpb24iLCJwb3MiLCJjc3NUZXh0IiwiaGVpZ2h0IiwiYmFja2dyb3VuZCIsImxpbmVIZWlnaHQiLCJsbmciLCJwcCIsImlkMiIsIndpZHRoIiwidG9GaXhlZCIsImRpc3BsYXkiLCJkb3duIiwiQm9vbCIsIl90aGlzIiwiYm9yZGVyQ29sb3IiLCJtYXJnaW5MZWZ0IiwibGVmdCIsIkJ1dHRvbiIsImNjIiwiaW5uZXJIVE1MIiwic3RhdCIsImZvbnRDb2xvciIsImZvbnRTZWxlY3QiLCJhZGRFdmVudExpc3RlbmVyIiwidGFyZ2V0IiwiZm5hbWUiLCJyZWFkZXIiLCJwYWRkaW5nIiwic2l6ZSIsIkNpcmN1bGFyIiwiQ29sb3IiLCJ0b3AiLCJib3R0b20iLCJvZmYiLCJyciIsInRyIiwiVHdvUEkiLCJodWUiLCJfcnIiLCJyYWQiLCJyYWQwIiwicmFkMSIsInNxcnQiLCJtYXhSIiwicmFkMiIsInBpOTAiLCJsdW0iLCJ0c2wiLCJjb3MiLCJzYXQiLCJjbGFtcCIsImhzbCIsInZpc2liaWxpdHkiLCJ1bnBhY2siLCJzeSIsImFkZFNjYWxhciIsIkZwcyIsIkRhdGUiLCJwYW5lbENzcyIsInNldEF0dHJpYnV0ZSIsImZvbnRXZWlnaHQiLCJib3JkZXJSYWRpdXMiLCJib3JkZXIiLCJwb2ludCIsInRpbWUiLCJHcmFwaCIsImdoIiwid20iLCJvaCIsInduIiwiaXciLCJHcm91cCIsImNoYW5nZSIsImlzT3BlbiIsImNsb3NlIiwib3BlbiIsInRtcGgiLCJpc1VJIiwibWFpbiIsInB1c2giLCJyZW1vdmVDaGlsZCIsImlzR3JvdXAiLCJKb3lzdGljayIsImRpdmlkZVNjYWxhciIsIm5lZ2F0ZSIsInVwIiwiYWJzIiwiS25vYiIsImVuZGFuZ2xlIiwic3RhcnRhbmdsZSIsInN0ZXAiLCJMaXN0IiwiZmx0b3AiLCJzYSIsInNjcm9sbCIsInNiIiwidGVzdEl0ZW1zIiwiYmFzZUgiLCJpdGVtIiwibnVwIiwiY2hpbGRyZW4iLCJOdW1lcmljIiwiaXNTaW5nbGUiLCJjdXJyZW50IiwiZm9yY2UiLCJueCIsIlNsaWRlIiwiaXNOdW0iLCJoMiIsInd3IiwicmEiLCJoMSIsInR4IiwiVGV4dElucHV0IiwiVGl0bGUiLCJ0ZXh0QWxpZ24iLCJ0b1VwcGVyQ2FzZSIsIlNlbGVjdCIsImJ1dHRvbkNvbG9yIiwiYnV0dG9uT3ZlciIsImJ1dHRvbkRvd24iLCJidXR0b25BY3Rpb24iLCJTZWxlY3RvciIsInNlbCIsIkVtcHR5IiwiSXRlbSIsImJnT3ZlciIsIkdyaWQiLCJpbnNlcnRSb3ciLCJyYWRpdXMiLCJ0eSIsImxpbmUiLCJhZGQiLCJ0b0xvd2VyQ2FzZSIsIkd1aSIsIm0iLCJmb250Iiwic2hhZG93IiwibW9kZSIsIm9udG9wIiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0Iiwic2VsZWN0ZWQiLCJjbGVhclRpbWVvdXQiLCJ3aW5kb3ciLCJoaGgiLCJpc0d1aSJdLCJtYXBwaW5ncyI6IjJPQU9BLElBQUlBLEVBQVcsU0FBVUMsa0JBR1JDLGNBQ0FDLHlEQUdhQywyQkFDS0MscUNBQ0ZDLHdDQUUvQkMsc0NBQ0VDLEVBQUEsbUVBVU0sSUFGUixzQkFJV0EsRUFBQUMsZUFDQUEsY0FJWEMscUhBOE1BQSxpQ0FHU0Msc0JBRUdDLCtGQWFSQyxRQUNBRix1SUFpQlNHLGlCQUNJQyw0REFP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
